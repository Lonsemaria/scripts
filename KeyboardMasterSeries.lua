
--[[
One Click to Challenger
Keyboard Master Series by Ensuluyn
Current Leauge Of Legends Version :5.24
Current Script Version :2.11
Last Update: 10.12.2015
--Credits to Nebelwolfi for mentoring <3
]]

assert(load(Base64Decode("DQogIC0tLS8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cXC0tLQ0KLS18fCA+IFNjcmlwdCBTdGFydCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8LS0NCi0tLVxcPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0vLy0tLQ0KICANCiAgbG9jYWwgVmVyc2lvbiA9ICIyLjExIiAgDQogIGxvY2FsIExWZXJzaW9uID0gIjUuMjQiDQogIGxvY2FsIFNjcmlwdG5hbWUgPSAiS2V5Ym9hcmQgTWFzdGVyIFNlcmllcyINCiAgbG9jYWwgQXV0aG9yID0gIkVuc3VsdXluIg0KICBsb2NhbCBsaXN0ID0gIkxlYmxhbmMgLCBMaXNzYW5kcmEgLCBWaWt0b3IsIEFrYWxpLCBEaWFuYSINCiAgbG9jYWwgbGluayA9ICJHbyB0byBodHRwOi8vZm9ydW0uYm90b2ZsZWdlbmRzLmNvbS9mb3J1bS8yMC1jaGFtcGlvbi1zY3JpcHRzLyB0aGVuIHlvdSBjYW4gc2VlIG15IHRvcGljICIuLlNjcmlwdG5hbWUuLiIgb24gdGhlIGZpcnN0IG9yIHNlY29uZCBwYWdlLiINCiAgbG9jYWwgZGF0ZSA9ICIwNi4xMi4yMDE1Ig0KICBnbG9iYWxfdGlja3MgPSAwDQogIGxvY2FsIGxhc3RUaW1lVGlja0NhbGxlZCA9IDANCiBsb2NhbCBGYWtlTG9hZCA9IGZhbHNlDQogICBpZiBGYWtlTG9hZCB0aGVuDQogIGxvY2FsIHNraW5zUEIgPSB7fTsNCiAgbG9jYWwgc2tpbk9iamVjdFBvcyA9IG5pbDsNCiAgbG9jYWwgc2tpbkhlYWRlciA9IG5pbDsNCiAgbG9jYWwgZGlzcGVsbEhlYWRlciA9IG5pbDsNCiAgbG9jYWwgc2tpbkggPSBuaWw7DQogIGxvY2FsIHNraW5IUG9zID0gbmlsOw0KICBlbmQNCiAgICAgIC0tLS8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cXC0tLQ0KLS18fCA+IEF1dG8gVXBkYXRlICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwtLQ0KLS0tXFw9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PS8vLS0tDQogIGxvY2FsIHZlcnNpb24gPSAyLjExDQogIGxvY2FsIGF1dGhvciA9ICJFbnN1bHV5biINCiAgbG9jYWwgU0NSSVBUX05BTUUgPSAiS2V5Ym9hcmRNYXN0ZXJTZXJpZXMiDQogIGxvY2FsIEFVVE9VUERBVEUgPSB0cnVlDQogIGxvY2FsIFVQREFURV9IT1NUID0gInJhdy5naXRodWIuY29tIg0KICBsb2NhbCBVUERBVEVfUEFUSCA9ICIvTG9uc2VtYXJpYS9zY3JpcHRzL21hc3Rlci9LZXlib2FyZE1hc3RlclNlcmllcy5sdWEiLi4iP3JhbmQ9Ii4ubWF0aC5yYW5kb20oMSwxMDAwMCkNCiAgbG9jYWwgVVBEQVRFX0ZJTEVfUEFUSCA9IFNDUklQVF9QQVRILi5HZXRDdXJyZW50RW52KCkuRklMRV9OQU1FDQogIGxvY2FsIFVQREFURV9VUkwgPSAiaHR0cHM6Ly8iLi5VUERBVEVfSE9TVC4uVVBEQVRFX1BBVEgNCiAgZnVuY3Rpb24gU2F5KHRleHQpDQogICAgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPktleWJvYXJkIE1hc3RlciBTZXJpZXM6PC9iPjwvZm9udD4gPGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+IiAuLiB0ZXh0IC4uICI8L2ZvbnQ+IikNCiAgZW5kDQogIGlmIEFVVE9VUERBVEUgdGhlbg0KICAgIGxvY2FsIFNlcnZlckRhdGEgPSBHZXRXZWJSZXN1bHQoVVBEQVRFX0hPU1QsICIvTG9uc2VtYXJpYS9zY3JpcHRzL21hc3Rlci92ZXJzaW9uL0J1bmRsZS52ZXJzaW9uIikNCiAgICBpZiBTZXJ2ZXJEYXRhIHRoZW4NCiAgICAgIFNlcnZlclZlcnNpb24gPSB0eXBlKHRvbnVtYmVyKFNlcnZlckRhdGEpKSA9PSAibnVtYmVyIiBhbmQgdG9udW1iZXIoU2VydmVyRGF0YSkgb3IgbmlsDQogICAgICBpZiBTZXJ2ZXJWZXJzaW9uIHRoZW4NCiAgICAgICAgaWYgdG9udW1iZXIodmVyc2lvbikgPCBTZXJ2ZXJWZXJzaW9uIHRoZW4NCiAgICAgICAgICBTYXkoIk5ldyB2ZXJzaW9uIGF2YWlsYWJsZSAiLi5TZXJ2ZXJWZXJzaW9uKQ0KICAgICAgICAgIFNheSgiVXBkYXRpbmcsIHBsZWFzZSBkb24ndCBwcmVzcyBGOSIpDQogICAgICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBEb3dubG9hZEZpbGUoVVBEQVRFX1VSTCwgVVBEQVRFX0ZJTEVfUEFUSCwgZnVuY3Rpb24gKCkgU2F5KCJTdWNjZXNzZnVsbHkgdXBkYXRlZC4gKCIuLnZlcnNpb24uLiIgPT4gIi4uU2VydmVyVmVyc2lvbi4uIiksIHByZXNzIEY5IHR3aWNlIHRvIGxvYWQgdGhlIHVwZGF0ZWQgdmVyc2lvbi4iKSBlbmQpIGVuZCwgMykNCiAgICAgICAgZWxzZQ0KICAgICAgICAgIFNheSgiLVdlbGNvbWUsIFlvdSBoYXZlIGdvdCB0aGUgbGF0ZXN0IHZlcnNpb24gKHYiLi5TZXJ2ZXJWZXJzaW9uLi4iKSBvZiAiLi5TY3JpcHRuYW1lLi4iICwgdXBkYXRlZCBhdCAoIi4uZGF0ZS4uIikgYnkgIiAuLiBhdXRob3IpDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgZWxzZSANCiAgICAgIFNheSgiRXJyb3IgZG93bmxvYWRpbmcgdmVyc2lvbiBpbmZvIikNCiAgICBlbmQNCiAgICANCiAgZW5kDQogICAgICAtLS0vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XFwtLS0NCi0tfHwgS2V5TWFzdGVyTGliIERvd25sb2FkICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fC0tDQotLS1cXD09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ly8tLS0NCiAgaWYgRmlsZUV4aXN0KExJQl9QQVRIIC4uICJLZXlib2FyZE1hc3RlckxpYi5sdWEiKSB0aGVuDQogICAgcmVxdWlyZSgiS2V5Ym9hcmRNYXN0ZXJMaWIiKQ0KICBlbHNlDQogIEZha2VMb2FkID0gdHJ1ZQ0KICAgIERlbGF5QWN0aW9uKERvd25sb2FkRmlsZSwgMCwgew0KICAgICAgImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9Mb25zZW1hcmlhL3NjcmlwdHMvbWFzdGVyL0tleWJvYXJkTWFzdGVyTGliLmx1YSIsDQogICAgICBMSUJfUEFUSC4uIlxcS2V5Ym9hcmRNYXN0ZXJMaWIubHVhIiwNCiAgICAgIGZ1bmN0aW9uICgpDQogICAgICBwcmludCgiPGZvbnQgY29sb3I9XCIjMDBGRkZGXCI+PGI+W0tleWJvYXJkTWFzdGVyTGliXTwvYj48L2ZvbnQ+IDxmb250IGNvbG9yPVwiI0ZGRkZGRlwiPktleWJvYXJkTWFzdGVyTGliLmx1YSBpcyBuZWNlc3NlcnksIHBsZWFzZSB3YWl0IHdoaWxlIGRvd25sb2FkaW5nLjwvZm9udD4iKQ0KICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKClwcmludCgiPGZvbnQgY29sb3I9XCIjMDBGRkZGXCI+PGI+W0tleWJvYXJkTWFzdGVyTGliXTwvYj48L2ZvbnQ+IDxmb250IGNvbG9yPVwiI0ZGRkZGRlwiPktleWJvYXJkTWFzdGVyTGliLmx1YSBoYXMgYmVlbiBkb3dubG9hZGVkLCBQbGVhc2UgcmVsb2FkICgyeEY5KTwvZm9udD4iKSBlbmQsIDUuNSkNCiAgICAgIGVuZA0KICAgIH0pDQogIGVuZA0KICAgIC0tLS8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cXC0tLQ0KLS18fCA+IE9ubG9hZCBGdW5jdGlvbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fC0tDQotLS1cXD09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ly8tLS0NCiAgZnVuY3Rpb24gT25Mb2FkKCkNCiAgICAgICAgICBpZiBub3QgUmVxdWlyZVNpbXBsZUxpYigpIHRoZW4gcmV0dXJuIGVuZA0KICAgICAgICAgIGl0ZW1maXgoKQ0KICAgICAgICAgICBpZiBfR1tteUhlcm8uY2hhck5hbWVdIHRoZW4NCiAgICAgICAgICAgICAgICAgIF9HW215SGVyby5jaGFyTmFtZV0oKQ0KICAgICAgICAgICAgICAgICAtLSBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+IFNraW4gSGFjayBjdXJyZW50bHkgZGlzYWJsZWQgdW50aWwgdGhlIG5leHQgdXBkYXRlIikgZW5kLCAxNCkNCiAgICAgICAgICBlbHNlDQogICAgICAgICAgIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjQ0JGNkZGXCI+IDpUaGlzIGNoYW1waW9uIGlzIG5vdCBzdXBwb3J0ZWQuIEN1cnJlbnRseSBzdXBwb3J0ZWQgY2hhbXBpb25zIGFyZTogIi4ubGlzdC4uIiAiICkNCiAgICAgICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjQ0JGNkZGXCI+RmVlbCBmcmVlIHRvIGNoZWNrIG15IGZvcnVtIHRvcGljIGFuZCBhc2sgYSBuZXcgY2hhbXBpb24gb3IgZ2l2ZSBmZWVkYmFjayIpIGVuZCwgMC41KQ0KICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNDQkY2RkZcIj4iLi5saW5rLi4iIikgZW5kLCAwLjUpDQogICAgICAgICAgZW5kDQogIGVuZA0KICAgICAgLS0tLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxcLS0tDQotLXx8ID4gU2NyaXB0U3RhdHVzLk5ldCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwtLQ0KLS0tXFw9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PS8vLS0tDQogIGFzc2VydChsb2FkKEJhc2U2NERlY29kZSgiRzB4MVlWSUFBUVFFQkFnQUdaTU5DaG9LQUFBQUFBQUFBQUFBQVFJS0FBQUFCZ0JBQUVGQUFBQWRRQUFCQmtCQUFHVUFBQUFLUUFDQkJrQkFBR1ZBQUFBS1FJQ0JId0NBQUFRQUFBQUVCZ0FBQUdOc1lYTnpBQVFOQUFBQVUyTnlhWEIwVTNSaGRIVnpBQVFIQUFBQVgxOXBibWwwQUFRTEFBQUFVMlZ1WkZWd1pHRjBaUUFDQUFBQUFnQUFBQWdBQUFBQ0FBb3RBQUFBaGtCQUFNYUFRQUFHd1VBQUJ3RkJBa0ZCQVFBZGdRQUJSc0ZBQUVjQndRS0JnUUVBWFlFQUFZYkJRQUNIQVVFRHdjRUJBSjJCQUFIR3dVQUF4d0hCQXdFQ0FnRGRnUUFCQnNKQUFBY0NRUVJCUWdJQUhZSUFBUllCQWdMZEFBQUJuWUFBQUFxQUFJQUtRQUNGaGdCREFNSEFBZ0NkZ0FBQkNvQ0FoUXFBdzRhR0FFUUF4OEJDQU1mQXd3SGRBSUFBbllBQUFBcUFnSWVNUUVRQUFZRUVBSjFBZ0FHR3dFUUE1UUFBQUoxQUFBRWZBSUFBRkFBQUFBUUZBQUFBYUhkcFpBQUVEUUFBQUVKaGMyVTJORVZ1WTI5a1pRQUVDUUFBQUhSdmMzUnlhVzVuQUFRREFBQUFiM01BQkFjQUFBQm5aWFJsYm5ZQUJCVUFBQUJRVWs5RFJWTlRUMUpmU1VSRlRsUkpSa2xGVWdBRUNRQUFBRlZUUlZKT1FVMUZBQVFOQUFBQVEwOU5VRlZVUlZKT1FVMUZBQVFRQUFBQVVGSlBRMFZUVTA5U1gweEZWa1ZNQUFRVEFBQUFVRkpQUTBWVFUwOVNYMUpGVmtsVFNVOU9BQVFFQUFBQVMyVjVBQVFIQUFBQWMyOWphMlYwQUFRSUFBQUFjbVZ4ZFdseVpRQUVDZ0FBQUdkaGJXVlRkR0YwWlFBQUJBUUFBQUIwWTNBQUJBY0FBQUJoYzNObGNuUUFCQXNBQUFCVFpXNWtWWEJrWVhSbEFBTUFBQUFBQUFEd1B3UVVBQUFBUVdSa1FuVm5jM0JzWVhSRFlXeHNZbUZqYXdBQkFBQUFDQUFBQUFnQUFBQUFBQU1GQUFBQUJRQUFBQXdBUUFDQlFBQUFIVUNBQVI4QWdBQUNBQUFBQkFzQUFBQlRaVzVrVlhCa1lYUmxBQU1BQUFBQUFBQUFRQUFBQUFBQkFBQUFBUUFRQUFBQVFHOWlablZ6WTJGMFpXUXViSFZoQUFVQUFBQUlBQUFBQ0FBQUFBZ0FBQUFJQUFBQUNBQUFBQUFBQUFBQkFBQUFCUUFBQUhObGJHWUFBUUFBQUFBQUVBQUFBRUJ2WW1aMWMyTmhkR1ZrTG14MVlRQXRBQUFBQXdBQUFBTUFBQUFFQUFBQUJBQUFBQVFBQUFBRUFBQUFCQUFBQUFRQUFBQUVBQUFBQkFBQUFBVUFBQUFGQUFBQUJRQUFBQVVBQUFBRkFBQUFCUUFBQUFVQUFBQUZBQUFBQmdBQUFBWUFBQUFHQUFBQUJnQUFBQVVBQUFBREFBQUFBd0FBQUFZQUFBQUdBQUFBQmdBQUFBWUFBQUFHQUFBQUJnQUFBQVlBQUFBSEFBQUFCd0FBQUFjQUFBQUhBQUFBQndBQUFBY0FBQUFIQUFBQUJ3QUFBQWNBQUFBSUFBQUFDQUFBQUFnQUFBQUlBQUFBQWdBQUFBVUFBQUJ6Wld4bUFBQUFBQUF0QUFBQUFnQUFBR0VBQUFBQUFDMEFBQUFCQUFBQUJRQUFBRjlGVGxZQUNRQUFBQTRBQUFBQ0FBMFhBQUFBaHdCQUFJeEFRQUVCZ1FBQVFjRUFBSjFBQUFLSEFFQUFqQUJCQVFGQkFRQkhnVUVBZ2NFQkFNY0JRZ0FCd2dFQVFBS0FBSUhDQVFER1FrSUF4NExDQlFIREFnQVdBUU1DblVDQUFZY0FRQUNNQUVNQm5VQUFBUjhBZ0FBTkFBQUFCQVFBQUFCMFkzQUFCQWdBQUFCamIyNXVaV04wQUFRUkFBQUFjMk55YVhCMGMzUmhkSFZ6TG01bGRBQURBQUFBQUFBQVZFQUVCUUFBQUhObGJtUUFCQXNBQUFCSFJWUWdMM041Ym1NdEFBUUVBQUFBUzJWNUFBUUNBQUFBTFFBRUJRQUFBR2gzYVdRQUJBY0FBQUJ0ZVVobGNtOEFCQWtBQUFCamFHRnlUbUZ0WlFBRUpnQUFBQ0JJVkZSUUx6RXVNQTBLU0c5emREb2djMk55YVhCMGMzUmhkSFZ6TG01bGRBMEtEUW9BQkFZQUFBQmpiRzl6WlFBQUFBQUFBUUFBQUFBQUVBQUFBRUJ2WW1aMWMyTmhkR1ZrTG14MVlRQVhBQUFBQ2dBQUFBb0FBQUFLQUFBQUNnQUFBQW9BQUFBTEFBQUFDd0FBQUFzQUFBQUxBQUFBREFBQUFBd0FBQUFOQUFBQURRQUFBQTBBQUFBT0FBQUFEZ0FBQUE0QUFBQU9BQUFBQ3dBQUFBNEFBQUFPQUFBQURnQUFBQTRBQUFBQ0FBQUFCUUFBQUhObGJHWUFBQUFBQUJjQUFBQUNBQUFBWVFBQUFBQUFGd0FBQUFFQUFBQUZBQUFBWDBWT1ZnQUJBQUFBQVFBUUFBQUFRRzlpWm5WelkyRjBaV1F1YkhWaEFBb0FBQUFCQUFBQUFRQUFBQUVBQUFBQ0FBQUFDQUFBQUFJQUFBQUpBQUFBRGdBQUFBa0FBQUFPQUFBQUFBQUFBQUVBQUFBRkFBQUFYMFZPVmdBPSIpLCBuaWwsICJidCIsIF9FTlYpKSgpIFNjcmlwdFN0YXR1cygiVEdKSk9LSEdGSkYiKSANCiAgLS0tLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxcLS0tDQotLXx8ID4gTGVibGFuYyBTdGFydC0gVmFyaWFibGVzICAgICAgICAgICAgICAgICAgICAgICAgICB8fC0tDQotLS1cXD09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ly8tLS0NCiAgY2xhc3MgIkxlYmxhbmMiDQogIGZ1bmN0aW9uIExlYmxhbmM6X19pbml0KCkNCiAgc2VsZi50cz0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgNTI1LCBEQU1BR0VfUEhZU0lDQUwsIGZhbHNlLCB0cnVlKQ0KICAgIHNlbGYudHNxPSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCA3MDAsIERBTUFHRV9QSFlTSUNBTCwgZmFsc2UsIHRydWUpDQogICBzZWxmLnRzdz0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgNjAwLCBEQU1BR0VfTUFHSUMsIGZhbHNlLCB0cnVlKQ0KICAgIHNlbGYudHNlPSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCA5MjUsIERBTUFHRV9NQUdJQywgZmFsc2UsIHRydWUpDQogICAgc2VsZi50c3I9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDkyNSwgREFNQUdFX01BR0lDLCBmYWxzZSwgdHJ1ZSkgDQogICAgc2VsZi50c2c9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDk1MCwgREFNQUdFX01BR0lDLCBmYWxzZSwgdHJ1ZSkgDQogICAgIHNlbGYuUVNwZWxsID0gX1NwZWxsKHtTbG90ID0gX1EsIERhbWFnZU5hbWUgPSAiUSIsIFJhbmdlID0gNzAwLCBXaWR0aCA9IDEsIERlbGF5ID0gMCwgU3BlZWQgPSBtYXRoLmh1Z2UsIENvbGxpc2lvbiA9IGZhbHNlLCBBb2UgPSBmYWxzZSwgVHlwZSA9IFNQRUxMX1RZUEUuVEFSR0VUVEVEfSkNCiAgICAgc2VsZi5XU3BlbGwgPSBfU3BlbGwoe1Nsb3QgPSBfVywgRGFtYWdlTmFtZSA9ICJXIiwgUmFuZ2UgPSA2MDAsIFdpZHRoID0gMTI1LCBEZWxheSA9IDAuNSwgU3BlZWQgPSAxMzAwLCBSYWRpdXMgPSAyNTAgLCBDb2xsaXNpb24gPSBmYWxzZSwgQW9lID0gdHJ1ZSwgVHlwZSA9IFNQRUxMX1RZUEUuVEFSR0VUVEVEfSkNCiAgICAgc2VsZi5FU3BlbGwgPSBfU3BlbGwoe1Nsb3QgPSBfRSwgRGFtYWdlTmFtZSA9ICJFIiwgUmFuZ2UgPSA5MjUsIFdpZHRoID0gNTUsIERlbGF5ID0gMC4yNSwgU3BlZWQgPSAxNjAwLCBDb2xsaXNpb24gPSB0cnVlLCBBb2UgPSBmYWxzZSwgVHlwZSA9IFNQRUxMX1RZUEUuTElORUFSfSkNCiAgICAgc2VsZi5SU3BlbGwgPSBfU3BlbGwoe1Nsb3QgPSBfUiwgRGFtYWdlTmFtZSA9ICJSIiwgUmFuZ2UgPTYwMCwgV2lkdGggPSAxMjUsIERlbGF5ID0gMC41LCBTcGVlZCA9IDEzMDAsIENvbGxpc2lvbiA9IGZhbHNlLCBBb2UgPSB0cnVlLCBUeXBlID0gU1BFTExfVFlQRS5UQVJHRVRURUR9KQ0KICAgICBzZWxmLklnbml0ZSA9IF9TcGVsbCh7U2xvdCA9IEZpbmRTdW1tb25lclNsb3QoInN1bW1vbmVyZG90IiksIERhbWFnZU5hbWUgPSAiSUdOSVRFIiwgUmFuZ2UgPSA2MDAsIFR5cGUgPSBTUEVMTF9UWVBFLlRBUkdFVFRFRH0pDQogICAgIHNlbGYubGVibGFuY1csIHNlbGYubGVibGFuY0ltYWdlLCBzZWxmLmNsb25lSWQgPSBuaWwsIG5pbCwgbmlsDQogIC0tfD4gTWluaW9uIE1hbmFnZXJzDQogICAgICBzZWxmLmVuZW15TWluaW9ucyAgID0gbWluaW9uTWFuYWdlcihNSU5JT05fRU5FTVksICAgNjUwLCBteUhlcm8sIE1JTklPTl9TT1JUX01BWEhFQUxUSF9ERUMpDQogICAgICBzZWxmLmFsbHlNaW5pb25zICAgID0gbWluaW9uTWFuYWdlcihNSU5JT05fQUxMWSwgICA2NTAsIG15SGVybywgTUlOSU9OX1NPUlRfTUFYSEVBTFRIX0RFQykNCiAgICAgIHNlbGYuanVuZ2xlTWluaW9ucyAgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9KVU5HTEUsICA2NTAsIG15SGVybywgTUlOSU9OX1NPUlRfTUFYSEVBTFRIX0RFQykNCiAgICAgIHNlbGYub3RoZXJNaW5pb25zICAgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9PVEhFUiwgICA2NTAsIG15SGVybywgTUlOSU9OX1NPUlRfTUFYSEVBTFRIX0RFQykNCiAgICAgIHNlbGY6TG9hZE1lbnUoKQ0KICAgICAgICBzZWxmOmZpbmRvcmJ3YWxrZXIoKQ0KICAgICAgICAgIExhc3RfTGV2ZWxTcGVsbCA9IDANCiAgICAgICAgQ2xvY2sgPSBvcy5jbG9jaygpDQogICAgICAgICANCiAgICAgICAgQWRkVGlja0NhbGxiYWNrKGZ1bmN0aW9uKCkgc2VsZjpUaWNrKCkgZW5kKQ0KICAgIEFkZERyYXdDYWxsYmFjayhmdW5jdGlvbigpIHNlbGY6RHJhdygpIGVuZCkNCiAgICBBZGRNc2dDYWxsYmFjayhmdW5jdGlvbihtc2csS2V5KSBzZWxmOlduZE1zZyhtc2csS2V5KSBlbmQpDQogICAgLS1BZGRBbmltYXRpb25DYWxsYmFjayhmdW5jdGlvbih1bml0LCBhbmltYXRpb24pIHNlbGY6QW5pbWF0aW9uKHVuaXQsIGFuaW1hdGlvbikgZW5kKQ0KICAgIC0tQWRkUHJvY2Vzc1NwZWxsQ2FsbGJhY2soZnVuY3Rpb24odW5pdCwgc3BlbGwpIHNlbGY6UHJvY2Vzc1NwZWxsKHVuaXQsIHNwZWxsKSBlbmQpDQogICAgLS1BZGRBcHBseUJ1ZmZDYWxsYmFjayhmdW5jdGlvbihzb3VyY2UsIHVuaXQsIGJ1ZmYpIHNlbGY6T25BcHBseUJ1ZmYoc291cmNlLCB1bml0LCBidWZmKSBlbmQpDQogICAgLS1BZGRVcGRhdGVCdWZmQ2FsbGJhY2soZnVuY3Rpb24odW5pdCwgYnVmZiwgc3RhY2tzKSBzZWxmOlVwZGF0ZUJ1ZmYodW5pdCwgYnVmZiwgc3RhY2tzKSBlbmQpDQogICAgLS1BZGRSZW1vdmVCdWZmQ2FsbGJhY2soZnVuY3Rpb24odW5pdCwgYnVmZikgc2VsZjpPblJlbW92ZUJ1ZmYodW5pdCwgYnVmZikgZW5kKSANCiAgICAgIGVuZA0KLS0tLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxcLS0tDQotLXx8ID4gTGVibGFuYyBNZW51ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fC0tDQotLS1cXD09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ly8tLS0NCiAgICAgIGZ1bmN0aW9uIExlYmxhbmM6TG9hZE1lbnUoKQ0KICAgICAgc2VsZi5Db25maWc9c2NyaXB0Q29uZmlnKCIiLi5TY3JpcHRuYW1lLi4iIFsiIC4uIG15SGVyby5jaGFyTmFtZS4uIl0iICwibWVudSIpDQogIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJDb21ibyBTZXR0aW5ncyIsICJjb21ibyIpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VRIiwgIlVzZSBRIGluIENvbWJvIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlVyIsICJVc2UgVyBpbiBDb21ibyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZUUiLCAiVXNlIEUgaW4gY29tYm8iLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VSIiwgIlVzZSBSIGluIGNvbWJvIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlSSIsICJVc2UgSWduaXRlIGlmIHRhcmdldCBraWxsYWJsZSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgLS1zZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgiZ2FwY2xvc2UiLCAiVXNlIFcgYXMgYSBnYXBjbG9zZSAoIEJldGEgKSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJsb2dpYyIsICJDb21ibyBsb2dpYyIsIFNDUklQVF9QQVJBTV9MSVNULCAxLCB7IlE+RT5XPlIiLCAiUT5SPkU+VyIsICJFPlE+Vz5SIiwgIkU+Vz5RPlIiICwiUmFuZG9tIFNraWxsIE9yZGVyIn0pDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFN1Yk1lbnUoIlcgU2tpbGwgdHVybiBiYWNrIHNldHRpbmdzIiwgInR1cm53IikNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm8udHVybnc6YWRkUGFyYW0oIncxIiwiVHVybiBiYWNrIHRvIFcgc3BvdCBvbiBRPkU+Vz5SIG1vZGUgIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvLnR1cm53OmFkZFBhcmFtKCJ3MiIsIlR1cm4gYmFjayB0byBXIHNwb3Qgb24gUT5SPkU+VyBtb2RlICIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5jb21iby50dXJudzphZGRQYXJhbSgidzMiLCJUdXJuIGJhY2sgdG8gVyBzcG90IG9uIEU+UT5XPlIgbW9kZSAiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm8udHVybnc6YWRkUGFyYW0oInc0IiwiVHVybiBiYWNrIHRvIFcgc3BvdCBvbiBFPlc+UT5SIG1vZGUgIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvLnR1cm53OmFkZFBhcmFtKCJ3NSIsIlR1cm4gYmFjayB0byBXIHNwb3Qgb24gUmFuZG9tIFNraWxsIE9yZGVyIG1vZGUgIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJNYW5hIiwiTWFuYSBNYW5hZ2VyICUiLFNDUklQVF9QQVJBTV9TTElDRSwgMTAsIDEwLCAxMDAsIDApDQogICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJIYXJhc3MgU2V0dGluZ3MiLCAiaGFyYXNzIikNCiAgICAgICAgc2VsZi5Db25maWcuaGFyYXNzOmFkZFBhcmFtKCJ1c2VRIiwgIkhhcmFzcyBXaXRoIFEiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczphZGRQYXJhbSgidXNlVyIsICJIYXJhc3MgV2l0aCBXIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6YWRkUGFyYW0oIk1hbmEiLCJNYW5hIE1hbmFnZXIgJSIsU0NSSVBUX1BBUkFNX1NMSUNFLCAxMCwgMTAsIDEwMCwgMCkNCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkxhbmVDbGVhciBTZXR0aW5ncyIsImxhbmVjbGVhciIpDQogICAgICAgIHNlbGYuQ29uZmlnLmxhbmVjbGVhcjphZGRQYXJhbSgidXNlUSIsIlVzZSBRIG9uIExhbmVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmxhbmVjbGVhcjphZGRQYXJhbSgidXNlVyIsIlVzZSBXIG9uIExhbmVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmxhbmVjbGVhcjphZGRQYXJhbSgidXNlUiIsIlVzZSBSIG9uIExhbmVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5sYW5lY2xlYXI6YWRkUGFyYW0oIk1hbmEiLCJNYW5hIE1hbmFnZXIgJSIsU0NSSVBUX1BBUkFNX1NMSUNFLCAzMCwgMTAsIDEwMCwgMCkNCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkp1bmdsZUNsZWFyIFNldHRpbmdzIiwianVuZ2xlY2xlYXIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhcjphZGRQYXJhbSgidXNlUSIsIlVzZSBRIG9uIGp1bmdsZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuanVuZ2xlY2xlYXI6YWRkUGFyYW0oInVzZVciLCJVc2UgVyBvbiBMYW5lY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhcjphZGRQYXJhbSgidXNlRSIsIlVzZSBFIG9uIGp1bmdsZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuanVuZ2xlY2xlYXI6YWRkUGFyYW0oIk1hbmEiLCJNYW5hIE1hbmFnZXIgJSIsU0NSSVBUX1BBUkFNX1NMSUNFLCAzMCwgMTAsIDEwMCwgMCkNCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkVzY2FwZSBTZXR0aW5ncyIsImVzY2FwZSIpDQogICAgICAgIHNlbGYuQ29uZmlnLmVzY2FwZTphZGRQYXJhbSgidXNlVyIsIlVzZSBXIFdoaWxlIEVzY2FwZSIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmVzY2FwZTphZGRQYXJhbSgidXNlUiIsIlVzZSBSIFdoaWxlIEVzY2FwZSIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogIA0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiS2lsbFN0ZWFsIFNldHRpbmdzIiwgImtpbGxzdGVhbCIpDQogICAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgia3MiLCJLaWxsc3RlYWwgT24vT2ZmIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJ1c2VRIiwgIlN0ZWFsIFdpdGggUSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJ1c2VXIiwgIlN0ZWFsIFdpdGggVyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJ1c2VFIiwgIlN0ZWFsIFdpdGggRSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJ1c2VSIiwgIlN0ZWFsIFdpdGggUiIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJ1c2VRVyIsICJTdGVhbCBXaXRoIFFXIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZUkiLCAiU3RlYWwgV2l0aCBJZ25pdGUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJJdGVtIFNldHRpbmdzIiwgIml0ZW0iKQ0KICAgICAgICBzZWxmLkNvbmZpZy5pdGVtOmFkZFBhcmFtKCJlbmFibGVhdXRvemhvbnlhIiwgIkF1dG8gWmhvbnlhIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCBmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcuaXRlbTphZGRQYXJhbSgiYXV0b3pob255YSIsICJaaG9ueWEgaWYgSGVhbHRoIHVuZGVyIC0+ICUiLCBTQ1JJUFRfUEFSQU1fU0xJQ0UsIDEwLCAwLCAxMDAsIDApDQogICAgICAgIA0KICAgICAgICBpZiBWSVBfVVNFUiB0aGVuDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIlZJUCBTZXR0aW5ncyIsICJ2aXAiKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oInBhY2tldCIsIlVzZSBQYWNrZXQgQ2FzdGluZyIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm8xIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm8yIiwgIlRvIHVzZSB2aXAgc2V0dGluZ3MsIFBhY2tldCBDYXN0aW5nIHNob3VsZCBiZSBvcGVuLiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXA6YWRkU3ViTWVudSgiQXV0byBMZXZlbCBTZXR0aW5ncyIsICJsZXZlbCIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcC5sZXZlbDphZGRQYXJhbSgia2V5IiwiVXNlIEF1dG8gTGV2ZWwiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcudmlwLmxldmVsOmFkZFBhcmFtKCJsb2dpYyIsICJTZWxlY3QgU2tpbGwgT3JkZXIiLCBTQ1JJUFRfUEFSQU1fTElTVCwgNywgeyJGb2N1cyBRPlc+RSIsICJGb2N1cyBRPkU+VyIsIkZvY3VzIFc+UT5FIiwiRm9jdXMgVz5FPlEiLCJGb2N1cyBFPlc+USIsICJGb2N1cyBFPlE+VyIsICJTbWFydCIgIH0pDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRTdWJNZW51KCJTa2luIEhhY2sgU2V0dGluZ3MiLCAic2tpbiIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcC5za2luOmFkZFBhcmFtKCJrZXkiLCJVc2UgU2tpbiBIYWNrIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcC5za2luOmFkZFBhcmFtKCdzZWxlY3RlZCcgLi4gbXlIZXJvLmNoYXJOYW1lIC4uICdTa2luJywgIlNlbGVjdCBTa2luIiwgU0NSSVBUX1BBUkFNX0xJU1QsIDEsIHNraW5NZXRhW215SGVyby5jaGFyTmFtZV0pDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcC5za2luOmFkZFBhcmFtKCJpbmZvNSIsICJNYWtlIHN1cmUgdGhhdCB1c2luZyBwYWNrZXQgY2FzdGluZyBpcyBPTi4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgLS1zZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm81IiwgIlNraW4gSGFjayB0ZW1wb3JhcnkgZGlzYWJsZWQgdW50aWwgbmV4dCB1cGRhdGUuIC4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgLS1bW3NlbGYuQ29uZmlnLnZpcDphZGRTdWJNZW51KCJBbnRpLUFGSyBTZXR0aW5ncyIsICJhbnRpYWZrIikNCiAgICAgICAgc2VsZi5Db25maWcudmlwLmFudGlhZms6YWRkUGFyYW0oImFudGlhZmsiLCJVc2UgQW50aSBBZmsiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkgXV0NCiAgICAgICAgc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvMyIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvNCIsICJUbyB1c2UgdmlwIHNldHRpbmdzLCBZb3UgbmVlZCB0byBiZSBhIFZJUCB1c2VyIG9uIEJPTCBjb21tdW5pdHkuIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgZW5kDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkRyYXcgU2V0dGluZ3MiLCJvdGhlciIpDQogICAgICAgIC0tc2VsZi5Db25maWcub3RoZXI6YWRkU3ViTWVudSgiU2hvdyBEYW1hZ2UgT24gSHAgQmFyIiwgIkhQQkFSIikNCiAgICAgICAgLS1zZWxmLkNvbmZpZy5vdGhlci5IUEJBUjphZGRQYXJhbSgia2V5IiwiT04vT0ZGIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXI6YWRkU3ViTWVudSgiU2tpbGwgRHJhd2luZyBTZXR0aW5ncyIsICJkcmF3IikNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgicWRyYXciLCJRIFNraWxsIERyYXdpbmdzIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgid2RyYXciLCJXIFNraWxsIERyYXdpbmdzIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgiZWRyYXciLCJFIFNraWxsIERyYXdpbmdzIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgicmRyYXciLCJSIFNraWxsIERyYXdpbmdzIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgiYWFkcmF3IiwiQXV0byBBdHRhY2sgUmFuZ2UiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXI6YWRkUGFyYW0oImNvbWJvbW9kZSIsIkRyYXcgQ29tYm8gTW9kZSIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLm90aGVyOmFkZFN1Yk1lbnUoIkRyYXcgUGVybWFib3giLCAicGVybWEiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5vdGhlci5wZXJtYTphZGRQYXJhbSgicGVybWEiLCJEcmF3IFBlcm1hYm94ICggTmVlZHMgMnggRjkgKSIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLm90aGVyOmFkZFBhcmFtKCJ0YXJnZXQiLCJEcmF3IGNpcmNsZSBmb3IgdGFyZ2V0IHNlbGVjdGVkIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXI6YWRkUGFyYW0oInRhcmdldGNhbCIsIlRhcmdldCBjYWxjdWxhdGlvbiIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJUYXJnZXRzZWxlY3RvcnMiLCJ0YXJnZXRzZWwiKQ0KICAgICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkUGFyYW0oImluZm9LMiIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFBhcmFtKCJpbmZvSyIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFBhcmFtKCJ0cyIsIkxlZnQgQ2xpY2sgRm9yIFRhcmdldCBTZWxlY3Rpb24iLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgIHNlbGYudHMubmFtZSAgPSAiTGVibGFuYyINCiAgICAgIHNlbGYudHNxLm5hbWUgPSAiTGVibGFuY1EiDQogICAgICBzZWxmLnRzdy5uYW1lID0gIkxlYmxhbmNXIg0KICAgICAgc2VsZi50c2UubmFtZSA9ICJMZWJsYW5jRSINCiAgICAgIHNlbGYudHNyLm5hbWUgPSAiTGVibGFuY1IiDQogICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkVFMoc2VsZi50cykNCiAgICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRUUyhzZWxmLnRzcSkNCiAgICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRUUyhzZWxmLnRzdykNCiAgICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRUUyhzZWxmLnRzZSkNCiAgICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRUUyhzZWxmLnRzcikgDQogICAgICANCiAgICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJLZXlzIFNldHRpbmdzIiwgIktleXMiKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0szIiwgIjwtLS0tLS0tLS0tLS0tLS0tLS1Db21ibyBLZXkgU2V0dGluZ3MtLS0tLS0tLS0tLS0tLS0tLS0+IiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJjb21ib2tleSIsICJDb21ibyBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgMzIpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJvbmx5ZSIsICJPbmx5IHVzZSBFIFNraWxsIChPbmx5IFN0dW4pIiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTixmYWxzZSwgc3RyaW5nLmJ5dGUoIk8iKSkNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImNvbWJvbW9kZSIsICIgU2VsZWN0IENvbWJvbW9kZSBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLGZhbHNlLCBzdHJpbmcuYnl0ZSgiMiIpKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0s0IiwgIjwtLS0tLS0tLS0tLS0tLS0tLS1IYXJhc3MgS2V5IFNldHRpbmdzLS0tLS0tLS0tLS0tLS0tLS0tPiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaGFyYXNza2V5IiwgIlNtYXJ0IEhhcmFzcyBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIkMiKSkNCiAgICAgLS0gc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaGFyYXNzdG9nbGVrZXkiLCAiSGFyYXNzIFRvZ2xlIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWVRPR0dMRSwgZmFsc2UsIHN0cmluZy5ieXRlKCJUIikpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJpbmZvSzUiLCAiPC0tLS0tLS0tLS0tLS0tLS0tLUNsZWFyIEtleSBTZXR0aW5ncy0tLS0tLS0tLS0tLS0tLS0tLS0tPiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgibGFuZWNsZWFya2V5IiwgIkxhbmVDbGVhciBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIlYiKSkNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImp1bmdsZWNsZWFya2V5IiwgIkp1bmdsZUNsZWFyIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiWiIpKQ0KICAgICAgLS1zZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJsYXN0aGl0a2V5IiwgIkxhc3RoaXQgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJYIikpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJpbmZvSzYiLCAiPC0tLS0tLS0tLS0tLS0tLS0tLU90aGVyIEtleSBTZXR0aW5ncy0tLS0tLS0tLS0tLS0tLS0tLS0tPiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiZXNjYXBla2V5IiwgIkVzY2FwZSBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIlkiKSkNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0syIiwgIk1ha2UgU3VyZSBUaGF0IFlvdXIgT3Jid2Fsa2VyIEtleXMgYXJlIFNhbWUgQXMgSGVyZSIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiT3J3V2Fsa2VyS2V5IFNldHRpbmdzIiwgIktleXMyIikNCiAgICAgIA0KICAgICAgT3Jid2Fsa01hbmFnZXI6TG9hZENvbW1vbktleXMoc2VsZi5Db25maWcuS2V5czIpDQogICAgICAgDQogICAgICAgDQogICAgICAgaWYgc2VsZi5Db25maWcub3RoZXIucGVybWEucGVybWEgdGhlbg0KICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgc2VsZi5Db25maWc6cGVybWFTaG93KCJpbmZvYm94IikgZW5kLCAxKQ0KICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBzZWxmLkNvbmZpZy5LZXlzOnBlcm1hU2hvdygiY29tYm9rZXkiKSAgZW5kLCAxLjIpDQogICAgICAtLXNlbGYuQ29uZmlnLktleXM6cGVybWFTaG93KCJoYXJhc3N0b2dsZWtleSIpDQogICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBzZWxmLkNvbmZpZy5LZXlzOnBlcm1hU2hvdygiaGFyYXNza2V5IikgIGVuZCwgMS4yKQ0KICAgIGVuZA0KICBlbmQNCiAtLS0vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XFwtLS0NCi0tfHwgPiBMZWJsYW5jIERyYXdpbmdzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fC0tDQotLS1cXD09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ly8tLS0NCiAgZnVuY3Rpb24gTGVibGFuYzpjb21ib21vZGUoKQ0KICBsb2NhbCBkcmF3cG9zID0gR2V0VW5pdEhQQmFyUG9zKG15SGVybykNCiAgaWYgc2VsZi5Db25maWcuY29tYm8ubG9naWMgPT0gMSB0aGVuDQogIERyYXdUZXh0KCJDdXJyZW50IENvbWJvIE1vZGU6IFE+RT5XPlIiLCAxMiwgZHJhd3Bvcy54LTQwLCBkcmF3cG9zLnkrMTYsIDB4ZmYwMGZmZmYpIGVuZA0KICBpZiBzZWxmLkNvbmZpZy5jb21iby5sb2dpYyA9PSAyIHRoZW4NCiAgRHJhd1RleHQoIkN1cnJlbnQgQ29tYm8gTW9kZTogUT5SPkU+VyIsIDEyLCBkcmF3cG9zLngtNDAsIGRyYXdwb3MueSsxNiwgMHhmZjAwZmZmZikgZW5kDQogIGlmIHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID09IDMgdGhlbg0KICBEcmF3VGV4dCgiQ3VycmVudCBDb21ibyBNb2RlOiBFPlE+Vz5SIiwgMTIsIGRyYXdwb3MueC00MCwgZHJhd3Bvcy55KzE2LCAweGZmMDBmZmZmKSBlbmQNCiAgaWYgc2VsZi5Db25maWcuY29tYm8ubG9naWMgPT0gNCB0aGVuDQogIERyYXdUZXh0KCJDdXJyZW50IENvbWJvIE1vZGU6IEU+Vz5RPlIiLCAxMiwgZHJhd3Bvcy54LTQwLCBkcmF3cG9zLnkrMTYsIDB4ZmYwMGZmZmYpIGVuZA0KICBpZiBzZWxmLkNvbmZpZy5jb21iby5sb2dpYyA9PSA1IHRoZW4NCiAgRHJhd1RleHQoIkN1cnJlbnQgQ29tYm8gTW9kZTogUmFuZG9tIFNraWxsIE9yZGVyIiwgMTIsIGRyYXdwb3MueC00MCwgZHJhd3Bvcy55KzE2LCAweGZmMDBmZmZmKSBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6RHJhdygpDQogIGlmIHNlbGYuQ29uZmlnLm90aGVyLmNvbWJvbW9kZSB0aGVuDQogIGxvY2FsIGRyYXdwb3MgPSBHZXRVbml0SFBCYXJQb3MobXlIZXJvKQ0KICBzZWxmOmNvbWJvbW9kZSgpDQogIGVuZA0KICAgICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LnFkcmF3IGFuZCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkgdGhlbg0KICAgICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDY1MCwgMSxyZWQpDQogICAgZW5kDQogIA0KICAgIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcud2RyYXcgYW5kIHNlbGYuV1NwZWxsOklzUmVhZHkoKSB0aGVuDQogICAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgNjAwLCAxLCByZWQpDQogICAgZW5kDQogIA0KICAgIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcuZWRyYXcgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSB0aGVuDQogICAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgOTI1LCAxLCByZWQpDQogICAgZW5kDQogICAgDQogICAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5yZHJhdyBhbmQgc2VsZi5SU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCA3MDAsMSwgcmVkKQ0KICAgIGVuZA0KICAgIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcuYWFkcmF3IHRoZW4NCiAgICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCA1NTAsMSwgQVJHQigyNTUsIDI1NSwwLDApKQ0KICAgIGVuZA0KICAgICAgICAgICAgICBpZiBzZWxmLkNvbmZpZy5vdGhlci50YXJnZXQgYW5kIHNlbGYuc2VsZWN0ZWRUYXIgfj0gbmlsIHRoZW4NCiAgICAgICAgIERyYXdDaXJjbGUzRChzZWxmLnNlbGVjdGVkVGFyLngsIHNlbGYuc2VsZWN0ZWRUYXIueSwgc2VsZi5zZWxlY3RlZFRhci56LCA4MCw2LCBBUkdCKDI1NSwgMjU1LDAsMCkpDQplbmQNCiAgaWYgc2VsZi5Db25maWcub3RoZXIudGFyZ2V0Y2FsIGFuZCBub3QgbXlIZXJvLmRlYWQgdGhlbg0KICAgICAgaWYgdGFyZ2V0IGFuZCB0YXJnZXQgfj0gbmlsIHRoZW4NCiAgICAgICAgbG9jYWwgZHJhd3Bvcz1Xb3JsZFRvU2NyZWVuKEQzRFhWRUNUT1IzKHRhcmdldC54LCB0YXJnZXQueSwgdGFyZ2V0LnopKQ0KICAgICAgICBsb2NhbCBjb21ib1RleHQsY29sb3IgPSBzZWxmOkdldERyYXdzKHRhcmdldCkNCiAgICAgICAgaWYgY29tYm9UZXh0IHRoZW4NCiAgICAgICAgICBEcmF3VGV4dChjb21ib1RleHQsMTUsZHJhd3Bvcy54LTIwLGRyYXdwb3MueS0yMCxjb2xvcikNCiAgICAgICAgZW5kIA0KICAgICAgZW5kIA0KICAgICAgZW5kDQogICAgICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpHZXREcmF3cyh0YXJnZXQpDQpEbWc9e1E9c2VsZi5RU3BlbGw6SXNSZWFkeSgpIGFuZCBnZXREbWcoIlEiLHRhcmdldCxteUhlcm8pb3IgMCxRMj1nZXREbWcoIlEiLHRhcmdldCxteUhlcm8sMilvciAwLFc9c2VsZi5XU3BlbGw6SXNSZWFkeSgpIGFuZCBnZXREbWcoIlciLHRhcmdldCxteUhlcm8pb3IgMCxFPXNlbGYuRVNwZWxsOklzUmVhZHkoKSBhbmQgZ2V0RG1nKCJFIix0YXJnZXQsbXlIZXJvKW9yIDAsUj1zZWxmLlJTcGVsbDpJc1JlYWR5KCkgYW5kIGdldERtZygiUiIsdGFyZ2V0LG15SGVybylvciAwLFIyPWdldERtZygiUiIsdGFyZ2V0LG15SGVybywyKW9yIDAsST1zZWxmLklnbml0ZTpJc1JlYWR5KCkgYW5kIGdldERtZygiSUdOSVRFIix0YXJnZXQsbXlIZXJvKW9yIDB9DQogIGlmIERtZy5RID50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EnLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgRG1nLlErIERtZy5JPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIElnbml0ZScsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBEbWcuVyA+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdXJywgUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIERtZy5XKyBEbWcuST50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1cgKyBJZ25pdGUnLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgRG1nLkUgPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnRScsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBEbWcuRSsgRG1nLkk+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdFICsgSWduaXRlJywgUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIERtZy5RK0RtZy5RMitEbWcuVyA+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgVycsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIERtZy5RK0RtZy5RMitEbWcuRSA+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgRScsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIERtZy5RK0RtZy5RMitEbWcuVysgRG1nLkk+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgVyArIElnbml0ZScsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIERtZy5RK0RtZy5RMitEbWcuRSsgRG1nLkk+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgRSArIElnbml0ZScsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIERtZy5RK0RtZy5RMitEbWcuRStEbWcuVyA+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgVyArIEUnLFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBEbWcuUStEbWcuUTIrRG1nLkUrRG1nLlcrIERtZy5JPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIFcgKyBFICsgSWduaXRlJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgRG1nLlErRG1nLlIrRG1nLlIyK0RtZy5RMitEbWcuRStEbWcuVyA+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgUiArIFcgKyBFJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgRG1nLlErRG1nLlIrRG1nLlIyK0RtZy5RMitEbWcuRStEbWcuVysgRG1nLkk+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgUiArIFcgKyBFICsgSWduaXRlJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlIA0KICAgIHJldHVybiAiQ2FudCBLaWxsIHlldCIsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVuZCANCmVuZA0KIC0tLS8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cXC0tLQ0KLS18fCA+IExlYmxhbmMgVGljayBGdW5jdGlvbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwtLQ0KLS0tXFw9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PS8vLS0tDQogIGZ1bmN0aW9uIExlYmxhbmM6VGljaygpDQogICAgICAgc2VsZjphdXRvemhvbnlhKCkNCiAgICAgICAgc2VsZjpjaGVja3RzKCkNCiAgICAgICBpZiBWSVBfVVNFUiB0aGVuIHNlbGY6YXV0b2xldmVsKCkgZW5kDQogICBpZiBWSVBfVVNFUiB0aGVuIHNlbGY6c2tpbmhhY2soKSBlbmQNCiAgICAgICBzZWxmOmdhcGNsb3NlKCkNCiAgIGlmKHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICApdGhlbg0KICAgICAgc2VsZjpjb21ibygpDQogICAgZW5kDQogICAgIGlmKHNlbGYuQ29uZmlnLktleXMub25seWUgICApdGhlbg0KICAgICAgc2VsZjpvbmx5ZSgpDQogICAgZW5kDQogICAgaWYoc2VsZi5Db25maWcuS2V5cy5sYW5lY2xlYXJrZXkgKXRoZW4NCiAgICAgIHNlbGY6TGFuZUNsZWFyKCkNCiAgICBlbmQNCiAgICBpZihzZWxmLkNvbmZpZy5LZXlzLmVzY2FwZWtleSApdGhlbg0KICAgICAgc2VsZjplc2NhcGUoKQ0KICAgIGVuZA0KICAgICAgaWYoc2VsZi5Db25maWcuS2V5cy5qdW5nbGVjbGVhcmtleSApdGhlbg0KICAgICBzZWxmOkp1bmdsZUNsZWFyKCkNCiAgICBlbmQNCiAgICBpZihzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgKSB0aGVuDQogICAgICBzZWxmOmtpbGxzdGVhbCgpDQogICAgZW5kDQogICAgaWYoc2VsZi5Db25maWcuS2V5cy5oYXJhc3NrZXkgICApIHRoZW4NCiAgICAgIHNlbGY6aGFyYXNzKCkNCiAgICBlbmQNCiAgICAgIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOmNoZWNrdHMoKQ0KICAgICAgICAgc2VsZi50czp1cGRhdGUoKQ0KICAgICAgIHNlbGYudHNlOnVwZGF0ZSgpDQogICAgICAgc2VsZi50c3E6dXBkYXRlKCkNCiAgICAgICBzZWxmLnRzcjp1cGRhdGUoKQ0KICAgICAgIHNlbGYudHN3OnVwZGF0ZSgpDQogICAgICAgc2VsZi50c2c6dXBkYXRlKCkNCiAgaWYgbm90IHNlbGYudHNnLnRhcmdldH49bmlsIG9yIG5vdCBzZWxmLkNvbmZpZy50YXJnZXRzZWwudHMgdGhlbg0KICB0YXJnZXQgPSBzZWxmLnRzdy50YXJnZXQNCiAgZWxzZWlmIHNlbGYudHNnLnRhcmdldH49bmlsIG9yIHNlbGYuc2VsZWN0ZWRUYXIgdGhlbg0KICB0YXJnZXQgPSBzZWxmLnNlbGVjdGVkVGFyDQogIGVuZA0KICBlbmQNCmZ1bmN0aW9uIExlYmxhbmM6c2tpbmhhY2soKQ0KICBpZiBub3QgRmFrZUxvYWQgdGhlbg0KICBpZiAoKEN1cnJlbnRUaW1lSW5NaWxsaXMoKSAtIGxhc3RUaW1lVGlja0NhbGxlZCkgPiAyMDApIHRoZW4NCiAgICAgIGxhc3RUaW1lVGlja0NhbGxlZCA9IEN1cnJlbnRUaW1lSW5NaWxsaXMoKQ0KICAgIGlmIHNlbGYuQ29uZmlnLnZpcC5za2luLmtleSBhbmQgc2VsZi5Db25maWcudmlwLnBhY2tldCAgdGhlbg0KICAgIGlmIHNlbGYuQ29uZmlnLnZpcC5za2luWydzZWxlY3RlZCcgLi4gbXlIZXJvLmNoYXJOYW1lIC4uICdTa2luJ10gfj0gbGFzdFNraW4gdGhlbg0KICAgICAgICBsYXN0U2tpbiA9IHNlbGYuQ29uZmlnLnZpcC5za2luWydzZWxlY3RlZCcgLi4gbXlIZXJvLmNoYXJOYW1lIC4uICdTa2luJ10NCiAgU2VuZFNraW5QYWNrZXQobXlIZXJvLmNoYXJOYW1lLCBza2luc1BCW3NlbGYuQ29uZmlnLnZpcC5za2luWydzZWxlY3RlZCcgLi4gbXlIZXJvLmNoYXJOYW1lIC4uICdTa2luJ11dLCBteUhlcm8ubmV0d29ya0lEKTsNCiAgZW5kDQogIGVuZA0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOm9ubHllKCkNCiAgICAgICAgIHNlbGYudHNlOnVwZGF0ZSgpDQogICAgICAgICAgaWYoc2VsZi50c2UudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZUUgYW5kICBzZWxmLkNvbmZpZy5LZXlzLm9ubHllICAgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEUoc2VsZi50c2UudGFyZ2V0KQ0KICBlbmQNCiAgZW5kDQogICAtLS0vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XFwtLS0NCi0tfHwgPiBMZWJsYW5jIENvbWJvICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fC0tDQotLS1cXD09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ly8tLS0NCiAgZnVuY3Rpb24gTGVibGFuYzpjb21ibygpDQogIGlmIHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID09IDEgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwICkgdGhlbg0KICBzZWxmOmNvbWJvUUVXUigpDQogIGVuZA0KICBpZiBzZWxmLkNvbmZpZy5jb21iby5sb2dpYyA9PSAyIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmNvbWJvLk1hbmEgLzEwMCApIHRoZW4NCiAgc2VsZjpjb21ib1FSRVcoKQ0KICBlbmQNCiAgaWYgc2VsZi5Db25maWcuY29tYm8ubG9naWMgPT0gMyBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKSB0aGVuDQogIHNlbGY6Y29tYm9FUVdSKCkNCiAgZW5kDQogIGlmIHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID09IDQgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwICkgdGhlbg0KICBzZWxmOmNvbWJvRVdRUigpDQogIGVuZA0KICBpZiBzZWxmLkNvbmZpZy5jb21iby5sb2dpYyA9PSA1IGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmNvbWJvLk1hbmEgLzEwMCApIHRoZW4NCiAgc2VsZjpyYW5kb21jb21ibygpDQogIGVuZA0KICAgICAgaWYoc2VsZi5Db25maWcuY29tYm8udXNlSSBhbmQgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgICl0aGVuDQogICAgICBmb3IgXywgdW5pdCBpbiBwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbw0KICAgICAgICBsb2NhbCBkbWdJID0oNTArICgobXlIZXJvLmxldmVsKSoyMCkpDQogICAgICAgIGxvY2FsIGhlYWx0aD11bml0LmhlYWx0aA0KICAgICAgICBpZihoZWFsdGg8ZG1nSSBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlSSBhbmQgR2V0RGlzdGFuY2UodW5pdCk8NjAwKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RJKHVuaXQpDQogICAgICBlbmQNCiAgICAgIGVuZA0KICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6Y29tYm9RUkVXKCkNCiAgIHNlbGYudHN3OnVwZGF0ZSgpDQogICBpZiBub3Qgc2VsZi5Db25maWcuY29tYm8udHVybncudzIgdGhlbg0KICBpZiAoc2VsZi50c3cudGFyZ2V0IH49IG5pbCApdGhlbg0KICBzZWxmOkNhc3RRUih0YXJnZXQpDQogIGVuZA0KICBpZihzZWxmLnRzdy50YXJnZXQgfj0gbmlsICkgYW5kIHNlbGY6UVJ1c2VkKCkgdGhlbg0KICBzZWxmOkNhc3RFVyh0YXJnZXQpDQogIGVuZA0KICBlbmQNCiAgIGlmIHNlbGYuQ29uZmlnLmNvbWJvLnR1cm53LncyIHRoZW4NCiAgaWYgKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgKXRoZW4NCiAgc2VsZjpDYXN0UVIodGFyZ2V0KQ0KICBlbmQNCiAgaWYoc2VsZi50c3cudGFyZ2V0IH49IG5pbCApIGFuZCBzZWxmOlFFdXNlZCgpIHRoZW4NCiAgc2VsZjpDYXN0RVdCKHRhcmdldCkNCiAgZW5kDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpjb21ib0VXUVIoKQ0KICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgIGlmIG5vdCBzZWxmLkNvbmZpZy5jb21iby50dXJudy53NCB0aGVuDQogIGlmIChzZWxmLnRzdy50YXJnZXQgfj0gbmlsICl0aGVuDQogIHNlbGY6Q2FzdEVXKHRhcmdldCkNCiAgZW5kDQogIGlmKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgKSBhbmQgc2VsZjpFV3VzZWQoKSB0aGVuDQogIHNlbGY6Q2FzdFFSKHRhcmdldCkNCiAgZW5kDQogIGVuZA0KICAgaWYgIHNlbGYuQ29uZmlnLmNvbWJvLnR1cm53Lnc0IHRoZW4NCiAgaWYgKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgKXRoZW4NCiAgc2VsZjpDYXN0RVdCKHRhcmdldCkNCiAgZW5kDQogIGlmKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgKSBhbmQgc2VsZjpFV3VzZWQoKSB0aGVuDQogIHNlbGY6Q2FzdFFSKHRhcmdldCkNCiAgZW5kDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpjb21ib0VRV1IoKQ0KICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgIGlmIG5vdCBzZWxmLkNvbmZpZy5jb21iby50dXJudy53MyB0aGVuDQogIGlmIChzZWxmLnRzdy50YXJnZXQgfj0gbmlsICl0aGVuDQogIHNlbGY6Q2FzdEVRKHRhcmdldCkNCiAgZW5kDQogIGlmKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgKSBhbmQgc2VsZjpFUXVzZWQoKSB0aGVuDQogIHNlbGY6Q2FzdFdSKHRhcmdldCkNCiAgZW5kDQogIGVuZA0KICAgaWYgIHNlbGYuQ29uZmlnLmNvbWJvLnR1cm53LnczIHRoZW4NCiAgaWYgKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgKXRoZW4NCiAgc2VsZjpDYXN0RVEodGFyZ2V0KQ0KICBlbmQNCiAgaWYoc2VsZi50c3cudGFyZ2V0IH49IG5pbCApIGFuZCBzZWxmOkVRdXNlZCgpIHRoZW4NCiAgc2VsZjpDYXN0V1JCKHRhcmdldCkNCiAgZW5kDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpjb21ib1FFV1IoKQ0KICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgIGlmIG5vdCBzZWxmLkNvbmZpZy5jb21iby50dXJudy53MSB0aGVuDQogIGlmIChzZWxmLnRzdy50YXJnZXQgfj0gbmlsICl0aGVuDQogIHNlbGY6Q2FzdFFFKHRhcmdldCkNCiAgZW5kDQogIGlmKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgKSBhbmQgc2VsZjpRRXVzZWQoKSB0aGVuDQogIHNlbGY6Q2FzdFdSKHRhcmdldCkNCiAgZW5kDQogIGVuZA0KICAgaWYgc2VsZi5Db25maWcuY29tYm8udHVybncudzEgdGhlbg0KICBpZiAoc2VsZi50c3cudGFyZ2V0IH49IG5pbCApdGhlbg0KICBzZWxmOkNhc3RRRSh0YXJnZXQpDQogIGVuZA0KICBpZihzZWxmLnRzdy50YXJnZXQgfj0gbmlsICkgYW5kIHNlbGY6UUV1c2VkKCkgdGhlbg0KICBzZWxmOkNhc3RXUkIodGFyZ2V0KQ0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOkNhc3RRKHVuaXQpDQogICAgc2VsZi5RU3BlbGw6Q2FzdCh1bml0KQ0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpDYXN0UUUodW5pdCkNCiAgICAgICAgc2VsZi50c3E6dXBkYXRlKCkNCiAgICAgICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi50c3EudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVEgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgIGFuZCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFEodGFyZ2V0KQ0KICAgICBlbmQNCiAgICAgICAgIHNlbGYudHNlOnVwZGF0ZSgpDQogICAgICAgICAgaWYoc2VsZi50c2UudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZUUgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEUodGFyZ2V0KQ0KICAgICAgICAgIGVuZA0KICAgICAgICAgIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOkNhc3RFVyh1bml0KQ0KICAgICAgICBzZWxmLnRzZTp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi50c2UudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZUUgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgIGFuZCBzZWxmLkVTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEUodGFyZ2V0KQ0KICAgICBlbmQNCiAgICAgICAgIHNlbGYudHN3OnVwZGF0ZSgpDQogICAgICAgICAgaWYoc2VsZi50c3cudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVcgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgYW5kIG5vdCBzZWxmOndVc2VkKCkgYW5kIHNlbGYuV1NwZWxsOklzUmVhZHkoKSkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFcodGFyZ2V0KQ0KICAgICAgICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpDYXN0RVdCKHVuaXQpDQogICAgICAgIHNlbGYudHNlOnVwZGF0ZSgpDQogICAgICBpZihzZWxmLnRzZS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlRSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICAgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0RSh0YXJnZXQpDQogICAgIGVuZA0KICAgICAgICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgICAgICAgICBpZihzZWxmLnRzdy50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlVyBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgIGFuZCBzZWxmLldTcGVsbDpJc1JlYWR5KCkpIHRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RXKHRhcmdldCkNCiAgICAgICAgICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6cmFuZG9tY29tYm8oKQ0KICAgICAgICBzZWxmLnRzcTp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi50c3EudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVEgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgIGFuZCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFEodGFyZ2V0KSAgICAgDQogICAgICAgICAgZW5kDQogICAgICAgICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgICAgIGlmKHNlbGYudHN3LnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VXIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgICBhbmQgc2VsZi5XU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RXKHRhcmdldCkgICAgICANCiAgICAgICAgICBlbmQNCiAgICAgICAgICBzZWxmLnRzZTp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi50c2UudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZUUgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgIGFuZCBzZWxmLkVTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEUodGFyZ2V0KSAgICANCiAgICAgICAgICBlbmQNCiAgICAgICAgICAgc2VsZi50c3I6dXBkYXRlKCkNCiAgICAgIGlmKHNlbGYudHNyLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VSIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgICBhbmQgc2VsZi5RU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RSKHRhcmdldCkNCiAgICAgICAgICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6Q2FzdFFSKHVuaXQpDQogICAgICAgIHNlbGYudHNxOnVwZGF0ZSgpDQogICAgICAgICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi50c3EudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVEgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgIGFuZCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFEodGFyZ2V0KQ0KICAgICBlbmQNCiAgICAgICAgIHNlbGYudHNyOnVwZGF0ZSgpDQogICAgICAgICAgaWYoc2VsZi50c3IudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVIgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgYW5kIHNlbGYuUlNwZWxsOklzUmVhZHkoKSkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFIodGFyZ2V0KQ0KICAgICAgICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpDYXN0V1IodW5pdCkNCiAgICAgICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgICAgIGlmKHNlbGYudHN3LnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VXIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgICBhbmQgc2VsZi5XU3BlbGw6SXNSZWFkeSgpYW5kIG5vdCBzZWxmOndVc2VkKCkpdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFcodGFyZ2V0KQ0KICAgICBlbmQNCiAgICAgICAgIHNlbGYudHNyOnVwZGF0ZSgpDQogICAgICAgICAgaWYoc2VsZi50c3IudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVIgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgYW5kIHNlbGYuUlNwZWxsOklzUmVhZHkoKSkgYW5kIG5vdCBzZWxmOnJVc2VkKCkgIHRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RSKHRhcmdldCkNCiAgICAgICAgICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6Q2FzdFdSQih1bml0KQ0KICAgICAgICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi50c3cudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVcgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgIGFuZCBzZWxmLldTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFcodGFyZ2V0KQ0KICAgICBlbmQNCiAgICAgICAgIHNlbGYudHNyOnVwZGF0ZSgpDQogICAgICAgICAgaWYoc2VsZi50c3IudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVIgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgYW5kIHNlbGYuUlNwZWxsOklzUmVhZHkoKSkgYW5kIG5vdCBzZWxmOnJVc2VkKCkgIHRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RSKHRhcmdldCkNCiAgICAgICAgICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6Q2FzdFFXSCgpDQogICAgICAgIHNlbGYudHNxOnVwZGF0ZSgpDQogICAgICBpZihzZWxmLnRzcS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuaGFyYXNzLnVzZVEgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmhhcmFzc2tleSAgYW5kIHNlbGYuUVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0USh0YXJnZXQpDQogICAgIGVuZA0KICAgICAgICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi50c3cudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmhhcmFzcy51c2VXIGFuZCAgc2VsZi5Db25maWcuS2V5cy5oYXJhc3NrZXkgIGFuZCBzZWxmLldTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICAgc2VsZjpDYXN0Vyh0YXJnZXQpDQogICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpDYXN0UVdLKHVuaXQpDQogICAgICAgIHNlbGYudHNxOnVwZGF0ZSgpDQogICAgICBpZihzZWxmLnRzcS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZVFXIGFuZCAgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzIGFuZCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFEodGFyZ2V0KQ0KICAgICBlbmQNCiAgICAgICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgICAgIGlmKHNlbGYudHN3LnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlUVcgYW5kIG5vdCBzZWxmOndVc2VkKCkgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyBhbmQgc2VsZi5XU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RXKHRhcmdldCkNCiAgICAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOkNhc3RFUSh1bml0KQ0KICAgICAgICBzZWxmLnRzZTp1cGRhdGUoKQ0KICAgICAgICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi50c2UudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZUUgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgIGFuZCBzZWxmLkVTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEUodGFyZ2V0KQ0KICAgICBlbmQNCiAgICAgICAgIHNlbGYudHNxOnVwZGF0ZSgpDQogICAgICAgICAgaWYoc2VsZi50c3EudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVEgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgYW5kIHNlbGYuUVNwZWxsOklzUmVhZHkoKSkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFEodGFyZ2V0KQ0KICAgICAgICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpDYXN0Vyh1bml0KQ0KICAgIHNlbGYuV1NwZWxsOkNhc3QodW5pdCkNCiAgZW5kDQogIA0KICBmdW5jdGlvbiBMZWJsYW5jOkNhc3RFKHVuaXQpDQogICBzZWxmLkVTcGVsbDpDYXN0KHVuaXQpDQogICAgDQogIGVuZA0KICANCiAgZnVuY3Rpb24gTGVibGFuYzpDYXN0Uih1bml0KQ0KICAgIHNlbGYuUlNwZWxsOkNhc3QodW5pdCkNCiAgZW5kDQogIA0KICBmdW5jdGlvbiBMZWJsYW5jOkNhc3RJKHVuaXQpDQogICAgc2VsZi5JZ25pdGU6Q2FzdCh1bml0KQ0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpraWxsc3RlYWwoKQ0KICBmb3IgXywgdW5pdCBpbiBwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbw0KICAgICAgbG9jYWwgaGVhbHRoID0gdW5pdC5oZWFsdGgNCiAgICAgIGxvY2FsIGRtZ0UgPSBnZXREbWcoIkUiLCB1bml0LCBteUhlcm8pICsgKChteUhlcm8uYXApKjAuNSkgKyAoZ2V0RG1nKCJFIiwgdW5pdCwgbXlIZXJvKSArICgobXlIZXJvLmFwKSowLjUpKQ0KICAgICAgICBpZihzZWxmLnRzZS50YXJnZXQgfj0gbmlsIGFuZCAgc2VsZi5FU3BlbGw6SXNSZWFkeSgpIGFuZCBub3Qgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgIGFuZCBoZWFsdGg8ZG1nRSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZUUgICBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RFKHVuaXQpICANCiAgICAgICAgZW5kDQogICAgICAgIGxvY2FsIGRtZ1EgPSBnZXREbWcoIlEiLCB1bml0LCBteUhlcm8pICsgKChteUhlcm8uYXApKjAuNDApDQogICAgICAgIGlmKHNlbGYudHNxLnRhcmdldCB+PSBuaWwgYW5kICBzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIG5vdCBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgYW5kIGhlYWx0aDxkbWdRIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlUSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzICl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0USh1bml0KSAgDQogICAgICAgIGVuZA0KICAgICAgICAgbG9jYWwgZG1nUVcgPSBnZXREbWcoIlEiLCB1bml0LCBteUhlcm8pICsgKChteUhlcm8uYXApKjAuNDApKyhnZXREbWcoIlciLCB1bml0LCBteUhlcm8pICsgKChteUhlcm8uYXApKjAuNjApKyhnZXREbWcoIlEiLCB1bml0LCBteUhlcm8pICsgKChteUhlcm8uYXApKjAuNDApKSkNCiAgICAgICAgaWYoc2VsZi50c3cudGFyZ2V0IH49IG5pbCBhbmQgIGhlYWx0aDxkbWdRIGFuZCBub3Qgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlUVcgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFFXSyh1bml0KSAgDQogICAgICAgIGVuZA0KICAgICAgICAgICAgICBsb2NhbCBkbWdXID0gZ2V0RG1nKCJXIiwgdW5pdCwgbXlIZXJvKSArICgobXlIZXJvLmFwKSowLjYwKQ0KICAgICAgICBpZihzZWxmLnRzdy50YXJnZXQgfj0gbmlsIGFuZCAgc2VsZi5XU3BlbGw6SXNSZWFkeSgpIGFuZCBub3Qgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSBhbmQgbm90IHNlbGY6d1VzZWQoKSAgIGFuZCBoZWFsdGg8ZG1nUSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZVcgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFcodW5pdCkgIA0KICAgICAgICBlbmQNCiAgICAgICAgIGxvY2FsIGRtZ0kgPSg1MCsgKChteUhlcm8ubGV2ZWwpKjIwKSkNCiAgICAgICAgaWYoaGVhbHRoPGRtZ0kgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VJIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgYW5kIEdldERpc3RhbmNlKHVuaXQpPDYwMCl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0SSh1bml0KQ0KICAgICAgICBlbmQNCiAgICAgICAgbG9jYWwgZG1nUiA9Z2V0RG1nKCJSIix1bml0LG15SGVybykrKChteUhlcm8uYXApKjAuNjApIA0KICAgICAgICBpZihzZWxmLnRzci50YXJnZXQgfj0gbmlsIGFuZCAgc2VsZi5SU3BlbGw6SXNSZWFkeSgpIGFuZCBub3Qgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgIGFuZCBoZWFsdGg8ZG1nUiBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZVIgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyBhbmQgR2V0RGlzdGFuY2UodW5pdCk8NjAwKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RSKHVuaXQpDQogICAgICAgIGVuZA0KICAgICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6aGFyYXNzKCkNCiAgICBzZWxmLnRzcTp1cGRhdGUoKQ0KICAgICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgIGlmIHNlbGYuQ29uZmlnLktleXMuaGFyYXNza2V5ICBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5oYXJhc3MuTWFuYSAvMTAwICkgIHRoZW4NCiAgICBzZWxmOkNhc3RRV0goKQ0KICAgICAgZW5kICAgDQogICBlbmQNCiAgIGZ1bmN0aW9uIExlYmxhbmM6TGFuZUNsZWFyKCkNCiAgbG9jYWwgY2xlYXJ0YXJnZXQgPSBzZWxmLmNsZWFydGFyZ2V0DQogIHNlbGYuZW5lbXlNaW5pb25zOnVwZGF0ZSgpDQogICBzZWxmLm90aGVyTWluaW9uczp1cGRhdGUoKQ0KICAgICAgc2VsZi5qdW5nbGVNaW5pb25zOnVwZGF0ZSgpDQogICAgICBmb3IgaSwgbWluaW9uIGluIGlwYWlycyhzZWxmLmVuZW15TWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgICBpZiBWYWxpZFRhcmdldChtaW5pb24sIDYwMCkgYW5kIChjbGVhcnRhcmdldCA9PSBuaWwgb3Igbm90IFZhbGlkVGFyZ2V0KGNsZWFydGFyZ2V0KSkgdGhlbg0KICAgICAgICAgIGNsZWFydGFyZ2V0ID0gbWluaW9uDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBmb3IgaSwgbWluaW9uIGluIHBhaXJzKHNlbGYuZW5lbXlNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICAgIGlmIFZhbGlkVGFyZ2V0KG1pbmlvbikgYW5kIG1pbmlvbiB+PSBuaWwgdGhlbg0KICAgICAgICAgIGlmIHNlbGYuQ29uZmlnLktleXMubGFuZWNsZWFya2V5ICBhbmQgc2VsZi5Db25maWcubGFuZWNsZWFyLnVzZVEgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcubGFuZWNsZWFyLk1hbmEgLzEwMCApIGFuZCBHZXREaXN0YW5jZShtaW5pb24pIDw9IHNlbGYuUVNwZWxsLlJhbmdlIHRoZW4gDQogICAgICAgICAgICAgc2VsZjpDYXN0UShjbGVhcnRhcmdldCkNCiAgICAgICAgICBlbmQNCiAgICAgICAgICBpZiBzZWxmLkNvbmZpZy5LZXlzLmxhbmVjbGVhcmtleSAgYW5kIHNlbGYuQ29uZmlnLmxhbmVjbGVhci51c2VXIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmxhbmVjbGVhci5NYW5hIC8xMDAgKSBhbmQgR2V0RGlzdGFuY2UobWluaW9uKSA8PSBzZWxmLldTcGVsbC5SYW5nZSB0aGVuIA0KICAgICAgICAgICAgbG9jYWwgQmVzdFBvcywgQmVzdEhpdCA9IEdldEJlc3RDaXJjdWxhckZhcm1Qb3NpdGlvbihzZWxmLldTcGVsbC5SYW5nZSwgc2VsZi5XU3BlbGwuV2lkdGgsIHNlbGYuZW5lbXlNaW5pb25zLm9iamVjdHMpDQogICAgICAgICAgICBpZiBCZXN0UG9zIH49IG5pbCB0aGVuDQogICAgICAgICAgICAgIENhc3RTcGVsbChfVywgQmVzdFBvcy54LCBCZXN0UG9zLnopDQogICAgICAgICAgZW5kDQogICAgICAgIGVuZA0KICAgICAgICBpZiBzZWxmLkNvbmZpZy5LZXlzLmxhbmVjbGVhcmtleSAgYW5kIHNlbGYuQ29uZmlnLmxhbmVjbGVhci51c2VSIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmxhbmVjbGVhci5NYW5hIC8xMDAgKSBhbmQgR2V0RGlzdGFuY2UobWluaW9uKSA8PSBzZWxmLldTcGVsbC5SYW5nZSB0aGVuIA0KICAgICAgICAgICAgbG9jYWwgQmVzdFBvcywgQmVzdEhpdCA9IEdldEJlc3RDaXJjdWxhckZhcm1Qb3NpdGlvbihzZWxmLldTcGVsbC5SYW5nZSwgc2VsZi5XU3BlbGwuV2lkdGgsIHNlbGYuZW5lbXlNaW5pb25zLm9iamVjdHMpDQogICAgICAgICAgICBpZiBCZXN0UG9zIH49IG5pbCB0aGVuDQogICAgICAgICAgICAgIENhc3RTcGVsbChfUiwgQmVzdFBvcy54LCBCZXN0UG9zLnopDQogICAgICAgICAgZW5kDQogICAgICAgIGVuZCAgICAgICAgDQogICAgICBlbmQNCiAgICBlbmQNCiAgZW5kDQogIA0KICBmdW5jdGlvbiBMZWJsYW5jOkp1bmdsZUNsZWFyKCkNCiAgbG9jYWwgY2xlYXJ0YXJnZXQgPSBuaWwNCiAgICAgIHNlbGYuZW5lbXlNaW5pb25zOnVwZGF0ZSgpDQogICAgICBzZWxmLm90aGVyTWluaW9uczp1cGRhdGUoKQ0KICAgICAgc2VsZi5qdW5nbGVNaW5pb25zOnVwZGF0ZSgpDQogICAgICBmb3IgaSwgbWluaW9uIGluIGlwYWlycyhzZWxmLmVuZW15TWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgICBpZiBWYWxpZFRhcmdldChtaW5pb24sIDYwMCkgYW5kIChjbGVhcnRhcmdldCA9PSBuaWwgb3Igbm90IFZhbGlkVGFyZ2V0KGNsZWFydGFyZ2V0KSkgdGhlbg0KICAgICAgICAgIGNsZWFydGFyZ2V0ID0gbWluaW9uDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBmb3IgaSwganVuZ2xlbWluaW9uIGluIGlwYWlycyhzZWxmLmp1bmdsZU1pbmlvbnMub2JqZWN0cykgZG8NCiAgICAgICAgaWYgVmFsaWRUYXJnZXQoanVuZ2xlbWluaW9uLCA2MDApIGFuZCAoY2xlYXJ0YXJnZXQgPT0gbmlsIG9yIG5vdCBWYWxpZFRhcmdldChjbGVhcnRhcmdldCkpIHRoZW4NCiAgICAgICAgICBjbGVhcnRhcmdldCA9IGp1bmdsZW1pbmlvbg0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgZm9yIGksIG90aGVybWluaW9uIGluIGlwYWlycyhzZWxmLm90aGVyTWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgICBpZiBWYWxpZFRhcmdldChvdGhlcm1pbmlvbiwgNjAwKSBhbmQgKGNsZWFydGFyZ2V0ID09IG5pbCBvciBub3QgVmFsaWRUYXJnZXQoY2xlYXJ0YXJnZXQpKSB0aGVuDQogICAgICAgICAgY2xlYXJ0YXJnZXQgPSBvdGhlcm1pbmlvbg0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgaWYgY2xlYXJ0YXJnZXQgfj0gbmlsIHRoZW4NCiAgICAgICAgaWYoc2VsZi5RU3BlbGw6SXNSZWFkeSgpIGFuZCBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhci51c2VRIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmp1bmdsZWNsZWFya2V5ICkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuanVuZ2xlY2xlYXIuTWFuYSAvMTAwICkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFEoY2xlYXJ0YXJnZXQpDQogICAgICAgIGVuZA0KICAgICAgICBpZiBjbGVhcnRhcmdldCB+PSBuaWwgdGhlbg0KICAgICAgICBpZihzZWxmLldTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyLnVzZVcgYW5kIHNlbGYuQ29uZmlnLktleXMuanVuZ2xlY2xlYXJrZXkgKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0VyhjbGVhcnRhcmdldCkNCiAgICAgICAgZW5kDQogICAgICAgIGlmIGNsZWFydGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGlmKHNlbGYuRVNwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcuanVuZ2xlY2xlYXIudXNlRSBhbmQgc2VsZi5Db25maWcuS2V5cy5qdW5nbGVjbGVhcmtleSApIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyLk1hbmEgLzEwMCApIHRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RFKGNsZWFydGFyZ2V0KQ0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgIGVuZA0KICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6d1VzZWQoKSANCiAgICBsb2NhbCBsZWJsYW5jVyA9IG15SGVybzpHZXRTcGVsbERhdGEoX1cpDQogICAgaWYgbGVibGFuY1cubmFtZSA9PSAibGVibGFuY3NsaWRlcmV0dXJuIiB0aGVuIA0KICAgICAgcmV0dXJuIHRydWUgDQogICAgZWxzZSANCiAgICAgIHJldHVybiBmYWxzZQ0KICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpyVXNlZCgpIA0KICAgIGxvY2FsIGxlYmxhbmNSID0gbXlIZXJvOkdldFNwZWxsRGF0YShfUikNCiAgICBpZiBsZWJsYW5jUi5uYW1lID09ICJMZWJsYW5jU2xpZGVNIiB0aGVuIA0KICAgICAgcmV0dXJuIGZhbHNlDQogICAgZWxzZSANCiAgICAgIHJldHVybiB0cnVlDQogICAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOlFFdXNlZCgpIA0KICAgIGxvY2FsIGxlYmxhbmNRID0gc2VsZi5RU3BlbGw6SXNSZWFkeSgpDQogICAgbG9jYWwgbGVibGFuY0UgPSBzZWxmLkVTcGVsbDpJc1JlYWR5KCkNCiAgICBpZiAobGVibGFuY1EgYW5kIGxlYmxhbmNFKSB0aGVuIA0KICAgICAgcmV0dXJuIGZhbHNlIA0KICAgIGVsc2UgDQogICAgICByZXR1cm4gdHJ1ZQ0KICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpFUXVzZWQoKSANCiAgICBsb2NhbCBsZWJsYW5jVyA9IHNlbGYuRVNwZWxsOklzUmVhZHkoKQ0KICAgIGxvY2FsIGxlYmxhbmNFID0gc2VsZi5RU3BlbGw6SXNSZWFkeSgpDQogICAgaWYgKGxlYmxhbmNXIGFuZCBsZWJsYW5jRSkgdGhlbiANCiAgICAgIHJldHVybiBmYWxzZSANCiAgICBlbHNlIA0KICAgICAgcmV0dXJuIHRydWUNCiAgICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6RVd1c2VkKCkgDQogICAgbG9jYWwgbGVibGFuY1cgPSBzZWxmLkVTcGVsbDpJc1JlYWR5KCkNCiAgICBsb2NhbCBsZWJsYW5jRSA9IHNlbGYuV1NwZWxsOklzUmVhZHkoKQ0KICAgIGlmIChsZWJsYW5jVyBhbmQgbGVibGFuY0UpIHRoZW4gDQogICAgICByZXR1cm4gZmFsc2UgDQogICAgZWxzZSANCiAgICAgIHJldHVybiB0cnVlDQogICAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOlFSdXNlZCgpIA0KICAgIGxvY2FsIGxlYmxhbmNXID0gc2VsZi5RU3BlbGw6SXNSZWFkeSgpDQogICAgbG9jYWwgbGVibGFuY0UgPSBzZWxmLlJTcGVsbDpJc1JlYWR5KCkNCiAgICBpZiAobGVibGFuY1cgYW5kIGxlYmxhbmNFKSB0aGVuIA0KICAgICAgcmV0dXJuIGZhbHNlIA0KICAgIGVsc2UgDQogICAgICByZXR1cm4gdHJ1ZQ0KICAgIGVuZA0KICBlbmQNCiAgbG9jYWwgc3BlbGxMZXZlbCA9IDANCiAgZnVuY3Rpb24gTGVibGFuYzphdXRvbGV2ZWwoKQ0KaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSAxIGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlMSA9ICAgeyAxLDIsMywxLDEsNCwxLDIsMSwyLDQsMiwyLDMsMyw0LDMsM30NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlMSkNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDIgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2UyID0gICB7IDEsMiwzLDEsMSw0LDEsMywxLDMsNCwzLDMsMiwyLDQsMiwyfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2UyKQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gMyBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTMgPSAgeyAyLDMsMSwyLDIsNCwyLDEsMiwxLDQsMSwxLDMsMyw0LDMsM30NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlMykNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDQgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2U0ID0gIHsgMiwzLDEsMiwyLDQsMiwzLDIsMyw0LDMsMywxLDEsNCwxLDF9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTQpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSA1IGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlNSA9ICB7IDMsMSwyLDMsMyw0LDMsMiwzLDIsNCwyLDIsMSwxLDQsMSwxfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2U1KQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gNiBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTYgPSAgeyAzLDEsMiwzLDMsNCwzLDEsMywxLDQsMSwxLDIsMiw0LDIsMn0NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlNikNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICAgIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gNyBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTYgPSAgeyAyLDEsMywyLDEsNCwyLDIsMSwzLDQsMiwxLDEsMyw0LDMsM30NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlNikNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzphdXRvemhvbnlhKCkNCiAgICBpZiBzZWxmLkNvbmZpZy5pdGVtLmVuYWJsZWF1dG96aG9ueWEgdGhlbg0KICAgICBmb3IgXyA9IElURU1fMSwgSVRFTV83IGRvDQogICAgICBpZiBteUhlcm8uaGVhbHRoIDw9IChteUhlcm8ubWF4SGVhbHRoICogc2VsZi5Db25maWcuaXRlbS5hdXRvemhvbnlhIC8gMTAwKSBhbmQgKCBteUhlcm86Q2FuVXNlU3BlbGwoXykgPT0gMCBhbmQgbXlIZXJvOkdldFNwZWxsRGF0YShfKS5uYW1lID09ICJaaG9ueWFzSG91cmdsYXNzIiApdGhlbiBDYXN0U3BlbGwoXykNCiAgICBlbmQNCiAgICBlbmQNCiAgICBlbmQNCiAgICBlbmQNCiAgICBmdW5jdGlvbiBMZWJsYW5jOmVzY2FwZWZvcmdhcCgpDQogIGlmIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgIGFuZCBzZWxmLkNvbmZpZy5jb21iby5nYXBjbG9zZSBhbmQgbm90IHNlbGY6d1VzZWQoKSB0aGVuDQogIENhc3RTcGVsbChfVyxtb3VzZVBvcy54LG1vdXNlUG9zLnopDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzplc2NhcGUoKQ0KICBpZiBzZWxmLkNvbmZpZy5LZXlzLmVzY2FwZWtleSAgYW5kIHNlbGYuQ29uZmlnLmVzY2FwZS51c2VXIGFuZCBub3Qgc2VsZjp3VXNlZCgpIHRoZW4NCiAgQ2FzdFNwZWxsKF9XLG1vdXNlUG9zLngsbW91c2VQb3MueikNCiAgZW5kDQogIGlmIHNlbGYuQ29uZmlnLktleXMuZXNjYXBla2V5ICB0aGVuIA0KICBzZWxmOndhbGsoKQ0KICBlbmQNCiAgaWYgc2VsZi5Db25maWcuS2V5cy5lc2NhcGVrZXkgIGFuZCBzZWxmLkNvbmZpZy5lc2NhcGUudXNlUiBhbmQgbm90ICBzZWxmOnJVc2VkKCkgdGhlbg0KICBDYXN0U3BlbGwoX1IsbW91c2VQb3MueCxtb3VzZVBvcy56KQ0KICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6d2FsaygpDQogICAgbXlIZXJvOk1vdmVUbyhtb3VzZVBvcy54LG1vdXNlUG9zLnopDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOmdhcGNsb3NlKCkNCiAgaWYgdGFyZ2V0IGFuZCBHZXREaXN0YW5jZSh0YXJnZXQsbXlIZXJvKT44MDAgdGhlbiANCiAgc2VsZjplc2NhcGVmb3JnYXAoKQ0KICAgICAgZW5kIA0KICANCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6VEFSR0VUQ1MoKQ0KICAgICAgbG9jYWwgVGFyZ2V0ID0gbmlsDQogICAgICBpZiBzZWxmLnNlbGVjdGVkVGFyIHRoZW4gVGFyZ2V0ID0gc2VsZi5zZWxlY3RlZFRhcg0KICAgICAgZWxzZSBUYXJnZXQgPSBzZWxmLnRzdy50YXJnZXQNCiAgICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpXbmRNc2coTXNnLCBLZXkpDQogIGlmIHNlbGYuQ29uZmlnLktleXMuY29tYm9tb2RlIHRoZW4NCiAgc2VsZi5Db25maWcuY29tYm8ubG9naWMgPSBzZWxmLkNvbmZpZy5jb21iby5sb2dpYyArMQ0KICBpZiBzZWxmLkNvbmZpZy5jb21iby5sb2dpYyA+IDUgdGhlbiBzZWxmLkNvbmZpZy5jb21iby5sb2dpYyA9IDEgZW5kDQogIGVuZA0KICBpZiBzZWxmLkNvbmZpZy50YXJnZXRzZWwudHMgdGhlbiAgICAgIA0KICAgICAgICAgIGlmIE1zZyA9PSBXTV9MQlVUVE9ORE9XTiB0aGVuDQogICAgICAgICAgICAgIGxvY2FsIG1pbkQgPSAxMA0KICAgICAgICAgICAgICBsb2NhbCBzdGFyZ2V0ID0gbmlsDQogICAgICAgICAgICAgIGZvciBpLCBlbmVteSBpbiBpcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8NCiAgICAgICAgICAgICAgICAgIGlmIFZhbGlkVGFyZ2V0KGVuZW15KSB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgaWYgR2V0RGlzdGFuY2UoZW5lbXksIG1vdXNlUG9zKSA8PSBtaW5EIG9yIHN0YXJnZXQgPT0gbmlsIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgbWluRCA9IEdldERpc3RhbmNlKGVuZW15LCBtb3VzZVBvcykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcmdldCA9IGVuZW15DQogICAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgZW5kICAgICANCiAgICAgICAgICAgICAgaWYgc3RhcmdldCBhbmQgbWluRCA8IDUwMCB0aGVuDQogICAgICAgICAgICAgICAgICBpZiBzZWxmLnNlbGVjdGVkVGFyIGFuZCBzdGFyZ2V0LmNoYXJOYW1lID09IHNlbGYuc2VsZWN0ZWRUYXIuY2hhck5hbWUgdGhlbg0KICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWRUYXIgPSBuaWwNCiAgICAgICAgICAgICAgICAgICAgICBwcmludCgiPGZvbnQgY29sb3I9XCIjQ0JGNkZGXCI+VGFyZ2V0IDxiPmlzIG5vIGxvZ2VyIHNlbGVjdGVkLjwvYj46ICIuLnN0YXJnZXQuY2hhck5hbWUuLiI8L2ZvbnQ+IikNCiAgICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNlbGVjdGVkVGFyID0gc3RhcmdldCAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgIHByaW50KCI8Zm9udCBjb2xvcj1cIiNDQkY2RkZcIj5OZXcgdGFyZ2V0IDxiPnNlbGVjdGVkLjwvYj46ICIuLnN0YXJnZXQuY2hhck5hbWUuLiI8L2ZvbnQ+IikNCiAgICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgZW5kDQogICAtLS0vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XFwtLS0NCi0tfHwgPiBBa2FsaSBTdGFydCAgICAgICAgICAgICAgICAgICAgICAgICAgfHwtLQ0KLS0tXFw9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PS8vLS0tDQogIGNsYXNzICJBa2FsaSINCiAgZnVuY3Rpb24gQWthbGk6X19pbml0KCkNCnNlbGYudHM9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDcwMCwgREFNQUdFX1BIWVNJQ0FMLCBmYWxzZSwgdHJ1ZSkNCnNlbGYudHNxPSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCA2MDAsIERBTUFHRV9QSFlTSUNBTCwgZmFsc2UsIHRydWUpDQpzZWxmLnRzdz0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgNzAwLCBEQU1BR0VfUEhZU0lDQUwsIGZhbHNlLCB0cnVlKQ0Kc2VsZi50c2U9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDMyNSwgREFNQUdFX1BIWVNJQ0FMLCBmYWxzZSwgdHJ1ZSkNCnNlbGYudHNyPSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCA3MDAsIERBTUFHRV9QSFlTSUNBTCwgZmFsc2UsIHRydWUpDQpzZWxmLnRzZz0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgOTI1LCBEQU1BR0VfTUFHSUMsIGZhbHNlLCB0cnVlKQ0KICAgc2VsZi5RU3BlbGwgPSBfU3BlbGwoe1Nsb3QgPSBfUSwgRGFtYWdlTmFtZSA9ICJRIiwgUmFuZ2UgPSA2MDAsIENvbGxpc2lvbiA9IGZhbHNlLCBBb2UgPSBmYWxzZSwgVHlwZSA9IFNQRUxMX1RZUEUuVEFSR0VUVEVEfSkNCiAgIHNlbGYuV1NwZWxsID0gX1NwZWxsKHtTbG90ID0gX1csIERhbWFnZU5hbWUgPSAiVyIsIFJhbmdlID0gNzAwLCBDb2xsaXNpb24gPSBmYWxzZSwgQW9lID0gdHJ1ZSwgVHlwZSA9IFNQRUxMX1RZUEUuU0VMRn0pDQogICBzZWxmLkVTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9FLCBEYW1hZ2VOYW1lID0gIkUiLCBSYW5nZSA9IDMyNSwgQ29sbGlzaW9uID0gZmFsc2UsIEFvZSA9IHRydWUsIFR5cGUgPSBTUEVMTF9UWVBFLlNFTEZ9KQ0KICAgc2VsZi5SU3BlbGwgPSBfU3BlbGwoe1Nsb3QgPSBfUiwgRGFtYWdlTmFtZSA9ICJSIiwgUmFuZ2UgPTcwMCwgIENvbGxpc2lvbiA9IGZhbHNlLCBBb2UgPSBmYWxzZSwgVHlwZSA9IFNQRUxMX1RZUEUuVEFSR0VUVEVEfSkNCiAgIHNlbGYuSWduaXRlID0gX1NwZWxsKHtTbG90ID0gRmluZFN1bW1vbmVyU2xvdCgic3VtbW9uZXJkb3QiKSwgRGFtYWdlTmFtZSA9ICJJR05JVEUiLCBSYW5nZSA9IDYwMCwgVHlwZSA9IFNQRUxMX1RZUEUuVEFSR0VUVEVEfSkNCi0tfD4gTWluaW9uIE1hbmFnZXJzDQogICAgc2VsZi5lbmVteU1pbmlvbnMgICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX0VORU1ZLCAgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgIHNlbGYuYWxseU1pbmlvbnMgICAgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9BTExZLCAgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgIHNlbGYuanVuZ2xlTWluaW9ucyAgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9KVU5HTEUsICA2NTAsIG15SGVybywgTUlOSU9OX1NPUlRfTUFYSEVBTFRIX0RFQykNCiAgICBzZWxmLm90aGVyTWluaW9ucyAgID0gbWluaW9uTWFuYWdlcihNSU5JT05fT1RIRVIsICAgNjUwLCBteUhlcm8sIE1JTklPTl9TT1JUX01BWEhFQUxUSF9ERUMpDQogICAgc2VsZjpMb2FkTWVudSgpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gMA0KICAgICAgc2VsZjpmaW5kb3Jid2Fsa2VyKCkNCiAgICAgIA0KICAgICAgQWRkVGlja0NhbGxiYWNrKGZ1bmN0aW9uKCkgc2VsZjpUaWNrKCkgZW5kKQ0KICBBZGREcmF3Q2FsbGJhY2soZnVuY3Rpb24oKSBzZWxmOkRyYXcoKSBlbmQpDQogIEFkZE1zZ0NhbGxiYWNrKGZ1bmN0aW9uKG1zZyxLZXkpIHNlbGY6V25kTXNnKG1zZyxLZXkpIGVuZCkNCiAgLS1BZGRBbmltYXRpb25DYWxsYmFjayhmdW5jdGlvbih1bml0LCBhbmltYXRpb24pIHNlbGY6QW5pbWF0aW9uKHVuaXQsIGFuaW1hdGlvbikgZW5kKQ0KICAtLUFkZFByb2Nlc3NTcGVsbENhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIHNwZWxsKSBzZWxmOlByb2Nlc3NTcGVsbCh1bml0LCBzcGVsbCkgZW5kKQ0KICAtLUFkZEFwcGx5QnVmZkNhbGxiYWNrKGZ1bmN0aW9uKHNvdXJjZSwgdW5pdCwgYnVmZikgc2VsZjpPbkFwcGx5QnVmZihzb3VyY2UsIHVuaXQsIGJ1ZmYpIGVuZCkNCiAgLS1BZGRVcGRhdGVCdWZmQ2FsbGJhY2soZnVuY3Rpb24odW5pdCwgYnVmZiwgc3RhY2tzKSBzZWxmOlVwZGF0ZUJ1ZmYodW5pdCwgYnVmZiwgc3RhY2tzKSBlbmQpDQogIC0tQWRkUmVtb3ZlQnVmZkNhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIGJ1ZmYpIHNlbGY6T25SZW1vdmVCdWZmKHVuaXQsIGJ1ZmYpIGVuZCkgDQogIGVuZA0KICBmdW5jdGlvbiBBa2FsaTpUaWNrKCkNCiAgc2VsZjphdXRvemhvbnlhKCkNCiAgc2VsZjpBdXRvc3RlYWx0aCgpDQogIHNlbGY6YXV0b3EoKQ0KICBzZWxmOml0ZW1zKCkNCiAgICAgICAgc2VsZjpjaGVja3RzKCkNCiAgICAgICAgaWYgVklQX1VTRVIgdGhlbiBzZWxmOmF1dG9sZXZlbCgpIGVuZA0KICAgICAgICAgaWYgVklQX1VTRVIgdGhlbiBzZWxmOnNraW5oYWNrKCkgZW5kDQogaWYoc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSBhbmQgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5SbG9naWMubG9naWMgPT0gMSApdGhlbg0KICAgIHNlbGY6Y29tYm8oKQ0KICBlbmQNCiAgIGlmKHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgYW5kIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljLmxvZ2ljID09IDIgKXRoZW4NCiAgICBzZWxmOmNvbWJvMigpDQogIGVuZA0KICAgICAgaWYoc2VsZi5Db25maWcuS2V5cy5qdW5nbGVjbGVhcmtleSApdGhlbg0KICAgc2VsZjpKdW5nbGVDbGVhcigpDQogIGVuZA0KICAgIGlmKHNlbGYuQ29uZmlnLktleXMubGFuZWNsZWFya2V5ICl0aGVuDQogICAgc2VsZjpMYW5lQ2xlYXIoKQ0KICBlbmQNCiAgaWYoc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzICkgdGhlbg0KICAgIHNlbGY6a2lsbHN0ZWFsKCkNCiAgZW5kDQogIGlmKHNlbGYuQ29uZmlnLktleXMuaGFyYXNza2V5ICApIHRoZW4NCiAgICBzZWxmOmhhcmFzcygpDQogIGVuZA0KICAgICAgaWYoc2VsZi5Db25maWcuS2V5cy5lc2NhcGVrZXkgKXRoZW4NCiAgICAgIHNlbGY6ZXNjYXBlKCkNCiAgICBlbmQNCiAgZW5kDQogICAgZnVuY3Rpb24gQWthbGk6d2FsaygpDQogICAgbXlIZXJvOk1vdmVUbyhtb3VzZVBvcy54LG1vdXNlUG9zLnopDQogIGVuZA0KICBmdW5jdGlvbiBBa2FsaTplc2NhcGUoKQ0KICAgaWYgc2VsZi5Db25maWcuS2V5cy5lc2NhcGVrZXkgIGFuZCBzZWxmLkNvbmZpZy5lc2NhcGUudXNlVyB0aGVuDQogIENhc3RTcGVsbChfVyxtb3VzZVBvcy54LG1vdXNlUG9zLnopDQogIGVuZA0KICBpZiBzZWxmLkNvbmZpZy5LZXlzLmVzY2FwZWtleSAgdGhlbiANCiAgc2VsZjp3YWxrKCkNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBBa2FsaTpEcmF3KCkNCiAgICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LnFkcmF3IGFuZCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkgdGhlbg0KICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCA2MDAsIDEscmVkKQ0KICBlbmQNCg0KICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LndkcmF3IGFuZCBzZWxmLldTcGVsbDpJc1JlYWR5KCkgdGhlbg0KICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCA3MDAsIDEsIHJlZCkNCiAgZW5kDQoNCiAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5lZHJhdyBhbmQgc2VsZi5FU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgMzI1LCAxLCByZWQpDQogIGVuZA0KICANCiAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5yZHJhdyBhbmQgc2VsZi5SU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgNzAwLDEsIHJlZCkNCiAgZW5kDQogIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcuYWFkcmF3IHRoZW4NCiAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgMTAwLDEsIEFSR0IoMjU1LCAyNTUsMCwwKSkNCiAgZW5kDQogICAgICAgICAgaWYgc2VsZi5Db25maWcub3RoZXIudGFyZ2V0IGFuZCBzZWxmLnNlbGVjdGVkVGFyIH49IG5pbCB0aGVuDQogICAgICAgICBEcmF3Q2lyY2xlM0Qoc2VsZi5zZWxlY3RlZFRhci54LCBzZWxmLnNlbGVjdGVkVGFyLnksIHNlbGYuc2VsZWN0ZWRUYXIueiwgODAsNiwgQVJHQigyNTUsIDI1NSwwLDApKQ0KZW5kDQogIGlmIHNlbGYuQ29uZmlnLm90aGVyLnRhcmdldGNhbCBhbmQgbm90IG15SGVyby5kZWFkIHRoZW4NCiAgICAgIGlmIHRhcmdldCBhbmQgdGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGxvY2FsIGRyYXdwb3M9V29ybGRUb1NjcmVlbihEM0RYVkVDVE9SMyh0YXJnZXQueCwgdGFyZ2V0LnksIHRhcmdldC56KSkNCiAgICAgICAgbG9jYWwgY29tYm9UZXh0LGNvbG9yID0gc2VsZjpHZXREcmF3cyh0YXJnZXQpDQogICAgICAgIGlmIGNvbWJvVGV4dCB0aGVuDQogICAgICAgICAgRHJhd1RleHQoY29tYm9UZXh0LDE1LGRyYXdwb3MueC0yMCxkcmF3cG9zLnktMjAsY29sb3IpDQogICAgICAgIGVuZCANCiAgICAgIGVuZCANCiAgICAgIGVuZA0KICAgICAgZW5kDQogDQpmdW5jdGlvbiBBa2FsaTpidWZmKHVuaXQpDQogcmV0dXJuIFRhcmdldEhhdmVCdWZmKCdBa2FsaU1vdGEnLCB1bml0KQ0KZW5kDQoNCmZ1bmN0aW9uIEFrYWxpOnNraW5oYWNrKCkNCiAgaWYgbm90IEZha2VMb2FkIHRoZW4NCiAgaWYgKChDdXJyZW50VGltZUluTWlsbGlzKCkgLSBsYXN0VGltZVRpY2tDYWxsZWQpID4gMjAwKSB0aGVuDQogICAgICBsYXN0VGltZVRpY2tDYWxsZWQgPSBDdXJyZW50VGltZUluTWlsbGlzKCkNCiAgICBpZiBzZWxmLkNvbmZpZy52aXAuc2tpbi5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgIHRoZW4NCiAgICBpZiBzZWxmLkNvbmZpZy52aXAuc2tpblsnc2VsZWN0ZWQnIC4uIG15SGVyby5jaGFyTmFtZSAuLiAnU2tpbiddIH49IGxhc3RTa2luIHRoZW4NCiAgICAgICAgbGFzdFNraW4gPSBzZWxmLkNvbmZpZy52aXAuc2tpblsnc2VsZWN0ZWQnIC4uIG15SGVyby5jaGFyTmFtZSAuLiAnU2tpbiddDQogIFNlbmRTa2luUGFja2V0KG15SGVyby5jaGFyTmFtZSwgc2tpbnNQQltzZWxmLkNvbmZpZy52aXAuc2tpblsnc2VsZWN0ZWQnIC4uIG15SGVyby5jaGFyTmFtZSAuLiAnU2tpbiddXSwgbXlIZXJvLm5ldHdvcmtJRCk7DQogIGVuZA0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBlbmQNCg0KIGZ1bmN0aW9uIEFrYWxpOmF1dG9sZXZlbCgpDQppZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDEgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2UxID0gICB7IDEsMiwzLDEsMSw0LDEsMiwxLDIsNCwyLDIsMywzLDQsMywzfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2UxKQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gMiBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTIgPSAgIHsgMSwyLDMsMSwxLDQsMSwzLDEsMyw0LDMsMywyLDIsNCwyLDJ9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTIpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSAzIGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlMyA9ICB7IDIsMywxLDIsMiw0LDIsMSwyLDEsNCwxLDEsMywzLDQsMywzfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2UzKQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gNCBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTQgPSAgeyAyLDMsMSwyLDIsNCwyLDMsMiwzLDQsMywzLDEsMSw0LDEsMX0NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlNCkNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDUgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2U1ID0gIHsgMywxLDIsMywzLDQsMywyLDMsMiw0LDIsMiwxLDEsNCwxLDF9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTUpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSA2IGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlNiA9ICB7IDMsMSwyLDMsMyw0LDMsMSwzLDEsNCwxLDEsMiwyLDQsMiwyfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2U2KQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogICAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSA3IGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlNiA9ICB7IDEsMywyLDEsMSw0LDEsMywxLDMsNCwzLDMsMiwyLDQsMiwyfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2U2KQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBBa2FsaTphdXRvemhvbnlhKCkNCiAgaWYgc2VsZi5Db25maWcuaXRlbS5lbmFibGVhdXRvemhvbnlhIHRoZW4NCiAgIGZvciBfID0gSVRFTV8xLCBJVEVNXzcgZG8NCiAgICBpZiBteUhlcm8uaGVhbHRoIDw9IChteUhlcm8ubWF4SGVhbHRoICogc2VsZi5Db25maWcuaXRlbS5hdXRvemhvbnlhIC8gMTAwKSBhbmQgKCBteUhlcm86Q2FuVXNlU3BlbGwoXykgPT0gMCBhbmQgbXlIZXJvOkdldFNwZWxsRGF0YShfKS5uYW1lID09ICJaaG9ueWFzSG91cmdsYXNzIiApdGhlbiBDYXN0U3BlbGwoXykNCiAgZW5kDQogIGVuZA0KICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIEFrYWxpOmNoZWNrdHMoKQ0KICAgICAgIHNlbGYudHM6dXBkYXRlKCkNCiAgICAgICBzZWxmLnRzZTp1cGRhdGUoKQ0KICAgICAgIHNlbGYudHNxOnVwZGF0ZSgpDQogICAgICAgc2VsZi50c3I6dXBkYXRlKCkNCiAgICAgICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgICAgIHNlbGYudHNnOnVwZGF0ZSgpDQppZiBub3Qgc2VsZi50c2cudGFyZ2V0fj1uaWwgb3Igbm90IHNlbGYuQ29uZmlnLnRhcmdldHNlbC50cyB0aGVuDQp0YXJnZXQgPSBzZWxmLnRzLnRhcmdldA0KZWxzZWlmIHNlbGYudHNnLnRhcmdldH49bmlsIG9yIHNlbGYuc2VsZWN0ZWRUYXIgdGhlbg0KdGFyZ2V0ID0gc2VsZi5zZWxlY3RlZFRhcg0KZW5kDQplbmQNCiAgZnVuY3Rpb24gQWthbGk6Y29tYm8oKQ0KICBsb2NhbCBhYnVmZiA9IHNlbGY6YnVmZih0YXJnZXQpDQogIGlmKHNlbGYudHNxLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VRIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgYW5kIHNlbGYuUVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgIHNlbGY6Q2FzdFEodGFyZ2V0KQ0KICAgZW5kDQogICAgaWYoc2VsZi50c3IudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVIgYW5kIGFidWZmIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgYW5kIG5vdCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYuUlNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgIHNlbGY6Q2FzdFIodGFyZ2V0KQ0KICAgZW5kDQogICAgaWYoc2VsZi50c2UudGFyZ2V0fj1uaWwgIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VFIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgIHNlbGY6Q2FzdEUodGFyZ2V0KQ0KICAgZW5kDQogICAgICAgaWYoc2VsZi5Db25maWcuY29tYm8udXNlSSBhbmQgc2VsZi5Db25maWcuY29tYm8uY29tYm9rZXkgKXRoZW4NCiAgICBmb3IgXywgdW5pdCBpbiBwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbw0KICAgICAgbG9jYWwgZG1nSSA9KDUwKyAoKG15SGVyby5sZXZlbCkqMjApKQ0KICAgICAgbG9jYWwgaGVhbHRoPXVuaXQuaGVhbHRoDQogICAgICBpZihoZWFsdGg8ZG1nSSBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlSSBhbmQgR2V0RGlzdGFuY2UodW5pdCk8NjAwKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0SSh1bml0KQ0KICAgIGVuZA0KICAgIGVuZA0KICBlbmQNCiAgZW5kDQogICAgZnVuY3Rpb24gQWthbGk6Y29tYm8yKCkNCiAgaWYoc2VsZi50c3EudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVEgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICBhbmQgc2VsZi5RU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0USh0YXJnZXQpDQogICBlbmQNCiAgICBpZihzZWxmLnRzci50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUiBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgIGFuZCBub3Qgc2VsZi5RU3BlbGw6SXNSZWFkeSgpIGFuZCBzZWxmLlJTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICBzZWxmOkNhc3RSKHRhcmdldCkNCiAgIGVuZA0KICAgIGlmKHNlbGYudHNlLnRhcmdldH49bmlsICBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlRSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgIGFuZCBzZWxmLkVTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICBzZWxmOkNhc3RFKHRhcmdldCkNCiAgIGVuZA0KICAgICAgIGlmKHNlbGYuQ29uZmlnLmNvbWJvLnVzZUkgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLmNvbWJva2V5ICl0aGVuDQogICAgZm9yIF8sIHVuaXQgaW4gcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8NCiAgICAgIGxvY2FsIGRtZ0kgPSg1MCsgKChteUhlcm8ubGV2ZWwpKjIwKSkNCiAgICAgIGxvY2FsIGhlYWx0aD11bml0LmhlYWx0aA0KICAgICAgaWYoaGVhbHRoPGRtZ0kgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZUkgYW5kIEdldERpc3RhbmNlKHVuaXQpPDYwMCl0aGVuDQogICAgICAgIHNlbGY6Q2FzdEkodW5pdCkNCiAgICBlbmQNCiAgICBlbmQNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBBa2FsaTpoYXJhc3MoKQ0KICBpZihzZWxmLnRzcS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuaGFyYXNzLnVzZVEgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmhhcmFzc2tleSAgYW5kIHNlbGYuUVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgIHNlbGY6Q2FzdFEodGFyZ2V0KQ0KICAgZW5kDQogICAgaWYoc2VsZi50c2UudGFyZ2V0fj1uaWwgIGFuZCBzZWxmLkNvbmZpZy5oYXJhc3MudXNlRSBhbmQgIHNlbGYuQ29uZmlnLktleXMuaGFyYXNza2V5ICBhbmQgc2VsZi5FU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0RSh0YXJnZXQpDQogICBlbmQNCiAgZW5kDQogICAgZnVuY3Rpb24gQWthbGk6SnVuZ2xlQ2xlYXIoKQ0KICAgbG9jYWwgY2xlYXJ0YXJnZXQgPSBuaWwNCiAgICAgIHNlbGYuZW5lbXlNaW5pb25zOnVwZGF0ZSgpDQogICAgICBzZWxmLm90aGVyTWluaW9uczp1cGRhdGUoKQ0KICAgICAgc2VsZi5qdW5nbGVNaW5pb25zOnVwZGF0ZSgpDQogICAgICBmb3IgaSwgbWluaW9uIGluIGlwYWlycyhzZWxmLmVuZW15TWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgICBpZiBWYWxpZFRhcmdldChtaW5pb24sIDYwMCkgYW5kIChjbGVhcnRhcmdldCA9PSBuaWwgb3Igbm90IFZhbGlkVGFyZ2V0KGNsZWFydGFyZ2V0KSkgdGhlbg0KICAgICAgICAgIGNsZWFydGFyZ2V0ID0gbWluaW9uDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBmb3IgaSwganVuZ2xlbWluaW9uIGluIGlwYWlycyhzZWxmLmp1bmdsZU1pbmlvbnMub2JqZWN0cykgZG8NCiAgICAgICAgaWYgVmFsaWRUYXJnZXQoanVuZ2xlbWluaW9uLCA2MDApIGFuZCAoY2xlYXJ0YXJnZXQgPT0gbmlsIG9yIG5vdCBWYWxpZFRhcmdldChjbGVhcnRhcmdldCkpIHRoZW4NCiAgICAgICAgICBjbGVhcnRhcmdldCA9IGp1bmdsZW1pbmlvbg0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgZm9yIGksIG90aGVybWluaW9uIGluIGlwYWlycyhzZWxmLm90aGVyTWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgICBpZiBWYWxpZFRhcmdldChvdGhlcm1pbmlvbiwgNjAwKSBhbmQgKGNsZWFydGFyZ2V0ID09IG5pbCBvciBub3QgVmFsaWRUYXJnZXQoY2xlYXJ0YXJnZXQpKSB0aGVuDQogICAgICAgICAgY2xlYXJ0YXJnZXQgPSBvdGhlcm1pbmlvbg0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgaWYgY2xlYXJ0YXJnZXQgfj0gbmlsIHRoZW4NCiAgICAgICAgaWYoc2VsZi5RU3BlbGw6SXNSZWFkeSgpIGFuZCBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyLnVzZVEgYW5kIHNlbGYuQ29uZmlnLktleXMuanVuZ2xlY2xlYXJrZXkgKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyLk1hbmEgLzEwMCApIHRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RRKGNsZWFydGFyZ2V0KQ0KICAgICAgICBlbmQNCiAgICAgICAgaWYgY2xlYXJ0YXJnZXQgfj0gbmlsIHRoZW4NCiAgICAgICAgaWYoc2VsZi5SU3BlbGw6SXNSZWFkeSgpIGFuZCBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyLnVzZVIgYW5kIHNlbGYuQ29uZmlnLktleXMuanVuZ2xlY2xlYXJrZXkgKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyLk1hbmEgLzEwMCApIHRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RSKGNsZWFydGFyZ2V0KQ0KICAgICAgICBlbmQNCiAgICAgICAgaWYgY2xlYXJ0YXJnZXQgfj0gbmlsIHRoZW4NCiAgICAgICAgaWYoc2VsZi5FU3BlbGw6SXNSZWFkeSgpIGFuZCBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyLnVzZUUgYW5kIHNlbGYuQ29uZmlnLktleXMuanVuZ2xlY2xlYXJrZXkgKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyLk1hbmEgLzEwMCApIHRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RFKGNsZWFydGFyZ2V0KQ0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgIGVuZA0KICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIEFrYWxpOkxhbmVDbGVhcigpDQogICBsb2NhbCBjbGVhcnRhcmdldCA9IG5pbA0KICAgICAgc2VsZi5lbmVteU1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIHNlbGYub3RoZXJNaW5pb25zOnVwZGF0ZSgpDQogICAgICBzZWxmLmp1bmdsZU1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIGZvciBpLCBtaW5pb24gaW4gaXBhaXJzKHNlbGYuZW5lbXlNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICAgIGlmIFZhbGlkVGFyZ2V0KG1pbmlvbiwgNjAwKSBhbmQgKGNsZWFydGFyZ2V0ID09IG5pbCBvciBub3QgVmFsaWRUYXJnZXQoY2xlYXJ0YXJnZXQpKSB0aGVuDQogICAgICAgICAgY2xlYXJ0YXJnZXQgPSBtaW5pb24NCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGZvciBpLCBqdW5nbGVtaW5pb24gaW4gaXBhaXJzKHNlbGYuanVuZ2xlTWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgICBpZiBWYWxpZFRhcmdldChqdW5nbGVtaW5pb24sIDYwMCkgYW5kIChjbGVhcnRhcmdldCA9PSBuaWwgb3Igbm90IFZhbGlkVGFyZ2V0KGNsZWFydGFyZ2V0KSkgdGhlbg0KICAgICAgICAgIGNsZWFydGFyZ2V0ID0ganVuZ2xlbWluaW9uDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBmb3IgaSwgb3RoZXJtaW5pb24gaW4gaXBhaXJzKHNlbGYub3RoZXJNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICAgIGlmIFZhbGlkVGFyZ2V0KG90aGVybWluaW9uLCA2MDApIGFuZCAoY2xlYXJ0YXJnZXQgPT0gbmlsIG9yIG5vdCBWYWxpZFRhcmdldChjbGVhcnRhcmdldCkpIHRoZW4NCiAgICAgICAgICBjbGVhcnRhcmdldCA9IG90aGVybWluaW9uDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBpZiBjbGVhcnRhcmdldCB+PSBuaWwgdGhlbg0KICAgICAgICBpZihzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYuQ29uZmlnLmZhcm0ubGFuZWNsZWFyLnVzZVEgYW5kIHNlbGYuQ29uZmlnLktleXMuanVuZ2xlY2xlYXJrZXkgKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyLk1hbmEgLzEwMCApIHRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RRKGNsZWFydGFyZ2V0KQ0KICAgICAgICBlbmQNCiAgICAgICAgaWYgY2xlYXJ0YXJnZXQgfj0gbmlsIHRoZW4NCiAgICAgICAgaWYoc2VsZi5SU3BlbGw6SXNSZWFkeSgpIGFuZCBzZWxmLkNvbmZpZy5mYXJtLmxhbmVjbGVhci51c2VSIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmp1bmdsZWNsZWFya2V5ICkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0UihjbGVhcnRhcmdldCkNCiAgICAgICAgZW5kDQogICAgICAgIGlmIGNsZWFydGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGlmKHNlbGYuRVNwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcuZmFybS5sYW5lY2xlYXIudXNlRSBhbmQgc2VsZi5Db25maWcuS2V5cy5qdW5nbGVjbGVhcmtleSApIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXIuTWFuYSAvMTAwICkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEUoY2xlYXJ0YXJnZXQpDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgZW5kDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gQWthbGk6Q2FzdFEodW5pdCkNCiAgc2VsZi5RU3BlbGw6Q2FzdCh1bml0KQ0KZW5kDQoNCmZ1bmN0aW9uIEFrYWxpOkNhc3RXKHVuaXQpDQogIHNlbGYuV1NwZWxsOkNhc3QodW5pdCkNCmVuZA0KDQpmdW5jdGlvbiBBa2FsaTpDYXN0RSh1bml0KQ0KICBzZWxmLkVTcGVsbDpDYXN0KHVuaXQpDQplbmQNCg0KZnVuY3Rpb24gQWthbGk6Q2FzdFIodW5pdCkNCiAgc2VsZi5SU3BlbGw6Q2FzdCh1bml0KQ0KZW5kDQpmdW5jdGlvbiBBa2FsaTpDYXN0SSh1bml0KQ0KICBzZWxmLklnbml0ZTpDYXN0KHVuaXQpDQplbmQNCiAgZnVuY3Rpb24gQWthbGk6YXV0b3EoKQ0KICAgICAgICAgaWYoc2VsZi50c3EudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLktleXMuYXV0b3EgYW5kICBzZWxmLlFTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICBzZWxmOkNhc3RRKHRhcmdldCkNCiAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gQWthbGk6R2V0RHJhd3ModGFyZ2V0KQ0KbG9jYWwgUWRtZz1nZXREbWcoIlEiLHRhcmdldCxteUhlcm8pDQpsb2NhbCBRZG1nMj0obXlIZXJvLmFwKjAuNSkNCmxvY2FsIEVkbWc9Z2V0RG1nKCJFIix0YXJnZXQsbXlIZXJvKQ0KbG9jYWwgUmRtZz1nZXREbWcoIlIiLHRhcmdldCxteUhlcm8pDQpsb2NhbCBJZG1nPSg1MCsgKChteUhlcm8ubGV2ZWwpKjIwKSkNCiAgDQogIGlmIFFkbWcgPiB0YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EnLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgUWRtZytJZG1nPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIElnbml0ZScsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBFZG1nPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnRScsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBFZG1nK0lkbWc+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdFICsgSWduaXRlJywgUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgICAgIGVsc2VpZiBSZG1nPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUicsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBSZG1nK0lkbWc+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdSICsgSWduaXRlJywgUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIFFkbWcrRWRtZz50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBFJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICAgICAgZWxzZWlmIFFkbWcrUmRtZz50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBSJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgUWRtZytFZG1nK0lkbWc+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgRSArIElnbml0ZScsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgICAgIGVsc2VpZiBRZG1nK1JkbWcrSWRtZz50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBSICsgSWduaXRlJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgUWRtZytFZG1nK1JkbWcrSWRtZz50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBSICsgRSArIElnbml0ZScsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIFFkbWcrUmRtZytFZG1nID50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBSICsgRScsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIFFkbWcrUWRtZzIgPiB0YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBRMicsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBRZG1nK0lkbWcrUWRtZzI+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgUTIgKyBJZ25pdGUnLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgRWRtZz50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ0UnLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgRWRtZytJZG1nPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnRSArIElnbml0ZScsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogICAgICBlbHNlaWYgUmRtZz50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1InLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgUmRtZytJZG1nPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUiArIElnbml0ZScsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBRZG1nK0VkbWcrUWRtZzI+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgUTIgKyBFJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICAgICAgZWxzZWlmIFFkbWcrUmRtZytRZG1nMj50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBRMiArIFInLFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBRZG1nK0VkbWcrSWRtZytRZG1nMj50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBRMiArIEUgKyBJZ25pdGUnLFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogICAgICBlbHNlaWYgUWRtZytSZG1nK0lkbWcrUWRtZzI+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgUTIgKyBSICsgSWduaXRlJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgUWRtZytFZG1nK1JkbWcrSWRtZytRZG1nMj50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBRMiArIFIgKyBFICsgSWduaXRlJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgUWRtZytSZG1nK0VkbWcrUWRtZzIgPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIFEyICsgUiArIEUnLFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogICAgICBlbHNlaWYgKFFkbWcrRWRtZytSZG1nK0lkbWcrUWRtZzIpKyhRZG1nK0VkbWcrUmRtZytJZG1nK1FkbWcyKSA+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdLaWxsIFdpdGggMiBDb21ibycsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZSANCiAgICByZXR1cm4gIkNhbnQgS2lsbCB5ZXQiLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbmQgDQplbmQNCiAgZnVuY3Rpb24gQWthbGk6a2lsbHN0ZWFsKCkNCmZvciBfLCB1bml0IGluIHBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvDQogICAgbG9jYWwgaGVhbHRoID0gdW5pdC5oZWFsdGgNCiAgICBsb2NhbCBkbWdFID0gZ2V0RG1nKCJFIiwgdW5pdCwgbXlIZXJvKQ0KICAgICAgaWYoc2VsZi50c2UudGFyZ2V0IH49IG5pbCBhbmQgIHNlbGYuRVNwZWxsOklzUmVhZHkoKSBhbmQgaGVhbHRoPGRtZ0UgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VFICAgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyl0aGVuDQogICAgICAgIHNlbGY6Q2FzdEUodW5pdCkgIA0KICAgICAgZW5kDQogICAgICBsb2NhbCBkbWdRID0gZ2V0RG1nKCJRIiwgdW5pdCwgbXlIZXJvKSANCiAgICAgIGlmKHNlbGYudHNxLnRhcmdldCB+PSBuaWwgYW5kICBzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIGhlYWx0aDxkbWdRIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlUSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzICl0aGVuDQogICAgICAgIHNlbGY6Q2FzdFEodW5pdCkgIA0KICAgICAgZW5kDQogICAgICAgbG9jYWwgZG1nSSA9KDUwKyAoKG15SGVyby5sZXZlbCkqMjApKQ0KICAgICAgaWYoaGVhbHRoPGRtZ0kgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VJIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgYW5kIEdldERpc3RhbmNlKHVuaXQpPDYwMCl0aGVuDQogICAgICAgIHNlbGY6Q2FzdEkodW5pdCkNCiAgICAgIGVuZA0KICAgICAgbG9jYWwgZG1nUiA9Z2V0RG1nKCJSIix1bml0LG15SGVybykNCiAgICAgIGlmKHNlbGYudHNyLnRhcmdldCB+PSBuaWwgYW5kICBzZWxmLlJTcGVsbDpJc1JlYWR5KCkgYW5kIGhlYWx0aDxkbWdSIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlUiBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzIGFuZCBHZXREaXN0YW5jZSh1bml0KTw1NTApdGhlbg0KICAgICAgICBzZWxmOkNhc3RSKHVuaXQpDQogICAgICBlbmQNCiAgIGVuZA0KZW5kDQpmdW5jdGlvbiBBa2FsaTppdGVtcygpDQogIGlmIHNlbGYuQ29uZmlnLml0ZW0udXNlYmcgYW5kIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgdGhlbg0KICAgZm9yIF8gPSBJVEVNXzEsIElURU1fNyBkbw0KICAgIGlmICggbXlIZXJvOkNhblVzZVNwZWxsKF8pID09IDAgYW5kIG15SGVybzpHZXRTcGVsbERhdGEoXykubmFtZSA9PSAiQmlsZ2V3YXRlckN1dGxhc3MiICl0aGVuIENhc3RTcGVsbChfKQ0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBpZiBzZWxmLkNvbmZpZy5pdGVtLnVzZWhnIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5IHRoZW4NCiAgIGZvciBfID0gSVRFTV8xLCBJVEVNXzcgZG8NCiAgICBpZiAoIG15SGVybzpDYW5Vc2VTcGVsbChfKSA9PSAwIGFuZCBteUhlcm86R2V0U3BlbGxEYXRhKF8pLm5hbWUgPT0gIkhleHRlY2hHdW5ibGFkZSIgKXRoZW4gQ2FzdFNwZWxsKF8pDQogIGVuZA0KICBlbmQNCiAgZW5kDQogIGVuZA0KIGZ1bmN0aW9uIEFrYWxpOkF1dG9zdGVhbHRoKCkNCiAgICBpZiBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLldsb2dpYy51c2VXIGFuZCBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLldsb2dpYy51c2VXZW4gdGhlbg0KICAgICAgICBpZiBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLldsb2dpYy51c2VXZSA9PSAxIHRoZW4NCiAgICAgICAgICAgIGlmIENvdW50RW5lbXlIZXJvSW5SYW5nZSg5MDApID49IDIgdGhlbg0KICAgICAgICAgICAgICAgIENhc3RTcGVsbChfVywgbXlIZXJvLngsIG15SGVyby56KQ0KICAgICAgICAgICAgZW5kDQogICAgICAgIGVsc2VpZiBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLldsb2dpYy51c2VXZSA9PSAyIHRoZW4NCiAgICAgICAgICAgIGlmIENvdW50RW5lbXlIZXJvSW5SYW5nZSg5MDApID49IDMgdGhlbg0KICAgICAgICAgICAgICAgIENhc3RTcGVsbChfVywgbXlIZXJvLngsIG15SGVyby56KQ0KICAgICAgICAgICAgZW5kDQogICAgICAgIGVsc2VpZiBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLldsb2dpYy51c2VXZSA9PSAzIHRoZW4NCiAgICAgICAgICAgIGlmIENvdW50RW5lbXlIZXJvSW5SYW5nZSg5MDApID49IDQgdGhlbg0KICAgICAgICAgICAgICAgIENhc3RTcGVsbChfVywgbXlIZXJvLngsIG15SGVyby56KQ0KICAgICAgICAgICAgZW5kDQogICAgICAgIGVsc2VpZiBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLldsb2dpYy51c2VXZSA9PSA0IHRoZW4NCiAgICAgICAgICAgIGlmIENvdW50RW5lbXlIZXJvSW5SYW5nZSg5MDApID49IDUgdGhlbg0KICAgICAgICAgICAgICAgIENhc3RTcGVsbChfVywgbXlIZXJvLngsIG15SGVyby56KQ0KICAgICAgICAgICAgZW5kDQogICAgICAgIGVuZA0KICAgIGVuZA0KICAgIGlmIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuV2xvZ2ljLnVzZVdocCBhbmQgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5XbG9naWMudXNlVyB0aGVuDQogICAgICAgIGlmIG15SGVyby5oZWFsdGggPD0gKG15SGVyby5tYXhIZWFsdGggKiBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLldsb2dpYy5ocCAvIDEwMCkgdGhlbiANCiAgICAgICAgICAgIENhc3RTcGVsbChfVywgbXlIZXJvLngsIG15SGVyby56KQ0KICAgICAgICBlbmQNCiAgICBlbmQNCmVuZA0KDQogIGZ1bmN0aW9uIEFrYWxpOkxvYWRNZW51KCkNCiAgICAgICBzZWxmLkNvbmZpZz1zY3JpcHRDb25maWcoIiIuLlNjcmlwdG5hbWUuLiIgWyIgLi4gbXlIZXJvLmNoYXJOYW1lLi4iXSIgLCJtZW51IikNCg0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiQ29tYm8gU2V0dGluZ3MiLCAiY29tYm8iKQ0KICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZVEiLCAiVXNlIFEgaW4gQ29tYm8iLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlRSIsICJVc2UgRSBpbiBjb21ibyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VSIiwgIlVzZSBSIGluIGNvbWJvIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZUkiLCAiVXNlIElnbml0ZSBpZiB0YXJnZXQga2lsbGFibGUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDEwLCAxMCwgMTAwLCAwKQ0KICAgICANCiAgICAgIA0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiSGFyYXNzIFNldHRpbmdzIiwgImhhcmFzcyIpDQogICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6YWRkUGFyYW0oInVzZVEiLCAiSGFyYXNzIFdpdGggUSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczphZGRQYXJhbSgidXNlRSIsICJIYXJhc3MgV2l0aCBFIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgc2VsZi5Db25maWcuaGFyYXNzOmFkZFBhcmFtKCJNYW5hIiwiTWFuYSBNYW5hZ2VyICUiLFNDUklQVF9QQVJBTV9TTElDRSwgMTAsIDEwLCAxMDAsIDApDQogICAgICANCiAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIlNraWxsIExvZ2ljcyIsICJza2lsbGxvZ2ljIikNCiAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWM6YWRkU3ViTWVudSgiVyBTa2lsbCBMb2dpYyIsICJXbG9naWMiKSANCiAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuV2xvZ2ljOmFkZFBhcmFtKCJ1c2VXIiwgIlVzZSBTdGVhbHRoIChXKSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuV2xvZ2ljOmFkZFBhcmFtKCJ1c2VXaHAiLCAiVXNlIFN0ZWFsdGggaWYgaGVhbHQgJSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgZmFsc2UpDQogICAgICBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLldsb2dpYzphZGRQYXJhbSgiaHAiLCJIZWFsdGggTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDMwLCAxMCwgMTAwLCAwKQ0KICAgICAgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5XbG9naWM6YWRkUGFyYW0oInVzZVdlbiIsICJVc2UgU3RlYWx0aCBpZiBlbmVteSA+IiwgU0NSSVBUX1BBUkFNX09OT0ZGLCBmYWxzZSkNCiAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuV2xvZ2ljOmFkZFBhcmFtKCJ1c2VXZSIsICJVc2UgU3RlYWx0aCBpZiBlbmVteSA+IiwgU0NSSVBUX1BBUkFNX0xJU1QsIDEsIHsiMiBlbmVteSIsICIzIGVuZW15IiAsICI0IGVuZW15IiwiNSBlbmVteSIgfSkNCiAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWM6YWRkU3ViTWVudSgiUiBTa2lsbCBMb2dpYyIsICJSbG9naWMiKSANCiAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljOmFkZFBhcmFtKCJsb2dpYyIsICJSIFNraWxsIExvZ2ljIiwgU0NSSVBUX1BBUkFNX0xJU1QsIDEsIHsiVXNlIFIgaWYgUSBpcyBvbiB0YXJnZXQiLCAiUnVzaCBTa2lsbHMiIH0pDQogICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiRmFybSBTZXR0aW5ncyIsICJmYXJtIikNCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnLmZhcm06YWRkU3ViTWVudSgiTGFuZUNsZWFyIFNldHRpbmdzIiwibGFuZWNsZWFyIikNCiAgICAgICAgc2VsZi5Db25maWcuZmFybS5sYW5lY2xlYXI6YWRkUGFyYW0oInVzZVEiLCJVc2UgUSBvbiBMYW5lY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5mYXJtLmxhbmVjbGVhcjphZGRQYXJhbSgidXNlRSIsIlVzZSBFIG9uIExhbmVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmZhcm0ubGFuZWNsZWFyOmFkZFBhcmFtKCJ1c2VSIiwiVXNlIFIgb24gTGFuZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLmZhcm0ubGFuZWNsZWFyOmFkZFBhcmFtKCJNYW5hIiwiTWFuYSBNYW5hZ2VyICUiLFNDUklQVF9QQVJBTV9TTElDRSwgMzAsIDEwLCAxMDAsIDApDQogICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZy5mYXJtOmFkZFN1Yk1lbnUoIkp1bmdsZUNsZWFyIFNldHRpbmdzIiwianVuZ2xlY2xlYXIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyOmFkZFBhcmFtKCJ1c2VRIiwiVXNlIFEgb24gSnVuZ2xlY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyOmFkZFBhcmFtKCJ1c2VFIiwiVXNlIEUgb24gSnVuZ2xlY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyOmFkZFBhcmFtKCJ1c2VSIiwiVXNlIFIgb24gSnVuZ2xlY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhcjphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDMwLCAxMCwgMTAwLCAwKQ0KICAgICAgDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJLaWxsU3RlYWwgU2V0dGluZ3MiLCAia2lsbHN0ZWFsIikNCiAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgia3MiLCJLaWxsc3RlYWwgT24vT2ZmIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgidXNlUSIsICJTdGVhbCBXaXRoIFEiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZUUiLCAiU3RlYWwgV2l0aCBFIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJ1c2VSIiwgIlN0ZWFsIFdpdGggUiIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgidXNlSSIsICJTdGVhbCBXaXRoIElnbml0ZSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIA0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiRXNjYXBlIFNldHRpbmdzIiwiZXNjYXBlIikNCiAgICAgIHNlbGYuQ29uZmlnLmVzY2FwZTphZGRQYXJhbSgidXNlVyIsIlVzZSBXIFdoaWxlIEVzY2FwZSIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIA0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiSXRlbSBTZXR0aW5ncyIsICJpdGVtIikNCiAgICAgIHNlbGYuQ29uZmlnLml0ZW06YWRkUGFyYW0oImVuYWJsZWF1dG96aG9ueWEiLCAiQXV0byBaaG9ueWEiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIGZhbHNlKQ0KICAgICAgc2VsZi5Db25maWcuaXRlbTphZGRQYXJhbSgiYXV0b3pob255YSIsICJaaG9ueWEgaWYgSGVhbHRoIHVuZGVyIC0+ICUiLCBTQ1JJUFRfUEFSQU1fU0xJQ0UsIDEwLCAwLCAxMDAsIDApDQogICAgICBzZWxmLkNvbmZpZy5pdGVtOmFkZFBhcmFtKCJ1c2VoZyIsICJVc2UgSGV4dGVjaCBHdW5ibGFkZSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLml0ZW06YWRkUGFyYW0oInVzZWJnIiwgIlVzZSBCaWxnZXdhdGVyIEN1dGxhc3MiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICANCiAgICAgIGlmIFZJUF9VU0VSIHRoZW4NCiAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIlZJUCBTZXR0aW5ncyIsICJ2aXAiKQ0KICAgICAgc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJwYWNrZXQiLCJVc2UgUGFja2V0IENhc3RpbmciLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzEiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm8yIiwgIlRvIHVzZSB2aXAgc2V0dGluZ3MsIFBhY2tldCBDYXN0aW5nIHNob3VsZCBiZSBvcGVuLiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcudmlwOmFkZFN1Yk1lbnUoIkF1dG8gTGV2ZWwgU2V0dGluZ3MiLCAibGV2ZWwiKQ0KICAgICAgc2VsZi5Db25maWcudmlwLmxldmVsOmFkZFBhcmFtKCJrZXkiLCJVc2UgQXV0byBMZXZlbCIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgc2VsZi5Db25maWcudmlwLmxldmVsOmFkZFBhcmFtKCJsb2dpYyIsICJTZWxlY3QgU2tpbGwgT3JkZXIiLCBTQ1JJUFRfUEFSQU1fTElTVCwgNywgeyJGb2N1cyBRPlc+RSIsICJGb2N1cyBRPkU+VyIsIkZvY3VzIFc+UT5FIiwiRm9jdXMgVz5FPlEiLCJGb2N1cyBFPlc+USIsICJGb2N1cyBFPlE+VyIsIlNtYXJ0IiAgfSkNCiAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRTdWJNZW51KCJTa2luIEhhY2sgU2V0dGluZ3MiLCAic2tpbiIpDQogICAgICBzZWxmLkNvbmZpZy52aXAuc2tpbjphZGRQYXJhbSgia2V5IiwiVXNlIFNraW4gSGFjayIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgc2VsZi5Db25maWcudmlwLnNraW46YWRkUGFyYW0oJ3NlbGVjdGVkJyAuLiBteUhlcm8uY2hhck5hbWUgLi4gJ1NraW4nLCAiU2VsZWN0IFNraW4iLCBTQ1JJUFRfUEFSQU1fTElTVCwgMSwgc2tpbk1ldGFbbXlIZXJvLmNoYXJOYW1lXSkNCiAgICAgIHNlbGYuQ29uZmlnLnZpcC5za2luOmFkZFBhcmFtKCJpbmZvNSIsICJNYWtlIHN1cmUgdGhhdCB1c2luZyBwYWNrZXQgY2FzdGluZyBpcyBPTi4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIC0tc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvNSIsICJTa2luIEhhY2sgdGVtcG9yYXJ5IGRpc2FibGVkIHVudGlsIG5leHQgdXBkYXRlLiAuIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAtLVtbc2VsZi5Db25maWcudmlwOmFkZFN1Yk1lbnUoIkFudGktQUZLIFNldHRpbmdzIiwgImFudGlhZmsiKQ0KICAgICAgc2VsZi5Db25maWcudmlwLmFudGlhZms6YWRkUGFyYW0oImFudGlhZmsiLCJVc2UgQW50aSBBZmsiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkgXV0NCiAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzMiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm80IiwgIlRvIHVzZSB2aXAgc2V0dGluZ3MsIFlvdSBuZWVkIHRvIGJlIGEgVklQIHVzZXIgb24gQk9MIGNvbW11bml0eS4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgZW5kDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJEcmF3IFNldHRpbmdzIiwib3RoZXIiKQ0KICAgICAgLS1zZWxmLkNvbmZpZy5vdGhlcjphZGRTdWJNZW51KCJTaG93IERhbWFnZSBPbiBIcCBCYXIiLCAiSFBCQVIiKQ0KICAgICAgLS1zZWxmLkNvbmZpZy5vdGhlci5IUEJBUjphZGRQYXJhbSgia2V5IiwiT04vT0ZGIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLm90aGVyOmFkZFN1Yk1lbnUoIlNraWxsIERyYXdpbmcgU2V0dGluZ3MiLCAiZHJhdyIpDQogICAgICBzZWxmLkNvbmZpZy5vdGhlci5kcmF3OmFkZFBhcmFtKCJxZHJhdyIsIlEgU2tpbGwgRHJhd2luZ3MiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgid2RyYXciLCJXIFNraWxsIERyYXdpbmdzIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oImVkcmF3IiwiRSBTa2lsbCBEcmF3aW5ncyIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5vdGhlci5kcmF3OmFkZFBhcmFtKCJyZHJhdyIsIlIgU2tpbGwgRHJhd2luZ3MiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgiYWFkcmF3IiwiQXV0byBBdHRhY2sgUmFuZ2UiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgIHNlbGYuQ29uZmlnLm90aGVyOmFkZFN1Yk1lbnUoIkRyYXcgUGVybWFib3giLCAicGVybWEiKQ0KICAgICAgc2VsZi5Db25maWcub3RoZXIucGVybWE6YWRkUGFyYW0oInBlcm1hIiwiRHJhdyBQZXJtYWJveCAoIE5lZWRzIDJ4IEY5ICkiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgc2VsZi5Db25maWcub3RoZXI6YWRkUGFyYW0oInRhcmdldCIsIkRyYXcgY2lyY2xlIGZvciB0YXJnZXQgc2VsZWN0ZWQiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgc2VsZi5Db25maWcub3RoZXI6YWRkUGFyYW0oInRhcmdldGNhbCIsIlRhcmdldCBjYWxjdWxhdGlvbiIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICANCiAgICAgIA0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiVGFyZ2V0c2VsZWN0b3JzIiwidGFyZ2V0c2VsIikNCiAgICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRQYXJhbSgiaW5mb0syIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFBhcmFtKCJpbmZvSyIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRQYXJhbSgidHMiLCJMZWZ0IENsaWNrIEZvciBUYXJnZXQgU2VsZWN0aW9uIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICBzZWxmLnRzLm5hbWUgID0gIkFrYWxpIg0KICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRUUyhzZWxmLnRzKQ0KICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJLZXlzIFNldHRpbmdzIiwgIktleXMiKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LMyIsICI8LS0tLS0tLS0tLS0tLS0tLS0tQ29tYm8gS2V5IFNldHRpbmdzLS0tLS0tLS0tLS0tLS0tLS0tPiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImNvbWJva2V5IiwgIkNvbWJvIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCAzMikNCiAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJpbmZvSzQiLCAiPC0tLS0tLS0tLS0tLS0tLS0tLUhhcmFzcyBLZXkgU2V0dGluZ3MtLS0tLS0tLS0tLS0tLS0tLS0+IiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaGFyYXNza2V5IiwgIlNtYXJ0IEhhcmFzcyBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIkMiKSkNCiAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJhdXRvcSIsICJBdXRvIEhhcmFzcyBRIiwgU0NSSVBUX1BBUkFNX09OS0VZVE9HR0xFLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIlQiKSkNCiAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJpbmZvSzUiLCAiPC0tLS0tLS0tLS0tLS0tLS0tLUNsZWFyIEtleSBTZXR0aW5ncy0tLS0tLS0tLS0tLS0tLS0tLS0tPiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImxhbmVjbGVhcmtleSIsICJMYW5lQ2xlYXIgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJWIikpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgianVuZ2xlY2xlYXJrZXkiLCAiSnVuZ2xlQ2xlYXIgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJWIikpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0s2IiwgIjwtLS0tLS0tLS0tLS0tLS0tLS1PdGhlciBLZXkgU2V0dGluZ3MtLS0tLS0tLS0tLS0tLS0tLS0tLT4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJlc2NhcGVrZXkiLCAiRXNjYXBlIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiWSIpKQ0KICAgIC0tc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgibGFzdGhpdGtleSIsICJMYXN0aGl0IEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiWCIpKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LMiIsICJNYWtlIFN1cmUgVGhhdCBZb3VyIE9yYndhbGtlciBLZXlzIGFyZSBTYW1lIEFzIEhlcmUiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJPcndXYWxrZXJLZXkgU2V0dGluZ3MiLCAiS2V5czIiKQ0KICAgIA0KICAgIE9yYndhbGtNYW5hZ2VyOkxvYWRDb21tb25LZXlzKHNlbGYuQ29uZmlnLktleXMyKQ0KICAgIA0KICAgICANCiAgICAgaWYgc2VsZi5Db25maWcub3RoZXIucGVybWEucGVybWEgdGhlbg0KICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBzZWxmLkNvbmZpZzpwZXJtYVNob3coImluZm9ib3giKSBlbmQsIDEpDQogICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHNlbGYuQ29uZmlnLktleXM6cGVybWFTaG93KCJjb21ib2tleSIpIGVuZCwgMS4yKQ0KICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgc2VsZi5Db25maWcuS2V5czpwZXJtYVNob3coImhhcmFzc2tleSIpIGVuZCwgMS4yKQ0KICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgc2VsZi5Db25maWcuS2V5czpwZXJtYVNob3coImF1dG9xIikgZW5kLCAxLjIpDQplbmQNCiAgZW5kDQpmdW5jdGlvbiBBa2FsaTpXbmRNc2coTXNnLCBLZXkpDQppZiBzZWxmLkNvbmZpZy50YXJnZXRzZWwudHMgdGhlbiAgICAgIA0KICAgICAgICBpZiBNc2cgPT0gV01fTEJVVFRPTkRPV04gdGhlbg0KICAgICAgICAgICAgbG9jYWwgbWluRCA9IDEwDQogICAgICAgICAgICBsb2NhbCBzdGFyZ2V0ID0gbmlsDQogICAgICAgICAgICBmb3IgaSwgZW5lbXkgaW4gaXBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvDQogICAgICAgICAgICAgICAgaWYgVmFsaWRUYXJnZXQoZW5lbXkpIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgaWYgR2V0RGlzdGFuY2UoZW5lbXksIG1vdXNlUG9zKSA8PSBtaW5EIG9yIHN0YXJnZXQgPT0gbmlsIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICAgIG1pbkQgPSBHZXREaXN0YW5jZShlbmVteSwgbW91c2VQb3MpDQogICAgICAgICAgICAgICAgICAgICAgICBzdGFyZ2V0ID0gZW5lbXkNCiAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICBlbmQgICAgIA0KICAgICAgICAgICAgaWYgc3RhcmdldCBhbmQgbWluRCA8IDUwMCB0aGVuDQogICAgICAgICAgICAgICAgaWYgc2VsZi5zZWxlY3RlZFRhciBhbmQgc3RhcmdldC5jaGFyTmFtZSA9PSBzZWxmLnNlbGVjdGVkVGFyLmNoYXJOYW1lIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgc2VsZi5zZWxlY3RlZFRhciA9IG5pbA0KICAgICAgICAgICAgICAgICAgICBwcmludCgiPGZvbnQgY29sb3I9XCIjQ0JGNkZGXCI+VGFyZ2V0IDxiPmlzIG5vIGxvZ2VyIHNlbGVjdGVkLjwvYj46ICIuLnN0YXJnZXQuY2hhck5hbWUuLiI8L2ZvbnQ+IikNCiAgICAgICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWRUYXIgPSBzdGFyZ2V0ICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIHByaW50KCI8Zm9udCBjb2xvcj1cIiNDQkY2RkZcIj5OZXcgdGFyZ2V0IDxiPnNlbGVjdGVkLjwvYj46ICIuLnN0YXJnZXQuY2hhck5hbWUuLiI8L2ZvbnQ+IikNCiAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgICBlbmQNCiAgICBlbmQNCiAgIC0tLS8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cXC0tLQ0KLS18fCA+IExpc3NhbmRyYSBTdGFydHMgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwtLQ0KLS0tXFw9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PS8vLS0tDQogIGNsYXNzICJMaXNzYW5kcmEiDQogIGZ1bmN0aW9uIExpc3NhbmRyYTpfX2luaXQoKQ0KICAgc2VsZi50cz0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgNTUwLCBEQU1BR0VfUEhZU0lDQUwsIGZhbHNlLCB0cnVlKQ0KICBzZWxmLnRzcT0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgNzI1LCBEQU1BR0VfUEhZU0lDQUwsIGZhbHNlLCB0cnVlKQ0KICBzZWxmLnRzdz0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgNDUwLCBEQU1BR0VfTUFHSUMsIGZhbHNlLCB0cnVlKQ0KICBzZWxmLnRzZT0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgMTA1MCwgREFNQUdFX01BR0lDLCBmYWxzZSwgdHJ1ZSkNCiAgc2VsZi50c3I9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDU1MCwgREFNQUdFX01BR0lDLCBmYWxzZSwgdHJ1ZSkgDQogICAgIHNlbGYuUVNwZWxsID0gX1NwZWxsKHtTbG90ID0gX1EsIERhbWFnZU5hbWUgPSAiUSIsIFJhbmdlID0gNzI1LCBXaWR0aCA9IDIwLCBEZWxheSA9IDAuMjUsIFNwZWVkID0gbWF0aC5odWdlLCBDb2xsaXNpb24gPSBmYWxzZSwgQW9lID0gZmFsc2UsIFR5cGUgPSBTUEVMTF9UWVBFLkxJTkVBUn0pDQogICAgIHNlbGYuV1NwZWxsID0gX1NwZWxsKHtTbG90ID0gX1csIERhbWFnZU5hbWUgPSAiVyIsIFJhbmdlID0gNDUwLCBXaWR0aCA9IDAsIERlbGF5ID0gMC41LCBTcGVlZCA9IG1hdGguaHVnZSwgQ29sbGlzaW9uID0gZmFsc2UsIEFvZSA9IHRydWUsIFR5cGUgPSBTUEVMTF9UWVBFLlNFTEZ9KQ0KICAgICBzZWxmLkVTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9FLCBEYW1hZ2VOYW1lID0gIkUiLCBSYW5nZSA9IDEwNTAsIFdpZHRoID0gMTEwLCBEZWxheSA9IC4yNSwgU3BlZWQgPSBtYXRoLmh1Z2UsIENvbGxpc2lvbiA9IGZhbHNlLCBBb2UgPSBmYWxzZSwgVHlwZSA9IFNQRUxMX1RZUEUuTElORUFSfSkNCiAgICAgc2VsZi5SU3BlbGwgPSBfU3BlbGwoe1Nsb3QgPSBfUiwgRGFtYWdlTmFtZSA9ICJSIiwgUmFuZ2UgPTU1MCwgV2lkdGggPSAwLCBEZWxheSA9IDAuMjUsIFNwZWVkID0gbWF0aC5odWdlLCBDb2xsaXNpb24gPSBmYWxzZSwgQW9lID0gdHJ1ZSwgVHlwZSA9IFNQRUxMX1RZUEUuVEFSR0VUVEVEfSkNCiAgICAgc2VsZi5SU1NwZWxsID0gX1NwZWxsKHtTbG90ID0gX1IsIERhbWFnZU5hbWUgPSAiUiIsIFJhbmdlID01NTAsIFdpZHRoID0gMCwgRGVsYXkgPSAwLjI1LCBTcGVlZCA9IG1hdGguaHVnZSwgQ29sbGlzaW9uID0gZmFsc2UsIEFvZSA9IHRydWUsIFR5cGUgPSBTUEVMTF9UWVBFLlRBUkdFVFRFRH0pDQogICAgIHNlbGYuSWduaXRlID0gX1NwZWxsKHtTbG90ID0gRmluZFN1bW1vbmVyU2xvdCgic3VtbW9uZXJkb3QiKSwgRGFtYWdlTmFtZSA9ICJJR05JVEUiLCBSYW5nZSA9IDYwMCwgVHlwZSA9IFNQRUxMX1RZUEUuVEFSR0VUVEVEfSkNCiAgLS18PiBNaW5pb24gTWFuYWdlcnMNCiAgICAgIHNlbGYuZW5lbXlNaW5pb25zICAgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9FTkVNWSwgICA2NTAsIG15SGVybywgTUlOSU9OX1NPUlRfTUFYSEVBTFRIX0RFQykNCiAgICAgIHNlbGYuYWxseU1pbmlvbnMgICAgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9BTExZLCAgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgICAgc2VsZi5qdW5nbGVNaW5pb25zICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX0pVTkdMRSwgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgICAgc2VsZi5vdGhlck1pbmlvbnMgICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX09USEVSLCAgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgICAgICAgIHNlbGY6TG9hZE1lbnUoKQ0KICAgICAgICAgICAgTGFzdF9MZXZlbFNwZWxsID0gMA0KICAgICAgICAgICAgc2VsZjpmaW5kb3Jid2Fsa2VyKCkNCiAgICAgICAgICAgICAgICANCiAgICAgICAgQWRkVGlja0NhbGxiYWNrKGZ1bmN0aW9uKCkgc2VsZjpUaWNrKCkgZW5kKQ0KICAgIEFkZERyYXdDYWxsYmFjayhmdW5jdGlvbigpIHNlbGY6RHJhdygpIGVuZCkNCiAgICAtLUFkZE1zZ0NhbGxiYWNrKGZ1bmN0aW9uKG1zZyxLZXkpIHNlbGY6V25kTXNnKG1zZyxLZXkpIGVuZCkNCiAgICAtLUFkZEFuaW1hdGlvbkNhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIGFuaW1hdGlvbikgc2VsZjpBbmltYXRpb24odW5pdCwgYW5pbWF0aW9uKSBlbmQpDQogICAgLS1BZGRQcm9jZXNzU3BlbGxDYWxsYmFjayhmdW5jdGlvbih1bml0LCBzcGVsbCkgc2VsZjpQcm9jZXNzU3BlbGwodW5pdCwgc3BlbGwpIGVuZCkNCiAgICAtLUFkZEFwcGx5QnVmZkNhbGxiYWNrKGZ1bmN0aW9uKHNvdXJjZSwgdW5pdCwgYnVmZikgc2VsZjpPbkFwcGx5QnVmZihzb3VyY2UsIHVuaXQsIGJ1ZmYpIGVuZCkNCiAgICAtLUFkZFVwZGF0ZUJ1ZmZDYWxsYmFjayhmdW5jdGlvbih1bml0LCBidWZmLCBzdGFja3MpIHNlbGY6VXBkYXRlQnVmZih1bml0LCBidWZmLCBzdGFja3MpIGVuZCkNCiAgICAtLUFkZFJlbW92ZUJ1ZmZDYWxsYmFjayhmdW5jdGlvbih1bml0LCBidWZmKSBzZWxmOk9uUmVtb3ZlQnVmZih1bml0LCBidWZmKSBlbmQpIA0KICAgICAgZW5kDQogICAgICBmdW5jdGlvbiBMaXNzYW5kcmE6VGljaygpDQogICAgICAgc2VsZjphdXRvemhvbnlhKCkNCiAgICAgICBzZWxmOmVuZ2FnZXdpdGhyKCkNCiAgICAgICAgIGlmIFZJUF9VU0VSIHRoZW4gc2VsZjphdXRvbGV2ZWwoKSBlbmQNCiAgICAgICAgICBpZiBWSVBfVVNFUiB0aGVuIHNlbGY6c2tpbmhhY2soKSBlbmQNCiAgICAgICBzZWxmOmF1dG9SKCkNCiAgICAgICBzZWxmOmF1dG9xKCkNCiAgIGlmKHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgKXRoZW4NCiAgICAgIHNlbGY6Y29tYm8oKQ0KICAgIGVuZA0KICAgICAgICBpZihzZWxmLkNvbmZpZy5LZXlzLmp1bmdsZWNsZWFya2V5ICl0aGVuDQogICAgIHNlbGY6SnVuZ2xlQ2xlYXIoKQ0KICAgIGVuZA0KICAgICAgaWYoc2VsZi5Db25maWcuS2V5cy5sYW5lY2xlYXJrZXkgKXRoZW4NCiAgICAgIHNlbGY6TGFuZUNsZWFyKCkNCiAgICBlbmQNCiAgICAgaWYoc2VsZi5Db25maWcuS2V5cy5jb21ib2tleXIgKXRoZW4NCiAgICAgIHNlbGY6ZW5nYWdld2l0aHIoKQ0KICAgIGVuZA0KICAgICAgaWYoc2VsZi5Db25maWcuS2V5cy5lc2NhcGVrZXkpdGhlbg0KICAgICAgc2VsZjplc2NhcGUoKQ0KICAgIGVuZA0KICAgIGlmKHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyApIHRoZW4NCiAgICAgIHNlbGY6a2lsbHN0ZWFsKCkNCiAgICBlbmQNCiAgICBpZihzZWxmLkNvbmZpZy5LZXlzLmhhcmFzc2tleSBvciBzZWxmLkNvbmZpZy5LZXlzLmhhcmFzc3RvZ2xla2V5ICApIHRoZW4NCiAgICAgIHNlbGY6aGFyYXNzKCkNCiAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgZnVuY3Rpb24gTGlzc2FuZHJhOkxvYWRNZW51KCkNCiAgICAgIHNlbGYuQ29uZmlnPXNjcmlwdENvbmZpZygiIi4uU2NyaXB0bmFtZS4uIiBbIiAuLiBteUhlcm8uY2hhck5hbWUuLiJdIiAsIm1lbnUiKQ0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiQ29tYm8gU2V0dGluZ3MiLCAiY29tYm8iKQ0KICAgICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlUSIsICJVc2UgUSBpbiBDb21ibyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZVciLCAiVXNlIFcgaW4gQ29tYm8iLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VFIiwgIlVzZSBFIGluIGNvbWJvIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlUiIsICJVc2UgUiBpbiBjb21ibyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZUkiLCAiVXNlIElnbml0ZSBpZiB0YXJnZXQga2lsbGFibGUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJNYW5hIiwiTWFuYSBNYW5hZ2VyICUiLFNDUklQVF9QQVJBTV9TTElDRSwgMTAsIDEwLCAxMDAsIDApDQogIA0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiSGFyYXNzIFNldHRpbmdzIiwgImhhcmFzcyIpDQogICAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczphZGRQYXJhbSgidXNlUSIsICJIYXJhc3MgV2l0aCBRIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6YWRkUGFyYW0oInVzZVciLCAiSGFyYXNzIFdpdGggVyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuaGFyYXNzOmFkZFBhcmFtKCJ1c2VFIiwgIkhhcmFzcyBXaXRoIEUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIGZhbHNlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6YWRkUGFyYW0oImF1dG9xIiwgIkF1dG8gSGFyYXNzIHdpdGggUSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDMwLCAxMCwgMTAwLCAwKQ0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiU2tpbGwgTG9naWNzIiwgInNraWxsbG9naWMiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljOmFkZFN1Yk1lbnUoIkUgU2tpbGwgTG9naWMiLCAiRWxvZ2ljIikNCiAgICAgICAgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5FbG9naWM6YWRkUGFyYW0oImNvbWJvIiwgIkUgTG9naWMgZm9yIGNvbWJvIG1vZGUiLCBTQ1JJUFRfUEFSQU1fTElTVCwgMiwgeyJFbmdhZ2Ugd2l0aCBzZWNvbmQgRSIsICJEbyBub3QgdXNlIFNlY29uZCBFICggUmVjb21lbmRlZCkiIH0pDQogICAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuRWxvZ2ljOmFkZFBhcmFtKCJoYXJhc3MiLCAiRSBMb2dpYyBmb3IgSGFyYXNzIG1vZGUiLCBTQ1JJUFRfUEFSQU1fTElTVCwgMSwgeyJEbyBub3QgdXNlIFNlY29uZCBFICggUmVjb21lbmRlZCkiLCAiRW5nYWdlIHdpdGggc2Vjb25kIEUiIH0pDQogICAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuRWxvZ2ljOmFkZFBhcmFtKCJibGFuayIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5FbG9naWM6YWRkUGFyYW0oImluZm9FIiwgIkVuZ2FnZSB3aXRoIHNlY29uZCBFIG9wdGlvbiBpcyBzdGlsbCBvbiBCZXRhLi4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgc2VsZi5Db25maWcuc2tpbGxsb2dpYzphZGRTdWJNZW51KCJSIFNraWxsIExvZ2ljIiwgIlJsb2dpYyIpDQogICAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljOmFkZFBhcmFtKCJSbG9naWMiLCAiUiBMb2dpYyBmb3IgY29tYm8gbW9kZSIsIFNDUklQVF9QQVJBTV9MSVNULCAxLCB7IlNtYXJ0IiwgInNhdmUgZm9yIHlvdXJzZWxmIiwgIlVzZSBmb3IgZW5lbXkiIH0pDQogICAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljOmFkZFBhcmFtKCJlbmFibGVhdXRvUiIsICJBdXRvIFIgZm9yIHlvdXJzZWxmIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLlJsb2dpYzphZGRQYXJhbSgiYXV0b1IiLCAiQXV0b1IgaWYgSGVhbHRoIHVuZGVyIC0+ICUiLCBTQ1JJUFRfUEFSQU1fU0xJQ0UsIDEwLCAwLCAxMDAsIDApDQogICAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljOmFkZFBhcmFtKCJpbmZvUjIiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljOmFkZFBhcmFtKCJpbmZvUiIsICJGb3IgdXNpbmcgU21hcnQgUiBsb2dpYywgQXV0b1Igc2hvdWxkIGJlIG9wZW4uLiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljOmFkZFN1Yk1lbnUoIlcgU2tpbGwgTG9naWMiLCAiV2xvZ2ljIikgDQogICAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuV2xvZ2ljOmFkZFBhcmFtKCJ1c2VXIiwgIlVzZSBXIGZvciBBbnRpIEdhcENsb3NlIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCBmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5XbG9naWM6YWRkUGFyYW0oImluZm93MiIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5XbG9naWM6YWRkUGFyYW0oImluZm9XMyIsICJUaGlzIEZ1bmN0aW9uIGlzIG9uIGJldGEuLiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICANCiAgICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkVzY2FwZSBTZXR0aW5ncyIsImVzY2FwZSIpDQogICAgICAgIHNlbGYuQ29uZmlnLmVzY2FwZTphZGRQYXJhbSgidXNlRSIsIlVzZSBFIFdoaWxlIEVzY2FwZSIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmVzY2FwZTphZGRQYXJhbSgidXNlVyIsIlVzZSBXIFdoaWxlIEVzY2FwZSIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJGYXJtIFNldHRpbmdzIiwgImZhcm0iKQ0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWcuZmFybTphZGRTdWJNZW51KCJMYW5lQ2xlYXIgU2V0dGluZ3MiLCJsYW5lY2xlYXIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5mYXJtLmxhbmVjbGVhcjphZGRQYXJhbSgidXNlUSIsIlVzZSBRIG9uIExhbmVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmZhcm0ubGFuZWNsZWFyOmFkZFBhcmFtKCJ1c2VXIiwiVXNlIFcgb24gTGFuZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICAgIC0tc2VsZi5Db25maWcuZmFybS5sYW5lY2xlYXI6YWRkUGFyYW0oInVzZUUiLCJVc2UgRSBvbiBMYW5lY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5mYXJtLmxhbmVjbGVhcjphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDMwLCAxMCwgMTAwLCAwKQ0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWcuZmFybTphZGRTdWJNZW51KCJKdW5nbGVDbGVhciBTZXR0aW5ncyIsImp1bmdsZWNsZWFyIikNCiAgICAgICAgc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhcjphZGRQYXJhbSgidXNlUSIsIlVzZSBRIG9uIGp1bmdsZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhcjphZGRQYXJhbSgidXNlVyIsIlVzZSBXIG9uIGp1bmdsZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhcjphZGRQYXJhbSgidXNlRSIsIlVzZSBFIG9uIGp1bmdsZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhcjphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDMwLCAxMCwgMTAwLCAwKQ0KICAgICAgICANCiAgICAgICAgLS1zZWxmLkNvbmZpZy5mYXJtOmFkZFN1Yk1lbnUoIkxhc3RoaXQgU2V0dGluZ3MiLCJsYXN0aGl0IikNCiAgICAgICAgLS1zZWxmLkNvbmZpZy5mYXJtLmxhc3RoaXQ6YWRkUGFyYW0oInVzZVEiLCJVc2UgUSBvbiBMYXN0aGl0IixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgLS1zZWxmLkNvbmZpZy5mYXJtLmxhc3RoaXQ6YWRkUGFyYW0oInVzZVciLCJVc2UgVyBvbiBMYXN0aGl0IixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgLS1zZWxmLkNvbmZpZy5mYXJtLmxhc3RoaXQ6YWRkUGFyYW0oInVzZUUiLCJVc2UgRSBvbiBMYXN0aGl0IixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgLS1zZWxmLkNvbmZpZy5mYXJtLmxhc3RoaXQ6YWRkUGFyYW0oIk1hbmEiLCJNYW5hIE1hbmFnZXIgJSIsU0NSSVBUX1BBUkFNX1NMSUNFLCAzMCwgMTAsIDEwMCwgMCkNCiAgICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJLaWxsU3RlYWwgU2V0dGluZ3MiLCAia2lsbHN0ZWFsIikNCiAgICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJrcyIsIktpbGxzdGVhbCBPbi9PZmYiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZVEiLCAiU3RlYWwgV2l0aCBRIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZUUiLCAiU3RlYWwgV2l0aCBFIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZVIiLCAiU3RlYWwgV2l0aCBSIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZUkiLCAiU3RlYWwgV2l0aCBJZ25pdGUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJJdGVtIFNldHRpbmdzIiwgIml0ZW0iKQ0KICAgICAgICBzZWxmLkNvbmZpZy5pdGVtOmFkZFBhcmFtKCJlbmFibGVhdXRvemhvbnlhIiwgIkF1dG8gWmhvbnlhIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCBmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcuaXRlbTphZGRQYXJhbSgiYXV0b3pob255YSIsICJaaG9ueWEgaWYgSGVhbHRoIHVuZGVyIC0+ICUiLCBTQ1JJUFRfUEFSQU1fU0xJQ0UsIDEwLCAwLCAxMDAsIDApDQogICAgICAgIA0KICAgICAgICAgICAgICBpZiBWSVBfVVNFUiB0aGVuDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIlZJUCBTZXR0aW5ncyIsICJ2aXAiKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oInBhY2tldCIsIlVzZSBQYWNrZXQgQ2FzdGluZyIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm8xIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm8yIiwgIlRvIHVzZSB2aXAgc2V0dGluZ3MsIFBhY2tldCBDYXN0aW5nIHNob3VsZCBiZSBvcGVuLiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXA6YWRkU3ViTWVudSgiQXV0byBMZXZlbCBTZXR0aW5ncyIsICJsZXZlbCIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcC5sZXZlbDphZGRQYXJhbSgia2V5IiwiVXNlIEF1dG8gTGV2ZWwiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcudmlwLmxldmVsOmFkZFBhcmFtKCJsb2dpYyIsICJTZWxlY3QgU2tpbGwgT3JkZXIiLCBTQ1JJUFRfUEFSQU1fTElTVCwgNywgeyJGb2N1cyBRPlc+RSIsICJGb2N1cyBRPkU+VyIsIkZvY3VzIFc+UT5FIiwiRm9jdXMgVz5FPlEiLCJGb2N1cyBFPlc+USIsICJGb2N1cyBFPlE+VyIgLCAiU21hcnQiICB9KQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXA6YWRkU3ViTWVudSgiU2tpbiBIYWNrIFNldHRpbmdzIiwgInNraW4iKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXAuc2tpbjphZGRQYXJhbSgia2V5IiwiVXNlIFNraW4gSGFjayIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXAuc2tpbjphZGRQYXJhbSgnc2VsZWN0ZWQnIC4uIG15SGVyby5jaGFyTmFtZSAuLiAnU2tpbicsICJTZWxlY3QgU2tpbiIsIFNDUklQVF9QQVJBTV9MSVNULCAxLCBza2luTWV0YVtteUhlcm8uY2hhck5hbWVdKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXAuc2tpbjphZGRQYXJhbSgiaW5mbzUiLCAiTWFrZSBzdXJlIHRoYXQgdXNpbmcgcGFja2V0IGNhc3RpbmcgaXMgT04uIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIC0tc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvNSIsICJTa2luIEhhY2sgdGVtcG9yYXJ5IGRpc2FibGVkIHVudGlsIG5leHQgdXBkYXRlLiAuIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIC0tW1tzZWxmLkNvbmZpZy52aXA6YWRkU3ViTWVudSgiQW50aS1BRksgU2V0dGluZ3MiLCAiYW50aWFmayIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcC5hbnRpYWZrOmFkZFBhcmFtKCJhbnRpYWZrIiwiVXNlIEFudGkgQWZrIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpIF1dDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzMiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzQiLCAiVG8gdXNlIHZpcCBzZXR0aW5ncywgWW91IG5lZWQgdG8gYmUgYSBWSVAgdXNlciBvbiBCT0wgY29tbXVuaXR5LiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIGVuZA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJEcmF3IFNldHRpbmdzIiwib3RoZXIiKQ0KICAgICAgICAtLXNlbGYuQ29uZmlnLm90aGVyOmFkZFN1Yk1lbnUoIlNob3cgRGFtYWdlIE9uIEhwIEJhciIsICJIUEJBUiIpDQogICAgICAgIC0tc2VsZi5Db25maWcub3RoZXIuSFBCQVI6YWRkUGFyYW0oImtleSIsIk9OL09GRiIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLm90aGVyOmFkZFN1Yk1lbnUoIlNraWxsIERyYXdpbmcgU2V0dGluZ3MiLCAiZHJhdyIpDQogICAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oInFkcmF3IiwiUSBTa2lsbCBEcmF3aW5ncyIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oIndkcmF3IiwiVyBTa2lsbCBEcmF3aW5ncyIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oImVkcmF3IiwiRSBTa2lsbCBEcmF3aW5ncyIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oInJkcmF3IiwiUiBTa2lsbCBEcmF3aW5ncyIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oImFhZHJhdyIsIkF1dG8gQXR0YWNrIFJhbmdlIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogIA0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiVGFyZ2V0c2VsZWN0b3JzIiwidGFyZ2V0c2VsIikNCiAgICAgIHNlbGYudHMubmFtZSAgPSAiTGlzc2FuZHJhIEdlbmVyYWwiDQogICAgICBzZWxmLnRzcS5uYW1lID0gIkxpc3NhbmRyYSBRIFNraWxsIg0KICAgICAgc2VsZi50c3cubmFtZSA9ICJMaXNzYW5kcmEgVyBTa2lsbCINCiAgICAgIHNlbGYudHNlLm5hbWUgPSAiTGlzc2FuZHJhIEUgU2tpbGwiDQogICAgICBzZWxmLnRzci5uYW1lID0gIkxpc3NhbmRyYSBSIFNraWxsIg0KICAgICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFRTKHNlbGYudHMpDQogICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkVFMoc2VsZi50c3EpDQogICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkVFMoc2VsZi50c3cpDQogICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkVFMoc2VsZi50c2UpDQogICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkVFMoc2VsZi50c3IpIA0KICAgICAgDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJLZXlzIFNldHRpbmdzIiwgIktleXMiKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0szIiwgIjwtLS0tLS0tLS0tLS0tLS0tLS1Db21ibyBLZXkgU2V0dGluZ3MtLS0tLS0tLS0tLS0tLS0tLS0+IiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJjb21ib2tleSIsICJDb21ibyBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgMzIpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJjb21ib2tleXIiLCAiU3RhcnQgRW5nYWdlIFdpdGggWW91ciBVbHRpICIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiVSIpKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0s0IiwgIjwtLS0tLS0tLS0tLS0tLS0tLS1IYXJhc3MgS2V5IFNldHRpbmdzLS0tLS0tLS0tLS0tLS0tLS0tPiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaGFyYXNza2V5IiwgIlNtYXJ0IEhhcmFzcyBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIkMiKSkNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImhhcmFzc3RvZ2xla2V5IiwgIkhhcmFzcyBUb2dsZSBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlUT0dHTEUsIGZhbHNlLCBzdHJpbmcuYnl0ZSgiVCIpKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0s1IiwgIjwtLS0tLS0tLS0tLS0tLS0tLS1DbGVhciBLZXkgU2V0dGluZ3MtLS0tLS0tLS0tLS0tLS0tLS0tLT4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImxhbmVjbGVhcmtleSIsICJMYW5lQ2xlYXIgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJWIikpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJqdW5nbGVjbGVhcmtleSIsICJKdW5nbGVDbGVhciBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIloiKSkNCiAgICAgIC0tc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgibGFzdGhpdGtleSIsICJMYXN0aGl0IEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiWCIpKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0s2IiwgIjwtLS0tLS0tLS0tLS0tLS0tLS1PdGhlciBLZXkgU2V0dGluZ3MtLS0tLS0tLS0tLS0tLS0tLS0tLT4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImVzY2FwZWtleSIsICJFc2NhcGUgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJZIikpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJpbmZvSyIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LMiIsICJNYWtlIFN1cmUgVGhhdCBZb3VyIE9yYndhbGtlciBLZXlzIGFyZSBTYW1lIEFzIEhlcmUiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIA0KICAgICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIk9yYndhbGtlciBLZXkgU2V0dGluZ3MiLCAiS2V5czIiKQ0KICAgICAgT3Jid2Fsa01hbmFnZXI6TG9hZENvbW1vbktleXMoc2VsZi5Db25maWcuS2V5czIpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzMjphZGRQYXJhbSgiaW5mb0s0IiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czI6YWRkUGFyYW0oImluZm9LMjIiLCAiTWFrZSBTdXJlIFRoYXQgWW91ciBTY3JpcHQgS2V5cyBhcmUgU2FtZSBBcyBIZXJlIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm8zIiwgIl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveCIsICIgICAgICAgICAgICAgICAiLi5TY3JpcHRuYW1lLi4iIiwgU0NSSVBUX1BBUkFNX0lORk8sICIiKSANCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDIiLCAiICAgICAgICAgICAgICAgICBTY3JpcHQgVmVyc2lvbjogICIuLlZlcnNpb24uLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3g2IiwgIiAgICAgICAgICAgIFNjcmlwdCB3YXMgbWFkZSBieSAgIi4uQXV0aG9yLi4gIiAgICAgICAgICIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94NSIsICIgICAgICAgTGVhdWdlIE9mIExlZ2VuZHMgVmVyc2lvbjogICIuLkxWZXJzaW9uLi4gIiAgICAgICAgICIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIA0KICAgICAgIHNlbGYuQ29uZmlnOnBlcm1hU2hvdygiaW5mb2JveCIpDQogICAgICAgc2VsZi5Db25maWcuS2V5czpwZXJtYVNob3coImNvbWJva2V5IikNCiAgICAgICBzZWxmLkNvbmZpZy5LZXlzOnBlcm1hU2hvdygiaGFyYXNzdG9nbGVrZXkiKQ0KICAgICAgIHNlbGYuQ29uZmlnLktleXM6cGVybWFTaG93KCJoYXJhc3NrZXkiKQ0KICAgIA0KICANCiAgZW5kDQpmdW5jdGlvbiBMaXNzYW5kcmE6c2tpbmhhY2soKQ0KICBpZiBub3QgRmFrZUxvYWQgdGhlbg0KICBpZiAoKEN1cnJlbnRUaW1lSW5NaWxsaXMoKSAtIGxhc3RUaW1lVGlja0NhbGxlZCkgPiAyMDApIHRoZW4NCiAgICAgIGxhc3RUaW1lVGlja0NhbGxlZCA9IEN1cnJlbnRUaW1lSW5NaWxsaXMoKQ0KICAgIGlmIHNlbGYuQ29uZmlnLnZpcC5za2luLmtleSBhbmQgc2VsZi5Db25maWcudmlwLnBhY2tldCAgdGhlbg0KICAgIGlmIHNlbGYuQ29uZmlnLnZpcC5za2luWydzZWxlY3RlZCcgLi4gbXlIZXJvLmNoYXJOYW1lIC4uICdTa2luJ10gfj0gbGFzdFNraW4gdGhlbg0KICAgICAgICBsYXN0U2tpbiA9IHNlbGYuQ29uZmlnLnZpcC5za2luWydzZWxlY3RlZCcgLi4gbXlIZXJvLmNoYXJOYW1lIC4uICdTa2luJ10NCiAgU2VuZFNraW5QYWNrZXQobXlIZXJvLmNoYXJOYW1lLCBza2luc1BCW3NlbGYuQ29uZmlnLnZpcC5za2luWydzZWxlY3RlZCcgLi4gbXlIZXJvLmNoYXJOYW1lIC4uICdTa2luJ11dLCBteUhlcm8ubmV0d29ya0lEKTsNCiAgZW5kDQogIGVuZA0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMaXNzYW5kcmE6YXV0b2xldmVsKCkNCmlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gMSBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTEgPSAgIHsgMSwyLDMsMSwxLDQsMSwyLDEsMiw0LDIsMiwzLDMsNCwzLDN9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTEpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSAyIGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlMiA9ICAgeyAxLDIsMywxLDEsNCwxLDMsMSwzLDQsMywzLDIsMiw0LDIsMn0NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlMikNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDMgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2UzID0gIHsgMiwzLDEsMiwyLDQsMiwxLDIsMSw0LDEsMSwzLDMsNCwzLDN9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTMpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSA0IGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlNCA9ICB7IDIsMywxLDIsMiw0LDIsMywyLDMsNCwzLDMsMSwxLDQsMSwxfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2U0KQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gNSBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTUgPSAgeyAzLDEsMiwzLDMsNCwzLDIsMywyLDQsMiwyLDEsMSw0LDEsMX0NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlNSkNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDYgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2U2ID0gIHsgMywxLDIsMywzLDQsMywxLDMsMSw0LDEsMSwyLDIsNCwyLDJ9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTYpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDcgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2U2ID0gIHsgMSwzLDIsMSwxLDQsMSwyLDEsMiw0LDIsMiwzLDMsNCwzLDN9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTYpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExpc3NhbmRyYTphdXRvemhvbnlhKCkNCiAgICBpZiBzZWxmLkNvbmZpZy5pdGVtLmVuYWJsZWF1dG96aG9ueWEgdGhlbg0KICAgICBmb3IgXyA9IElURU1fMSwgSVRFTV83IGRvDQogICAgICBpZiBteUhlcm8uaGVhbHRoIDw9IChteUhlcm8ubWF4SGVhbHRoICogc2VsZi5Db25maWcuaXRlbS5hdXRvemhvbnlhIC8gMTAwKSBhbmQgKCBteUhlcm86Q2FuVXNlU3BlbGwoXykgPT0gMCBhbmQgbXlIZXJvOkdldFNwZWxsRGF0YShfKS5uYW1lID09ICJaaG9ueWFzSG91cmdsYXNzIiApdGhlbiBDYXN0U3BlbGwoXykNCiAgICBlbmQNCiAgICBlbmQNCiAgICBlbmQNCiAgICBlbmQNCiAgDQogIGZ1bmN0aW9uIExpc3NhbmRyYTphdXRvUigpDQogICAgaWYgKCBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLlJsb2dpYy5lbmFibGVhdXRvUiBhbmQgKHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljLlJsb2dpYyA9PSAyIG9yIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljLlJsb2dpYyA9PSAxKSkgdGhlbg0KICAgICAgaWYgbXlIZXJvLmhlYWx0aCA8PSAobXlIZXJvLm1heEhlYWx0aCAqIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljLmF1dG9SIC8gMTAwKSB0aGVuIHNlbGY6Q2FzdFJTKG15SGVybykNCiAgICAgIGVuZA0KICAgIGVuZA0KICAgIGVuZA0KICANCiAgZnVuY3Rpb24gTGlzc2FuZHJhOmVuZ2FnZXdpdGhyKCkNCiAgIHNlbGYudHNxOnVwZGF0ZSgpDQogICBpZiBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ciB0aGVuDQogICBzZWxmOndhbGsoKQ0KICAgZW5kDQogICAgICBpZihzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwIClhbmQgc2VsZi50c3EudGFyZ2V0fj1uaWwgIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VRIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ciAgKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RRKHNlbGYudHNxLnRhcmdldCkNCiAgICAgIGVuZA0KICAgICAgc2VsZi50c2U6dXBkYXRlKCkNCiAgICAgIGlmKHNlbGYuRVNwZWxsOklzUmVhZHkoKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKWFuZCBzZWxmLnRzZS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlRSBhbmQgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleXIgKXRoZW4NCiAgICAgICAgICAgICAgICBsb2NhbCBUaWNrZXIgPSBHZXRUaWNrQ291bnQoKQ0KICBpZiAoZ2xvYmFsX3RpY2tzICsgMjAwMCkgPCBUaWNrZXIgdGhlbg0KICBpZiAobXlIZXJvOkNhblVzZVNwZWxsKF9FKSA9PSBSRUFEWSApIHRoZW4NCiAgICAgQ2FzdFNwZWxsKF9FLCBzZWxmLnRzZS50YXJnZXQueCwgc2VsZi50c2UudGFyZ2V0LnopDQogICAgIGdsb2JhbF90aWNrcyA9IFRpY2tlcg0KICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgQ2FzdFNwZWxsKF9FKSBlbmQsIDEuNSkNCiAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIHNlbGYudHN3OnVwZGF0ZSgpDQogICAgICBpZihzZWxmLldTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwICkgYW5kIHNlbGYudHN3LnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VXIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleXIgICl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0VyhzZWxmLnRzdy50YXJnZXQpDQogICAgICBlbmQNCiAgICAgIHNlbGYudHNyOnVwZGF0ZSgpDQogICAgICBpZihzZWxmLlJTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwICkgYW5kIHNlbGYudHNyLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VSIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleXIgKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RSKHNlbGYudHNyLnRhcmdldCkNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMaXNzYW5kcmE6RHJhdygpDQogICAgICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LnFkcmF3IGFuZCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkgdGhlbg0KICAgICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDcyNSwgMSxyZWQpDQogICAgZW5kDQogIA0KICAgIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcud2RyYXcgYW5kIHNlbGYuV1NwZWxsOklzUmVhZHkoKSB0aGVuDQogICAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgMTA1MCwgMSwgcmVkKQ0KICAgIGVuZA0KICANCiAgICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LmVkcmF3IGFuZCBzZWxmLkVTcGVsbDpJc1JlYWR5KCkgdGhlbg0KICAgICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDQyMCwgMSwgcmVkKQ0KICAgIGVuZA0KICAgIA0KICAgIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcucmRyYXcgYW5kIHNlbGYuUlNwZWxsOklzUmVhZHkoKSB0aGVuDQogICAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgNTAwLDEsIHJlZCkNCiAgICBlbmQNCiAgICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LmFhZHJhdyB0aGVuDQogICAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgNTUwLDEsIEFSR0IoMjU1LCAyNTUsMCwwKSkNCiAgICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExpc3NhbmRyYTphbnRpZ2FwdygpDQogICAgICBpZihzZWxmLldTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwIClhbmQgc2VsZi50c3cudGFyZ2V0fj1uaWwgIGFuZCBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLldsb2dpYy51c2VXICApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFcoc2VsZi50c3cudGFyZ2V0KQ0KICAgICAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMaXNzYW5kcmE6Y29tYm8oKQ0KICAgICAgICBzZWxmLnRzcTp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi5RU3BlbGw6SXNSZWFkeSgpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmNvbWJvLk1hbmEgLzEwMCApYW5kIHNlbGYudHNxLnRhcmdldH49bmlsICBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUSBhbmQgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RRKHNlbGYudHNxLnRhcmdldCkNCiAgICAgIGVuZA0KICAgICAgc2VsZi50c2U6dXBkYXRlKCkNCiAgICAgIGlmKHNlbGYuQ29uZmlnLnNraWxsbG9naWMuRWxvZ2ljLmNvbWJvID09IDEgYW5kICAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmNvbWJvLk1hbmEgLzEwMCApYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZUUgYW5kIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICl0aGVuDQogICAgICBsb2NhbCBUaWNrZXIgPSBHZXRUaWNrQ291bnQoKQ0KICBpZiAoZ2xvYmFsX3RpY2tzICsgMjAwMCkgPCBUaWNrZXIgdGhlbg0KICBpZiAobXlIZXJvOkNhblVzZVNwZWxsKF9FKSA9PSBSRUFEWSBhbmQgc2VsZi50c2UudGFyZ2V0fj1uaWwpIHRoZW4NCiAgICAgQ2FzdFNwZWxsKF9FLCBzZWxmLnRzZS50YXJnZXQueCwgc2VsZi50c2UudGFyZ2V0LnopDQogICAgIGdsb2JhbF90aWNrcyA9IFRpY2tlcg0KICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgQ2FzdFNwZWxsKF9FKSBlbmQsIDEuNSkNCiAgICAgICAgICBlbmQNCiAgICAgICAgICBlbmQNCiAgICAgICAgICBlbmQNCiAgICAgICAgIGlmKHNlbGYuQ29uZmlnLnNraWxsbG9naWMuRWxvZ2ljLmNvbWJvID09IDIgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwICkgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZUUgYW5kIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICl0aGVuDQogICAgICAgICBsb2NhbCBUaWNrZXIgPSBHZXRUaWNrQ291bnQoKQ0KICBpZiAoZ2xvYmFsX3RpY2tzICsgMjAwMCkgPCBUaWNrZXIgdGhlbg0KICBpZiAobXlIZXJvOkNhblVzZVNwZWxsKF9FKSA9PSBSRUFEWSBhbmQgc2VsZi50c2UudGFyZ2V0fj1uaWwpIHRoZW4NCiAgICAgQ2FzdFNwZWxsKF9FLCBzZWxmLnRzZS50YXJnZXQueCwgc2VsZi50c2UudGFyZ2V0LnopDQogICAgIGdsb2JhbF90aWNrcyA9IFRpY2tlcg0KICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgQ2FzdFNwZWxsKF9FKSBlbmQsIDIpDQogICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi5XU3BlbGw6SXNSZWFkeSgpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmNvbWJvLk1hbmEgLzEwMCApIGFuZCBzZWxmLnRzdy50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlVyBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFcoc2VsZi50c3cudGFyZ2V0KQ0KICAgICAgZW5kDQogICAgICBpZihzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLlJsb2dpYy5SbG9naWMgPT0gMyBvciBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLlJsb2dpYy5SbG9naWMgPT0gMSBhbmQgc2VsZi5SU3BlbGw6SXNSZWFkeSgpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmNvbWJvLk1hbmEgLzEwMCApIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VSIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICApdGhlbg0KICAgICAgZm9yIF8sIHVuaXQgaW4gcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8NCiAgICAgICAgbG9jYWwgZG1nUiA9Z2V0RG1nKCJSIix1bml0LG15SGVybykrICgobXlIZXJvLmFwKSowLjcwKSANCiAgICAgICAgbG9jYWwgaGVhbHRoPXVuaXQuaGVhbHRoDQogICAgICAgIGlmKGhlYWx0aDxkbWdSIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VSIGFuZCBHZXREaXN0YW5jZSh1bml0KTw1NTApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFIodW5pdCkNCiAgICAgIGVsc2VpZiAoc2VsZi5Db25maWcuc2tpbGxsb2dpYy5SbG9naWMuUmxvZ2ljID09IDIgYW5kICBteUhlcm8uaGVhbHRoIDw9IChteUhlcm8ubWF4SGVhbHRoICogc2VsZi5Db25maWcuc2tpbGxsb2dpYy5SbG9naWMuYXV0b1IgLyAxMDApKSB0aGVuIA0KICAgICAgIHNlbGY6Q2FzdFJTKG15SGVybykNCiAgICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICANCiAgICAgIGlmKHNlbGYuQ29uZmlnLmNvbWJvLnVzZUkgYW5kIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICl0aGVuDQogICAgICBmb3IgXywgdW5pdCBpbiBwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbw0KICAgICAgICBsb2NhbCBkbWdJID0oNTArICgobXlIZXJvLmxldmVsKSoyMCkpDQogICAgICAgIGxvY2FsIGhlYWx0aD11bml0LmhlYWx0aA0KICAgICAgICBpZihoZWFsdGg8ZG1nSSBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlSSBhbmQgR2V0RGlzdGFuY2UodW5pdCk8NjAwKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RJKHVuaXQpDQogICAgICBlbmQNCiAgICAgIGVuZA0KICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExpc3NhbmRyYTpDYXN0USh1bml0KQ0KICAgIHNlbGYuUVNwZWxsOkNhc3QodW5pdCkNCiAgZW5kDQogIA0KICBmdW5jdGlvbiBMaXNzYW5kcmE6Q2FzdFcodW5pdCkNCiAgICBzZWxmLldTcGVsbDpDYXN0KHVuaXQpDQogIGVuZA0KICANCiAgZnVuY3Rpb24gTGlzc2FuZHJhOkNhc3RFKHVuaXQpDQogICAgc2VsZi5FU3BlbGw6Q2FzdCh1bml0KQ0KICBlbmQNCiAgDQogIGZ1bmN0aW9uIExpc3NhbmRyYTpDYXN0Uih1bml0KQ0KICAgIHNlbGYuUlNwZWxsOkNhc3QodW5pdCkNCiAgZW5kDQogIGZ1bmN0aW9uIExpc3NhbmRyYTpDYXN0UlModW5pdCkNCiAgIENhc3RTcGVsbChfUiAsIG15SGVybykNCiAgZW5kDQogIA0KICBmdW5jdGlvbiBMaXNzYW5kcmE6Q2FzdEkodW5pdCkNCiAgICBzZWxmLklnbml0ZTpDYXN0KHVuaXQpDQogIGVuZA0KICBmdW5jdGlvbiBMaXNzYW5kcmE6a2lsbHN0ZWFsKCkNCiAgZm9yIF8sIHVuaXQgaW4gcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8NCiAgICAgIGxvY2FsIGhlYWx0aCA9IHVuaXQuaGVhbHRoDQogICAgICBsb2NhbCBkbWdFID0gZ2V0RG1nKCJFIiwgdW5pdCwgbXlIZXJvKSArICgobXlIZXJvLmFwKSowLjYpIA0KICAgICAgICBpZihzZWxmLnRzZS50YXJnZXQgfj0gbmlsIGFuZCAgc2VsZi5FU3BlbGw6SXNSZWFkeSgpIGFuZCBoZWFsdGg8ZG1nRSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZUUgICBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RFKHVuaXQpICANCiAgICAgICAgZW5kDQogICAgICAgIGxvY2FsIGRtZ1EgPSBnZXREbWcoIlEiLCB1bml0LCBteUhlcm8pICsgKChteUhlcm8uYXApKjAuNjUpDQogICAgICAgIGlmKHNlbGYudHNxLnRhcmdldCB+PSBuaWwgYW5kICBzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIGhlYWx0aDxkbWdRIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlUSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzICl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0USh1bml0KSAgDQogICAgICAgIGVuZA0KICAgICAgICBsb2NhbCBkbWdXID0gZ2V0RG1nKCJXIiwgdW5pdCwgbXlIZXJvKSArICgobXlIZXJvLmFwKSowLjQwKQ0KICAgICAgICBpZihzZWxmLnRzdy50YXJnZXQgfj0gbmlsIGFuZCAgc2VsZi5XU3BlbGw6SXNSZWFkeSgpIGFuZCBoZWFsdGg8ZG1nUSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZVcgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFcodW5pdCkgIA0KICAgICAgICBlbmQNCiAgICAgICAgIGxvY2FsIGRtZ0kgPSg1MCsgKChteUhlcm8ubGV2ZWwpKjIwKSkNCiAgICAgICAgaWYoaGVhbHRoPGRtZ0kgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VJIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgYW5kIEdldERpc3RhbmNlKHVuaXQpPDYwMCl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0SSh1bml0KQ0KICAgICAgICBlbmQNCiAgICAgICAgbG9jYWwgZG1nUiA9Z2V0RG1nKCJSIix1bml0LG15SGVybykrKChteUhlcm8uYXApKjAuNzApIA0KICAgICAgICBpZihzZWxmLnRzci50YXJnZXQgfj0gbmlsIGFuZCAgc2VsZi5SU3BlbGw6SXNSZWFkeSgpIGFuZCBoZWFsdGg8ZG1nUiBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZVIgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyBhbmQgR2V0RGlzdGFuY2UodW5pdCk8NTUwKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RSKHVuaXQpDQogICAgICAgIGVuZA0KICAgICBlbmQNCiAgZW5kDQogIA0KICBmdW5jdGlvbiBMaXNzYW5kcmE6ZXNjYXBlKCkNCiAgbG9jYWwgVGlja2VyID0gR2V0VGlja0NvdW50KCkNCiAgaWYgKGdsb2JhbF90aWNrcyArIDIwMDApIDwgVGlja2VyIHRoZW4NCiAgaWYgc2VsZi5Db25maWcuS2V5cy5lc2NhcGVrZXkgYW5kIHNlbGYuQ29uZmlnLmVzY2FwZS51c2VFICB0aGVuDQogIGlmIChteUhlcm86Q2FuVXNlU3BlbGwoX0UpID09IFJFQURZICkgdGhlbg0KICAgICBDYXN0U3BlbGwoX0UsbW91c2VQb3MueCxtb3VzZVBvcy56KQ0KICAgICBnbG9iYWxfdGlja3MgPSBUaWNrZXINCiAgICAgICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIENhc3RTcGVsbChfRSkgZW5kLCAxLjUpDQogIGVuZA0KICBlbmQNCiAgZW5kDQogIGlmIHNlbGYuQ29uZmlnLktleXMuZXNjYXBla2V5IHRoZW4gDQogIHNlbGY6d2FsaygpDQogIGVuZA0KICBpZiBzZWxmLkNvbmZpZy5LZXlzLmVzY2FwZWtleSBhbmQgc2VsZi5Db25maWcuZXNjYXBlLnVzZVcgYW5kIHNlbGYudHN3LnRhcmdldH49bmlsIHRoZW4NCiAgQ2FzdFNwZWxsKF9XLHRzdy50YXJnZXQpDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGlzc2FuZHJhOndhbGsoKQ0KICAgIG15SGVybzpNb3ZlVG8obW91c2VQb3MueCxtb3VzZVBvcy56KQ0KICBlbmQNCiAgZnVuY3Rpb24gTGlzc2FuZHJhOmhhcmFzcygpDQogICAgc2VsZi50czp1cGRhdGUoKQ0KICAgIHNlbGYudHNxOnVwZGF0ZSgpDQogICAgIHNlbGYudHN3OnVwZGF0ZSgpDQogICAgICBzZWxmLnRzZTp1cGRhdGUoKQ0KICAgIGlmIHNlbGYuQ29uZmlnLktleXMuaGFyYXNza2V5IG9yIHNlbGYuQ29uZmlnLktleXMuaGFyYXNzdG9nbGVrZXkgdGhlbg0KICAgICAgICBpZihzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuaGFyYXNzLk1hbmEgLzEwMCApIGFuZCBzZWxmLnRzcS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuaGFyYXNzLnVzZVEgKSB0aGVuICAgICAgICANCiAgICAgICAgICBzZWxmOkNhc3RRKHNlbGYudHNxLnRhcmdldCkNCiAgICAgICAgZW5kICAgDQogICAgICAgIGVuZA0KICAgIGlmIHNlbGYuQ29uZmlnLktleXMuaGFyYXNza2V5IG9yIHNlbGYuQ29uZmlnLktleXMuaGFyYXNzdG9nbGVrZXkgdGhlbg0KICAgICAgICBpZihzZWxmLldTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuaGFyYXNzLk1hbmEgLzEwMCApIGFuZCBzZWxmLnRzdy50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuaGFyYXNzLnVzZVcgKSB0aGVuICAgICAgICANCiAgICAgICAgICBzZWxmOkNhc3RXKHNlbGYudHN3LnRhcmdldCkNCiAgICAgICAgZW5kICANCiAgICAgICAgZW5kIA0KICAgICAgICAgIGlmIHNlbGYuQ29uZmlnLktleXMuaGFyYXNza2V5IG9yIHNlbGYuQ29uZmlnLktleXMuaGFyYXNzdG9nbGVrZXkgIHRoZW4NCiAgICAgICAgaWYoc2VsZi5Db25maWcuc2tpbGxsb2dpYy5FbG9naWMuaGFyYXNzID09IDEgIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmhhcmFzcy5NYW5hIC8xMDAgKSAgYW5kIHNlbGYuQ29uZmlnLmhhcmFzcy51c2VFICkgdGhlbiAgICAgICAgDQogICAgICAgICBsb2NhbCBUaWNrZXIgPSBHZXRUaWNrQ291bnQoKQ0KICBpZiAoZ2xvYmFsX3RpY2tzICsgMjAwMCkgPCBUaWNrZXIgdGhlbg0KICBpZiAobXlIZXJvOkNhblVzZVNwZWxsKF9FKSA9PSBSRUFEWSBhbmQgc2VsZi50c2UudGFyZ2V0fj1uaWwpIHRoZW4NCiAgICAgQ2FzdFNwZWxsKF9FLCBzZWxmLnRzZS50YXJnZXQueCwgc2VsZi50c2UudGFyZ2V0LnopDQogICAgIGdsb2JhbF90aWNrcyA9IFRpY2tlcg0KICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgQ2FzdFNwZWxsKF9FKSBlbmQsIDIpDQogICAgICAgICAgZW5kDQogICAgICAgICAgZW5kDQogICAgICAgICAgZW5kDQogICAgICAgICAgZW5kDQogICAgICAgICAgIGlmIHNlbGYuQ29uZmlnLktleXMuaGFyYXNza2V5IG9yIHNlbGYuQ29uZmlnLktleXMuaGFyYXNzdG9nbGVrZXkgIHRoZW4NCiAgICAgICAgICAgICAgIGlmKHNlbGYuQ29uZmlnLnNraWxsbG9naWMuRWxvZ2ljLmhhcmFzcyA9PSAyIGFuZCAgIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuaGFyYXNzLk1hbmEgLzEwMCApICBhbmQgc2VsZi5Db25maWcuaGFyYXNzLnVzZUUgKSB0aGVuICAgICAgICANCiAgICAgICAgIGxvY2FsIFRpY2tlciA9IEdldFRpY2tDb3VudCgpDQogIGlmIChnbG9iYWxfdGlja3MgKyAyMDAwKSA8IFRpY2tlciB0aGVuDQogIGlmIChteUhlcm86Q2FuVXNlU3BlbGwoX0UpID09IFJFQURZIGFuZCBzZWxmLnRzZS50YXJnZXR+PW5pbCkgdGhlbg0KICAgICBDYXN0U3BlbGwoX0UsIHNlbGYudHNlLnRhcmdldC54LCBzZWxmLnRzZS50YXJnZXQueikNCiAgICAgZ2xvYmFsX3RpY2tzID0gVGlja2VyDQogICAgICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBDYXN0U3BlbGwoX0UpIGVuZCwgMS41KQ0KICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBlbmQNCiAgZnVuY3Rpb24gTGlzc2FuZHJhOkxhbmVDbGVhcigpDQogICBsb2NhbCBjbGVhcnRhcmdldCA9IG5pbA0KICBzZWxmLmVuZW15TWluaW9uczp1cGRhdGUoKQ0KICAgc2VsZi5vdGhlck1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIHNlbGYuanVuZ2xlTWluaW9uczp1cGRhdGUoKQ0KICAgICAgZm9yIGksIG1pbmlvbiBpbiBpcGFpcnMoc2VsZi5lbmVteU1pbmlvbnMub2JqZWN0cykgZG8NCiAgICAgICAgaWYgVmFsaWRUYXJnZXQobWluaW9uLCA2MDApIGFuZCAoY2xlYXJ0YXJnZXQgPT0gbmlsIG9yIG5vdCBWYWxpZFRhcmdldChjbGVhcnRhcmdldCkpIHRoZW4NCiAgICAgICAgICBjbGVhcnRhcmdldCA9IG1pbmlvbg0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgZm9yIGksIG1pbmlvbiBpbiBwYWlycyhzZWxmLmVuZW15TWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgICBpZiBWYWxpZFRhcmdldChtaW5pb24pIGFuZCBtaW5pb24gfj0gbmlsIHRoZW4NCiAgICAgICAgICBpZiBzZWxmLkNvbmZpZy5LZXlzLmxhbmVjbGVhcmtleSAgYW5kIHNlbGYuQ29uZmlnLmZhcm0ubGFuZWNsZWFyLnVzZVEgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuZmFybS5sYW5lY2xlYXIuTWFuYSAvMTAwICkgYW5kIEdldERpc3RhbmNlKG1pbmlvbikgPD0gc2VsZi5RU3BlbGwuUmFuZ2UgdGhlbiANCiAgICAgICAgIGxvY2FsIEJlc3RQb3MsIEJlc3RIaXQgPSBHZXRCZXN0TGluZUZhcm1Qb3NpdGlvbihzZWxmLlFTcGVsbC5SYW5nZSwgc2VsZi5RU3BlbGwuV2lkdGgsIHNlbGYuZW5lbXlNaW5pb25zLm9iamVjdHMgKQ0KICAgICAgICBpZiBCZXN0UG9zICBhbmQgQmVzdEhpdCA+IDAgdGhlbg0KICAgICAgICAgQ2FzdFNwZWxsKF9RLCBCZXN0UG9zLngsIEJlc3RQb3MueikNCiAgICAgICAgICBlbmQNCiAgICAgICAgaWYgY2xlYXJ0YXJnZXQgfj0gbmlsIHRoZW4NCiAgICAgICAgaWYoc2VsZi5XU3BlbGw6SXNSZWFkeSgpIGFuZCBzZWxmLkNvbmZpZy5mYXJtLmxhbmVjbGVhci51c2VXIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmxhbmVjbGVhcmtleSApIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmZhcm0ubGFuZWNsZWFyLk1hbmEgLzEwMCApIHRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RXKGNsZWFydGFyZ2V0KQ0KICAgICAgICBlbmQNCiAgICAgICAgZW5kDQogICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgICAgICAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMaXNzYW5kcmE6YXV0b3EoKQ0KICANCiAgICAgICAgaWYoc2VsZi5RU3BlbGw6SXNSZWFkeSgpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmhhcmFzcy5NYW5hIC8xMDAgKSBhbmQgc2VsZi50c3EudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmhhcmFzcy5hdXRvcSApIHRoZW4gICAgICAgIA0KICAgICAgICAgIHNlbGY6Q2FzdFEoc2VsZi50c3EudGFyZ2V0KQ0KICAgICAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMaXNzYW5kcmE6SnVuZ2xlQ2xlYXIoKQ0KICBsb2NhbCBjbGVhcnRhcmdldCA9IG5pbA0KICAgICAgc2VsZi5lbmVteU1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIHNlbGYub3RoZXJNaW5pb25zOnVwZGF0ZSgpDQogICAgICBzZWxmLmp1bmdsZU1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIGZvciBpLCBtaW5pb24gaW4gaXBhaXJzKHNlbGYuZW5lbXlNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICAgIGlmIFZhbGlkVGFyZ2V0KG1pbmlvbiwgNjAwKSBhbmQgKGNsZWFydGFyZ2V0ID09IG5pbCBvciBub3QgVmFsaWRUYXJnZXQoY2xlYXJ0YXJnZXQpKSB0aGVuDQogICAgICAgICAgY2xlYXJ0YXJnZXQgPSBtaW5pb24NCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGZvciBpLCBqdW5nbGVtaW5pb24gaW4gaXBhaXJzKHNlbGYuanVuZ2xlTWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgICBpZiBWYWxpZFRhcmdldChqdW5nbGVtaW5pb24sIDYwMCkgYW5kIChjbGVhcnRhcmdldCA9PSBuaWwgb3Igbm90IFZhbGlkVGFyZ2V0KGNsZWFydGFyZ2V0KSkgdGhlbg0KICAgICAgICAgIGNsZWFydGFyZ2V0ID0ganVuZ2xlbWluaW9uDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBmb3IgaSwgb3RoZXJtaW5pb24gaW4gaXBhaXJzKHNlbGYub3RoZXJNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICAgIGlmIFZhbGlkVGFyZ2V0KG90aGVybWluaW9uLCA2MDApIGFuZCAoY2xlYXJ0YXJnZXQgPT0gbmlsIG9yIG5vdCBWYWxpZFRhcmdldChjbGVhcnRhcmdldCkpIHRoZW4NCiAgICAgICAgICBjbGVhcnRhcmdldCA9IG90aGVybWluaW9uDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBpZiBjbGVhcnRhcmdldCB+PSBuaWwgdGhlbg0KICAgICAgICBpZihzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXIudXNlUSBhbmQgc2VsZi5Db25maWcuS2V5cy5qdW5nbGVjbGVhcmtleSApIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXIuTWFuYSAvMTAwICkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFEoY2xlYXJ0YXJnZXQpDQogICAgICAgIGVuZA0KICAgICAgICBpZiBjbGVhcnRhcmdldCB+PSBuaWwgdGhlbg0KICAgICAgICBpZihzZWxmLldTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXIudXNlVyBhbmQgc2VsZi5Db25maWcuS2V5cy5qdW5nbGVjbGVhcmtleSApIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXIuTWFuYSAvMTAwICkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFcoY2xlYXJ0YXJnZXQpDQogICAgICAgIGVuZA0KICAgICAgICBpZiBjbGVhcnRhcmdldCB+PSBuaWwgdGhlbg0KICAgICAgICBpZihzZWxmLkVTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXIudXNlRSBhbmQgc2VsZi5Db25maWcuS2V5cy5qdW5nbGVjbGVhcmtleSApIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXIuTWFuYSAvMTAwICkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEUoY2xlYXJ0YXJnZXQpDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgZW5kDQogIGVuZA0KICBlbmQNCiAgIC0tLS8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cXC0tLQ0KLS18fCA+IFZpa3RvciBTdGFydHMgICAgICAgICAgICAgICAgICAgICAgICAgfHwtLQ0KLS0tXFw9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PS8vLS0tDQogIGNsYXNzICJWaWt0b3IiDQogIHJlcXVpcmUgJ0hQcmVkaWN0aW9uJw0KICBmdW5jdGlvbiBWaWt0b3I6X19pbml0KCkNCiAgIHNlbGYudHM9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDUyNSwgREFNQUdFX1BIWVNJQ0FMLCBmYWxzZSwgdHJ1ZSkNCiAgICBzZWxmLnRzcT0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgNjAwLCBEQU1BR0VfUEhZU0lDQUwsIGZhbHNlLCB0cnVlKQ0KICAgIHNlbGYudHN3PSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCA3MDAsIERBTUFHRV9NQUdJQywgZmFsc2UsIHRydWUpDQogICAgc2VsZi50c2U9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDEyMDAsIERBTUFHRV9NQUdJQywgZmFsc2UsIHRydWUpDQogICAgc2VsZi50c3I9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDcwMCwgREFNQUdFX01BR0lDLCBmYWxzZSwgdHJ1ZSkgDQogICAgIHNlbGYuUVNwZWxsID0gX1NwZWxsKHtTbG90ID0gX1EsIERhbWFnZU5hbWUgPSAiUSIsIFJhbmdlID0gbWF0aC5odWdlLCBXaWR0aCA9IDEsIERlbGF5ID0gMCwgU3BlZWQgPSBtYXRoLmh1Z2UsIENvbGxpc2lvbiA9IHRydWUsIEFvZSA9IGZhbHNlLCBUeXBlID0gU1BFTExfVFlQRS5UQVJHRVRURUR9KQ0KICAgICBzZWxmLldTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9XLCBEYW1hZ2VOYW1lID0gIlciLCBSYW5nZSA9IG1hdGguaHVnZSwgV2lkdGggPSAxMjUsIERlbGF5ID0gMC41LCBTcGVlZCA9IDc1MCwgQ29sbGlzaW9uID0gZmFsc2UsIEFvZSA9IHRydWUsIFR5cGUgPSBTUEVMTF9UWVBFLkNJUkNVTEFSfSkNCiAgICAgc2VsZi5FU3BlbGwgPSBfU3BlbGwoe1Nsb3QgPSBfRSwgRGFtYWdlTmFtZSA9ICJFIiwgUmFuZ2UgPSAxMjAwLCBXaWR0aCA9IDkwLCBEZWxheSA9IDAsIFNwZWVkID0gbWF0aC5odWdlLCBDb2xsaXNpb24gPSB0cnVlLCBBb2UgPSBmYWxzZSwgVHlwZSA9IFNQRUxMX1RZUEUuTElORUFSfSkNCiAgICAgc2VsZi5SU3BlbGwgPSBfU3BlbGwoe1Nsb3QgPSBfUiwgRGFtYWdlTmFtZSA9ICJSIiwgUmFuZ2UgPTcwMCwgV2lkdGggPSAwLCBEZWxheSA9IDAuMjUsIFNwZWVkID0gMTAwMCwgQ29sbGlzaW9uID0gZmFsc2UsIEFvZSA9IHRydWUsIFR5cGUgPSBTUEVMTF9UWVBFLkNJUkNVTEFSfSkNCiAgICAgc2VsZi5JZ25pdGUgPSBfU3BlbGwoe1Nsb3QgPSBGaW5kU3VtbW9uZXJTbG90KCJzdW1tb25lcmRvdCIpLCBEYW1hZ2VOYW1lID0gIklHTklURSIsIFJhbmdlID0gNjAwLCBUeXBlID0gU1BFTExfVFlQRS5UQVJHRVRURUR9KQ0KICAgICBzZWxmLkhQcmVkID0gSFByZWRpY3Rpb24oKQ0KICAgICBzZWxmLkUgPSB7UmFuZ2UxID0gNTUwLCBSYW5nZTIgPSA3MDAsIHdpZHRoID0gMTgwLCByZWFkeX0NCiAgICAgc2VsZi5FUmFuZ2UgPSBzZWxmLkUuUmFuZ2UxK3NlbGYuRS5SYW5nZTINCiAgLS18PiBNaW5pb24gTWFuYWdlcnMNCiAgICAgIHNlbGYuZW5lbXlNaW5pb25zICAgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9FTkVNWSwgICA2NTAsIG15SGVybywgTUlOSU9OX1NPUlRfTUFYSEVBTFRIX0RFQykNCiAgICAgIHNlbGYuYWxseU1pbmlvbnMgICAgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9BTExZLCAgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgICAgc2VsZi5qdW5nbGVNaW5pb25zICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX0pVTkdMRSwgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgICAgc2VsZi5vdGhlck1pbmlvbnMgICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX09USEVSLCAgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgICAgICAgICAgICBzZWxmOkxvYWRNZW51KCkNCiAgICAgICAgICAgICAgc2VsZjpmaW5kb3Jid2Fsa2VyKCkNCiAgICAgICAgICAgICAgICBMYXN0X0xldmVsU3BlbGwgPSAwDQogICAgICANCiAgICAgICAgQWRkVGlja0NhbGxiYWNrKGZ1bmN0aW9uKCkgc2VsZjpUaWNrKCkgZW5kKQ0KICAgIEFkZERyYXdDYWxsYmFjayhmdW5jdGlvbigpIHNlbGY6RHJhdygpIGVuZCkNCiAgICAtLUFkZE1zZ0NhbGxiYWNrKGZ1bmN0aW9uKG1zZyxLZXkpIHNlbGY6V25kTXNnKG1zZyxLZXkpIGVuZCkNCiAgICAtLUFkZEFuaW1hdGlvbkNhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIGFuaW1hdGlvbikgc2VsZjpBbmltYXRpb24odW5pdCwgYW5pbWF0aW9uKSBlbmQpDQogICAgLS1BZGRQcm9jZXNzU3BlbGxDYWxsYmFjayhmdW5jdGlvbih1bml0LCBzcGVsbCkgc2VsZjpQcm9jZXNzU3BlbGwodW5pdCwgc3BlbGwpIGVuZCkNCiAgICAtLUFkZEFwcGx5QnVmZkNhbGxiYWNrKGZ1bmN0aW9uKHNvdXJjZSwgdW5pdCwgYnVmZikgc2VsZjpPbkFwcGx5QnVmZihzb3VyY2UsIHVuaXQsIGJ1ZmYpIGVuZCkNCiAgICAtLUFkZFVwZGF0ZUJ1ZmZDYWxsYmFjayhmdW5jdGlvbih1bml0LCBidWZmLCBzdGFja3MpIHNlbGY6VXBkYXRlQnVmZih1bml0LCBidWZmLCBzdGFja3MpIGVuZCkNCiAgICAtLUFkZFJlbW92ZUJ1ZmZDYWxsYmFjayhmdW5jdGlvbih1bml0LCBidWZmKSBzZWxmOk9uUmVtb3ZlQnVmZih1bml0LCBidWZmKSBlbmQpIA0KICAgICAgZW5kDQogIC0tIGhhbmRsZXMgc2NyaXB0IGxvZ2ljLCBhIHB1cmUgaGlnaCBzcGVlZCBsb29wDQogIGZ1bmN0aW9uIFZpa3RvcjpUaWNrKCkNCiAgICAgICBzZWxmOmF1dG96aG9ueWEoKQ0KICAgICAgICAgICBpZiBWSVBfVVNFUiB0aGVuIHNlbGY6YXV0b2xldmVsKCkgZW5kDQogICAgICAgICAgICBpZiBWSVBfVVNFUiB0aGVuIHNlbGY6c2tpbmhhY2soKSBlbmQNCiAgIGlmKHNlbGYuQ29uZmlnLmNvbWJvLmNvbWJva2V5ICl0aGVuDQogICAgICBzZWxmOmNvbWJvKCkNCiAgICBlbmQNCiAgICBpZihzZWxmLkNvbmZpZy5sYW5lY2xlYXIubGFuZWNsZWFya2V5KXRoZW4NCiAgICAgIHNlbGY6TGFuZUNsZWFyKCkNCiAgICBlbmQNCiAgICAgIGlmKHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyLmp1bmdsZWNsZWFya2V5KXRoZW4NCiAgICAgIHNlbGY6SnVuZ2xlQ2xlYXIoKQ0KICAgIGVuZA0KICAgIGlmKHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyApIHRoZW4NCiAgICAgIHNlbGY6a2lsbHN0ZWFsKCkNCiAgICBlbmQNCiAgICBpZihzZWxmLkNvbmZpZy5oYXJhc3MuaGFyYXNza2V5IG9yIHNlbGYuQ29uZmlnLmhhcmFzcy5oYXJhc3N0b2dsZSApIHRoZW4NCiAgICAgIHNlbGY6aGFyYXNzKCkNCiAgICBlbmQNCiAgICAgIGVuZA0KICBmdW5jdGlvbiBWaWt0b3I6TG9hZE1lbnUoKQ0KICAgICAgICAgc2VsZi5Db25maWc9c2NyaXB0Q29uZmlnKCIiLi5TY3JpcHRuYW1lLi4iIFsiIC4uIG15SGVyby5jaGFyTmFtZS4uIl0iICwibWVudSIpDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkhpdGNoYW5jZSIsICJoaXQiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5oaXQ6YWRkUGFyYW0oIkUiLCAiRSBIaXRDaGFuY2UgKERlZmF1bHQgdmFsdWUgPSAxLjYpIiwgU0NSSVBUX1BBUkFNX1NMSUNFLCAxLjYsIDEsIDMsIDIpDQogICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkNvbWJvIFNldHRpbmdzIiwgImNvbWJvIikNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oImNvbWJva2V5IiwgIkNvbWJvIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCAzMikNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZVEiLCAiVXNlIFEgaW4gQ29tYm8iLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VXIiwgIlVzZSBXIGluIENvbWJvIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlRSIsICJVc2UgRSBpbiBjb21ibyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZVIiLCAiVXNlIFIgaW4gY29tYm8iLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VJIiwgIlVzZSBJZ25pdGUgaWYgdGFyZ2V0IGtpbGxhYmxlIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgibG9naWMiLCAiVWx0aSBMb2dpYyIsIFNDUklQVF9QQVJBTV9MSVNULCAxLCB7IlVzZSBVbHRpIElmIFRhcmdldCBJcyBLaWxsYWJsZSIsfSkgLS0oIlVzZSBVbHRpIERpcmVjdGx5IiB9KQ0KICAgICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDEwLCAxMCwgMTAwLCAwKQ0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiSGFyYXNzIFNldHRpbmdzIiwgImhhcmFzcyIpDQogICAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczphZGRQYXJhbSgiaGFyYXNza2V5IiwgIlNtYXJ0IEhhcmFzcyBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIkMiKSkNCiAgICAgICAgc2VsZi5Db25maWcuaGFyYXNzOmFkZFBhcmFtKCJoYXJhc3N0b2dsZSIsICJTbWFydCBBdXRvIEhhcmFzcyIsICAgU0NSSVBUX1BBUkFNX09OS0VZVE9HR0xFLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIlQiKSkNCiAgICAgICAgc2VsZi5Db25maWcuaGFyYXNzOmFkZFBhcmFtKCJ1c2VRIiwgIkhhcmFzcyBXaXRoIFEiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczphZGRQYXJhbSgidXNlRSIsICJIYXJhc3MgV2l0aCBFIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6YWRkUGFyYW0oIkUiLCAiRSBIaXRDaGFuY2UgKERlZmF1bHQgdmFsdWUgPSAyKSIsIFNDUklQVF9QQVJBTV9TTElDRSwgMiwgMSwgMywgMikNCiAgICAgICAgc2VsZi5Db25maWcuaGFyYXNzOmFkZFBhcmFtKCJNYW5hIiwiTWFuYSBNYW5hZ2VyICUiLFNDUklQVF9QQVJBTV9TTElDRSwgMzAsIDEwLCAxMDAsIDApDQogICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJMYW5lQ2xlYXIgU2V0dGluZ3MiLCJsYW5lY2xlYXIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5sYW5lY2xlYXI6YWRkUGFyYW0oImxhbmVjbGVhcmtleSIsICJMYW5lIENsZWFyIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiViIpKQ0KICAgICAgICBzZWxmLkNvbmZpZy5sYW5lY2xlYXI6YWRkUGFyYW0oInVzZVEiLCJVc2UgUSBvbiBMYW5lY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5sYW5lY2xlYXI6YWRkUGFyYW0oInVzZUUiLCJVc2UgRSBvbiBMYW5lY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5sYW5lY2xlYXI6YWRkUGFyYW0oIk1hbmEiLCJNYW5hIE1hbmFnZXIgJSIsU0NSSVBUX1BBUkFNX1NMSUNFLCAzMCwgMTAsIDEwMCwgMCkNCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkp1bmdsZUNsZWFyIFNldHRpbmdzIiwianVuZ2xlY2xlYXIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhcjphZGRQYXJhbSgianVuZ2xlY2xlYXJrZXkiLCAiSnVuZ2xlQ2xlYXIgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJWIikpDQogICAgICAgIHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyOmFkZFBhcmFtKCJ1c2VRIiwiVXNlIFEgb24ganVuZ2xlY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhcjphZGRQYXJhbSgidXNlRSIsIlVzZSBFIG9uIGp1bmdsZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuanVuZ2xlY2xlYXI6YWRkUGFyYW0oIk1hbmEiLCJNYW5hIE1hbmFnZXIgJSIsU0NSSVBUX1BBUkFNX1NMSUNFLCAzMCwgMTAsIDEwMCwgMCkNCiAgICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJLaWxsU3RlYWwgU2V0dGluZ3MiLCAia2lsbHN0ZWFsIikNCiAgICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJrcyIsIktpbGxzdGVhbCBPbi9PZmYiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZVEiLCAiU3RlYWwgV2l0aCBRIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZUUiLCAiU3RlYWwgV2l0aCBFIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZVIiLCAiU3RlYWwgV2l0aCBSIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZUkiLCAiU3RlYWwgV2l0aCBJZ25pdGUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJJdGVtIFNldHRpbmdzIiwgIml0ZW0iKQ0KICAgICAgICBzZWxmLkNvbmZpZy5pdGVtOmFkZFBhcmFtKCJlbmFibGVhdXRvemhvbnlhIiwgIkF1dG8gWmhvbnlhIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCBmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcuaXRlbTphZGRQYXJhbSgiYXV0b3pob255YSIsICJaaG9ueWEgaWYgSGVhbHRoIHVuZGVyIC0+ICUiLCBTQ1JJUFRfUEFSQU1fU0xJQ0UsIDEwLCAwLCAxMDAsIDApDQogICAgICAgIA0KICAgICAgICAgICAgICBpZiBWSVBfVVNFUiB0aGVuDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIlZJUCBTZXR0aW5ncyIsICJ2aXAiKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oInBhY2tldCIsIlVzZSBQYWNrZXQgQ2FzdGluZyIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm8xIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm8yIiwgIlRvIHVzZSB2aXAgc2V0dGluZ3MsIFBhY2tldCBDYXN0aW5nIHNob3VsZCBiZSBvcGVuLiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXA6YWRkU3ViTWVudSgiQXV0byBMZXZlbCBTZXR0aW5ncyIsICJsZXZlbCIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcC5sZXZlbDphZGRQYXJhbSgia2V5IiwiVXNlIEF1dG8gTGV2ZWwiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcudmlwLmxldmVsOmFkZFBhcmFtKCJsb2dpYyIsICJTZWxlY3QgU2tpbGwgT3JkZXIiLCBTQ1JJUFRfUEFSQU1fTElTVCwgNywgeyJGb2N1cyBRPlc+RSIsICJGb2N1cyBRPkU+VyIsIkZvY3VzIFc+UT5FIiwiRm9jdXMgVz5FPlEiLCJGb2N1cyBFPlc+USIsICJGb2N1cyBFPlE+VyIsICJTbWFydCIgIH0pDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRTdWJNZW51KCJTa2luIEhhY2sgU2V0dGluZ3MiLCAic2tpbiIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcC5za2luOmFkZFBhcmFtKCJrZXkiLCJVc2UgU2tpbiBIYWNrIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcC5za2luOmFkZFBhcmFtKCdzZWxlY3RlZCcgLi4gbXlIZXJvLmNoYXJOYW1lIC4uICdTa2luJywgIlNlbGVjdCBTa2luIiwgU0NSSVBUX1BBUkFNX0xJU1QsIDEsIHNraW5NZXRhW215SGVyby5jaGFyTmFtZV0pDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcC5za2luOmFkZFBhcmFtKCJpbmZvNSIsICJNYWtlIHN1cmUgdGhhdCB1c2luZyBwYWNrZXQgY2FzdGluZyBpcyBPTi4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgLS1zZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm81IiwgIlNraW4gSGFjayB0ZW1wb3JhcnkgZGlzYWJsZWQgdW50aWwgbmV4dCB1cGRhdGUuIC4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgLS1bW3NlbGYuQ29uZmlnLnZpcDphZGRTdWJNZW51KCJBbnRpLUFGSyBTZXR0aW5ncyIsICJhbnRpYWZrIikNCiAgICAgICAgc2VsZi5Db25maWcudmlwLmFudGlhZms6YWRkUGFyYW0oImFudGlhZmsiLCJVc2UgQW50aSBBZmsiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkgXV0NCiAgICAgICAgc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvMyIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvNCIsICJUbyB1c2UgdmlwIHNldHRpbmdzLCBZb3UgbmVlZCB0byBiZSBhIFZJUCB1c2VyIG9uIEJPTCBjb21tdW5pdHkuIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgZW5kDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkRyYXcgU2V0dGluZ3MiLCJvdGhlciIpDQogICAgICAgIC0tc2VsZi5Db25maWcub3RoZXI6YWRkU3ViTWVudSgiU2hvdyBEYW1hZ2UgT24gSHAgQmFyIiwgIkhQQkFSIikNCiAgICAgICAgLS1zZWxmLkNvbmZpZy5vdGhlci5IUEJBUjphZGRQYXJhbSgia2V5IiwiT04vT0ZGIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXI6YWRkU3ViTWVudSgiU2tpbGwgRHJhd2luZyBTZXR0aW5ncyIsICJkcmF3IikNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgicWRyYXciLCJRIFNraWxsIERyYXdpbmdzIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgid2RyYXciLCJXIFNraWxsIERyYXdpbmdzIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgiZWRyYXciLCJFIFNraWxsIERyYXdpbmdzIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgicmRyYXciLCJSIFNraWxsIERyYXdpbmdzIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgiYWFkcmF3IiwiQXV0byBBdHRhY2sgUmFuZ2UiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIlRhcmdldHNlbGVjdG9ycyIsInRhcmdldHNlbCIpDQogICAgIHNlbGYudHMubmFtZSAgPSAiVmlrdG9yIg0KICAgICAgc2VsZi50c3EubmFtZSA9ICJWaWt0b3JRIg0KICAgICAgc2VsZi50c3cubmFtZSA9ICJWaWt0b3JXIg0KICAgICAgc2VsZi50c2UubmFtZSA9ICJWaWt0b3JFIg0KICAgICAgc2VsZi50c3IubmFtZSA9ICJWaWt0b3JSIg0KICAgICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFRTKHNlbGYudHMpDQogICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkVFMoc2VsZi50c3EpDQogICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkVFMoc2VsZi50c3cpDQogICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkVFMoc2VsZi50c2UpDQogICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkVFMoc2VsZi50c3IpIA0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiS2V5cyBTZXR0aW5ncyIsICJLZXlzIikNCiAgICAgIE9yYndhbGtNYW5hZ2VyOkxvYWRDb21tb25LZXlzKHNlbGYuQ29uZmlnLktleXMpDQogICAgICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvMyIsICJfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3giLCAiICAgICAgICAgICAgICAgIi4uU2NyaXB0bmFtZS4uIiIsIFNDUklQVF9QQVJBTV9JTkZPLCAiIikgDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3gyIiwgIiAgICAgICAgICAgICAgICAgU2NyaXB0IFZlcnNpb246ICAiLi5WZXJzaW9uLi4gIiAgICAgICAgICIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94NiIsICIgICAgICAgICAgICBTY3JpcHQgd2FzIG1hZGUgYnkgICIuLkF1dGhvci4uICIgICAgICAgICAiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDUiLCAiICAgICAgIExlYXVnZSBPZiBMZWdlbmRzIFZlcnNpb246ICAiLi5MVmVyc2lvbi4uICIgICAgICAgICAiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICANCiAgICAgICBzZWxmLkNvbmZpZzpwZXJtYVNob3coImluZm9ib3giKQ0KICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOnBlcm1hU2hvdygiY29tYm9rZXkiKQ0KICAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczpwZXJtYVNob3coImhhcmFzc3RvZ2xlIikNCiAgICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6cGVybWFTaG93KCJoYXJhc3NrZXkiKQ0KICAgIA0KICBlbmQNCiAgZnVuY3Rpb24gVmlrdG9yOkRyYXcoKQ0KICAgICAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5xZHJhdyBhbmQgc2VsZi5RU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCA2MDAsIDEscmVkKQ0KICAgIGVuZA0KICANCiAgICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LndkcmF3IGFuZCBzZWxmLldTcGVsbDpJc1JlYWR5KCkgdGhlbg0KICAgICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDcwMCwgMSwgcmVkKQ0KICAgIGVuZA0KICANCiAgICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LmVkcmF3IGFuZCBzZWxmLkVTcGVsbDpJc1JlYWR5KCkgdGhlbg0KICAgICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDEyMDAsIDEsIHJlZCkNCiAgICBlbmQNCiAgICANCiAgICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LnJkcmF3IGFuZCBzZWxmLlJTcGVsbDpJc1JlYWR5KCkgdGhlbg0KICAgICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDcwMCwxLCByZWQpDQogICAgZW5kDQogICAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5hYWRyYXcgdGhlbg0KICAgICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDUyNSwxLCBBUkdCKDI1NSwgMjU1LDAsMCkpDQogICAgZW5kDQogIGVuZA0KICANCmZ1bmN0aW9uIFZpa3Rvcjpza2luaGFjaygpDQogIGlmIG5vdCBGYWtlTG9hZCB0aGVuDQogIGlmICgoQ3VycmVudFRpbWVJbk1pbGxpcygpIC0gbGFzdFRpbWVUaWNrQ2FsbGVkKSA+IDIwMCkgdGhlbg0KICAgICAgbGFzdFRpbWVUaWNrQ2FsbGVkID0gQ3VycmVudFRpbWVJbk1pbGxpcygpDQogICAgaWYgc2VsZi5Db25maWcudmlwLnNraW4ua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAucGFja2V0ICB0aGVuDQogICAgaWYgc2VsZi5Db25maWcudmlwLnNraW5bJ3NlbGVjdGVkJyAuLiBteUhlcm8uY2hhck5hbWUgLi4gJ1NraW4nXSB+PSBsYXN0U2tpbiB0aGVuDQogICAgICAgIGxhc3RTa2luID0gc2VsZi5Db25maWcudmlwLnNraW5bJ3NlbGVjdGVkJyAuLiBteUhlcm8uY2hhck5hbWUgLi4gJ1NraW4nXQ0KICBTZW5kU2tpblBhY2tldChteUhlcm8uY2hhck5hbWUsIHNraW5zUEJbc2VsZi5Db25maWcudmlwLnNraW5bJ3NlbGVjdGVkJyAuLiBteUhlcm8uY2hhck5hbWUgLi4gJ1NraW4nXV0sIG15SGVyby5uZXR3b3JrSUQpOw0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIFZpa3RvcjphdXRvbGV2ZWwoKQ0KaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSAxIGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlMSA9ICAgeyAxLDIsMywxLDEsNCwxLDIsMSwyLDQsMiwyLDMsMyw0LDMsM30NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlMSkNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDIgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2UyID0gICB7IDEsMiwzLDEsMSw0LDEsMywxLDMsNCwzLDMsMiwyLDQsMiwyfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2UyKQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gMyBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTMgPSAgeyAyLDMsMSwyLDIsNCwyLDEsMiwxLDQsMSwxLDMsMyw0LDMsM30NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlMykNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDQgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2U0ID0gIHsgMiwzLDEsMiwyLDQsMiwzLDIsMyw0LDMsMywxLDEsNCwxLDF9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTQpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSA1IGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlNSA9ICB7IDMsMSwyLDMsMyw0LDMsMiwzLDIsNCwyLDIsMSwxLDQsMSwxfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2U1KQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gNiBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTYgPSAgeyAzLDEsMiwzLDMsNCwzLDEsMywxLDQsMSwxLDIsMiw0LDIsMn0NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlNikNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICAgIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gNyBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTYgPSAgeyAxLDMsMywyLDMsNCwzLDEsMywxLDQsMSwyLDEsMiw0LDIsMn0NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlNikNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gVmlrdG9yOmF1dG96aG9ueWEoKQ0KICAgIGlmIHNlbGYuQ29uZmlnLml0ZW0uZW5hYmxlYXV0b3pob255YSB0aGVuDQogICAgIGZvciBfID0gSVRFTV8xLCBJVEVNXzcgZG8NCiAgICAgIGlmIG15SGVyby5oZWFsdGggPD0gKG15SGVyby5tYXhIZWFsdGggKiBzZWxmLkNvbmZpZy5pdGVtLmF1dG96aG9ueWEgLyAxMDApIGFuZCAoIG15SGVybzpDYW5Vc2VTcGVsbChfKSA9PSAwIGFuZCBteUhlcm86R2V0U3BlbGxEYXRhKF8pLm5hbWUgPT0gIlpob255YXNIb3VyZ2xhc3MiICl0aGVuIENhc3RTcGVsbChfKQ0KICAgIGVuZA0KICAgIGVuZA0KICAgIGVuZA0KICAgIGVuZA0KICAgIGZ1bmN0aW9uIFZpa3Rvcjpvbmx5cigpDQogICAgaWYgKHNlbGYuUlNwZWxsOklzUmVhZHkoKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKSBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUiBhbmQgc2VsZi5Db25maWcuY29tYm8uY29tYm9rZXkgYW5kIEdldERpc3RhbmNlKHNlbGYudHNyLnRhcmdldCk8NzAwICl0aGVuDQogICAgICBzZWxmOkNhc3RSKHNlbGYudHNyLnRhcmdldCkNCiAgICAgIGVuZA0KICAgIGVuZA0KICBmdW5jdGlvbiBWaWt0b3I6Y29tYm8oKQ0KICAgICAgICBzZWxmLnRzcTp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi5RU3BlbGw6SXNSZWFkeSgpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmNvbWJvLk1hbmEgLzEwMCApYW5kIHNlbGYudHNxLnRhcmdldH49bmlsICBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUSBhbmQgc2VsZi5Db25maWcuY29tYm8uY29tYm9rZXkgICl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0UShzZWxmLnRzcS50YXJnZXQpDQogICAgICBlbmQNCiAgICAgIHNlbGYudHNlOnVwZGF0ZSgpDQogICAgICBpZihzZWxmLkVTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwIClhbmQgc2VsZi50c2UudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZUUgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLmNvbWJva2V5ICApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEUoc2VsZi50c2UudGFyZ2V0KQ0KICAgICAgZW5kDQogICAgICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi5XU3BlbGw6SXNSZWFkeSgpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmNvbWJvLk1hbmEgLzEwMCApIGFuZCBzZWxmLnRzdy50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlVyBhbmQgIHNlbGYuQ29uZmlnLmNvbWJvLmNvbWJva2V5ICApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFcoc2VsZi50c3cudGFyZ2V0KQ0KICAgICAgZW5kDQogICAgICBpZiggc2VsZi5SU3BlbGw6SXNSZWFkeSgpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmNvbWJvLk1hbmEgLzEwMCApIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VSIGFuZCBzZWxmLkNvbmZpZy5jb21iby5jb21ib2tleSApdGhlbg0KICAgICAgZm9yIF8sIHVuaXQgaW4gcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8NCiAgICAgICAgbG9jYWwgZG1nUiA9Z2V0RG1nKCJSIix1bml0LG15SGVybykrICgobXlIZXJvLmFwKSowLjU1KSANCiAgICAgICAgbG9jYWwgaGVhbHRoPXVuaXQuaGVhbHRoDQogICAgICAgIGlmKGhlYWx0aDxkbWdSIGFuZCBzZWxmLkNvbmZpZy5jb21iby5sb2dpYyA9PSAxIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VSIGFuZCBHZXREaXN0YW5jZSh1bml0KTw3MDApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFIodW5pdCkNCiAgICAgICBlbmQNCiAgICAgICBlbmQNCiAgICAgICBpZiAoc2VsZi5Db25maWcuY29tYm8ubG9naWMgPT0gMiBhbmQgc2VsZi50c3IudGFyZ2V0fj1uaWwpIHRoZW4NCiAgICAgICBzZWxmOm9ubHlyKCkNCiAgICAgIGVuZA0KICAgIA0KICAgICAgaWYoc2VsZi5Db25maWcuY29tYm8udXNlSSBhbmQgc2VsZi5Db25maWcuY29tYm8uY29tYm9rZXkgKXRoZW4NCiAgICAgIGZvciBfLCB1bml0IGluIHBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvDQogICAgICAgIGxvY2FsIGRtZ0kgPSg1MCsgKChteUhlcm8ubGV2ZWwpKjIwKSkNCiAgICAgICAgbG9jYWwgaGVhbHRoPXVuaXQuaGVhbHRoDQogICAgICAgIGlmKGhlYWx0aDxkbWdJIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VJIGFuZCBHZXREaXN0YW5jZSh1bml0KTw2MDApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEkodW5pdCkNCiAgICAgIGVuZA0KICAgICAgZW5kDQogIGVuZA0KICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIFZpa3RvcjpDYXN0USh1bml0KQ0KICAgIHNlbGYuUVNwZWxsOkNhc3QodW5pdCkNCiAgZW5kDQogIA0KICBmdW5jdGlvbiBWaWt0b3I6Q2FzdFcodW5pdCkNCiAgICBzZWxmLldTcGVsbDpDYXN0KHVuaXQpDQogIGVuZA0KICANCiAgZnVuY3Rpb24gVmlrdG9yOkNhc3RFKHVuaXQpDQogICANCiAgICBpZiB1bml0LmRlYWQgb3IgdW5pdC5oZWFsdGggPT0gMCB0aGVuDQogICAgICByZXR1cm4NCiAgICBlbmQNCiAgICANCiAgICBpZiBHZXREaXN0YW5jZSh1bml0LCBteUhlcm8pID4gc2VsZi5FLlJhbmdlMS01IHRoZW4NCiAgICAgRVN0YXJ0UG9zID0gQ2lyY2xlSW50ZXJzZWN0aW9uKG15SGVybywgdW5pdCwgbXlIZXJvLCBzZWxmLkUuUmFuZ2UxLTUpDQogICAgZWxzZQ0KICAgICBFU3RhcnRQb3MgPSBWZWN0b3IodW5pdC54LCB1bml0LnksIHVuaXQueikNCiAgICBlbmQNCiAgICANCiAgICAgRVBvcywgRUhpdENoYW5jZSA9IHNlbGYuSFByZWQ6R2V0UHJlZGljdChzZWxmLkhQcmVkLlByZXNldHNbJ1Zpa3RvciddWyJFIl0sIHVuaXQsIEVTdGFydFBvcykNCiAgICANCiAgICBpZiBtb2RlID09ICJDb21ibyIgYW5kIEVIaXRDaGFuY2UgPj0gc2VsZi5Db25maWcuaGl0LkUgb3IgbW9kZSA9PSAiSGFyYXNzIiBhbmQgRUhpdENoYW5jZSA+PSBzZWxmLkNvbmZpZy5oYXJhc3MuRSBvciAgbW9kZSA9PSBuaWwgYW5kIEVIaXRDaGFuY2UgPiAxIHRoZW4NCiAgICAgIENhc3RTcGVsbDMoX0UsIEQzRFhWRUNUT1IzKEVTdGFydFBvcy54LCAwLCBFU3RhcnRQb3MueiksIEQzRFhWRUNUT1IzKEVQb3MueCwgMCwgRVBvcy56KSkNCiAgICBlbmQNCiAgICANCiAgZW5kDQogIA0KICBmdW5jdGlvbiBWaWt0b3I6Q2FzdFIodW5pdCkNCiAgICBzZWxmLlJTcGVsbDpDYXN0KHVuaXQpDQogIGVuZA0KICBmdW5jdGlvbiBWaWt0b3I6Q2FzdEkodW5pdCkNCiAgICBzZWxmLklnbml0ZTpDYXN0KHVuaXQpDQogIGVuZA0KICBmdW5jdGlvbiBWaWt0b3I6a2lsbHN0ZWFsKCkNCiAgZm9yIF8sIHVuaXQgaW4gcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8NCiAgICAgIGxvY2FsIGhlYWx0aCA9IHVuaXQuaGVhbHRoDQogICAgICBsb2NhbCBkbWdFID0gZ2V0RG1nKCJFIiwgdW5pdCwgbXlIZXJvKSArICgobXlIZXJvLmFwKSowLjcpICsgKChnZXREbWcoIkUiLCB1bml0LCBteUhlcm8pICsgKChteUhlcm8uYXApKjAuNykpKjAuNCkNCiAgICAgICAgaWYoc2VsZi50c2UudGFyZ2V0IH49IG5pbCBhbmQgIHNlbGYuRVNwZWxsOklzUmVhZHkoKSBhbmQgaGVhbHRoPGRtZ0UgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VFIGFuZCBHZXREaXN0YW5jZSh1bml0KTw3MDAgICBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RFKHVuaXQpICANCiAgICAgICAgZW5kDQogICAgICAgIGxvY2FsIGRtZ1EgPSBnZXREbWcoIlEiLCB1bml0LCBteUhlcm8pICsgKChteUhlcm8uYXApKjAuMzApDQogICAgICAgIGlmKHNlbGYudHNxLnRhcmdldCB+PSBuaWwgYW5kICBzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIGhlYWx0aDxkbWdRIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlUSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzICl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0USh1bml0KSAgDQogICAgICAgIGVuZA0KICAgICAgICAgbG9jYWwgZG1nSSA9KDUwKyAoKG15SGVyby5sZXZlbCkqMjApKQ0KICAgICAgICBpZihoZWFsdGg8ZG1nSSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZUkgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyBhbmQgR2V0RGlzdGFuY2UodW5pdCk8NjAwKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RJKHVuaXQpDQogICAgICAgIGVuZA0KICAgICAgICBsb2NhbCBkbWdSID1nZXREbWcoIlIiLHVuaXQsbXlIZXJvKSsoKG15SGVyby5hcCkqMC41NSkgDQogICAgICAgIGlmKHNlbGYudHNyLnRhcmdldCB+PSBuaWwgYW5kICBzZWxmLlJTcGVsbDpJc1JlYWR5KCkgYW5kIGhlYWx0aDxkbWdSIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlUiBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzIGFuZCBHZXREaXN0YW5jZSh1bml0KTw3MDApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFIodW5pdCkNCiAgICAgICAgZW5kDQogICAgIGVuZA0KICBlbmQNCiAgDQogIGZ1bmN0aW9uIFZpa3RvcjpoYXJhc3MoKQ0KICAgIHNlbGYudHM6dXBkYXRlKCkNCiAgICBzZWxmLnRzcTp1cGRhdGUoKQ0KICAgIGlmIHNlbGYuQ29uZmlnLmhhcmFzcy5oYXJhc3NrZXkgb3Igc2VsZi5Db25maWcuaGFyYXNzLmhhcmFzc3RvZ2xlICB0aGVuDQogICAgICAgIGlmKHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5oYXJhc3MuTWFuYSAvMTAwICkgYW5kIHNlbGYudHNxLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5oYXJhc3MudXNlUSApIHRoZW4gICAgICAgIA0KICAgICAgICAgIHNlbGY6Q2FzdFEoc2VsZi50c3EudGFyZ2V0KQ0KICAgICAgICBlbmQgICANCiAgICAgICAgc2VsZi50c2U6dXBkYXRlKCkNCiAgICAgICAgIGlmKHNlbGYuRVNwZWxsOklzUmVhZHkoKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5oYXJhc3MuTWFuYSAvMTAwICkgYW5kIHNlbGYudHNlLnRhcmdldCB+PSBuaWwgYW5kIHNlbGYuQ29uZmlnLmhhcmFzcy51c2VFICBhbmQgVmFsaWRUYXJnZXQoc2VsZi50c2UudGFyZ2V0LCBzZWxmLkVSYW5nZSkpIHRoZW4NCiAgICAgICAgc2VsZjpDYXN0RShzZWxmLnRzZS50YXJnZXQpDQogICAgZW5kDQogIA0KICAgICAgICBlbmQNCiAgICAgIGVuZCAgIA0KICAgDQogIGZ1bmN0aW9uIFZpa3RvcjpMYW5lQ2xlYXIoKQ0KICAgbG9jYWwgY2xlYXJ0YXJnZXQgPSBuaWwNCiAgICAgIHNlbGYuZW5lbXlNaW5pb25zOnVwZGF0ZSgpDQogICAgICBzZWxmLm90aGVyTWluaW9uczp1cGRhdGUoKQ0KICAgICAgc2VsZi5qdW5nbGVNaW5pb25zOnVwZGF0ZSgpDQogICAgICBmb3IgaSwgbWluaW9uIGluIGlwYWlycyhzZWxmLmVuZW15TWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgICBpZiBWYWxpZFRhcmdldChtaW5pb24sIDYwMCkgYW5kIChjbGVhcnRhcmdldCA9PSBuaWwgb3Igbm90IFZhbGlkVGFyZ2V0KGNsZWFydGFyZ2V0KSkgdGhlbg0KICAgICAgICAgIGNsZWFydGFyZ2V0ID0gbWluaW9uDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBmb3IgaSwganVuZ2xlbWluaW9uIGluIGlwYWlycyhzZWxmLmp1bmdsZU1pbmlvbnMub2JqZWN0cykgZG8NCiAgICAgICAgaWYgVmFsaWRUYXJnZXQoanVuZ2xlbWluaW9uLCA2MDApIGFuZCAoY2xlYXJ0YXJnZXQgPT0gbmlsIG9yIG5vdCBWYWxpZFRhcmdldChjbGVhcnRhcmdldCkpIHRoZW4NCiAgICAgICAgICBjbGVhcnRhcmdldCA9IGp1bmdsZW1pbmlvbg0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgZm9yIGksIG90aGVybWluaW9uIGluIGlwYWlycyhzZWxmLm90aGVyTWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgICBpZiBWYWxpZFRhcmdldChvdGhlcm1pbmlvbiwgNjAwKSBhbmQgKGNsZWFydGFyZ2V0ID09IG5pbCBvciBub3QgVmFsaWRUYXJnZXQoY2xlYXJ0YXJnZXQpKSB0aGVuDQogICAgICAgICAgY2xlYXJ0YXJnZXQgPSBvdGhlcm1pbmlvbg0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgaWYgY2xlYXJ0YXJnZXQgfj0gbmlsIHRoZW4NCiAgICAgICAgaWYoc2VsZi5RU3BlbGw6SXNSZWFkeSgpIGFuZCBzZWxmLkNvbmZpZy5sYW5lY2xlYXIudXNlUSBhbmQgc2VsZi5Db25maWcubGFuZWNsZWFyLmxhbmVjbGVhcmtleSkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcubGFuZWNsZWFyLk1hbmEgLzEwMCApIHRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RRKGNsZWFydGFyZ2V0KQ0KICAgICAgICBlbmQNCiAgICAgICBpZiBjbGVhcnRhcmdldCB+PSBuaWwgdGhlbg0KICAgICAgICBpZihzZWxmLkVTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYuQ29uZmlnLmxhbmVjbGVhci51c2VFIGFuZCBzZWxmLkNvbmZpZy5sYW5lY2xlYXIubGFuZWNsZWFya2V5KSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5sYW5lY2xlYXIuTWFuYSAvMTAwICkgdGhlbg0KICAgICAgICBsb2NhbCBCZXN0UG9zLCBCZXN0SGl0ID0gR2V0QmVzdExpbmVGYXJtUG9zaXRpb24oc2VsZi5FU3BlbGwuUmFuZ2UsIHNlbGYuRVNwZWxsLldpZHRoLCBzZWxmLmVuZW15TWluaW9ucy5vYmplY3RzICkNCiAgICAgICAgaWYgQmVzdFBvcyB+PSBuaWwgYW5kIEJlc3RIaXQgPj0gMSB0aGVuDQogICAgICAgICBDYXN0U3BlbGwoX0UsIEJlc3RQb3MueCwgQmVzdFBvcy56KQ0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgIGVuZA0KICAgIGVuZA0KICAgIGVuZA0KICAgIGZ1bmN0aW9uIFZpa3RvcjpKdW5nbGVDbGVhcigpDQogICBsb2NhbCBjbGVhcnRhcmdldCA9IG5pbA0KICAgICAgc2VsZi5lbmVteU1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIHNlbGYub3RoZXJNaW5pb25zOnVwZGF0ZSgpDQogICAgICBzZWxmLmp1bmdsZU1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIGZvciBpLCBqdW5nbGVtaW5pb24gaW4gaXBhaXJzKHNlbGYuanVuZ2xlTWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgICBpZiBWYWxpZFRhcmdldChqdW5nbGVtaW5pb24sIDYwMCkgYW5kIChjbGVhcnRhcmdldCA9PSBuaWwgb3Igbm90IFZhbGlkVGFyZ2V0KGNsZWFydGFyZ2V0KSkgdGhlbg0KICAgICAgICAgIGNsZWFydGFyZ2V0ID0ganVuZ2xlbWluaW9uDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBpZiBjbGVhcnRhcmdldCB+PSBuaWwgdGhlbg0KICAgICAgICBpZihzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyLnVzZVEgYW5kIHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyLmp1bmdsZWNsZWFya2V5KSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0UShjbGVhcnRhcmdldCkNCiAgICAgICAgZW5kDQogICAgICAgIGlmIGNsZWFydGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGlmKHNlbGYuRVNwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcuanVuZ2xlY2xlYXIudXNlRSBhbmQgc2VsZi5Db25maWcuanVuZ2xlY2xlYXIuanVuZ2xlY2xlYXJrZXkpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyLk1hbmEgLzEwMCApIHRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RFKGNsZWFydGFyZ2V0KQ0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgIGVuZA0KICAgIGVuZA0KICBjbGFzcyAiRGlhbmEiDQogLS0tLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxcLS0tDQotLXx8ID4gRGlhbmEgU3RhcnRzICAgICAgICAgICAgICAgICAgICAgICAgIHx8LS0NCi0tLVxcPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0vLy0tLQ0KICBmdW5jdGlvbiBEaWFuYTpfX2luaXQoKQ0Kc2VsZi50cz0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgODMwLCBEQU1BR0VfUEhZU0lDQUwsIGZhbHNlLCB0cnVlKQ0Kc2VsZi50c3E9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDgzMCwgREFNQUdFX1BIWVNJQ0FMLCBmYWxzZSwgdHJ1ZSkNCnNlbGYudHN3PSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCAyMDAsIERBTUFHRV9QSFlTSUNBTCwgZmFsc2UsIHRydWUpDQpzZWxmLnRzZT0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgMzUwLCBEQU1BR0VfUEhZU0lDQUwsIGZhbHNlLCB0cnVlKQ0Kc2VsZi50c3I9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDgyNSwgREFNQUdFX1BIWVNJQ0FMLCBmYWxzZSwgdHJ1ZSkNCnNlbGYudHNnPSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCAxMDAwLCBEQU1BR0VfTUFHSUMsIGZhbHNlLCB0cnVlKQ0KICAgc2VsZi5RU3BlbGwgPSBfU3BlbGwoe1Nsb3QgPSBfUSwgRGFtYWdlTmFtZSA9ICJRIiwgUmFuZ2UgPSA4MzAsIFdpZHRoID0gNzUsIERlbGF5ID0gMC4yNSwgU3BlZWQgPSAyMDAwLCBDb2xsaXNpb24gPSBmYWxzZSwgQW9lID0gZmFsc2UsIFR5cGUgPSBTUEVMTF9UWVBFLkxJTkVBUn0pDQogICBzZWxmLldTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9XLCBEYW1hZ2VOYW1lID0gIlciLCBSYW5nZSA9IDIwMCwgQ29sbGlzaW9uID0gZmFsc2UsIEFvZSA9IHRydWUsIFR5cGUgPSBTUEVMTF9UWVBFLlNFTEZ9KQ0KICAgc2VsZi5FU3BlbGwgPSBfU3BlbGwoe1Nsb3QgPSBfRSwgRGFtYWdlTmFtZSA9ICJFIiwgUmFuZ2UgPSAzNTAsIENvbGxpc2lvbiA9IHRydWUsIEFvZSA9IGZhbHNlLCBUeXBlID0gU1BFTExfVFlQRS5TRUxGfSkNCiAgIHNlbGYuUlNwZWxsID0gX1NwZWxsKHtTbG90ID0gX1IsIERhbWFnZU5hbWUgPSAiUiIsIFJhbmdlID0gODI1LCAgQ29sbGlzaW9uID0gZmFsc2UsIEFvZSA9IHRydWUsIFR5cGUgPSBTUEVMTF9UWVBFLlRBUkdFVFRFRH0pDQogICBzZWxmLklnbml0ZSA9IF9TcGVsbCh7U2xvdCA9IEZpbmRTdW1tb25lclNsb3QoInN1bW1vbmVyZG90IiksIERhbWFnZU5hbWUgPSAiSUdOSVRFIiwgUmFuZ2UgPSA2MDAsIFR5cGUgPSBTUEVMTF9UWVBFLlRBUkdFVFRFRH0pDQotLXw+IE1pbmlvbiBNYW5hZ2Vycw0KICAgIHNlbGYuZW5lbXlNaW5pb25zICAgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9FTkVNWSwgICA2NTAsIG15SGVybywgTUlOSU9OX1NPUlRfTUFYSEVBTFRIX0RFQykNCiAgICBzZWxmLmFsbHlNaW5pb25zICAgID0gbWluaW9uTWFuYWdlcihNSU5JT05fQUxMWSwgICA2NTAsIG15SGVybywgTUlOSU9OX1NPUlRfTUFYSEVBTFRIX0RFQykNCiAgICBzZWxmLmp1bmdsZU1pbmlvbnMgID0gbWluaW9uTWFuYWdlcihNSU5JT05fSlVOR0xFLCAgNjUwLCBteUhlcm8sIE1JTklPTl9TT1JUX01BWEhFQUxUSF9ERUMpDQogICAgc2VsZi5vdGhlck1pbmlvbnMgICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX09USEVSLCAgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgIHNlbGY6TG9hZE1lbnUoKQ0KICAgICAgc2VsZjpmaW5kb3Jid2Fsa2VyKCkNCiAgICAgICAgIExhc3RfTGV2ZWxTcGVsbCA9IDANCiAgICAgIENsb2NrID0gb3MuY2xvY2soKQ0KICAgICAgQWRkVGlja0NhbGxiYWNrKGZ1bmN0aW9uKCkgc2VsZjpUaWNrKCkgZW5kKQ0KICBBZGREcmF3Q2FsbGJhY2soZnVuY3Rpb24oKSBzZWxmOkRyYXcoKSBlbmQpDQogIEFkZE1zZ0NhbGxiYWNrKGZ1bmN0aW9uKG1zZyxLZXkpIHNlbGY6V25kTXNnKG1zZyxLZXkpIGVuZCkNCiAgLS1BZGRBbmltYXRpb25DYWxsYmFjayhmdW5jdGlvbih1bml0LCBhbmltYXRpb24pIHNlbGY6QW5pbWF0aW9uKHVuaXQsIGFuaW1hdGlvbikgZW5kKQ0KICBBZGRQcm9jZXNzU3BlbGxDYWxsYmFjayhmdW5jdGlvbih1bml0LCBzcGVsbCkgc2VsZjpQcm9jZXNzU3BlbGwodW5pdCwgc3BlbGwpIGVuZCkNCiAgLS1BZGRBcHBseUJ1ZmZDYWxsYmFjayhmdW5jdGlvbihzb3VyY2UsIHVuaXQsIGJ1ZmYpIHNlbGY6T25BcHBseUJ1ZmYoc291cmNlLCB1bml0LCBidWZmKSBlbmQpDQogIC0tQWRkVXBkYXRlQnVmZkNhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIGJ1ZmYsIHN0YWNrcykgc2VsZjpVcGRhdGVCdWZmKHVuaXQsIGJ1ZmYsIHN0YWNrcykgZW5kKQ0KICAtLUFkZFJlbW92ZUJ1ZmZDYWxsYmFjayhmdW5jdGlvbih1bml0LCBidWZmKSBzZWxmOk9uUmVtb3ZlQnVmZih1bml0LCBidWZmKSBlbmQpIA0KICAgIGVuZA0KICAgICBmdW5jdGlvbiBEaWFuYTpUaWNrKCkNCiAgc2VsZjphdXRvemhvbnlhKCkNCiAgc2VsZjphdXRvcSgpDQogIC0tc2VsZjpnYXBjbG9zZSgpDQogIHNlbGY6aXRlbXMoKQ0KICAgICAgICBzZWxmOmNoZWNrdHMoKQ0KICAgICAgICBpZiBWSVBfVVNFUiB0aGVuIHNlbGY6YXV0b2xldmVsKCkgZW5kDQogICAgICAgICBpZiBWSVBfVVNFUiB0aGVuIHNlbGY6c2tpbmhhY2soKSBlbmQNCiAgICAgIGlmKHNlbGYuQ29uZmlnLktleXMuanVuZ2xlY2xlYXJrZXkgKXRoZW4NCiAgIHNlbGY6SnVuZ2xlQ2xlYXIoKQ0KICBlbmQNCiAgIGlmKHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID09IDEgKXRoZW4NCiAgICBzZWxmOmNvbWJvMSgpDQogIGVuZA0KICAgaWYoc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSBhbmQgc2VsZi5Db25maWcuY29tYm8ubG9naWMgPT0gMiApdGhlbg0KICAgIHNlbGY6Y29tYm8yKCkNCiAgZW5kDQogICAgIGlmKHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID09IDMgKXRoZW4NCiAgICBzZWxmOmNvbWJvMygpDQogIGVuZA0KICAgIGlmKHNlbGYuQ29uZmlnLktleXMubGFuZWNsZWFya2V5ICl0aGVuDQogICAgc2VsZjpMYW5lQ2xlYXIoKQ0KICBlbmQNCiAgaWYoc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzICkgdGhlbg0KICAgIHNlbGY6a2lsbHN0ZWFsKCkNCiAgZW5kDQogIGlmKHNlbGYuQ29uZmlnLktleXMuaGFyYXNza2V5ICApIHRoZW4NCiAgICBzZWxmOmhhcmFzcygpDQogIGVuZA0KICAgICAgaWYoc2VsZi5Db25maWcuS2V5cy5lc2NhcGVrZXkgKXRoZW4NCiAgICAgIHNlbGY6ZXNjYXBlKCkNCiAgICBlbmQNCiAgZW5kDQogICAgZnVuY3Rpb24gRGlhbmE6RHJhdygpDQogICAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5xZHJhdyBhbmQgc2VsZi5RU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgODMwLCAxLHJlZCkNCiAgZW5kDQoNCiAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy53ZHJhdyBhbmQgc2VsZi5XU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgMjAwLCAxLCByZWQpDQogIGVuZA0KDQogIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcuZWRyYXcgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSB0aGVuDQogICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDM1NSwgMSwgcmVkKQ0KICBlbmQNCiAgDQogIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcucmRyYXcgYW5kIHNlbGYuUlNwZWxsOklzUmVhZHkoKSB0aGVuDQogICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDgyMCwxLCByZWQpDQogIGVuZA0KICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LmFhZHJhdyB0aGVuDQogICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDEwMCwxLCBBUkdCKDI1NSwgMjU1LDAsMCkpDQogIGVuZA0KICAgICAgICAgIGlmIHNlbGYuQ29uZmlnLm90aGVyLnRhcmdldCBhbmQgc2VsZi5zZWxlY3RlZFRhciB+PSBuaWwgdGhlbg0KICAgICAgICAgRHJhd0NpcmNsZTNEKHNlbGYuc2VsZWN0ZWRUYXIueCwgc2VsZi5zZWxlY3RlZFRhci55LCBzZWxmLnNlbGVjdGVkVGFyLnosIDgwLDYsIEFSR0IoMjU1LCAyNTUsMCwwKSkNCmVuZA0KICBpZiBzZWxmLkNvbmZpZy5vdGhlci50YXJnZXRjYWwgYW5kIG5vdCBteUhlcm8uZGVhZCB0aGVuDQogICAgICBpZiB0YXJnZXQgYW5kIHRhcmdldCB+PSBuaWwgdGhlbg0KICAgICAgICBsb2NhbCBkcmF3cG9zPVdvcmxkVG9TY3JlZW4oRDNEWFZFQ1RPUjModGFyZ2V0LngsIHRhcmdldC55LCB0YXJnZXQueikpDQogICAgICAgIGxvY2FsIGNvbWJvVGV4dCxjb2xvciA9IHNlbGY6R2V0RHJhd3ModGFyZ2V0KQ0KICAgICAgICBpZiBjb21ib1RleHQgdGhlbg0KICAgICAgICAgIERyYXdUZXh0KGNvbWJvVGV4dCwxNSxkcmF3cG9zLngtMjAsZHJhd3Bvcy55LTIwLGNvbG9yKQ0KICAgICAgICBlbmQgDQogICAgICBlbmQgDQogICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgZnVuY3Rpb24gRGlhbmE6a2lsbHN0ZWFsKCkNCmZvciBfLCB1bml0IGluIHBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvDQogICAgbG9jYWwgaGVhbHRoID0gdW5pdC5oZWFsdGgNCiAgICBsb2NhbCBkbWdFID0gZ2V0RG1nKCJFIiwgdW5pdCwgbXlIZXJvKQ0KICAgICAgaWYoc2VsZi50c2UudGFyZ2V0IH49IG5pbCBhbmQgIHNlbGYuRVNwZWxsOklzUmVhZHkoKSBhbmQgaGVhbHRoPGRtZ0UgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VFICAgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyl0aGVuDQogICAgICAgIHNlbGY6Q2FzdEUodW5pdCkgIA0KICAgICAgZW5kDQogICAgICBsb2NhbCBkbWdRID0gZ2V0RG1nKCJRIiwgdW5pdCwgbXlIZXJvKSANCiAgICAgIGlmKHNlbGYudHNxLnRhcmdldCB+PSBuaWwgYW5kICBzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIGhlYWx0aDxkbWdRIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlUSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzICl0aGVuDQogICAgICAgIHNlbGY6Q2FzdFEodW5pdCkgIA0KICAgICAgZW5kDQogICAgICAgICAgbG9jYWwgZG1nVyA9IGdldERtZygiVyIsIHVuaXQsIG15SGVybykNCiAgICAgIGlmKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgYW5kICBzZWxmLldTcGVsbDpJc1JlYWR5KCkgYW5kIGhlYWx0aDxkbWdXIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlVyAgIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MpdGhlbg0KICAgICAgICBzZWxmOkNhc3RXKHVuaXQpICANCiAgICAgIGVuZA0KICAgICAgIGxvY2FsIGRtZ0kgPSg1MCsgKChteUhlcm8ubGV2ZWwpKjIwKSkNCiAgICAgIGlmKGhlYWx0aDxkbWdJIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlSSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzIGFuZCBHZXREaXN0YW5jZSh1bml0KTw2MDApdGhlbg0KICAgICAgICBzZWxmOkNhc3RJKHVuaXQpDQogICAgICBlbmQNCiAgICAgIGxvY2FsIGRtZ1IgPWdldERtZygiUiIsdW5pdCxteUhlcm8pDQogICAgICBpZihzZWxmLnRzci50YXJnZXQgfj0gbmlsIGFuZCAgc2VsZi5SU3BlbGw6SXNSZWFkeSgpIGFuZCBoZWFsdGg8ZG1nUiBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZVIgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyBhbmQgR2V0RGlzdGFuY2UodW5pdCk8NTUwKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0Uih1bml0KQ0KICAgICAgZW5kDQogICBlbmQNCmVuZA0KZnVuY3Rpb24gRGlhbmE6UHJvY2Vzc1NwZWxsKHVuaXQsIHNwZWxsKQ0KIC0tW1sgaWYgc3BlbGwubmFtZSA9PSAiYXR0YWNrIiAgdGhlbg0KICAgICBpZiB1bml0IGFuZCB1bml0LnR5cGUgPT0gbXlIZXJvLnR5cGUgYW5kIHVuaXQudGVhbSB+PSBteUhlcm8udGVhbSBhbmQgc3BlbGwgYW5kIHNwZWxsLnRhcmdldCBhbmQgc3BlbGwudGFyZ2V0IH49IG5pbCBhbmQgc3BlbGwudGFyZ2V0LmlzTWUgdGhlbg0KIGlmIChzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLldsb2dpYy51c2VXIGFuZCBzZWxmLldTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYudHN3LnRhcmdldH49bmlsKSB0aGVuDQpzZWxmOkNhc3RXKHVuaXQpDQogICAgICAgIGVuZA0KICAgICBlbmQNCiAgZW5kXV0NCmlmIEludGVycnVwdFt1bml0LmNoYXJOYW1lXSB+PSBuaWwgdGhlbg0KICAgICAgICBzcGVsbCA9IEludGVycnVwdFt1bml0LmNoYXJOYW1lXS5zdG9wW3NwZWxsLm5hbWVdDQogICAgICAgIGlmIHNwZWxsIH49IG5pbCB0aGVuDQogICAgICAgICAgICBpZiBzZWxmLkNvbmZpZy5taXNjLmludGVycnVwdFtzcGVsbC5uYW1lXSB0aGVuDQogICAgICAgICAgICAgICAgaWYgVmFsaWRUYXJnZXQodW5pdCkgYW5kIEdldERpc3RhbmNlKHVuaXQpIDwgc2VsZi5FU3BlbGwuUmFuZ2UgIGFuZCBzZWxmLkVTcGVsbDpJc1JlYWR5KCkgIGFuZCBzZWxmLkNvbmZpZy5taXNjLmludGVycnVwdC5yIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgc2VsZjpDYXN0RSh1bml0KQ0KICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgZW5kDQogICAgICAgIGVuZA0KICAgIGVuZA0KZW5kDQogICAgICANCiAgICAgICAgZnVuY3Rpb24gRGlhbmE6Y2hlY2t0cygpDQogICAgICAgc2VsZi50czp1cGRhdGUoKQ0KICAgICAgIHNlbGYudHNlOnVwZGF0ZSgpDQogICAgICAgc2VsZi50c3E6dXBkYXRlKCkNCiAgICAgICBzZWxmLnRzcjp1cGRhdGUoKQ0KICAgICAgIHNlbGYudHN3OnVwZGF0ZSgpDQogICAgICAgc2VsZi50c2c6dXBkYXRlKCkNCmlmIG5vdCBzZWxmLnRzZy50YXJnZXR+PW5pbCBvciBub3Qgc2VsZi5Db25maWcudGFyZ2V0c2VsLnRzIHRoZW4NCnRhcmdldCA9IHNlbGYudHMudGFyZ2V0DQplbHNlaWYgc2VsZi50c2cudGFyZ2V0fj1uaWwgb3Igc2VsZi5zZWxlY3RlZFRhciB0aGVuDQp0YXJnZXQgPSBzZWxmLnNlbGVjdGVkVGFyDQplbmQNCmVuZA0KICAgIGZ1bmN0aW9uIERpYW5hOndhbGsoKQ0KICAgIG15SGVybzpNb3ZlVG8obW91c2VQb3MueCxtb3VzZVBvcy56KQ0KICBlbmQNCiAgZnVuY3Rpb24gRGlhbmE6ZXNjYXBlKCkNCiAgaWYgc2VsZi5Db25maWcuS2V5cy5lc2NhcGVrZXkgIHRoZW4gDQogIHNlbGY6d2FsaygpDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gRGlhbmE6aGFyYXNzKCkNCiAgaWYoc2VsZi50c3EudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmhhcmFzcy51c2VRIGFuZCAgc2VsZi5Db25maWcuS2V5cy5oYXJhc3NrZXkgIGFuZCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICBzZWxmOkNhc3RRKHRhcmdldCkNCiAgIGVuZA0KICAgICAgICBpZihzZWxmLnRzdy50YXJnZXR+PW5pbCAgYW5kIHNlbGYuQ29uZmlnLmhhcmFzcy51c2VXIGFuZCAgc2VsZi5Db25maWcuS2V5cy5oYXJhc3NrZXkgIGFuZCBzZWxmLldTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICBzZWxmOkNhc3RXKHRhcmdldCkNCiAgIGVuZA0KICAgIGlmKHNlbGYudHNlLnRhcmdldH49bmlsICBhbmQgc2VsZi5Db25maWcuaGFyYXNzLnVzZUUgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmhhcmFzc2tleSAgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgIHNlbGY6Q2FzdEUodGFyZ2V0KQ0KICAgZW5kDQogIGVuZA0KICAgIGZ1bmN0aW9uIERpYW5hOmF1dG9xKCkNCiAgICAgICAgIGlmKHNlbGYudHNxLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmF1dG9xIGFuZCAgc2VsZi5RU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0USh0YXJnZXQpDQogICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIERpYW5hOkNhc3RRKHVuaXQpDQogIHNlbGYuUVNwZWxsOkNhc3QodW5pdCkNCmVuZA0KDQpmdW5jdGlvbiBEaWFuYTpDYXN0Vyh1bml0KQ0KICBzZWxmLldTcGVsbDpDYXN0KHVuaXQpDQplbmQNCg0KZnVuY3Rpb24gRGlhbmE6Q2FzdEUodW5pdCkNCiAgc2VsZi5FU3BlbGw6Q2FzdCh1bml0KQ0KZW5kDQoNCmZ1bmN0aW9uIERpYW5hOkNhc3RSKHVuaXQpDQogIHNlbGYuUlNwZWxsOkNhc3QodW5pdCkNCmVuZA0KZnVuY3Rpb24gRGlhbmE6Q2FzdEkodW5pdCkNCiAgc2VsZi5JZ25pdGU6Q2FzdCh1bml0KQ0KZW5kDQogICAgZnVuY3Rpb24gRGlhbmE6YXV0b3pob255YSgpDQogICAgaWYgc2VsZi5Db25maWcuaXRlbS5lbmFibGVhdXRvemhvbnlhIHRoZW4NCiAgICAgZm9yIF8gPSBJVEVNXzEsIElURU1fNyBkbw0KICAgICAgaWYgbXlIZXJvLmhlYWx0aCA8PSAobXlIZXJvLm1heEhlYWx0aCAqIHNlbGYuQ29uZmlnLml0ZW0uYXV0b3pob255YSAvIDEwMCkgYW5kICggbXlIZXJvOkNhblVzZVNwZWxsKF8pID09IDAgYW5kIG15SGVybzpHZXRTcGVsbERhdGEoXykubmFtZSA9PSAiWmhvbnlhc0hvdXJnbGFzcyIgKXRoZW4gQ2FzdFNwZWxsKF8pDQogICAgZW5kDQogICAgZW5kDQogICAgZW5kDQogICAgZW5kDQogICAgZnVuY3Rpb24gRGlhbmE6aXRlbXMoKQ0KICBpZiBzZWxmLkNvbmZpZy5pdGVtLnVzZWJnIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5IHRoZW4NCiAgIGZvciBfID0gSVRFTV8xLCBJVEVNXzcgZG8NCiAgICBpZiAoIG15SGVybzpDYW5Vc2VTcGVsbChfKSA9PSAwIGFuZCBteUhlcm86R2V0U3BlbGxEYXRhKF8pLm5hbWUgPT0gIkJpbGdld2F0ZXJDdXRsYXNzIiApdGhlbiBDYXN0U3BlbGwoXykNCiAgZW5kDQogIGVuZA0KICBlbmQNCiAgaWYgc2VsZi5Db25maWcuaXRlbS51c2VoZyBhbmQgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSB0aGVuDQogICBmb3IgXyA9IElURU1fMSwgSVRFTV83IGRvDQogICAgaWYgKCBteUhlcm86Q2FuVXNlU3BlbGwoXykgPT0gMCBhbmQgbXlIZXJvOkdldFNwZWxsRGF0YShfKS5uYW1lID09ICJIZXh0ZWNoR3VuYmxhZGUiICl0aGVuIENhc3RTcGVsbChfKQ0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBlbmQNCmZ1bmN0aW9uIERpYW5hOkxvYWRNZW51KCkNCiAgICAgIHNlbGYuQ29uZmlnPXNjcmlwdENvbmZpZygiIi4uU2NyaXB0bmFtZS4uIiBbIiAuLiBteUhlcm8uY2hhck5hbWUuLiJdIiAsIm1lbnUiKQ0KDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJDb21ibyBTZXR0aW5ncyIsICJjb21ibyIpDQogICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlUSIsICJVc2UgUSBpbiBDb21ibyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VXIiwgIlVzZSBXIGluIGNvbWJvIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZUUiLCAiVXNlIEUgaW4gY29tYm8iLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlUiIsICJVc2UgUiBpbiBjb21ibyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VJIiwgIlVzZSBJZ25pdGUgaWYgdGFyZ2V0IGtpbGxhYmxlIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oIk1hbmEiLCJNYW5hIE1hbmFnZXIgJSIsU0NSSVBUX1BBUkFNX1NMSUNFLCAxMCwgMTAsIDEwMCwgMCkNCiAgICAgIC0tc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oImxvZ2ljZ2FwIiwgIlVzZSBRUiB0byBnYXBjbG9zZSIsIFNDUklQVF9QQVJBTV9MSVNULCAxLCB7Ik9ubHkgaWYgdGFyZ2V0IEtpbGxhYmxlIiwgIkFsd2F5cyIgLCAiTmV2ZXIiIH0pDQogICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgibG9naWMiLCAiQ29tYm8gTG9naWMiLCBTQ1JJUFRfUEFSQU1fTElTVCwgMSwgeyJTbWFydCBDb21ibyIsICJVc2UgUiBpZiB0YXJnZXQgbWFya2VkIiAsICJTcGFtIGV2ZXJ5dGhpbmcgZmFzdCIgfSkNCiAgICAgDQogICAgICANCiAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkhhcmFzcyBTZXR0aW5ncyIsICJoYXJhc3MiKQ0KICAgICAgc2VsZi5Db25maWcuaGFyYXNzOmFkZFBhcmFtKCJ1c2VRIiwgIkhhcmFzcyBXaXRoIFEiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6YWRkUGFyYW0oInVzZVciLCAiSGFyYXNzIFdpdGggVyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczphZGRQYXJhbSgidXNlRSIsICJIYXJhc3MgV2l0aCBFIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgc2VsZi5Db25maWcuaGFyYXNzOmFkZFBhcmFtKCJNYW5hIiwiTWFuYSBNYW5hZ2VyICUiLFNDUklQVF9QQVJBTV9TTElDRSwgMTAsIDEwLCAxMDAsIDApDQogICAgICANCiAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJGYXJtIFNldHRpbmdzIiwgImZhcm0iKQ0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWcuZmFybTphZGRTdWJNZW51KCJMYW5lQ2xlYXIgU2V0dGluZ3MiLCJsYW5lY2xlYXIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5mYXJtLmxhbmVjbGVhcjphZGRQYXJhbSgidXNlUSIsIlVzZSBRIG9uIExhbmVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmZhcm0ubGFuZWNsZWFyOmFkZFBhcmFtKCJ1c2VXIiwiVXNlIFcgb24gTGFuZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuZmFybS5sYW5lY2xlYXI6YWRkUGFyYW0oIk1hbmEiLCJNYW5hIE1hbmFnZXIgJSIsU0NSSVBUX1BBUkFNX1NMSUNFLCAzMCwgMTAsIDEwMCwgMCkNCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnLmZhcm06YWRkU3ViTWVudSgiSnVuZ2xlQ2xlYXIgU2V0dGluZ3MiLCJqdW5nbGVjbGVhciIpDQogICAgICAgIHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXI6YWRkUGFyYW0oInVzZVEiLCJVc2UgUSBvbiBKdW5nbGVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXI6YWRkUGFyYW0oInVzZVciLCJVc2UgVyBvbiBKdW5nbGVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXI6YWRkUGFyYW0oIk1hbmEiLCJNYW5hIE1hbmFnZXIgJSIsU0NSSVBUX1BBUkFNX1NMSUNFLCAzMCwgMTAsIDEwMCwgMCkNCiAgICAgIA0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiS2lsbFN0ZWFsIFNldHRpbmdzIiwgImtpbGxzdGVhbCIpDQogICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oImtzIiwiS2lsbHN0ZWFsIE9uL09mZiIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZVEiLCAiU3RlYWwgV2l0aCBRIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJ1c2VFIiwgIlN0ZWFsIFdpdGggRSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgidXNlUiIsICJTdGVhbCBXaXRoIFIiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZUkiLCAiU3RlYWwgV2l0aCBJZ25pdGUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICANCiAgICAtLVtbICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJFc2NhcGUgU2V0dGluZ3MiLCJlc2NhcGUiKQ0KICAgICAgc2VsZi5Db25maWcuZXNjYXBlOmFkZFBhcmFtKCJ1c2VSIiwiVXNlIFIgTWluaW9uIFRvIEVzY2FwZSIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5lc2NhcGU6YWRkUGFyYW0oInVzZVFSIiwiVXNlIFFSIE1pbmlvbiBUbyBFc2NhcGUiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKV1dDQogICAgICAgIA0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiSXRlbSBTZXR0aW5ncyIsICJpdGVtIikNCiAgICAgIHNlbGYuQ29uZmlnLml0ZW06YWRkUGFyYW0oImVuYWJsZWF1dG96aG9ueWEiLCAiQXV0byBaaG9ueWEiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIGZhbHNlKQ0KICAgICAgc2VsZi5Db25maWcuaXRlbTphZGRQYXJhbSgiYXV0b3pob255YSIsICJaaG9ueWEgaWYgSGVhbHRoIHVuZGVyIC0+ICUiLCBTQ1JJUFRfUEFSQU1fU0xJQ0UsIDEwLCAwLCAxMDAsIDApDQogICAgICBzZWxmLkNvbmZpZy5pdGVtOmFkZFBhcmFtKCJ1c2VoZyIsICJVc2UgSGV4dGVjaCBHdW5ibGFkZSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgZmFsc2UpDQogICAgICBzZWxmLkNvbmZpZy5pdGVtOmFkZFBhcmFtKCJ1c2ViZyIsICJVc2UgQmlsZ2V3YXRlciBDdXRsYXNzIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCBmYWxzZSkNCiAgICAgIA0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiTWlzYyBTZXR0aW5ncyIsICJtaXNjIikNCiAgICAgIHNlbGYuQ29uZmlnLm1pc2M6YWRkU3ViTWVudSgiWyIgLi4gbXlIZXJvLmNoYXJOYW1lLi4gIl0gLSBBdXRvLUludGVycnVwdCIsICJpbnRlcnJ1cHQiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5taXNjLmludGVycnVwdDphZGRQYXJhbSgiciIsICJJbnRlcnJ1cHQgd2l0aCBFIFNraWxsIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5taXNjLmludGVycnVwdDphZGRQYXJhbSgiaW5mbzMiLCAiICAgICAgICAgICAgICAgICAgW1N1cHBvcnRlZCBTa2lsbHNdIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIGZvciBpLCBhIGluIHBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvDQogICAgICAgICAgICBpZiBJbnRlcnJ1cHRbYS5jaGFyTmFtZV0gfj0gbmlsIHRoZW4NCiAgICAgICAgICAgICAgICBmb3IgaSwgc3BlbGwgaW4gcGFpcnMoSW50ZXJydXB0W2EuY2hhck5hbWVdLnN0b3ApIGRvDQogICAgICAgICAgICAgICAgICAgICBzZWxmLkNvbmZpZy5taXNjLmludGVycnVwdDphZGRQYXJhbShzcGVsbC5zcGVsbE5hbWUsIGEuY2hhck5hbWUuLiIgLSAiLi5zcGVsbC5uYW1lLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgIA0KICAgICAgICBlbmQNCiAgICAgIA0KICAgICAgc2VsZi5Db25maWcubWlzYzphZGRQYXJhbSgiZW1heCIsICJVc2UgRSBvbmx5IGlmIGVuZW15IGRpc3RhbmNlID4gMjgwIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgLS1zZWxmLkNvbmZpZy5taXNjOmFkZFBhcmFtKCJ1c2VXIiwgIkF1dG8gVyBza2lsbCBpZiBlbmVteSBhdHRhY2tzLiIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIA0KICAgICAgaWYgVklQX1VTRVIgdGhlbg0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiVklQIFNldHRpbmdzIiwgInZpcCIpDQogICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oInBhY2tldCIsIlVzZSBQYWNrZXQgQ2FzdGluZyIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvMSIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzIiLCAiVG8gdXNlIHZpcCBzZXR0aW5ncywgUGFja2V0IENhc3Rpbmcgc2hvdWxkIGJlIG9wZW4uIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICBzZWxmLkNvbmZpZy52aXA6YWRkU3ViTWVudSgiQXV0byBMZXZlbCBTZXR0aW5ncyIsICJsZXZlbCIpDQogICAgICBzZWxmLkNvbmZpZy52aXAubGV2ZWw6YWRkUGFyYW0oImtleSIsIlVzZSBBdXRvIExldmVsIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICBzZWxmLkNvbmZpZy52aXAubGV2ZWw6YWRkUGFyYW0oImxvZ2ljIiwgIlNlbGVjdCBTa2lsbCBPcmRlciIsIFNDUklQVF9QQVJBTV9MSVNULCA3LCB7IkZvY3VzIFE+Vz5FIiwgIkZvY3VzIFE+RT5XIiwiRm9jdXMgVz5RPkUiLCJGb2N1cyBXPkU+USIsIkZvY3VzIEU+Vz5RIiwgIkZvY3VzIEU+UT5XIiwiU21hcnQiICB9KQ0KICAgICAgc2VsZi5Db25maWcudmlwOmFkZFN1Yk1lbnUoIlNraW4gSGFjayBTZXR0aW5ncyIsICJza2luIikNCiAgICAgIHNlbGYuQ29uZmlnLnZpcC5za2luOmFkZFBhcmFtKCJrZXkiLCJVc2UgU2tpbiBIYWNrIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICBzZWxmLkNvbmZpZy52aXAuc2tpbjphZGRQYXJhbSgnc2VsZWN0ZWQnIC4uIG15SGVyby5jaGFyTmFtZSAuLiAnU2tpbicsICJTZWxlY3QgU2tpbiIsIFNDUklQVF9QQVJBTV9MSVNULCAxLCBza2luTWV0YVtteUhlcm8uY2hhck5hbWVdKQ0KICAgICAgc2VsZi5Db25maWcudmlwLnNraW46YWRkUGFyYW0oImluZm81IiwgIk1ha2Ugc3VyZSB0aGF0IHVzaW5nIHBhY2tldCBjYXN0aW5nIGlzIE9OLiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgLS1zZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm81IiwgIlNraW4gSGFjayB0ZW1wb3JhcnkgZGlzYWJsZWQgdW50aWwgbmV4dCB1cGRhdGUuIC4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIC0tW1tzZWxmLkNvbmZpZy52aXA6YWRkU3ViTWVudSgiQW50aS1BRksgU2V0dGluZ3MiLCAiYW50aWFmayIpDQogICAgICBzZWxmLkNvbmZpZy52aXAuYW50aWFmazphZGRQYXJhbSgiYW50aWFmayIsIlVzZSBBbnRpIEFmayIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKSBdXQ0KICAgICAgc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvMyIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzQiLCAiVG8gdXNlIHZpcCBzZXR0aW5ncywgWW91IG5lZWQgdG8gYmUgYSBWSVAgdXNlciBvbiBCT0wgY29tbXVuaXR5LiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICBlbmQNCiAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkRyYXcgU2V0dGluZ3MiLCJvdGhlciIpDQogICAgICAtLXNlbGYuQ29uZmlnLm90aGVyOmFkZFN1Yk1lbnUoIlNob3cgRGFtYWdlIE9uIEhwIEJhciIsICJIUEJBUiIpDQogICAgICAtLXNlbGYuQ29uZmlnLm90aGVyLkhQQkFSOmFkZFBhcmFtKCJrZXkiLCJPTi9PRkYiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgc2VsZi5Db25maWcub3RoZXI6YWRkU3ViTWVudSgiU2tpbGwgRHJhd2luZyBTZXR0aW5ncyIsICJkcmF3IikNCiAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oInFkcmF3IiwiUSBTa2lsbCBEcmF3aW5ncyIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5vdGhlci5kcmF3OmFkZFBhcmFtKCJ3ZHJhdyIsIlcgU2tpbGwgRHJhd2luZ3MiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgiZWRyYXciLCJFIFNraWxsIERyYXdpbmdzIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oInJkcmF3IiwiUiBTa2lsbCBEcmF3aW5ncyIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5vdGhlci5kcmF3OmFkZFBhcmFtKCJhYWRyYXciLCJBdXRvIEF0dGFjayBSYW5nZSIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgc2VsZi5Db25maWcub3RoZXI6YWRkU3ViTWVudSgiRHJhdyBQZXJtYWJveCIsICJwZXJtYSIpDQogICAgICBzZWxmLkNvbmZpZy5vdGhlci5wZXJtYTphZGRQYXJhbSgicGVybWEiLCJEcmF3IFBlcm1hYm94ICggTmVlZHMgMnggRjkgKSIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5vdGhlcjphZGRQYXJhbSgidGFyZ2V0IiwiRHJhdyBjaXJjbGUgZm9yIHRhcmdldCBzZWxlY3RlZCIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5vdGhlcjphZGRQYXJhbSgidGFyZ2V0Y2FsIiwiVGFyZ2V0IGNhbGN1bGF0aW9uIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIA0KICAgICAgDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJUYXJnZXRzZWxlY3RvcnMiLCJ0YXJnZXRzZWwiKQ0KICAgICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFBhcmFtKCJpbmZvSzIiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkUGFyYW0oImluZm9LIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFBhcmFtKCJ0cyIsIkxlZnQgQ2xpY2sgRm9yIFRhcmdldCBTZWxlY3Rpb24iLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICBzZWxmLnRzLm5hbWUgID0gIkRpYW5hIg0KICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRUUyhzZWxmLnRzKQ0KICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJLZXlzIFNldHRpbmdzIiwgIktleXMiKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LMyIsICI8LS0tLS0tLS0tLS0tLS0tLS0tQ29tYm8gS2V5IFNldHRpbmdzLS0tLS0tLS0tLS0tLS0tLS0tPiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImNvbWJva2V5IiwgIkNvbWJvIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCAzMikNCiAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJpbmZvSzQiLCAiPC0tLS0tLS0tLS0tLS0tLS0tLUhhcmFzcyBLZXkgU2V0dGluZ3MtLS0tLS0tLS0tLS0tLS0tLS0+IiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaGFyYXNza2V5IiwgIlNtYXJ0IEhhcmFzcyBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIkMiKSkNCiAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJhdXRvcSIsICJBdXRvIEhhcmFzcyBRIiwgU0NSSVBUX1BBUkFNX09OS0VZVE9HR0xFLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIlQiKSkNCiAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJpbmZvSzUiLCAiPC0tLS0tLS0tLS0tLS0tLS0tLUNsZWFyIEtleSBTZXR0aW5ncy0tLS0tLS0tLS0tLS0tLS0tLS0tPiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImxhbmVjbGVhcmtleSIsICJMYW5lQ2xlYXIgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJWIikpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgianVuZ2xlY2xlYXJrZXkiLCAiSnVuZ2xlQ2xlYXIgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJaIikpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0s2IiwgIjwtLS0tLS0tLS0tLS0tLS0tLS1PdGhlciBLZXkgU2V0dGluZ3MtLS0tLS0tLS0tLS0tLS0tLS0tLT4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJlc2NhcGVrZXkiLCAiRXNjYXBlIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiWSIpKQ0KICAgIC0tc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgibGFzdGhpdGtleSIsICJMYXN0aGl0IEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiWCIpKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LMiIsICJNYWtlIFN1cmUgVGhhdCBZb3VyIE9yYndhbGtlciBLZXlzIGFyZSBTYW1lIEFzIEhlcmUiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJPcndXYWxrZXJLZXkgU2V0dGluZ3MiLCAiS2V5czIiKQ0KICAgIA0KICAgIE9yYndhbGtNYW5hZ2VyOkxvYWRDb21tb25LZXlzKHNlbGYuQ29uZmlnLktleXMyKQ0KICAgIA0KICAgICANCiAgICAgaWYgc2VsZi5Db25maWcub3RoZXIucGVybWEucGVybWEgdGhlbg0KICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgc2VsZi5Db25maWc6cGVybWFTaG93KCJpbmZvYm94IikgZW5kLCAxKQ0KICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKClzZWxmLkNvbmZpZy5LZXlzOnBlcm1hU2hvdygiY29tYm9rZXkiKSBlbmQsIDEuMikNCiAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKXNlbGYuQ29uZmlnLktleXM6cGVybWFTaG93KCJoYXJhc3NrZXkiKSBlbmQsIDEuMikNCiAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHNlbGYuQ29uZmlnLktleXM6cGVybWFTaG93KCJhdXRvcSIpIGVuZCwgMS4yKQ0KICBlbmQNCmVuZA0KLS1bW2Z1bmN0aW9uIERpYW5hOmdhcGNsb3NlKCkNCmxvY2FsIFFkbWc9Z2V0RG1nKCJRIix0YXJnZXQsbXlIZXJvKQ0KbG9jYWwgV2RtZz1nZXREbWcoIlciLHRhcmdldCxteUhlcm8pDQpsb2NhbCBFZG1nPWdldERtZygiRSIsdGFyZ2V0LG15SGVybykNCmxvY2FsIFJkbWc9Z2V0RG1nKCJSIix0YXJnZXQsbXlIZXJvKQ0KbG9jYWwgSWRtZz0oNTArICgobXlIZXJvLmxldmVsKSoyMCkpDQpsb2NhbCBmdWxjb21ibz0gUWRtZyArIFdkbWcgKyBFZG1nICsgUmRtZw0KaWYgKHRhcmdldC5oZWFsdGggPCBmdWxjb21ibyBhbmQgc2VsZi5Db25maWcuY29tYm8ubG9naWNnYXAgPT0gMSBhbmQgR2V0RGlzdGFuY2UodW5pdCk+ODMwIGFuZCBzZWxmLnRzZy50YXJnZXR+PW5pbCkgdGhlbg0Kc2VsZjpDYXN0UVIobWluaW9uKQ0KZWxzZWlmICAoc2VsZi5Db25maWcuY29tYm8ubG9naWNnYXAgPT0gMiBhbmQgR2V0RGlzdGFuY2UodW5pdCk+ODMwIGFuZCBzZWxmLnRzZy50YXJnZXR+PW5pbCkgdGhlbg0Kc2VsZjpDYXN0UVIobWluaW9uKQ0KZW5kDQplbmRdXQ0KICBmdW5jdGlvbiBEaWFuYTpDYXN0UlEodW5pdCkNCiAgICAgICAgICAgIGlmKHNlbGYudHNxLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VRIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgIGFuZCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICAgc2VsZjpDYXN0USh0YXJnZXQpIA0KICAgICBlbmQNCiAgICAgIGlmKHNlbGYudHNyLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VSIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgIGFuZCBzZWxmLlJTcGVsbDpJc1JlYWR5KCkpIHRoZW4NCiAgICAgICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpc2VsZjpDYXN0Uih0YXJnZXQpIGVuZCwgMC41KQ0KICAgICAgICAgIGVuZA0KICAgICAgICAgIGVuZA0KICAgIGZ1bmN0aW9uIERpYW5hOkNhc3RRUih1bml0KQ0KICBsb2NhbCBhYnVmZiA9IHNlbGY6YnVmZihtaW5pb24pDQogICAgICBpZihzZWxmLnRzcS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICAgYW5kIHNlbGYuUVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0UShtaW5pb24pDQogICAgIGVuZA0KICAgICAgICAgICBpZihzZWxmLnRzci50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUiBhbmQgYWJ1ZmYgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgYW5kIHNlbGYuUlNwZWxsOklzUmVhZHkoKSkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFIobWluaW9uKQ0KICAgICAgICAgIGVuZA0KICBlbmQNCiBmdW5jdGlvbiBEaWFuYTpjb21ibzEoKQ0KICAgIHNlbGY6Q2FzdFJRKHRhcmdldCkNCiAgICAgICAgaWYoc2VsZi50c3cudGFyZ2V0fj1uaWwgIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VXIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgYW5kIHNlbGYuV1NwZWxsOklzUmVhZHkoKSBhbmQgbm90IHNlbGYuUVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgIHNlbGY6Q2FzdFcodGFyZ2V0KQ0KICAgZW5kDQogICBpZiBzZWxmLkNvbmZpZy5taXNjLmVtYXggdGhlbg0KICAgIGlmKHNlbGYudHNlLnRhcmdldH49bmlsICBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlRSBhbmQgR2V0RGlzdGFuY2UodGFyZ2V0KT4yODAgYW5kIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgIGFuZCBzZWxmLkVTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICBzZWxmOkNhc3RFKHRhcmdldCkNCiAgIGVuZA0KICAgZWxzZWlmIG5vdCBzZWxmLkNvbmZpZy5taXNjLmVtYXggdGhlbg0KICAgICAgIGlmKHNlbGYudHNlLnRhcmdldH49bmlsICBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlRSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgIGFuZCBzZWxmLkVTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICBzZWxmOkNhc3RFKHRhcmdldCkNCiAgIGVuZA0KICAgZW5kDQogICAgICAgaWYoc2VsZi5Db25maWcuY29tYm8udXNlSSBhbmQgc2VsZi5Db25maWcuY29tYm8uY29tYm9rZXkgKXRoZW4NCiAgICBmb3IgXywgdW5pdCBpbiBwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbw0KICAgICAgbG9jYWwgZG1nSSA9KDUwKyAoKG15SGVyby5sZXZlbCkqMjApKQ0KICAgICAgbG9jYWwgaGVhbHRoPXVuaXQuaGVhbHRoDQogICAgICBpZihoZWFsdGg8ZG1nSSBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlSSBhbmQgR2V0RGlzdGFuY2UodW5pdCk8NjAwKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0SSh1bml0KQ0KICAgIGVuZA0KICAgIGVuZA0KICBlbmQNCiAgZW5kDQogICBmdW5jdGlvbiBEaWFuYTpjb21ibzIoKQ0KICBsb2NhbCBhYnVmZiA9IHNlbGY6YnVmZih0YXJnZXQpDQogIGlmKHNlbGYudHNxLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VRIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgYW5kIHNlbGYuUVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgIHNlbGY6Q2FzdFEodGFyZ2V0KQ0KICAgZW5kDQogICAgaWYoc2VsZi50c3IudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVIgYW5kIGFidWZmIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgYW5kIG5vdCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYuUlNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgIHNlbGY6Q2FzdFIodGFyZ2V0KQ0KICAgZW5kDQogICAgICAgIGlmKHNlbGYudHN3LnRhcmdldH49bmlsICBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlVyBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgIGFuZCBzZWxmLldTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICBzZWxmOkNhc3RXKHRhcmdldCkNCiAgIGVuZA0KICAgIGlmIHNlbGYuQ29uZmlnLm1pc2MuZW1heCB0aGVuDQogICAgaWYoc2VsZi50c2UudGFyZ2V0fj1uaWwgIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VFIGFuZCBHZXREaXN0YW5jZSh0YXJnZXQpPjI4MCBhbmQgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSAgKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0RSh0YXJnZXQpDQogICBlbmQNCiAgIGVsc2VpZiBub3Qgc2VsZi5Db25maWcubWlzYy5lbWF4IHRoZW4NCiAgICAgICBpZihzZWxmLnRzZS50YXJnZXR+PW5pbCAgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZUUgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICBhbmQgc2VsZi5FU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0RSh0YXJnZXQpDQogICBlbmQNCiAgIGVuZA0KICAgICAgIGlmKHNlbGYuQ29uZmlnLmNvbWJvLnVzZUkgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLmNvbWJva2V5ICl0aGVuDQogICAgZm9yIF8sIHVuaXQgaW4gcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8NCiAgICAgIGxvY2FsIGRtZ0kgPSg1MCsgKChteUhlcm8ubGV2ZWwpKjIwKSkNCiAgICAgIGxvY2FsIGhlYWx0aD11bml0LmhlYWx0aA0KICAgICAgaWYoaGVhbHRoPGRtZ0kgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZUkgYW5kIEdldERpc3RhbmNlKHVuaXQpPDYwMCl0aGVuDQogICAgICAgIHNlbGY6Q2FzdEkodW5pdCkNCiAgICBlbmQNCiAgICBlbmQNCiAgZW5kDQogIGVuZA0KICAgZnVuY3Rpb24gRGlhbmE6Y29tYm8zKCkNCiAgaWYoc2VsZi50c3EudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVEgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICBhbmQgc2VsZi5RU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0USh0YXJnZXQpDQogICBlbmQNCiAgICAgICBpZihzZWxmLnRzdy50YXJnZXR+PW5pbCAgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVcgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICBhbmQgc2VsZi5XU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0Vyh0YXJnZXQpDQogICBlbmQNCiAgICBpZihzZWxmLnRzci50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUiBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgIGFuZCBub3Qgc2VsZi5RU3BlbGw6SXNSZWFkeSgpIGFuZCBzZWxmLlJTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICBzZWxmOkNhc3RSKHRhcmdldCkNCiAgIGVuZA0KICAgIGlmIHNlbGYuQ29uZmlnLm1pc2MuZW1heCB0aGVuDQogICAgaWYoc2VsZi50c2UudGFyZ2V0fj1uaWwgIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VFIGFuZCBHZXREaXN0YW5jZSh0YXJnZXQpPjI4MCBhbmQgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSApdGhlbg0KICAgICAgICBzZWxmOkNhc3RFKHRhcmdldCkNCiAgIGVuZA0KICAgZWxzZWlmIG5vdCBzZWxmLkNvbmZpZy5taXNjLmVtYXggdGhlbg0KICAgICAgIGlmKHNlbGYudHNlLnRhcmdldH49bmlsICBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlRSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgIGFuZCBzZWxmLkVTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICBzZWxmOkNhc3RFKHRhcmdldCkNCiAgIGVuZA0KICAgZW5kDQogICAgICAgaWYoc2VsZi5Db25maWcuY29tYm8udXNlSSBhbmQgc2VsZi5Db25maWcuY29tYm8uY29tYm9rZXkgKXRoZW4NCiAgICBmb3IgXywgdW5pdCBpbiBwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbw0KICAgICAgbG9jYWwgZG1nSSA9KDUwKyAoKG15SGVyby5sZXZlbCkqMjApKQ0KICAgICAgbG9jYWwgaGVhbHRoPXVuaXQuaGVhbHRoDQogICAgICBpZihoZWFsdGg8ZG1nSSBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlSSBhbmQgR2V0RGlzdGFuY2UodW5pdCk8NjAwKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0SSh1bml0KQ0KICAgIGVuZA0KICAgIGVuZA0KICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIERpYW5hOmJ1ZmYodW5pdCkNCiByZXR1cm4gVGFyZ2V0SGF2ZUJ1ZmYoJ2RpYW5hbW9vbmxpZ2h0JywgdW5pdCkNCmVuZA0KZnVuY3Rpb24gRGlhbmE6V25kTXNnKE1zZywgS2V5KQ0KaWYgc2VsZi5Db25maWcudGFyZ2V0c2VsLnRzIHRoZW4gICAgICANCiAgICAgICAgaWYgTXNnID09IFdNX0xCVVRUT05ET1dOIHRoZW4NCiAgICAgICAgICAgIGxvY2FsIG1pbkQgPSAxMA0KICAgICAgICAgICAgbG9jYWwgc3RhcmdldCA9IG5pbA0KICAgICAgICAgICAgZm9yIGksIGVuZW15IGluIGlwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbw0KICAgICAgICAgICAgICAgIGlmIFZhbGlkVGFyZ2V0KGVuZW15KSB0aGVuDQogICAgICAgICAgICAgICAgICAgIGlmIEdldERpc3RhbmNlKGVuZW15LCBtb3VzZVBvcykgPD0gbWluRCBvciBzdGFyZ2V0ID09IG5pbCB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgICBtaW5EID0gR2V0RGlzdGFuY2UoZW5lbXksIG1vdXNlUG9zKQ0KICAgICAgICAgICAgICAgICAgICAgICAgc3RhcmdldCA9IGVuZW15DQogICAgICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgZW5kICAgICANCiAgICAgICAgICAgIGlmIHN0YXJnZXQgYW5kIG1pbkQgPCA1MDAgdGhlbg0KICAgICAgICAgICAgICAgIGlmIHNlbGYuc2VsZWN0ZWRUYXIgYW5kIHN0YXJnZXQuY2hhck5hbWUgPT0gc2VsZi5zZWxlY3RlZFRhci5jaGFyTmFtZSB0aGVuDQogICAgICAgICAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWRUYXIgPSBuaWwNCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoIjxmb250IGNvbG9yPVwiI0NCRjZGRlwiPlRhcmdldCA8Yj5pcyBubyBsb2dlciBzZWxlY3RlZC48L2I+OiAiLi5zdGFyZ2V0LmNoYXJOYW1lLi4iPC9mb250PiIpDQogICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgICAgICBzZWxmLnNlbGVjdGVkVGFyID0gc3RhcmdldCAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBwcmludCgiPGZvbnQgY29sb3I9XCIjQ0JGNkZGXCI+TmV3IHRhcmdldCA8Yj5zZWxlY3RlZC48L2I+OiAiLi5zdGFyZ2V0LmNoYXJOYW1lLi4iPC9mb250PiIpDQogICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICBlbmQNCiAgICAgICAgZW5kDQogICAgZW5kDQogICAgZW5kDQogICAgZnVuY3Rpb24gRGlhbmE6R2V0RHJhd3ModGFyZ2V0KQ0KbG9jYWwgUWRtZz1nZXREbWcoIlEiLHRhcmdldCxteUhlcm8pDQpsb2NhbCBXZG1nPWdldERtZygiVyIsdGFyZ2V0LG15SGVybykNCmxvY2FsIEVkbWc9Z2V0RG1nKCJFIix0YXJnZXQsbXlIZXJvKQ0KbG9jYWwgUmRtZz1nZXREbWcoIlIiLHRhcmdldCxteUhlcm8pDQpsb2NhbCBJZG1nPSg1MCsgKChteUhlcm8ubGV2ZWwpKjIwKSkNCiAgDQogIGlmIFFkbWcgPiB0YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EnLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgUWRtZytJZG1nPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIElnbml0ZScsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogICAgIGVsc2VpZiBXZG1nID4gdGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdXJywgUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIFdkbWcrSWRtZz50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1cgKyBJZ25pdGUnLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgRWRtZz50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ0UnLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgRWRtZytJZG1nPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnRSArIElnbml0ZScsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogICAgICBlbHNlaWYgUmRtZz50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1InLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgUmRtZytJZG1nPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUiArIElnbml0ZScsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBRZG1nK0VkbWc+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgRScsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgICAgIGVsc2VpZiBRZG1nK1dkbWc+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgVycsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgICAgIGVsc2VpZiBRZG1nK1JkbWc+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgUicsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIFFkbWcrRWRtZytJZG1nPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIEUgKyBJZ25pdGUnLFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogICAgICBlbHNlaWYgUWRtZytXZG1nK0lkbWc+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgVyArIElnbml0ZScsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgICAgIGVsc2VpZiBRZG1nK1JkbWcrSWRtZz50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBSICsgSWduaXRlJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgUWRtZytFZG1nK1JkbWcrSWRtZz50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBSICsgRSArIElnbml0ZScsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIFFkbWcrUmRtZytFZG1nID50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBSICsgRScsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgICAgICAgICAgICAgZWxzZWlmIChRZG1nK0VkbWcrUmRtZytJZG1nK1dkbWcpID50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ0tpbGwgV2l0aCBmdWxsIENvbWJvJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICAgICAgICAgIGVsc2VpZiAoUWRtZytFZG1nK1JkbWcrSWRtZytXZG1nKSsoUWRtZytFZG1nK1JkbWcrSWRtZytXZG1nKSA+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdLaWxsIFdpdGggMiBDb21ibycsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZSANCiAgICByZXR1cm4gIkNhbnQgS2lsbCB5ZXQiLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbmQgDQplbmQNCmZ1bmN0aW9uIERpYW5hOnNraW5oYWNrKCkNCiAgaWYgbm90IEZha2VMb2FkIHRoZW4NCiAgaWYgKChDdXJyZW50VGltZUluTWlsbGlzKCkgLSBsYXN0VGltZVRpY2tDYWxsZWQpID4gMjAwKSB0aGVuDQogICAgICBsYXN0VGltZVRpY2tDYWxsZWQgPSBDdXJyZW50VGltZUluTWlsbGlzKCkNCiAgICBpZiBzZWxmLkNvbmZpZy52aXAuc2tpbi5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgIHRoZW4NCiAgICBpZiBzZWxmLkNvbmZpZy52aXAuc2tpblsnc2VsZWN0ZWQnIC4uIG15SGVyby5jaGFyTmFtZSAuLiAnU2tpbiddIH49IGxhc3RTa2luIHRoZW4NCiAgICAgICAgbGFzdFNraW4gPSBzZWxmLkNvbmZpZy52aXAuc2tpblsnc2VsZWN0ZWQnIC4uIG15SGVyby5jaGFyTmFtZSAuLiAnU2tpbiddDQogIFNlbmRTa2luUGFja2V0KG15SGVyby5jaGFyTmFtZSwgc2tpbnNQQltzZWxmLkNvbmZpZy52aXAuc2tpblsnc2VsZWN0ZWQnIC4uIG15SGVyby5jaGFyTmFtZSAuLiAnU2tpbiddXSwgbXlIZXJvLm5ldHdvcmtJRCk7DQogIGVuZA0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBlbmQNCiBmdW5jdGlvbiBEaWFuYTphdXRvbGV2ZWwoKQ0KaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSAxIGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlMSA9ICAgeyAxLDIsMywxLDEsNCwxLDIsMSwyLDQsMiwyLDMsMyw0LDMsM30NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlMSkNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDIgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2UyID0gICB7IDEsMiwzLDEsMSw0LDEsMywxLDMsNCwzLDMsMiwyLDQsMiwyfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2UyKQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gMyBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTMgPSAgeyAyLDMsMSwyLDIsNCwyLDEsMiwxLDQsMSwxLDMsMyw0LDMsM30NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlMykNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDQgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2U0ID0gIHsgMiwzLDEsMiwyLDQsMiwzLDIsMyw0LDMsMywxLDEsNCwxLDF9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTQpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSA1IGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlNSA9ICB7IDMsMSwyLDMsMyw0LDMsMiwzLDIsNCwyLDIsMSwxLDQsMSwxfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2U1KQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gNiBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTYgPSAgeyAzLDEsMiwzLDMsNCwzLDEsMywxLDQsMSwxLDIsMiw0LDIsMn0NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlNikNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICAgIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gNyBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTYgPSAgeyAxLDIsMywxLDEsNCwxLDIsMSwyLDQsMiwyLDMsMyw0LDMsM30NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlNikNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gRGlhbmE6SnVuZ2xlQ2xlYXIoKQ0KICAgbG9jYWwgY2xlYXJ0YXJnZXQgPSBuaWwNCiAgICAgIHNlbGYuZW5lbXlNaW5pb25zOnVwZGF0ZSgpDQogICAgICBzZWxmLm90aGVyTWluaW9uczp1cGRhdGUoKQ0KICAgICAgc2VsZi5qdW5nbGVNaW5pb25zOnVwZGF0ZSgpDQogICAgICBmb3IgaSwgbWluaW9uIGluIGlwYWlycyhzZWxmLmVuZW15TWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgICBpZiBWYWxpZFRhcmdldChtaW5pb24sIDYwMCkgYW5kIChjbGVhcnRhcmdldCA9PSBuaWwgb3Igbm90IFZhbGlkVGFyZ2V0KGNsZWFydGFyZ2V0KSkgdGhlbg0KICAgICAgICAgIGNsZWFydGFyZ2V0ID0gbWluaW9uDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBmb3IgaSwganVuZ2xlbWluaW9uIGluIGlwYWlycyhzZWxmLmp1bmdsZU1pbmlvbnMub2JqZWN0cykgZG8NCiAgICAgICAgaWYgVmFsaWRUYXJnZXQoanVuZ2xlbWluaW9uLCA2MDApIGFuZCAoY2xlYXJ0YXJnZXQgPT0gbmlsIG9yIG5vdCBWYWxpZFRhcmdldChjbGVhcnRhcmdldCkpIHRoZW4NCiAgICAgICAgICBjbGVhcnRhcmdldCA9IGp1bmdsZW1pbmlvbg0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgZm9yIGksIG90aGVybWluaW9uIGluIGlwYWlycyhzZWxmLm90aGVyTWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgICBpZiBWYWxpZFRhcmdldChvdGhlcm1pbmlvbiwgNjAwKSBhbmQgKGNsZWFydGFyZ2V0ID09IG5pbCBvciBub3QgVmFsaWRUYXJnZXQoY2xlYXJ0YXJnZXQpKSB0aGVuDQogICAgICAgICAgY2xlYXJ0YXJnZXQgPSBvdGhlcm1pbmlvbg0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgaWYgY2xlYXJ0YXJnZXQgfj0gbmlsIHRoZW4NCiAgICAgICAgaWYoc2VsZi5RU3BlbGw6SXNSZWFkeSgpIGFuZCBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyLnVzZVEgYW5kIHNlbGYuQ29uZmlnLktleXMuanVuZ2xlY2xlYXJrZXkgKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyLk1hbmEgLzEwMCApIHRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RRKGNsZWFydGFyZ2V0KQ0KICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICBpZihzZWxmLldTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXIudXNlVyBhbmQgc2VsZi5Db25maWcuS2V5cy5qdW5nbGVjbGVhcmtleSApIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXIuTWFuYSAvMTAwICkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFcoY2xlYXJ0YXJnZXQpDQogICAgICAgIGVuZA0KICAgICANCiAgZW5kDQogIGVuZA0KICAgZnVuY3Rpb24gRGlhbmE6TGFuZUNsZWFyKCkNCiAgICAgIHNlbGYuZW5lbXlNaW5pb25zOnVwZGF0ZSgpDQogICBpZihzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYuQ29uZmlnLmZhcm0ubGFuZWNsZWFyLnVzZVEgYW5kIHNlbGYuQ29uZmlnLktleXMubGFuZWNsZWFya2V5KSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5mYXJtLmxhbmVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgIGxvY2FsIEJlc3RQb3MsIEJlc3RIaXQgPSBHZXRCZXN0TGluZUZhcm1Qb3NpdGlvbihzZWxmLlFTcGVsbC5SYW5nZSwgc2VsZi5RU3BlbGwuV2lkdGgsIHNlbGYuZW5lbXlNaW5pb25zLm9iamVjdHMgKQ0KICAgICAgICBpZiBCZXN0UG9zIH49IG5pbCBhbmQgQmVzdEhpdCA+PSAxIHRoZW4NCiAgICAgICAgIENhc3RTcGVsbChfUSwgQmVzdFBvcy54LCBCZXN0UG9zLnopDQogICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgICAgICAgaWYoc2VsZi5XU3BlbGw6SXNSZWFkeSgpIGFuZCAgc2VsZi5Db25maWcuZmFybS5sYW5lY2xlYXIudXNlVyBhbmQgc2VsZi5Db25maWcuS2V5cy5sYW5lY2xlYXJrZXkpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmZhcm0ubGFuZWNsZWFyLk1hbmEgLzEwMCApIHRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RXKHNlbGYuZW5lbXlNaW5pb25zLm9iamVjdCkNCiAgICAgICAgZW5kDQplbmQNCiANCiAgICAtLS0vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XFwtLS0NCi0tfHwgPiBTaW1wbGVMaWIgICAgICAgICAgICAgICAgICAgICAgICAgIHx8LS0NCi0tLVxcPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0vLy0tLQ0KICBmdW5jdGlvbiBSZXF1aXJlU2ltcGxlTGliKCkNCiAgICAgIGlmIEZpbGVFeGlzdChMSUJfUEFUSC4uIlNpbXBsZUxpYi5sdWEiKSBhbmQgbm90IEZpbGVFeGlzdChTQ1JJUFRfUEFUSC4uIlNpbXBsZUxpYi5sdWEiKSB0aGVuDQogICAgICAgICAgcmVxdWlyZSAiU2ltcGxlTGliIg0KICAgICAgICAgIGlmIF9HLlNpbXBsZUxpYlZlcnNpb24gPT0gbmlsIHRoZW4gDQogICAgICAgICAgICAgIHByaW50KCJZb3VyIFNpbXBsZUxpYiBmaWxlIGlzIHdyb25nLiIpDQogICAgICAgICAgICAgIHJldHVybiBmYWxzZQ0KICAgICAgICAgIGVuZA0KICAgICAgICAgIGlmIF9HLlNpbXBsZUxpYlZlcnNpb24gPCAxLjAyIHRoZW4NCiAgICAgICAgICAgICAgcHJpbnQoIllvdSBuZWVkIHRoZSBsYXN0ZXN0IHZlcnNpb24gb2YgU2ltcGxlTGliLiIpDQogICAgICAgICAgICAgIHJldHVybiBmYWxzZQ0KICAgICAgICAgIGVuZA0KICAgICAgICAgIHJldHVybiB0cnVlDQogICAgICBlbHNlaWYgRmlsZUV4aXN0KExJQl9QQVRILi4iU2ltcGxlTGliLmx1YSIpIGFuZCBGaWxlRXhpc3QoU0NSSVBUX1BBVEguLiJTaW1wbGVMaWIubHVhIikgdGhlbg0KICAgICAgICAgIHByaW50KCJTaW1wbGVMaWIubHVhIHNob3VsZCBub3QgYmUgaW4gQ3VzdG9tIFNjcmlwdCAoT25seSBvbiBDb21tb24gZm9sZGVyKSwgZGVsZXRlIGl0IGZyb20gdGhlcmUuLi4iKQ0KICAgICAgICAgIHJldHVybiBmYWxzZQ0KICAgICAgZWxzZQ0KICAgICAgICAgIGxvY2FsIGZ1bmN0aW9uIEJhc2U2NEVuY29kZTIoZGF0YSkNCiAgICAgICAgICAgICAgbG9jYWwgYj0nQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLycNCiAgICAgICAgICAgICAgcmV0dXJuICgoZGF0YTpnc3ViKCcuJywgZnVuY3Rpb24oeCkNCiAgICAgICAgICAgICAgICAgIGxvY2FsIHIsYj0nJyx4OmJ5dGUoKQ0KICAgICAgICAgICAgICAgICAgZm9yIGk9OCwxLC0xIGRvIHI9ci4uKGIlMl5pLWIlMl4oaS0xKT4wIGFuZCAnMScgb3IgJzAnKSBlbmQNCiAgICAgICAgICAgICAgICAgIHJldHVybiByOw0KICAgICAgICAgICAgICBlbmQpLi4nMDAwMCcpOmdzdWIoJyVkJWQlZD8lZD8lZD8lZD8nLCBmdW5jdGlvbih4KQ0KICAgICAgICAgICAgICAgICAgaWYgKCN4IDwgNikgdGhlbiByZXR1cm4gJycgZW5kDQogICAgICAgICAgICAgICAgICBsb2NhbCBjPTANCiAgICAgICAgICAgICAgICAgIGZvciBpPTEsNiBkbyBjPWMrKHg6c3ViKGksaSk9PScxJyBhbmQgMl4oNi1pKSBvciAwKSBlbmQNCiAgICAgICAgICAgICAgICAgIHJldHVybiBiOnN1YihjKzEsYysxKQ0KICAgICAgICAgICAgICBlbmQpLi4oeyAnJywgJz09JywgJz0nIH0pWyNkYXRhJTMrMV0pDQogICAgICAgICAgZW5kDQogICAgICAgICAgbG9jYWwgU2F2ZVBhdGggPSBMSUJfUEFUSC4uIlNpbXBsZUxpYi5sdWEiDQogICAgICAgICAgbG9jYWwgU2NyaXB0UGF0aCA9ICcvQm9ML1RDUFVwZGF0ZXIvR2V0U2NyaXB0NS5waHA/c2NyaXB0PScuLkJhc2U2NEVuY29kZTIoInJhdy5naXRodWJ1c2VyY29udGVudC5jb20vamFjaGljYW8vQm9ML21hc3Rlci9TaW1wbGVMaWIubHVhIikuLicmcmFuZD0nLi5tYXRoLnJhbmRvbSg5OTk5OTk5OSkNCiAgICAgICAgICBsb2NhbCBHb3RTY3JpcHQgPSBmYWxzZQ0KICAgICAgICAgIGxvY2FsIEx1YVNvY2tldCA9IG5pbA0KICAgICAgICAgIGxvY2FsIFNvY2tldCA9IG5pbA0KICAgICAgICAgIGxvY2FsIFNpemUgPSBuaWwNCiAgICAgICAgICBsb2NhbCBSZWN2U3RhcnRlZCA9IGZhbHNlDQogICAgICAgICAgbG9jYWwgUmVjZWl2ZSwgU3RhdHVzLCBTbmlwcGVkID0gbmlsLCBuaWwsIG5pbA0KICAgICAgICAgIGxvY2FsIFN0YXJ0ZWQgPSBmYWxzZQ0KICAgICAgICAgIGxvY2FsIEZpbGUgPSAiIg0KICAgICAgICAgIGxvY2FsIE5ld0ZpbGUgPSAiIg0KICAgICAgICAgIGlmIG5vdCBMdWFTb2NrZXQgdGhlbg0KICAgICAgICAgICAgICBMdWFTb2NrZXQgPSByZXF1aXJlKCJzb2NrZXQiKQ0KICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgU29ja2V0OmNsb3NlKCkNCiAgICAgICAgICAgICAgU29ja2V0ID0gbmlsDQogICAgICAgICAgICAgIFNpemUgPSBuaWwNCiAgICAgICAgICAgICAgUmVjdlN0YXJ0ZWQgPSBmYWxzZQ0KICAgICAgICAgIGVuZA0KICAgICAgICAgIFNvY2tldCA9IEx1YVNvY2tldC50Y3AoKQ0KICAgICAgICAgIGlmIG5vdCBTb2NrZXQgdGhlbg0KICAgICAgICAgICAgICBwcmludCgnU29ja2V0IEVycm9yJykNCiAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgIFNvY2tldDpzZXR0aW1lb3V0KDAsICdiJykNCiAgICAgICAgICAgICAgU29ja2V0OnNldHRpbWVvdXQoOTk5OTk5OTksICd0JykNCiAgICAgICAgICAgICAgU29ja2V0OmNvbm5lY3QoJ3N4LWJvbC5ldScsIDgwKQ0KICAgICAgICAgICAgICBTdGFydGVkID0gZmFsc2UNCiAgICAgICAgICAgICAgRmlsZSA9ICIiDQogICAgICAgICAgZW5kDQogICAgICAgICAgQWRkVGlja0NhbGxiYWNrKGZ1bmN0aW9uKCkNCiAgICAgICAgICAgICAgaWYgR290U2NyaXB0IHRoZW4gcmV0dXJuIGVuZA0KICAgICAgICAgICAgICBSZWNlaXZlLCBTdGF0dXMsIFNuaXBwZWQgPSBTb2NrZXQ6cmVjZWl2ZSgxMDI0KQ0KICAgICAgICAgICAgICBpZiBTdGF0dXMgPT0gJ3RpbWVvdXQnIGFuZCBub3QgU3RhcnRlZCB0aGVuDQogICAgICAgICAgICAgICAgICBTdGFydGVkID0gdHJ1ZQ0KICAgICAgICAgICAgICAgICAgcHJpbnQoIkRvd25sb2FkaW5nIGEgbGlicmFyeSBjYWxsZWQgU2ltcGxlTGliLiBQbGVhc2Ugd2FpdC4uLiIpDQogICAgICAgICAgICAgICAgICBTb2NrZXQ6c2VuZCgiR0VUICIuLlNjcmlwdFBhdGguLiIgSFRUUC8xLjFcclxuSG9zdDogc3gtYm9sLmV1XHJcblxyXG4iKQ0KICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgaWYgKFJlY2VpdmUgb3IgKCNTbmlwcGVkID4gMCkpIGFuZCBub3QgUmVjdlN0YXJ0ZWQgdGhlbg0KICAgICAgICAgICAgICAgICAgUmVjdlN0YXJ0ZWQgPSB0cnVlDQogICAgICAgICAgICAgIGVuZA0KICANCiAgICAgICAgICAgICAgRmlsZSA9IEZpbGUgLi4gKFJlY2VpdmUgb3IgU25pcHBlZCkNCiAgICAgICAgICAgICAgaWYgRmlsZTpmaW5kKCc8L3NpJy4uJ3plPicpIHRoZW4NCiAgICAgICAgICAgICAgICAgIGlmIG5vdCBTaXplIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICBTaXplID0gdG9udW1iZXIoRmlsZTpzdWIoRmlsZTpmaW5kKCc8c2knLi4nemU+JykgKyA2LCBGaWxlOmZpbmQoJzwvc2knLi4nemU+JykgLSAxKSkNCiAgICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICAgICAgaWYgRmlsZTpmaW5kKCc8c2NyJy4uJ2lwdD4nKSB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgbG9jYWwgXywgU2NyaXB0RmluZCA9IEZpbGU6ZmluZCgnPHNjcicuLidpcHQ+JykNCiAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBTY3JpcHRFbmQgPSBGaWxlOmZpbmQoJzwvc2NyJy4uJ2lwdD4nKQ0KICAgICAgICAgICAgICAgICAgICAgIGlmIFNjcmlwdEVuZCB0aGVuIFNjcmlwdEVuZCA9IFNjcmlwdEVuZCAtIDEgZW5kDQogICAgICAgICAgICAgICAgICAgICAgbG9jYWwgRG93bmxvYWRlZFNpemUgPSBGaWxlOnN1YihTY3JpcHRGaW5kICsgMSxTY3JpcHRFbmQgb3IgLTEpOmxlbigpDQogICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgIGlmIEZpbGU6ZmluZCgnPC9zY3InLi4naXB0PicpIHRoZW4NCiAgICAgICAgICAgICAgICAgIGxvY2FsIGEsYiA9IEZpbGU6ZmluZCgnXHJcblxyXG4nKQ0KICAgICAgICAgICAgICAgICAgRmlsZSA9IEZpbGU6c3ViKGEsLTEpDQogICAgICAgICAgICAgICAgICBOZXdGaWxlID0gJycNCiAgICAgICAgICAgICAgICAgIGZvciBsaW5lLGNvbnRlbnQgaW4gaXBhaXJzKEZpbGU6c3BsaXQoJ1xuJykpIGRvDQogICAgICAgICAgICAgICAgICAgICAgaWYgY29udGVudDpsZW4oKSA+IDUgdGhlbg0KICAgICAgICAgICAgICAgICAgICAgICAgICBOZXdGaWxlID0gTmV3RmlsZSAuLiBjb250ZW50DQogICAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICAgIGxvY2FsIEhlYWRlckVuZCwgQ29udGVudFN0YXJ0ID0gTmV3RmlsZTpmaW5kKCc8c2MnLi4ncmlwdD4nKQ0KICAgICAgICAgICAgICAgICAgbG9jYWwgQ29udGVudEVuZCwgXyA9IE5ld0ZpbGU6ZmluZCgnPC9zY3InLi4naXB0PicpDQogICAgICAgICAgICAgICAgICBpZiBub3QgQ29udGVudFN0YXJ0IG9yIG5vdCBDb250ZW50RW5kIHRoZW4NCiAgICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBuZXdmID0gTmV3RmlsZTpzdWIoQ29udGVudFN0YXJ0ICsgMSxDb250ZW50RW5kIC0gMSkNCiAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBuZXdmID0gbmV3Zjpnc3ViKCdccicsJycpDQogICAgICAgICAgICAgICAgICAgICAgaWYgbmV3ZjpsZW4oKSB+PSBTaXplIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuDQogICAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgICAgICAgbG9jYWwgbmV3ZiA9IEJhc2U2NERlY29kZShuZXdmKQ0KICAgICAgICAgICAgICAgICAgICAgIGlmIHR5cGUobG9hZChuZXdmKSkgfj0gJ2Z1bmN0aW9uJyB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBmID0gaW8ub3BlbihTYXZlUGF0aCwgIncrYiIpDQogICAgICAgICAgICAgICAgICAgICAgICAgIGY6d3JpdGUobmV3ZikNCiAgICAgICAgICAgICAgICAgICAgICAgICAgZjpjbG9zZSgpDQogICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCJSZXF1aXJlZCBsaWJyYXJ5IGRvd25sb2FkZWQuIFBsZWFzZSByZWxvYWQgd2l0aCAyeCBGOS4iKQ0KICAgICAgICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgICBHb3RTY3JpcHQgPSB0cnVlDQogICAgICAgICAgICAgIGVuZA0KICAgICAgICAgIGVuZCkNCiAgICAgICAgICByZXR1cm4gZmFsc2UNCiAgICAgIGVuZA0KICBlbmQNCiAgDQogICAtLS0vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XFwtLS0NCi0tfHwgPiBPcmJXYWxrcyAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fC0tDQotLS1cXD09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ly8tLS0NCiAgDQogIGZ1bmN0aW9uIFZpa3RvcjpmaW5kb3Jid2Fsa2VyKCkNCiAgIGlmIF9HLlJlYm9ybl9Mb2FkZWQgdGhlbg0KICAgICAgU0FDPXRydWUgYW5kDQogICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+U2lkYXMgQXV0byBDYXJyeSBoYXMgYmVlbiBmb3VuZCIpIGVuZCwgMikNCiAgICAgICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+U2lkYXMgQXV0byBDYXJyeSBpbnRlZ3JhdGlvbiBoYXMgYmVlbiBmaW5pc2hlZCBzdWNjZXNmdWxseSIpIGVuZCwgOCkNCiAgICBlbHNlaWYgbm90IF9HLlJlYm9ybl9Mb2FkZWQgYW5kIEZpbGVFeGlzdChMSUJfUEFUSCAuLiAiU3hPcmJXYWxrLmx1YSIpIHRoZW4NCiAgICAgIFN4T3JiPXRydWUgYW5kIA0KICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj4gU3hPcmJXYWxrIGhhcyBiZWVuIGZvdW5kIikgZW5kLCAyKQ0KICAgICAgICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBwcmludCgiPGZvbnQgY29sb3I9XCIjRkYwMDAwXCI+PGI+ICIuLlNjcmlwdG5hbWUuLiIgLSA8L2I+PC9mb250Pjxmb250IGNvbG9yPVwiI0ZGRkZGRlwiPiBTeE9yYldhbGsgaW50ZWdyYXRpb24gaGFzIGJlZW4gZmluaXNoZWQgc3VjY2VzZnVsbHkiKSBlbmQsIDQpDQogICAgICByZXF1aXJlKCJTeE9yYldhbGsiKQ0KICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiU3hPcmJXYWxrIiwib3JiV2FsayIpIGVuZCw1KQ0KICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBfRy5TeE9yYjpMb2FkVG9NZW51KHNlbGYuQ29uZmlnLm9yYldhbGspIGVuZCw1KQ0KICAgIGVsc2VpZiBTQUN+PXRydWUgYW5kIFN4T3Jifj0gdHJ1ZSB0aGVuDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgICBwKCJTeE9yYiBvciBTQUM6UiBpcyByZXF1aXJlZC4iKQ0KICAgICAgcCgiPT09PT09PT09PT09PT09PT0iKQ0KICAgICAgcCgiPT09PT09PT09PT09PT09PT0iKQ0KICAgIGVuZA0KICBlbmQNCiAgICBmdW5jdGlvbiBBa2FsaTpmaW5kb3Jid2Fsa2VyKCkNCmlmIF9HLlJlYm9ybl9Mb2FkZWQgdGhlbg0KICAgICAgU0FDPXRydWUgYW5kDQogICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+U2lkYXMgQXV0byBDYXJyeSBoYXMgYmVlbiBmb3VuZCIpIGVuZCwgMikNCiAgICAgICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+U2lkYXMgQXV0byBDYXJyeSBpbnRlZ3JhdGlvbiBoYXMgYmVlbiBmaW5pc2hlZCBzdWNjZXNmdWxseSIpIGVuZCwgOCkNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDIyIiwgIkN1cnJlbnQgT3Jid2Fsa2VyOiAgICAgICAgICAgICAgICAgICAgICBTaWRhcyBBdXRvIENhcnJ5IiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm8zIiwgIl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveCIsICIgICAgICAgICAgICAgICAiLi5TY3JpcHRuYW1lLi4iIiwgU0NSSVBUX1BBUkFNX0lORk8sICIiKSANCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDIiLCAiICAgICAgICAgICAgICAgICBTY3JpcHQgVmVyc2lvbjogICIuLlZlcnNpb24uLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3g2IiwgIiAgICAgICAgICAgIFNjcmlwdCB3YXMgbWFkZSBieSAgIi4uQXV0aG9yLi4gIiAgICAgICAgICIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94NSIsICIgICAgICAgTGVhdWdlIE9mIExlZ2VuZHMgVmVyc2lvbjogICIuLkxWZXJzaW9uLi4gIiAgICAgICAgICIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKSAgIA0KICAgIGVsc2VpZiBub3QgX0cuUmVib3JuX0xvYWRlZCBhbmQgRmlsZUV4aXN0KExJQl9QQVRIIC4uICJTeE9yYldhbGsubHVhIikgdGhlbg0KICAgICAgU3hPcmI9dHJ1ZSBhbmQgDQogICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBwcmludCgiPGZvbnQgY29sb3I9XCIjRkYwMDAwXCI+PGI+ICIuLlNjcmlwdG5hbWUuLiIgLSA8L2I+PC9mb250Pjxmb250IGNvbG9yPVwiI0ZGRkZGRlwiPiBTeE9yYldhbGsgaGFzIGJlZW4gZm91bmQiKSBlbmQsIDIpDQogICAgICAgICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+IFN4T3JiV2FsayBpbnRlZ3JhdGlvbiBoYXMgYmVlbiBmaW5pc2hlZCBzdWNjZXNmdWxseSIpIGVuZCwgNCkNCiAgICAgIHJlcXVpcmUoIlN4T3JiV2FsayIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3gyMiIsICJDdXJyZW50IE9yYndhbGtlcjogICAgICAgICAgICAgICAgICAgICAgICAgICAgIFN4T3JiV2FsayIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvMyIsICJfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3giLCAiICAgICAgICAgICAgICAgIi4uU2NyaXB0bmFtZS4uIiIsIFNDUklQVF9QQVJBTV9JTkZPLCAiIikgDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3gyIiwgIiAgICAgICAgICAgICAgICAgU2NyaXB0IFZlcnNpb246ICAiLi5WZXJzaW9uLi4gIiAgICAgICAgICIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94NiIsICIgICAgICAgICAgICBTY3JpcHQgd2FzIG1hZGUgYnkgICIuLkF1dGhvci4uICIgICAgICAgICAiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDUiLCAiICAgICAgIExlYXVnZSBPZiBMZWdlbmRzIFZlcnNpb246ICAiLi5MVmVyc2lvbi4uICIgICAgICAgICAiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikgICANCiAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIlN4T3JiV2FsayIsIm9yYldhbGsiKSBlbmQsNSkNCiAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgX0cuU3hPcmI6TG9hZFRvTWVudShzZWxmLkNvbmZpZy5vcmJXYWxrKSBlbmQsNSkNCiAgICBlbHNlaWYgU0FDfj10cnVlIGFuZCBTeE9yYn49IHRydWUgdGhlbg0KICAgICAgcCgiPT09PT09PT09PT09PT09PT0iKQ0KICAgICAgcCgiPT09PT09PT09PT09PT09PT0iKQ0KICAgICAgcCgiU3hPcmIgb3IgU0FDOlIgaXMgcmVxdWlyZWQuIikNCiAgICAgIHAoIj09PT09PT09PT09PT09PT09IikNCiAgICAgIHAoIj09PT09PT09PT09PT09PT09IikNCiAgICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIERpYW5hOmZpbmRvcmJ3YWxrZXIoKQ0KaWYgX0cuUmVib3JuX0xvYWRlZCB0aGVuDQogICAgICBTQUM9dHJ1ZSBhbmQNCiAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj5TaWRhcyBBdXRvIENhcnJ5IGhhcyBiZWVuIGZvdW5kIikgZW5kLCAyKQ0KICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj5TaWRhcyBBdXRvIENhcnJ5IGludGVncmF0aW9uIGhhcyBiZWVuIGZpbmlzaGVkIHN1Y2Nlc2Z1bGx5IikgZW5kLCA4KQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94MjIiLCAiQ3VycmVudCBPcmJ3YWxrZXI6ICAgICAgICAgICAgICAgICAgICAgIFNpZGFzIEF1dG8gQ2FycnkiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mbzMiLCAiX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXyIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94IiwgIiAgICAgICAgICAgICAgICIuLlNjcmlwdG5hbWUuLiIiLCBTQ1JJUFRfUEFSQU1fSU5GTywgIiIpIA0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94MiIsICIgICAgICAgICAgICAgICAgIFNjcmlwdCBWZXJzaW9uOiAgIi4uVmVyc2lvbi4uICIgICAgICAgICAiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDYiLCAiICAgICAgICAgICAgU2NyaXB0IHdhcyBtYWRlIGJ5ICAiLi5BdXRob3IuLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3g1IiwgIiAgICAgICBMZWF1Z2UgT2YgTGVnZW5kcyBWZXJzaW9uOiAgIi4uTFZlcnNpb24uLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpICAgDQogICAgZWxzZWlmIG5vdCBfRy5SZWJvcm5fTG9hZGVkIGFuZCBGaWxlRXhpc3QoTElCX1BBVEggLi4gIlN4T3JiV2Fsay5sdWEiKSB0aGVuDQogICAgICBTeE9yYj10cnVlIGFuZCANCiAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+IFN4T3JiV2FsayBoYXMgYmVlbiBmb3VuZCIpIGVuZCwgMikNCiAgICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj4gU3hPcmJXYWxrIGludGVncmF0aW9uIGhhcyBiZWVuIGZpbmlzaGVkIHN1Y2Nlc2Z1bGx5IikgZW5kLCA0KQ0KICAgICAgcmVxdWlyZSgiU3hPcmJXYWxrIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDIyIiwgIkN1cnJlbnQgT3Jid2Fsa2VyOiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3hPcmJXYWxrIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm8zIiwgIl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveCIsICIgICAgICAgICAgICAgICAiLi5TY3JpcHRuYW1lLi4iIiwgU0NSSVBUX1BBUkFNX0lORk8sICIiKSANCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDIiLCAiICAgICAgICAgICAgICAgICBTY3JpcHQgVmVyc2lvbjogICIuLlZlcnNpb24uLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3g2IiwgIiAgICAgICAgICAgIFNjcmlwdCB3YXMgbWFkZSBieSAgIi4uQXV0aG9yLi4gIiAgICAgICAgICIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94NSIsICIgICAgICAgTGVhdWdlIE9mIExlZ2VuZHMgVmVyc2lvbjogICIuLkxWZXJzaW9uLi4gIiAgICAgICAgICIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKSAgIA0KICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiU3hPcmJXYWxrIiwib3JiV2FsayIpIGVuZCw1KQ0KICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBfRy5TeE9yYjpMb2FkVG9NZW51KHNlbGYuQ29uZmlnLm9yYldhbGspIGVuZCw1KQ0KICAgIGVsc2VpZiBTQUN+PXRydWUgYW5kIFN4T3Jifj0gdHJ1ZSB0aGVuDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgICBwKCJTeE9yYiBvciBTQUM6UiBpcyByZXF1aXJlZC4iKQ0KICAgICAgcCgiPT09PT09PT09PT09PT09PT0iKQ0KICAgICAgcCgiPT09PT09PT09PT09PT09PT0iKQ0KICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGlzc2FuZHJhOmZpbmRvcmJ3YWxrZXIoKQ0KICAgaWYgX0cuUmVib3JuX0xvYWRlZCB0aGVuDQogICAgICBTQUM9dHJ1ZSBhbmQNCiAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj5TaWRhcyBBdXRvIENhcnJ5IGhhcyBiZWVuIGZvdW5kIikgZW5kLCAyKQ0KICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj5TaWRhcyBBdXRvIENhcnJ5IGludGVncmF0aW9uIGhhcyBiZWVuIGZpbmlzaGVkIHN1Y2Nlc2Z1bGx5IikgZW5kLCA4KQ0KICAgIGVsc2VpZiBub3QgX0cuUmVib3JuX0xvYWRlZCBhbmQgRmlsZUV4aXN0KExJQl9QQVRIIC4uICJTeE9yYldhbGsubHVhIikgdGhlbg0KICAgICAgU3hPcmI9dHJ1ZSBhbmQgDQogICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBwcmludCgiPGZvbnQgY29sb3I9XCIjRkYwMDAwXCI+PGI+ICIuLlNjcmlwdG5hbWUuLiIgLSA8L2I+PC9mb250Pjxmb250IGNvbG9yPVwiI0ZGRkZGRlwiPiBTeE9yYldhbGsgaGFzIGJlZW4gZm91bmQiKSBlbmQsIDIpDQogICAgICAgICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+IFN4T3JiV2FsayBpbnRlZ3JhdGlvbiBoYXMgYmVlbiBmaW5pc2hlZCBzdWNjZXNmdWxseSIpIGVuZCwgNCkNCiAgICAgIHJlcXVpcmUoIlN4T3JiV2FsayIpDQogICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJTeE9yYldhbGsiLCJvcmJXYWxrIikgZW5kLDUpDQogICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIF9HLlN4T3JiOkxvYWRUb01lbnUoc2VsZi5Db25maWcub3JiV2FsaykgZW5kLDUpDQogICAgZWxzZWlmIFNBQ349dHJ1ZSBhbmQgU3hPcmJ+PSB0cnVlIHRoZW4NCiAgICAgIHAoIj09PT09PT09PT09PT09PT09IikNCiAgICAgIHAoIj09PT09PT09PT09PT09PT09IikNCiAgICAgIHAoIlN4T3JiIG9yIFNBQzpSIGlzIHJlcXVpcmVkLiIpDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOmZpbmRvcmJ3YWxrZXIoKQ0KICAgaWYgX0cuUmVib3JuX0xvYWRlZCB0aGVuDQogICAgICBTQUM9dHJ1ZSBhbmQNCiAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj5TaWRhcyBBdXRvIENhcnJ5IGhhcyBiZWVuIGZvdW5kIikgZW5kLCAyKQ0KICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj5TaWRhcyBBdXRvIENhcnJ5IGludGVncmF0aW9uIGhhcyBiZWVuIGZpbmlzaGVkIHN1Y2Nlc2Z1bGx5IikgZW5kLCA4KQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94MjIiLCAiQ3VycmVudCBPcmJ3YWxrZXI6ICAgICAgICAgICAgICAgICAgICAgIFNpZGFzIEF1dG8gQ2FycnkiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mbzMiLCAiX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXyIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94IiwgIiAgICAgICAgICAgICAgICIuLlNjcmlwdG5hbWUuLiIiLCBTQ1JJUFRfUEFSQU1fSU5GTywgIiIpIA0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94MiIsICIgICAgICAgICAgICAgICAgIFNjcmlwdCBWZXJzaW9uOiAgIi4uVmVyc2lvbi4uICIgICAgICAgICAiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDYiLCAiICAgICAgICAgICAgU2NyaXB0IHdhcyBtYWRlIGJ5ICAiLi5BdXRob3IuLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3g1IiwgIiAgICAgICBMZWF1Z2UgT2YgTGVnZW5kcyBWZXJzaW9uOiAgIi4uTFZlcnNpb24uLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpICAgDQogICAgZWxzZWlmIG5vdCBfRy5SZWJvcm5fTG9hZGVkIGFuZCBGaWxlRXhpc3QoTElCX1BBVEggLi4gIlN4T3JiV2Fsay5sdWEiKSB0aGVuDQogICAgICBTeE9yYj10cnVlIGFuZCANCiAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+IFN4T3JiV2FsayBoYXMgYmVlbiBmb3VuZCIpIGVuZCwgMikNCiAgICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj4gU3hPcmJXYWxrIGludGVncmF0aW9uIGhhcyBiZWVuIGZpbmlzaGVkIHN1Y2Nlc2Z1bGx5IikgZW5kLCA0KQ0KICAgICAgcmVxdWlyZSgiU3hPcmJXYWxrIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDIyIiwgIkN1cnJlbnQgT3Jid2Fsa2VyOiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3hPcmJXYWxrIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm8zIiwgIl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveCIsICIgICAgICAgICAgICAgICAiLi5TY3JpcHRuYW1lLi4iIiwgU0NSSVBUX1BBUkFNX0lORk8sICIiKSANCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDIiLCAiICAgICAgICAgICAgICAgICBTY3JpcHQgVmVyc2lvbjogICIuLlZlcnNpb24uLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3g2IiwgIiAgICAgICAgICAgIFNjcmlwdCB3YXMgbWFkZSBieSAgIi4uQXV0aG9yLi4gIiAgICAgICAgICIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94NSIsICIgICAgICAgTGVhdWdlIE9mIExlZ2VuZHMgVmVyc2lvbjogICIuLkxWZXJzaW9uLi4gIiAgICAgICAgICIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKSAgIA0KICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiU3hPcmJXYWxrIiwib3JiV2FsayIpIGVuZCw1KQ0KICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBfRy5TeE9yYjpMb2FkVG9NZW51KHNlbGYuQ29uZmlnLm9yYldhbGspIGVuZCw1KQ0KICAgIGVsc2VpZiBTQUN+PXRydWUgYW5kIFN4T3Jifj0gdHJ1ZSB0aGVuDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgICBwKCJTeE9yYiBvciBTQUM6UiBpcyByZXF1aXJlZC4iKQ0KICAgICAgcCgiPT09PT09PT09PT09PT09PT0iKQ0KICAgICAgcCgiPT09PT09PT09PT09PT09PT0iKQ0KICAgIGVuZA0KICBlbmQNCiANCiBmdW5jdGlvbiBPblVubG9hZCgpDQogIGlmIFZJUF9VU0VSIGFuZCBub3QgRmFrZUxvYWQgIHRoZW4NCiAgICBTZW5kU2tpblBhY2tldChteUhlcm8uY2hhck5hbWUsIG5pbCwgbXlIZXJvLm5ldHdvcmtJRCkNCiAgZW5kDQplbmQ=="), nil, "bt", _ENV))()
-- easy c/p