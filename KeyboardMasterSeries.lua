
--[[
One Click to Challenger
Keyboard Master Series by Ensuluyn
Current Leauge Of Legends Version :5.23
Current Script Version :2.09
Last Update: 06.12.2015
--Credits to Nebelwolfi for mentoring <3
]]

assert(load(Base64Decode("DQogIC0tLS8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cXC0tLQ0KLS18fCA+IFNjcmlwdCBTdGFydCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8LS0NCi0tLVxcPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0vLy0tLQ0KICANCiAgbG9jYWwgVmVyc2lvbiA9ICIyLjA5IiAgDQogIGxvY2FsIExWZXJzaW9uID0gIjUuMjMiDQogIGxvY2FsIFNjcmlwdG5hbWUgPSAiS2V5Ym9hcmQgTWFzdGVyIFNlcmllcyINCiAgbG9jYWwgQXV0aG9yID0gIkVuc3VsdXluIg0KICBsb2NhbCBsaXN0ID0gIkxlYmxhbmMgLCBMaXNzYW5kcmEgLCBWaWt0b3IsIEFrYWxpLCBEaWFuYSINCiAgbG9jYWwgbGluayA9ICJHbyB0byBodHRwOi8vZm9ydW0uYm90b2ZsZWdlbmRzLmNvbS9mb3J1bS8yMC1jaGFtcGlvbi1zY3JpcHRzLyB0aGVuIHlvdSBjYW4gc2VlIG15IHRvcGljICIuLlNjcmlwdG5hbWUuLiIgb24gdGhlIGZpcnN0IG9yIHNlY29uZCBwYWdlLiINCiAgbG9jYWwgZGF0ZSA9ICIwNi4xMi4yMDE1Ig0KICBnbG9iYWxfdGlja3MgPSAwDQogIGxvY2FsIGxhc3RUaW1lVGlja0NhbGxlZCA9IDANCiBsb2NhbCBGYWtlTG9hZCA9IGZhbHNlDQogICBpZiBGYWtlTG9hZCB0aGVuDQogIGxvY2FsIHNraW5zUEIgPSB7fTsNCiAgbG9jYWwgc2tpbk9iamVjdFBvcyA9IG5pbDsNCiAgbG9jYWwgc2tpbkhlYWRlciA9IG5pbDsNCiAgbG9jYWwgZGlzcGVsbEhlYWRlciA9IG5pbDsNCiAgbG9jYWwgc2tpbkggPSBuaWw7DQogIGxvY2FsIHNraW5IUG9zID0gbmlsOw0KICBlbmQNCiAgICAgIC0tLS8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cXC0tLQ0KLS18fCA+IEF1dG8gVXBkYXRlICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwtLQ0KLS0tXFw9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PS8vLS0tDQogIGxvY2FsIHZlcnNpb24gPSAyLjA5DQogIGxvY2FsIGF1dGhvciA9ICJFbnN1bHV5biINCiAgbG9jYWwgU0NSSVBUX05BTUUgPSAiS2V5Ym9hcmRNYXN0ZXJTZXJpZXMiDQogIGxvY2FsIEFVVE9VUERBVEUgPSB0cnVlDQogIGxvY2FsIFVQREFURV9IT1NUID0gInJhdy5naXRodWIuY29tIg0KICBsb2NhbCBVUERBVEVfUEFUSCA9ICIvTG9uc2VtYXJpYS9zY3JpcHRzL21hc3Rlci9LZXlib2FyZE1hc3RlclNlcmllcy5sdWEiLi4iP3JhbmQ9Ii4ubWF0aC5yYW5kb20oMSwxMDAwMCkNCiAgbG9jYWwgVVBEQVRFX0ZJTEVfUEFUSCA9IFNDUklQVF9QQVRILi5HZXRDdXJyZW50RW52KCkuRklMRV9OQU1FDQogIGxvY2FsIFVQREFURV9VUkwgPSAiaHR0cHM6Ly8iLi5VUERBVEVfSE9TVC4uVVBEQVRFX1BBVEgNCiAgZnVuY3Rpb24gU2F5KHRleHQpDQogICAgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPktleWJvYXJkIE1hc3RlciBTZXJpZXM6PC9iPjwvZm9udD4gPGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+IiAuLiB0ZXh0IC4uICI8L2ZvbnQ+IikNCiAgZW5kDQogIGlmIEFVVE9VUERBVEUgdGhlbg0KICAgIGxvY2FsIFNlcnZlckRhdGEgPSBHZXRXZWJSZXN1bHQoVVBEQVRFX0hPU1QsICIvTG9uc2VtYXJpYS9zY3JpcHRzL21hc3Rlci92ZXJzaW9uL0J1bmRsZS52ZXJzaW9uIikNCiAgICBpZiBTZXJ2ZXJEYXRhIHRoZW4NCiAgICAgIFNlcnZlclZlcnNpb24gPSB0eXBlKHRvbnVtYmVyKFNlcnZlckRhdGEpKSA9PSAibnVtYmVyIiBhbmQgdG9udW1iZXIoU2VydmVyRGF0YSkgb3IgbmlsDQogICAgICBpZiBTZXJ2ZXJWZXJzaW9uIHRoZW4NCiAgICAgICAgaWYgdG9udW1iZXIodmVyc2lvbikgPCBTZXJ2ZXJWZXJzaW9uIHRoZW4NCiAgICAgICAgICBTYXkoIk5ldyB2ZXJzaW9uIGF2YWlsYWJsZSAiLi5TZXJ2ZXJWZXJzaW9uKQ0KICAgICAgICAgIFNheSgiVXBkYXRpbmcsIHBsZWFzZSBkb24ndCBwcmVzcyBGOSIpDQogICAgICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBEb3dubG9hZEZpbGUoVVBEQVRFX1VSTCwgVVBEQVRFX0ZJTEVfUEFUSCwgZnVuY3Rpb24gKCkgU2F5KCJTdWNjZXNzZnVsbHkgdXBkYXRlZC4gKCIuLnZlcnNpb24uLiIgPT4gIi4uU2VydmVyVmVyc2lvbi4uIiksIHByZXNzIEY5IHR3aWNlIHRvIGxvYWQgdGhlIHVwZGF0ZWQgdmVyc2lvbi4iKSBlbmQpIGVuZCwgMykNCiAgICAgICAgZWxzZQ0KICAgICAgICAgIFNheSgiLVdlbGNvbWUsIFlvdSBoYXZlIGdvdCB0aGUgbGF0ZXN0IHZlcnNpb24gKHYiLi5TZXJ2ZXJWZXJzaW9uLi4iKSBvZiAiLi5TY3JpcHRuYW1lLi4iICwgdXBkYXRlZCBhdCAoIi4uZGF0ZS4uIikgYnkgIiAuLiBhdXRob3IpDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgZWxzZSANCiAgICAgIFNheSgiRXJyb3IgZG93bmxvYWRpbmcgdmVyc2lvbiBpbmZvIikNCiAgICBlbmQNCiAgZW5kDQogICAgICAtLS0vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XFwtLS0NCi0tfHwgS2V5TWFzdGVyTGliIERvd25sb2FkICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fC0tDQotLS1cXD09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ly8tLS0NCiAgaWYgRmlsZUV4aXN0KExJQl9QQVRIIC4uICJLZXlib2FyZE1hc3RlckxpYi5sdWEiKSB0aGVuDQogICAgcmVxdWlyZSgiS2V5Ym9hcmRNYXN0ZXJMaWIiKQ0KICBlbHNlDQogIEZha2VMb2FkID0gdHJ1ZQ0KICAgIERlbGF5QWN0aW9uKERvd25sb2FkRmlsZSwgMCwgew0KICAgICAgImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9Mb25zZW1hcmlhL3NjcmlwdHMvbWFzdGVyL0tleWJvYXJkTWFzdGVyTGliLmx1YSIsDQogICAgICBMSUJfUEFUSC4uIlxcS2V5Ym9hcmRNYXN0ZXJMaWIubHVhIiwNCiAgICAgIGZ1bmN0aW9uICgpDQogICAgICBwcmludCgiPGZvbnQgY29sb3I9XCIjMDBGRkZGXCI+PGI+W0tleWJvYXJkTWFzdGVyTGliXTwvYj48L2ZvbnQ+IDxmb250IGNvbG9yPVwiI0ZGRkZGRlwiPktleWJvYXJkTWFzdGVyTGliLmx1YSBpcyBuZWNlc3NlcnksIHBsZWFzZSB3YWl0IHdoaWxlIGRvd25sb2FkaW5nLjwvZm9udD4iKQ0KICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKClwcmludCgiPGZvbnQgY29sb3I9XCIjMDBGRkZGXCI+PGI+W0tleWJvYXJkTWFzdGVyTGliXTwvYj48L2ZvbnQ+IDxmb250IGNvbG9yPVwiI0ZGRkZGRlwiPktleWJvYXJkTWFzdGVyTGliLmx1YSBoYXMgYmVlbiBkb3dubG9hZGVkLCBQbGVhc2UgcmVsb2FkICgyeEY5KTwvZm9udD4iKSBlbmQsIDUuNSkNCiAgICAgIGVuZA0KICAgIH0pDQogIGVuZA0KICAgIC0tLS8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cXC0tLQ0KLS18fCA+IE9ubG9hZCBGdW5jdGlvbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fC0tDQotLS1cXD09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ly8tLS0NCiAgZnVuY3Rpb24gT25Mb2FkKCkNCiAgICAgICAgICBpZiBub3QgUmVxdWlyZVNpbXBsZUxpYigpIHRoZW4gcmV0dXJuIGVuZA0KICAgICAgICAgIGl0ZW1maXgoKQ0KICAgICAgICAgICBpZiBfR1tteUhlcm8uY2hhck5hbWVdIHRoZW4NCiAgICAgICAgICAgICAgICAgIF9HW215SGVyby5jaGFyTmFtZV0oKQ0KICAgICAgICAgICAgICAgICAtLSBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+IFNraW4gSGFjayBjdXJyZW50bHkgZGlzYWJsZWQgdW50aWwgdGhlIG5leHQgdXBkYXRlIikgZW5kLCAxNCkNCiAgICAgICAgICBlbHNlDQogICAgICAgICAgIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjQ0JGNkZGXCI+IDpUaGlzIGNoYW1waW9uIGlzIG5vdCBzdXBwb3J0ZWQuIEN1cnJlbnRseSBzdXBwb3J0ZWQgY2hhbXBpb25zIGFyZTogIi4ubGlzdC4uIiAiICkNCiAgICAgICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjQ0JGNkZGXCI+RmVlbCBmcmVlIHRvIGNoZWNrIG15IGZvcnVtIHRvcGljIGFuZCBhc2sgYSBuZXcgY2hhbXBpb24gb3IgZ2l2ZSBmZWVkYmFjayIpIGVuZCwgMC41KQ0KICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNDQkY2RkZcIj4iLi5saW5rLi4iIikgZW5kLCAwLjUpDQogICAgICAgICAgZW5kDQogIGVuZA0KICAtLS0vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XFwtLS0NCi0tfHwgPiBMZWJsYW5jIFN0YXJ0LSBWYXJpYWJsZXMgICAgICAgICAgICAgICAgICAgICAgICAgIHx8LS0NCi0tLVxcPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0vLy0tLQ0KICBjbGFzcyAiTGVibGFuYyINCiAgZnVuY3Rpb24gTGVibGFuYzpfX2luaXQoKQ0KICBzZWxmLnRzPSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCA1MjUsIERBTUFHRV9QSFlTSUNBTCwgZmFsc2UsIHRydWUpDQogICAgc2VsZi50c3E9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDcwMCwgREFNQUdFX1BIWVNJQ0FMLCBmYWxzZSwgdHJ1ZSkNCiAgIHNlbGYudHN3PSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCA2MDAsIERBTUFHRV9NQUdJQywgZmFsc2UsIHRydWUpDQogICAgc2VsZi50c2U9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDkyNSwgREFNQUdFX01BR0lDLCBmYWxzZSwgdHJ1ZSkNCiAgICBzZWxmLnRzcj0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgOTI1LCBEQU1BR0VfTUFHSUMsIGZhbHNlLCB0cnVlKSANCiAgICBzZWxmLnRzZz0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgOTUwLCBEQU1BR0VfTUFHSUMsIGZhbHNlLCB0cnVlKSANCiAgICAgc2VsZi5RU3BlbGwgPSBfU3BlbGwoe1Nsb3QgPSBfUSwgRGFtYWdlTmFtZSA9ICJRIiwgUmFuZ2UgPSA3MDAsIFdpZHRoID0gMSwgRGVsYXkgPSAwLCBTcGVlZCA9IG1hdGguaHVnZSwgQ29sbGlzaW9uID0gZmFsc2UsIEFvZSA9IGZhbHNlLCBUeXBlID0gU1BFTExfVFlQRS5UQVJHRVRURUR9KQ0KICAgICBzZWxmLldTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9XLCBEYW1hZ2VOYW1lID0gIlciLCBSYW5nZSA9IDYwMCwgV2lkdGggPSAxMjUsIERlbGF5ID0gMC41LCBTcGVlZCA9IDEzMDAsIFJhZGl1cyA9IDI1MCAsIENvbGxpc2lvbiA9IGZhbHNlLCBBb2UgPSB0cnVlLCBUeXBlID0gU1BFTExfVFlQRS5UQVJHRVRURUR9KQ0KICAgICBzZWxmLkVTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9FLCBEYW1hZ2VOYW1lID0gIkUiLCBSYW5nZSA9IDkyNSwgV2lkdGggPSA1NSwgRGVsYXkgPSAwLjI1LCBTcGVlZCA9IDE2MDAsIENvbGxpc2lvbiA9IHRydWUsIEFvZSA9IGZhbHNlLCBUeXBlID0gU1BFTExfVFlQRS5MSU5FQVJ9KQ0KICAgICBzZWxmLlJTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9SLCBEYW1hZ2VOYW1lID0gIlIiLCBSYW5nZSA9NjAwLCBXaWR0aCA9IDEyNSwgRGVsYXkgPSAwLjUsIFNwZWVkID0gMTMwMCwgQ29sbGlzaW9uID0gZmFsc2UsIEFvZSA9IHRydWUsIFR5cGUgPSBTUEVMTF9UWVBFLlRBUkdFVFRFRH0pDQogICAgIHNlbGYuSWduaXRlID0gX1NwZWxsKHtTbG90ID0gRmluZFN1bW1vbmVyU2xvdCgic3VtbW9uZXJkb3QiKSwgRGFtYWdlTmFtZSA9ICJJR05JVEUiLCBSYW5nZSA9IDYwMCwgVHlwZSA9IFNQRUxMX1RZUEUuVEFSR0VUVEVEfSkNCiAgICAgc2VsZi5sZWJsYW5jVywgc2VsZi5sZWJsYW5jSW1hZ2UsIHNlbGYuY2xvbmVJZCA9IG5pbCwgbmlsLCBuaWwNCiAgLS18PiBNaW5pb24gTWFuYWdlcnMNCiAgICAgIHNlbGYuZW5lbXlNaW5pb25zICAgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9FTkVNWSwgICA2NTAsIG15SGVybywgTUlOSU9OX1NPUlRfTUFYSEVBTFRIX0RFQykNCiAgICAgIHNlbGYuYWxseU1pbmlvbnMgICAgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9BTExZLCAgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgICAgc2VsZi5qdW5nbGVNaW5pb25zICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX0pVTkdMRSwgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgICAgc2VsZi5vdGhlck1pbmlvbnMgICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX09USEVSLCAgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgICAgc2VsZjpMb2FkTWVudSgpDQogICAgICAgIHNlbGY6ZmluZG9yYndhbGtlcigpDQogICAgICAgICAgTGFzdF9MZXZlbFNwZWxsID0gMA0KICAgICAgICBDbG9jayA9IG9zLmNsb2NrKCkNCiAgICAgICAgIA0KICAgICAgICBBZGRUaWNrQ2FsbGJhY2soZnVuY3Rpb24oKSBzZWxmOlRpY2soKSBlbmQpDQogICAgQWRkRHJhd0NhbGxiYWNrKGZ1bmN0aW9uKCkgc2VsZjpEcmF3KCkgZW5kKQ0KICAgIEFkZE1zZ0NhbGxiYWNrKGZ1bmN0aW9uKG1zZyxLZXkpIHNlbGY6V25kTXNnKG1zZyxLZXkpIGVuZCkNCiAgICAtLUFkZEFuaW1hdGlvbkNhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIGFuaW1hdGlvbikgc2VsZjpBbmltYXRpb24odW5pdCwgYW5pbWF0aW9uKSBlbmQpDQogICAgLS1BZGRQcm9jZXNzU3BlbGxDYWxsYmFjayhmdW5jdGlvbih1bml0LCBzcGVsbCkgc2VsZjpQcm9jZXNzU3BlbGwodW5pdCwgc3BlbGwpIGVuZCkNCiAgICAtLUFkZEFwcGx5QnVmZkNhbGxiYWNrKGZ1bmN0aW9uKHNvdXJjZSwgdW5pdCwgYnVmZikgc2VsZjpPbkFwcGx5QnVmZihzb3VyY2UsIHVuaXQsIGJ1ZmYpIGVuZCkNCiAgICAtLUFkZFVwZGF0ZUJ1ZmZDYWxsYmFjayhmdW5jdGlvbih1bml0LCBidWZmLCBzdGFja3MpIHNlbGY6VXBkYXRlQnVmZih1bml0LCBidWZmLCBzdGFja3MpIGVuZCkNCiAgICAtLUFkZFJlbW92ZUJ1ZmZDYWxsYmFjayhmdW5jdGlvbih1bml0LCBidWZmKSBzZWxmOk9uUmVtb3ZlQnVmZih1bml0LCBidWZmKSBlbmQpIA0KICAgICAgZW5kDQotLS0vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XFwtLS0NCi0tfHwgPiBMZWJsYW5jIE1lbnUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8LS0NCi0tLVxcPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0vLy0tLQ0KICAgICAgZnVuY3Rpb24gTGVibGFuYzpMb2FkTWVudSgpDQogICAgICBzZWxmLkNvbmZpZz1zY3JpcHRDb25maWcoIiIuLlNjcmlwdG5hbWUuLiIgWyIgLi4gbXlIZXJvLmNoYXJOYW1lLi4iXSIgLCJtZW51IikNCiAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkNvbWJvIFNldHRpbmdzIiwgImNvbWJvIikNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZVEiLCAiVXNlIFEgaW4gQ29tYm8iLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VXIiwgIlVzZSBXIGluIENvbWJvIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlRSIsICJVc2UgRSBpbiBjb21ibyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZVIiLCAiVXNlIFIgaW4gY29tYm8iLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VJIiwgIlVzZSBJZ25pdGUgaWYgdGFyZ2V0IGtpbGxhYmxlIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICAtLXNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJnYXBjbG9zZSIsICJVc2UgVyBhcyBhIGdhcGNsb3NlICggQmV0YSApIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCBmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oImxvZ2ljIiwgIkNvbWJvIGxvZ2ljIiwgU0NSSVBUX1BBUkFNX0xJU1QsIDEsIHsiUT5FPlc+UiIsICJRPlI+RT5XIiwgIkU+UT5XPlIiLCAiRT5XPlE+UiIgLCJSYW5kb20gU2tpbGwgT3JkZXIifSkNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkU3ViTWVudSgiVyBTa2lsbCB0dXJuIGJhY2sgc2V0dGluZ3MiLCAidHVybnciKQ0KICAgICAgICBzZWxmLkNvbmZpZy5jb21iby50dXJudzphZGRQYXJhbSgidzEiLCJUdXJuIGJhY2sgdG8gVyBzcG90IG9uIFE+RT5XPlIgbW9kZSAiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm8udHVybnc6YWRkUGFyYW0oIncyIiwiVHVybiBiYWNrIHRvIFcgc3BvdCBvbiBRPlI+RT5XIG1vZGUgIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvLnR1cm53OmFkZFBhcmFtKCJ3MyIsIlR1cm4gYmFjayB0byBXIHNwb3Qgb24gRT5RPlc+UiBtb2RlICIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5jb21iby50dXJudzphZGRQYXJhbSgidzQiLCJUdXJuIGJhY2sgdG8gVyBzcG90IG9uIEU+Vz5RPlIgbW9kZSAiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm8udHVybnc6YWRkUGFyYW0oInc1IiwiVHVybiBiYWNrIHRvIFcgc3BvdCBvbiBSYW5kb20gU2tpbGwgT3JkZXIgbW9kZSAiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oIk1hbmEiLCJNYW5hIE1hbmFnZXIgJSIsU0NSSVBUX1BBUkFNX1NMSUNFLCAxMCwgMTAsIDEwMCwgMCkNCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkhhcmFzcyBTZXR0aW5ncyIsICJoYXJhc3MiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6YWRkUGFyYW0oInVzZVEiLCAiSGFyYXNzIFdpdGggUSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuaGFyYXNzOmFkZFBhcmFtKCJ1c2VXIiwgIkhhcmFzcyBXaXRoIFciLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDEwLCAxMCwgMTAwLCAwKQ0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiTGFuZUNsZWFyIFNldHRpbmdzIiwibGFuZWNsZWFyIikNCiAgICAgICAgc2VsZi5Db25maWcubGFuZWNsZWFyOmFkZFBhcmFtKCJ1c2VRIiwiVXNlIFEgb24gTGFuZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcubGFuZWNsZWFyOmFkZFBhcmFtKCJ1c2VXIiwiVXNlIFcgb24gTGFuZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcubGFuZWNsZWFyOmFkZFBhcmFtKCJ1c2VSIiwiVXNlIFIgb24gTGFuZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLmxhbmVjbGVhcjphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDMwLCAxMCwgMTAwLCAwKQ0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiSnVuZ2xlQ2xlYXIgU2V0dGluZ3MiLCJqdW5nbGVjbGVhciIpDQogICAgICAgIHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyOmFkZFBhcmFtKCJ1c2VRIiwiVXNlIFEgb24ganVuZ2xlY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhcjphZGRQYXJhbSgidXNlVyIsIlVzZSBXIG9uIExhbmVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyOmFkZFBhcmFtKCJ1c2VFIiwiVXNlIEUgb24ganVuZ2xlY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhcjphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDMwLCAxMCwgMTAwLCAwKQ0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiRXNjYXBlIFNldHRpbmdzIiwiZXNjYXBlIikNCiAgICAgICAgc2VsZi5Db25maWcuZXNjYXBlOmFkZFBhcmFtKCJ1c2VXIiwiVXNlIFcgV2hpbGUgRXNjYXBlIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuZXNjYXBlOmFkZFBhcmFtKCJ1c2VSIiwiVXNlIFIgV2hpbGUgRXNjYXBlIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgDQogICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJLaWxsU3RlYWwgU2V0dGluZ3MiLCAia2lsbHN0ZWFsIikNCiAgICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJrcyIsIktpbGxzdGVhbCBPbi9PZmYiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZVEiLCAiU3RlYWwgV2l0aCBRIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZVciLCAiU3RlYWwgV2l0aCBXIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZUUiLCAiU3RlYWwgV2l0aCBFIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZVIiLCAiU3RlYWwgV2l0aCBSIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZVFXIiwgIlN0ZWFsIFdpdGggUVciLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgidXNlSSIsICJTdGVhbCBXaXRoIElnbml0ZSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkl0ZW0gU2V0dGluZ3MiLCAiaXRlbSIpDQogICAgICAgIHNlbGYuQ29uZmlnLml0ZW06YWRkUGFyYW0oImVuYWJsZWF1dG96aG9ueWEiLCAiQXV0byBaaG9ueWEiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIGZhbHNlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5pdGVtOmFkZFBhcmFtKCJhdXRvemhvbnlhIiwgIlpob255YSBpZiBIZWFsdGggdW5kZXIgLT4gJSIsIFNDUklQVF9QQVJBTV9TTElDRSwgMTAsIDAsIDEwMCwgMCkNCiAgICAgICAgDQogICAgICAgIGlmIFZJUF9VU0VSIHRoZW4NCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiVklQIFNldHRpbmdzIiwgInZpcCIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgicGFja2V0IiwiVXNlIFBhY2tldCBDYXN0aW5nIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzEiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzIiLCAiVG8gdXNlIHZpcCBzZXR0aW5ncywgUGFja2V0IENhc3Rpbmcgc2hvdWxkIGJlIG9wZW4uIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRTdWJNZW51KCJBdXRvIExldmVsIFNldHRpbmdzIiwgImxldmVsIikNCiAgICAgICAgc2VsZi5Db25maWcudmlwLmxldmVsOmFkZFBhcmFtKCJrZXkiLCJVc2UgQXV0byBMZXZlbCIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXAubGV2ZWw6YWRkUGFyYW0oImxvZ2ljIiwgIlNlbGVjdCBTa2lsbCBPcmRlciIsIFNDUklQVF9QQVJBTV9MSVNULCA3LCB7IkZvY3VzIFE+Vz5FIiwgIkZvY3VzIFE+RT5XIiwiRm9jdXMgVz5RPkUiLCJGb2N1cyBXPkU+USIsIkZvY3VzIEU+Vz5RIiwgIkZvY3VzIEU+UT5XIiwgIlNtYXJ0IiAgfSkNCiAgICAgICAgc2VsZi5Db25maWcudmlwOmFkZFN1Yk1lbnUoIlNraW4gSGFjayBTZXR0aW5ncyIsICJza2luIikNCiAgICAgICAgc2VsZi5Db25maWcudmlwLnNraW46YWRkUGFyYW0oImtleSIsIlVzZSBTa2luIEhhY2siLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcudmlwLnNraW46YWRkUGFyYW0oJ3NlbGVjdGVkJyAuLiBteUhlcm8uY2hhck5hbWUgLi4gJ1NraW4nLCAiU2VsZWN0IFNraW4iLCBTQ1JJUFRfUEFSQU1fTElTVCwgMSwgc2tpbk1ldGFbbXlIZXJvLmNoYXJOYW1lXSkNCiAgICAgICAgc2VsZi5Db25maWcudmlwLnNraW46YWRkUGFyYW0oImluZm81IiwgIk1ha2Ugc3VyZSB0aGF0IHVzaW5nIHBhY2tldCBjYXN0aW5nIGlzIE9OLiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICAtLXNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzUiLCAiU2tpbiBIYWNrIHRlbXBvcmFyeSBkaXNhYmxlZCB1bnRpbCBuZXh0IHVwZGF0ZS4gLiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICAtLVtbc2VsZi5Db25maWcudmlwOmFkZFN1Yk1lbnUoIkFudGktQUZLIFNldHRpbmdzIiwgImFudGlhZmsiKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXAuYW50aWFmazphZGRQYXJhbSgiYW50aWFmayIsIlVzZSBBbnRpIEFmayIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKSBdXQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm8zIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm80IiwgIlRvIHVzZSB2aXAgc2V0dGluZ3MsIFlvdSBuZWVkIHRvIGJlIGEgVklQIHVzZXIgb24gQk9MIGNvbW11bml0eS4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBlbmQNCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiRHJhdyBTZXR0aW5ncyIsIm90aGVyIikNCiAgICAgICAgLS1zZWxmLkNvbmZpZy5vdGhlcjphZGRTdWJNZW51KCJTaG93IERhbWFnZSBPbiBIcCBCYXIiLCAiSFBCQVIiKQ0KICAgICAgICAtLXNlbGYuQ29uZmlnLm90aGVyLkhQQkFSOmFkZFBhcmFtKCJrZXkiLCJPTi9PRkYiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5vdGhlcjphZGRTdWJNZW51KCJTa2lsbCBEcmF3aW5nIFNldHRpbmdzIiwgImRyYXciKQ0KICAgICAgICBzZWxmLkNvbmZpZy5vdGhlci5kcmF3OmFkZFBhcmFtKCJxZHJhdyIsIlEgU2tpbGwgRHJhd2luZ3MiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5vdGhlci5kcmF3OmFkZFBhcmFtKCJ3ZHJhdyIsIlcgU2tpbGwgRHJhd2luZ3MiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5vdGhlci5kcmF3OmFkZFBhcmFtKCJlZHJhdyIsIkUgU2tpbGwgRHJhd2luZ3MiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5vdGhlci5kcmF3OmFkZFBhcmFtKCJyZHJhdyIsIlIgU2tpbGwgRHJhd2luZ3MiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5vdGhlci5kcmF3OmFkZFBhcmFtKCJhYWRyYXciLCJBdXRvIEF0dGFjayBSYW5nZSIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5vdGhlcjphZGRQYXJhbSgiY29tYm9tb2RlIiwiRHJhdyBDb21ibyBNb2RlIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXI6YWRkU3ViTWVudSgiRHJhdyBQZXJtYWJveCIsICJwZXJtYSIpDQogICAgICAgIHNlbGYuQ29uZmlnLm90aGVyLnBlcm1hOmFkZFBhcmFtKCJwZXJtYSIsIkRyYXcgUGVybWFib3ggKCBOZWVkcyAyeCBGOSApIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXI6YWRkUGFyYW0oInRhcmdldCIsIkRyYXcgY2lyY2xlIGZvciB0YXJnZXQgc2VsZWN0ZWQiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5vdGhlcjphZGRQYXJhbSgidGFyZ2V0Y2FsIiwiVGFyZ2V0IGNhbGN1bGF0aW9uIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIlRhcmdldHNlbGVjdG9ycyIsInRhcmdldHNlbCIpDQogICAgICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRQYXJhbSgiaW5mb0syIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkUGFyYW0oImluZm9LIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkUGFyYW0oInRzIiwiTGVmdCBDbGljayBGb3IgVGFyZ2V0IFNlbGVjdGlvbiIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgc2VsZi50cy5uYW1lICA9ICJMZWJsYW5jIg0KICAgICAgc2VsZi50c3EubmFtZSA9ICJMZWJsYW5jUSINCiAgICAgIHNlbGYudHN3Lm5hbWUgPSAiTGVibGFuY1ciDQogICAgICBzZWxmLnRzZS5uYW1lID0gIkxlYmxhbmNFIg0KICAgICAgc2VsZi50c3IubmFtZSA9ICJMZWJsYW5jUiINCiAgICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRUUyhzZWxmLnRzKQ0KICAgICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFRTKHNlbGYudHNxKQ0KICAgICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFRTKHNlbGYudHN3KQ0KICAgICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFRTKHNlbGYudHNlKQ0KICAgICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFRTKHNlbGYudHNyKSANCiAgICAgIA0KICAgICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIktleXMgU2V0dGluZ3MiLCAiS2V5cyIpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJpbmZvSzMiLCAiPC0tLS0tLS0tLS0tLS0tLS0tLUNvbWJvIEtleSBTZXR0aW5ncy0tLS0tLS0tLS0tLS0tLS0tLT4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImNvbWJva2V5IiwgIkNvbWJvIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCAzMikNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oIm9ubHllIiwgIk9ubHkgdXNlIEUgU2tpbGwgKE9ubHkgU3R1bikiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLGZhbHNlLCBzdHJpbmcuYnl0ZSgiTyIpKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiY29tYm9tb2RlIiwgIiBTZWxlY3QgQ29tYm9tb2RlIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sZmFsc2UsIHN0cmluZy5ieXRlKCIyIikpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJpbmZvSzQiLCAiPC0tLS0tLS0tLS0tLS0tLS0tLUhhcmFzcyBLZXkgU2V0dGluZ3MtLS0tLS0tLS0tLS0tLS0tLS0+IiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJoYXJhc3NrZXkiLCAiU21hcnQgSGFyYXNzIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiQyIpKQ0KICAgICAtLSBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJoYXJhc3N0b2dsZWtleSIsICJIYXJhc3MgVG9nbGUgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZVE9HR0xFLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIlQiKSkNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LNSIsICI8LS0tLS0tLS0tLS0tLS0tLS0tQ2xlYXIgS2V5IFNldHRpbmdzLS0tLS0tLS0tLS0tLS0tLS0tLS0+IiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJsYW5lY2xlYXJrZXkiLCAiTGFuZUNsZWFyIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiViIpKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgianVuZ2xlY2xlYXJrZXkiLCAiSnVuZ2xlQ2xlYXIgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJaIikpDQogICAgICAtLXNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImxhc3RoaXRrZXkiLCAiTGFzdGhpdCBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIlgiKSkNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LNiIsICI8LS0tLS0tLS0tLS0tLS0tLS0tT3RoZXIgS2V5IFNldHRpbmdzLS0tLS0tLS0tLS0tLS0tLS0tLS0+IiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJlc2NhcGVrZXkiLCAiRXNjYXBlIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiWSIpKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0siLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJpbmZvSzIiLCAiTWFrZSBTdXJlIFRoYXQgWW91ciBPcmJ3YWxrZXIgS2V5cyBhcmUgU2FtZSBBcyBIZXJlIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJPcndXYWxrZXJLZXkgU2V0dGluZ3MiLCAiS2V5czIiKQ0KICAgICAgDQogICAgICBPcmJ3YWxrTWFuYWdlcjpMb2FkQ29tbW9uS2V5cyhzZWxmLkNvbmZpZy5LZXlzMikNCiAgICAgICANCiAgICAgICANCiAgICAgICBpZiBzZWxmLkNvbmZpZy5vdGhlci5wZXJtYS5wZXJtYSB0aGVuDQogICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBzZWxmLkNvbmZpZzpwZXJtYVNob3coImluZm9ib3giKSBlbmQsIDEpDQogICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHNlbGYuQ29uZmlnLktleXM6cGVybWFTaG93KCJjb21ib2tleSIpICBlbmQsIDEuMikNCiAgICAgIC0tc2VsZi5Db25maWcuS2V5czpwZXJtYVNob3coImhhcmFzc3RvZ2xla2V5IikNCiAgICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHNlbGYuQ29uZmlnLktleXM6cGVybWFTaG93KCJoYXJhc3NrZXkiKSAgZW5kLCAxLjIpDQogICAgZW5kDQogIGVuZA0KIC0tLS8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cXC0tLQ0KLS18fCA+IExlYmxhbmMgRHJhd2luZ3MgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8LS0NCi0tLVxcPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0vLy0tLQ0KICBmdW5jdGlvbiBMZWJsYW5jOmNvbWJvbW9kZSgpDQogIGxvY2FsIGRyYXdwb3MgPSBHZXRVbml0SFBCYXJQb3MobXlIZXJvKQ0KICBpZiBzZWxmLkNvbmZpZy5jb21iby5sb2dpYyA9PSAxIHRoZW4NCiAgRHJhd1RleHQoIkN1cnJlbnQgQ29tYm8gTW9kZTogUT5FPlc+UiIsIDEyLCBkcmF3cG9zLngtNDAsIGRyYXdwb3MueSsxNiwgMHhmZjAwZmZmZikgZW5kDQogIGlmIHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID09IDIgdGhlbg0KICBEcmF3VGV4dCgiQ3VycmVudCBDb21ibyBNb2RlOiBRPlI+RT5XIiwgMTIsIGRyYXdwb3MueC00MCwgZHJhd3Bvcy55KzE2LCAweGZmMDBmZmZmKSBlbmQNCiAgaWYgc2VsZi5Db25maWcuY29tYm8ubG9naWMgPT0gMyB0aGVuDQogIERyYXdUZXh0KCJDdXJyZW50IENvbWJvIE1vZGU6IEU+UT5XPlIiLCAxMiwgZHJhd3Bvcy54LTQwLCBkcmF3cG9zLnkrMTYsIDB4ZmYwMGZmZmYpIGVuZA0KICBpZiBzZWxmLkNvbmZpZy5jb21iby5sb2dpYyA9PSA0IHRoZW4NCiAgRHJhd1RleHQoIkN1cnJlbnQgQ29tYm8gTW9kZTogRT5XPlE+UiIsIDEyLCBkcmF3cG9zLngtNDAsIGRyYXdwb3MueSsxNiwgMHhmZjAwZmZmZikgZW5kDQogIGlmIHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID09IDUgdGhlbg0KICBEcmF3VGV4dCgiQ3VycmVudCBDb21ibyBNb2RlOiBSYW5kb20gU2tpbGwgT3JkZXIiLCAxMiwgZHJhd3Bvcy54LTQwLCBkcmF3cG9zLnkrMTYsIDB4ZmYwMGZmZmYpIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpEcmF3KCkNCiAgaWYgc2VsZi5Db25maWcub3RoZXIuY29tYm9tb2RlIHRoZW4NCiAgbG9jYWwgZHJhd3BvcyA9IEdldFVuaXRIUEJhclBvcyhteUhlcm8pDQogIHNlbGY6Y29tYm9tb2RlKCkNCiAgZW5kDQogICAgIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcucWRyYXcgYW5kIHNlbGYuUVNwZWxsOklzUmVhZHkoKSB0aGVuDQogICAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgNjUwLCAxLHJlZCkNCiAgICBlbmQNCiAgDQogICAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy53ZHJhdyBhbmQgc2VsZi5XU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCA2MDAsIDEsIHJlZCkNCiAgICBlbmQNCiAgDQogICAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5lZHJhdyBhbmQgc2VsZi5FU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCA5MjUsIDEsIHJlZCkNCiAgICBlbmQNCiAgICANCiAgICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LnJkcmF3IGFuZCBzZWxmLlJTcGVsbDpJc1JlYWR5KCkgdGhlbg0KICAgICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDcwMCwxLCByZWQpDQogICAgZW5kDQogICAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5hYWRyYXcgdGhlbg0KICAgICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDU1MCwxLCBBUkdCKDI1NSwgMjU1LDAsMCkpDQogICAgZW5kDQogICAgICAgICAgICAgIGlmIHNlbGYuQ29uZmlnLm90aGVyLnRhcmdldCBhbmQgc2VsZi5zZWxlY3RlZFRhciB+PSBuaWwgdGhlbg0KICAgICAgICAgRHJhd0NpcmNsZTNEKHNlbGYuc2VsZWN0ZWRUYXIueCwgc2VsZi5zZWxlY3RlZFRhci55LCBzZWxmLnNlbGVjdGVkVGFyLnosIDgwLDYsIEFSR0IoMjU1LCAyNTUsMCwwKSkNCmVuZA0KICBpZiBzZWxmLkNvbmZpZy5vdGhlci50YXJnZXRjYWwgYW5kIG5vdCBteUhlcm8uZGVhZCB0aGVuDQogICAgICBpZiB0YXJnZXQgYW5kIHRhcmdldCB+PSBuaWwgdGhlbg0KICAgICAgICBsb2NhbCBkcmF3cG9zPVdvcmxkVG9TY3JlZW4oRDNEWFZFQ1RPUjModGFyZ2V0LngsIHRhcmdldC55LCB0YXJnZXQueikpDQogICAgICAgIGxvY2FsIGNvbWJvVGV4dCxjb2xvciA9IHNlbGY6R2V0RHJhd3ModGFyZ2V0KQ0KICAgICAgICBpZiBjb21ib1RleHQgdGhlbg0KICAgICAgICAgIERyYXdUZXh0KGNvbWJvVGV4dCwxNSxkcmF3cG9zLngtMjAsZHJhd3Bvcy55LTIwLGNvbG9yKQ0KICAgICAgICBlbmQgDQogICAgICBlbmQgDQogICAgICBlbmQNCiAgICAgIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOkdldERyYXdzKHRhcmdldCkNCkRtZz17UT1zZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIGdldERtZygiUSIsdGFyZ2V0LG15SGVybylvciAwLFEyPWdldERtZygiUSIsdGFyZ2V0LG15SGVybywyKW9yIDAsVz1zZWxmLldTcGVsbDpJc1JlYWR5KCkgYW5kIGdldERtZygiVyIsdGFyZ2V0LG15SGVybylvciAwLEU9c2VsZi5FU3BlbGw6SXNSZWFkeSgpIGFuZCBnZXREbWcoIkUiLHRhcmdldCxteUhlcm8pb3IgMCxSPXNlbGYuUlNwZWxsOklzUmVhZHkoKSBhbmQgZ2V0RG1nKCJSIix0YXJnZXQsbXlIZXJvKW9yIDAsUjI9Z2V0RG1nKCJSIix0YXJnZXQsbXlIZXJvLDIpb3IgMCxJPXNlbGYuSWduaXRlOklzUmVhZHkoKSBhbmQgZ2V0RG1nKCJJR05JVEUiLHRhcmdldCxteUhlcm8pb3IgMH0NCiAgaWYgRG1nLlEgPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUScsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBEbWcuUSsgRG1nLkk+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgSWduaXRlJywgUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIERtZy5XID50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1cnLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgRG1nLlcrIERtZy5JPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnVyArIElnbml0ZScsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBEbWcuRSA+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdFJywgUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIERtZy5FKyBEbWcuST50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ0UgKyBJZ25pdGUnLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgRG1nLlErRG1nLlEyK0RtZy5XID50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBXJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgRG1nLlErRG1nLlEyK0RtZy5FID50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBFJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgRG1nLlErRG1nLlEyK0RtZy5XKyBEbWcuST50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBXICsgSWduaXRlJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgRG1nLlErRG1nLlEyK0RtZy5FKyBEbWcuST50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBFICsgSWduaXRlJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgRG1nLlErRG1nLlEyK0RtZy5FK0RtZy5XID50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBXICsgRScsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIERtZy5RK0RtZy5RMitEbWcuRStEbWcuVysgRG1nLkk+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgVyArIEUgKyBJZ25pdGUnLFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBEbWcuUStEbWcuUitEbWcuUjIrRG1nLlEyK0RtZy5FK0RtZy5XID50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBSICsgVyArIEUnLFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBEbWcuUStEbWcuUitEbWcuUjIrRG1nLlEyK0RtZy5FK0RtZy5XKyBEbWcuST50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBSICsgVyArIEUgKyBJZ25pdGUnLFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2UgDQogICAgcmV0dXJuICJDYW50IEtpbGwgeWV0IiwgUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZW5kIA0KZW5kDQogLS0tLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxcLS0tDQotLXx8ID4gTGVibGFuYyBUaWNrIEZ1bmN0aW9uICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fC0tDQotLS1cXD09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ly8tLS0NCiAgZnVuY3Rpb24gTGVibGFuYzpUaWNrKCkNCiAgICAgICBzZWxmOmF1dG96aG9ueWEoKQ0KICAgICAgICBzZWxmOmNoZWNrdHMoKQ0KICAgICAgIGlmIFZJUF9VU0VSIHRoZW4gc2VsZjphdXRvbGV2ZWwoKSBlbmQNCiAgIGlmIFZJUF9VU0VSIHRoZW4gc2VsZjpza2luaGFjaygpIGVuZA0KICAgICAgIHNlbGY6Z2FwY2xvc2UoKQ0KICAgaWYoc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgICl0aGVuDQogICAgICBzZWxmOmNvbWJvKCkNCiAgICBlbmQNCiAgICAgaWYoc2VsZi5Db25maWcuS2V5cy5vbmx5ZSAgICl0aGVuDQogICAgICBzZWxmOm9ubHllKCkNCiAgICBlbmQNCiAgICBpZihzZWxmLkNvbmZpZy5LZXlzLmxhbmVjbGVhcmtleSApdGhlbg0KICAgICAgc2VsZjpMYW5lQ2xlYXIoKQ0KICAgIGVuZA0KICAgIGlmKHNlbGYuQ29uZmlnLktleXMuZXNjYXBla2V5ICl0aGVuDQogICAgICBzZWxmOmVzY2FwZSgpDQogICAgZW5kDQogICAgICBpZihzZWxmLkNvbmZpZy5LZXlzLmp1bmdsZWNsZWFya2V5ICl0aGVuDQogICAgIHNlbGY6SnVuZ2xlQ2xlYXIoKQ0KICAgIGVuZA0KICAgIGlmKHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyApIHRoZW4NCiAgICAgIHNlbGY6a2lsbHN0ZWFsKCkNCiAgICBlbmQNCiAgICBpZihzZWxmLkNvbmZpZy5LZXlzLmhhcmFzc2tleSAgICkgdGhlbg0KICAgICAgc2VsZjpoYXJhc3MoKQ0KICAgIGVuZA0KICAgICAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6Y2hlY2t0cygpDQogICAgICAgICBzZWxmLnRzOnVwZGF0ZSgpDQogICAgICAgc2VsZi50c2U6dXBkYXRlKCkNCiAgICAgICBzZWxmLnRzcTp1cGRhdGUoKQ0KICAgICAgIHNlbGYudHNyOnVwZGF0ZSgpDQogICAgICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgICAgICBzZWxmLnRzZzp1cGRhdGUoKQ0KICBpZiBub3Qgc2VsZi50c2cudGFyZ2V0fj1uaWwgb3Igbm90IHNlbGYuQ29uZmlnLnRhcmdldHNlbC50cyB0aGVuDQogIHRhcmdldCA9IHNlbGYudHN3LnRhcmdldA0KICBlbHNlaWYgc2VsZi50c2cudGFyZ2V0fj1uaWwgb3Igc2VsZi5zZWxlY3RlZFRhciB0aGVuDQogIHRhcmdldCA9IHNlbGYuc2VsZWN0ZWRUYXINCiAgZW5kDQogIGVuZA0KZnVuY3Rpb24gTGVibGFuYzpza2luaGFjaygpDQogIGlmIG5vdCBGYWtlTG9hZCB0aGVuDQogIGlmICgoQ3VycmVudFRpbWVJbk1pbGxpcygpIC0gbGFzdFRpbWVUaWNrQ2FsbGVkKSA+IDIwMCkgdGhlbg0KICAgICAgbGFzdFRpbWVUaWNrQ2FsbGVkID0gQ3VycmVudFRpbWVJbk1pbGxpcygpDQogICAgaWYgc2VsZi5Db25maWcudmlwLnNraW4ua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAucGFja2V0ICB0aGVuDQogICAgaWYgc2VsZi5Db25maWcudmlwLnNraW5bJ3NlbGVjdGVkJyAuLiBteUhlcm8uY2hhck5hbWUgLi4gJ1NraW4nXSB+PSBsYXN0U2tpbiB0aGVuDQogICAgICAgIGxhc3RTa2luID0gc2VsZi5Db25maWcudmlwLnNraW5bJ3NlbGVjdGVkJyAuLiBteUhlcm8uY2hhck5hbWUgLi4gJ1NraW4nXQ0KICBTZW5kU2tpblBhY2tldChteUhlcm8uY2hhck5hbWUsIHNraW5zUEJbc2VsZi5Db25maWcudmlwLnNraW5bJ3NlbGVjdGVkJyAuLiBteUhlcm8uY2hhck5hbWUgLi4gJ1NraW4nXV0sIG15SGVyby5uZXR3b3JrSUQpOw0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6b25seWUoKQ0KICAgICAgICAgc2VsZi50c2U6dXBkYXRlKCkNCiAgICAgICAgICBpZihzZWxmLnRzZS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlRSBhbmQgIHNlbGYuQ29uZmlnLktleXMub25seWUgICBhbmQgc2VsZi5FU3BlbGw6SXNSZWFkeSgpKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0RShzZWxmLnRzZS50YXJnZXQpDQogIGVuZA0KICBlbmQNCiAgIC0tLS8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cXC0tLQ0KLS18fCA+IExlYmxhbmMgQ29tYm8gICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8LS0NCi0tLVxcPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0vLy0tLQ0KICBmdW5jdGlvbiBMZWJsYW5jOmNvbWJvKCkNCiAgaWYgc2VsZi5Db25maWcuY29tYm8ubG9naWMgPT0gMSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKSB0aGVuDQogIHNlbGY6Y29tYm9RRVdSKCkNCiAgZW5kDQogIGlmIHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID09IDIgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwICkgdGhlbg0KICBzZWxmOmNvbWJvUVJFVygpDQogIGVuZA0KICBpZiBzZWxmLkNvbmZpZy5jb21iby5sb2dpYyA9PSAzIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmNvbWJvLk1hbmEgLzEwMCApIHRoZW4NCiAgc2VsZjpjb21ib0VRV1IoKQ0KICBlbmQNCiAgaWYgc2VsZi5Db25maWcuY29tYm8ubG9naWMgPT0gNCBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKSB0aGVuDQogIHNlbGY6Y29tYm9FV1FSKCkNCiAgZW5kDQogIGlmIHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID09IDUgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwICkgdGhlbg0KICBzZWxmOnJhbmRvbWNvbWJvKCkNCiAgZW5kDQogICAgICBpZihzZWxmLkNvbmZpZy5jb21iby51c2VJIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgKXRoZW4NCiAgICAgIGZvciBfLCB1bml0IGluIHBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvDQogICAgICAgIGxvY2FsIGRtZ0kgPSg1MCsgKChteUhlcm8ubGV2ZWwpKjIwKSkNCiAgICAgICAgbG9jYWwgaGVhbHRoPXVuaXQuaGVhbHRoDQogICAgICAgIGlmKGhlYWx0aDxkbWdJIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VJIGFuZCBHZXREaXN0YW5jZSh1bml0KTw2MDApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEkodW5pdCkNCiAgICAgIGVuZA0KICAgICAgZW5kDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpjb21ib1FSRVcoKQ0KICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgIGlmIG5vdCBzZWxmLkNvbmZpZy5jb21iby50dXJudy53MiB0aGVuDQogIGlmIChzZWxmLnRzdy50YXJnZXQgfj0gbmlsICl0aGVuDQogIHNlbGY6Q2FzdFFSKHRhcmdldCkNCiAgZW5kDQogIGlmKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgKSBhbmQgc2VsZjpRUnVzZWQoKSB0aGVuDQogIHNlbGY6Q2FzdEVXKHRhcmdldCkNCiAgZW5kDQogIGVuZA0KICAgaWYgc2VsZi5Db25maWcuY29tYm8udHVybncudzIgdGhlbg0KICBpZiAoc2VsZi50c3cudGFyZ2V0IH49IG5pbCApdGhlbg0KICBzZWxmOkNhc3RRUih0YXJnZXQpDQogIGVuZA0KICBpZihzZWxmLnRzdy50YXJnZXQgfj0gbmlsICkgYW5kIHNlbGY6UUV1c2VkKCkgdGhlbg0KICBzZWxmOkNhc3RFV0IodGFyZ2V0KQ0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOmNvbWJvRVdRUigpDQogICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgaWYgbm90IHNlbGYuQ29uZmlnLmNvbWJvLnR1cm53Lnc0IHRoZW4NCiAgaWYgKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgKXRoZW4NCiAgc2VsZjpDYXN0RVcodGFyZ2V0KQ0KICBlbmQNCiAgaWYoc2VsZi50c3cudGFyZ2V0IH49IG5pbCApIGFuZCBzZWxmOkVXdXNlZCgpIHRoZW4NCiAgc2VsZjpDYXN0UVIodGFyZ2V0KQ0KICBlbmQNCiAgZW5kDQogICBpZiAgc2VsZi5Db25maWcuY29tYm8udHVybncudzQgdGhlbg0KICBpZiAoc2VsZi50c3cudGFyZ2V0IH49IG5pbCApdGhlbg0KICBzZWxmOkNhc3RFV0IodGFyZ2V0KQ0KICBlbmQNCiAgaWYoc2VsZi50c3cudGFyZ2V0IH49IG5pbCApIGFuZCBzZWxmOkVXdXNlZCgpIHRoZW4NCiAgc2VsZjpDYXN0UVIodGFyZ2V0KQ0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOmNvbWJvRVFXUigpDQogICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgaWYgbm90IHNlbGYuQ29uZmlnLmNvbWJvLnR1cm53LnczIHRoZW4NCiAgaWYgKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgKXRoZW4NCiAgc2VsZjpDYXN0RVEodGFyZ2V0KQ0KICBlbmQNCiAgaWYoc2VsZi50c3cudGFyZ2V0IH49IG5pbCApIGFuZCBzZWxmOkVRdXNlZCgpIHRoZW4NCiAgc2VsZjpDYXN0V1IodGFyZ2V0KQ0KICBlbmQNCiAgZW5kDQogICBpZiAgc2VsZi5Db25maWcuY29tYm8udHVybncudzMgdGhlbg0KICBpZiAoc2VsZi50c3cudGFyZ2V0IH49IG5pbCApdGhlbg0KICBzZWxmOkNhc3RFUSh0YXJnZXQpDQogIGVuZA0KICBpZihzZWxmLnRzdy50YXJnZXQgfj0gbmlsICkgYW5kIHNlbGY6RVF1c2VkKCkgdGhlbg0KICBzZWxmOkNhc3RXUkIodGFyZ2V0KQ0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOmNvbWJvUUVXUigpDQogICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgaWYgbm90IHNlbGYuQ29uZmlnLmNvbWJvLnR1cm53LncxIHRoZW4NCiAgaWYgKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgKXRoZW4NCiAgc2VsZjpDYXN0UUUodGFyZ2V0KQ0KICBlbmQNCiAgaWYoc2VsZi50c3cudGFyZ2V0IH49IG5pbCApIGFuZCBzZWxmOlFFdXNlZCgpIHRoZW4NCiAgc2VsZjpDYXN0V1IodGFyZ2V0KQ0KICBlbmQNCiAgZW5kDQogICBpZiBzZWxmLkNvbmZpZy5jb21iby50dXJudy53MSB0aGVuDQogIGlmIChzZWxmLnRzdy50YXJnZXQgfj0gbmlsICl0aGVuDQogIHNlbGY6Q2FzdFFFKHRhcmdldCkNCiAgZW5kDQogIGlmKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgKSBhbmQgc2VsZjpRRXVzZWQoKSB0aGVuDQogIHNlbGY6Q2FzdFdSQih0YXJnZXQpDQogIGVuZA0KICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6Q2FzdFEodW5pdCkNCiAgICBzZWxmLlFTcGVsbDpDYXN0KHVuaXQpDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOkNhc3RRRSh1bml0KQ0KICAgICAgICBzZWxmLnRzcTp1cGRhdGUoKQ0KICAgICAgIHNlbGYudHN3OnVwZGF0ZSgpDQogICAgICBpZihzZWxmLnRzcS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICAgYW5kIHNlbGYuUVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0USh0YXJnZXQpDQogICAgIGVuZA0KICAgICAgICAgc2VsZi50c2U6dXBkYXRlKCkNCiAgICAgICAgICBpZihzZWxmLnRzZS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlRSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICBhbmQgc2VsZi5FU3BlbGw6SXNSZWFkeSgpKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0RSh0YXJnZXQpDQogICAgICAgICAgZW5kDQogICAgICAgICAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6Q2FzdEVXKHVuaXQpDQogICAgICAgIHNlbGYudHNlOnVwZGF0ZSgpDQogICAgICBpZihzZWxmLnRzZS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlRSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICAgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0RSh0YXJnZXQpDQogICAgIGVuZA0KICAgICAgICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgICAgICAgICBpZihzZWxmLnRzdy50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlVyBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICBhbmQgbm90IHNlbGY6d1VzZWQoKSBhbmQgc2VsZi5XU3BlbGw6SXNSZWFkeSgpKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0Vyh0YXJnZXQpDQogICAgICAgICAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOkNhc3RFV0IodW5pdCkNCiAgICAgICAgc2VsZi50c2U6dXBkYXRlKCkNCiAgICAgIGlmKHNlbGYudHNlLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VFIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgICBhbmQgc2VsZi5FU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RFKHRhcmdldCkNCiAgICAgZW5kDQogICAgICAgICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgICAgICAgIGlmKHNlbGYudHN3LnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VXIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgYW5kIHNlbGYuV1NwZWxsOklzUmVhZHkoKSkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFcodGFyZ2V0KQ0KICAgICAgICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpyYW5kb21jb21ibygpDQogICAgICAgIHNlbGYudHNxOnVwZGF0ZSgpDQogICAgICBpZihzZWxmLnRzcS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICAgYW5kIHNlbGYuUVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0USh0YXJnZXQpICAgICANCiAgICAgICAgICBlbmQNCiAgICAgICAgICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi50c3cudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVcgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgIGFuZCBzZWxmLldTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFcodGFyZ2V0KSAgICAgIA0KICAgICAgICAgIGVuZA0KICAgICAgICAgIHNlbGYudHNlOnVwZGF0ZSgpDQogICAgICBpZihzZWxmLnRzZS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlRSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICAgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0RSh0YXJnZXQpICAgIA0KICAgICAgICAgIGVuZA0KICAgICAgICAgICBzZWxmLnRzcjp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi50c3IudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVIgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgIGFuZCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFIodGFyZ2V0KQ0KICAgICAgICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpDYXN0UVIodW5pdCkNCiAgICAgICAgc2VsZi50c3E6dXBkYXRlKCkNCiAgICAgICAgIHNlbGYudHN3OnVwZGF0ZSgpDQogICAgICBpZihzZWxmLnRzcS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICAgYW5kIHNlbGYuUVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0USh0YXJnZXQpDQogICAgIGVuZA0KICAgICAgICAgc2VsZi50c3I6dXBkYXRlKCkNCiAgICAgICAgICBpZihzZWxmLnRzci50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUiBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICBhbmQgc2VsZi5SU3BlbGw6SXNSZWFkeSgpKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0Uih0YXJnZXQpDQogICAgICAgICAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOkNhc3RXUih1bml0KQ0KICAgICAgICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi50c3cudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVcgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgIGFuZCBzZWxmLldTcGVsbDpJc1JlYWR5KClhbmQgbm90IHNlbGY6d1VzZWQoKSl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0Vyh0YXJnZXQpDQogICAgIGVuZA0KICAgICAgICAgc2VsZi50c3I6dXBkYXRlKCkNCiAgICAgICAgICBpZihzZWxmLnRzci50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUiBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICBhbmQgc2VsZi5SU3BlbGw6SXNSZWFkeSgpKSBhbmQgbm90IHNlbGY6clVzZWQoKSAgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFIodGFyZ2V0KQ0KICAgICAgICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpDYXN0V1JCKHVuaXQpDQogICAgICAgIHNlbGYudHN3OnVwZGF0ZSgpDQogICAgICBpZihzZWxmLnRzdy50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlVyBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICAgYW5kIHNlbGYuV1NwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0Vyh0YXJnZXQpDQogICAgIGVuZA0KICAgICAgICAgc2VsZi50c3I6dXBkYXRlKCkNCiAgICAgICAgICBpZihzZWxmLnRzci50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUiBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICBhbmQgc2VsZi5SU3BlbGw6SXNSZWFkeSgpKSBhbmQgbm90IHNlbGY6clVzZWQoKSAgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFIodGFyZ2V0KQ0KICAgICAgICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpDYXN0UVdIKCkNCiAgICAgICAgc2VsZi50c3E6dXBkYXRlKCkNCiAgICAgIGlmKHNlbGYudHNxLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5oYXJhc3MudXNlUSBhbmQgIHNlbGYuQ29uZmlnLktleXMuaGFyYXNza2V5ICBhbmQgc2VsZi5RU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RRKHRhcmdldCkNCiAgICAgZW5kDQogICAgICAgIHNlbGYudHN3OnVwZGF0ZSgpDQogICAgICBpZihzZWxmLnRzdy50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuaGFyYXNzLnVzZVcgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmhhcmFzc2tleSAgYW5kIHNlbGYuV1NwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgICBzZWxmOkNhc3RXKHRhcmdldCkNCiAgICAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOkNhc3RRV0sodW5pdCkNCiAgICAgICAgc2VsZi50c3E6dXBkYXRlKCkNCiAgICAgIGlmKHNlbGYudHNxLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlUVcgYW5kICBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgYW5kIHNlbGYuUVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0USh0YXJnZXQpDQogICAgIGVuZA0KICAgICAgICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi50c3cudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VRVyBhbmQgbm90IHNlbGY6d1VzZWQoKSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzIGFuZCBzZWxmLldTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFcodGFyZ2V0KQ0KICAgICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6Q2FzdEVRKHVuaXQpDQogICAgICAgIHNlbGYudHNlOnVwZGF0ZSgpDQogICAgICAgIHNlbGYudHN3OnVwZGF0ZSgpDQogICAgICBpZihzZWxmLnRzZS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlRSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICAgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0RSh0YXJnZXQpDQogICAgIGVuZA0KICAgICAgICAgc2VsZi50c3E6dXBkYXRlKCkNCiAgICAgICAgICBpZihzZWxmLnRzcS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICBhbmQgc2VsZi5RU3BlbGw6SXNSZWFkeSgpKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0USh0YXJnZXQpDQogICAgICAgICAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOkNhc3RXKHVuaXQpDQogICAgc2VsZi5XU3BlbGw6Q2FzdCh1bml0KQ0KICBlbmQNCiAgDQogIGZ1bmN0aW9uIExlYmxhbmM6Q2FzdEUodW5pdCkNCiAgIHNlbGYuRVNwZWxsOkNhc3QodW5pdCkNCiAgICANCiAgZW5kDQogIA0KICBmdW5jdGlvbiBMZWJsYW5jOkNhc3RSKHVuaXQpDQogICAgc2VsZi5SU3BlbGw6Q2FzdCh1bml0KQ0KICBlbmQNCiAgDQogIGZ1bmN0aW9uIExlYmxhbmM6Q2FzdEkodW5pdCkNCiAgICBzZWxmLklnbml0ZTpDYXN0KHVuaXQpDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOmtpbGxzdGVhbCgpDQogIGZvciBfLCB1bml0IGluIHBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvDQogICAgICBsb2NhbCBoZWFsdGggPSB1bml0LmhlYWx0aA0KICAgICAgbG9jYWwgZG1nRSA9IGdldERtZygiRSIsIHVuaXQsIG15SGVybykgKyAoKG15SGVyby5hcCkqMC41KSArIChnZXREbWcoIkUiLCB1bml0LCBteUhlcm8pICsgKChteUhlcm8uYXApKjAuNSkpDQogICAgICAgIGlmKHNlbGYudHNlLnRhcmdldCB+PSBuaWwgYW5kICBzZWxmLkVTcGVsbDpJc1JlYWR5KCkgYW5kIG5vdCBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgYW5kIGhlYWx0aDxkbWdFIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlRSAgIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MpdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEUodW5pdCkgIA0KICAgICAgICBlbmQNCiAgICAgICAgbG9jYWwgZG1nUSA9IGdldERtZygiUSIsIHVuaXQsIG15SGVybykgKyAoKG15SGVyby5hcCkqMC40MCkNCiAgICAgICAgaWYoc2VsZi50c3EudGFyZ2V0IH49IG5pbCBhbmQgIHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgbm90IHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICBhbmQgaGVhbHRoPGRtZ1EgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VRIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RRKHVuaXQpICANCiAgICAgICAgZW5kDQogICAgICAgICBsb2NhbCBkbWdRVyA9IGdldERtZygiUSIsIHVuaXQsIG15SGVybykgKyAoKG15SGVyby5hcCkqMC40MCkrKGdldERtZygiVyIsIHVuaXQsIG15SGVybykgKyAoKG15SGVyby5hcCkqMC42MCkrKGdldERtZygiUSIsIHVuaXQsIG15SGVybykgKyAoKG15SGVyby5hcCkqMC40MCkpKQ0KICAgICAgICBpZihzZWxmLnRzdy50YXJnZXQgfj0gbmlsIGFuZCAgaGVhbHRoPGRtZ1EgYW5kIG5vdCBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VRVyBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzICl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0UVdLKHVuaXQpICANCiAgICAgICAgZW5kDQogICAgICAgICAgICAgIGxvY2FsIGRtZ1cgPSBnZXREbWcoIlciLCB1bml0LCBteUhlcm8pICsgKChteUhlcm8uYXApKjAuNjApDQogICAgICAgIGlmKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgYW5kICBzZWxmLldTcGVsbDpJc1JlYWR5KCkgYW5kIG5vdCBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5IGFuZCBub3Qgc2VsZjp3VXNlZCgpICAgYW5kIGhlYWx0aDxkbWdRIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlVyBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzICl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0Vyh1bml0KSAgDQogICAgICAgIGVuZA0KICAgICAgICAgbG9jYWwgZG1nSSA9KDUwKyAoKG15SGVyby5sZXZlbCkqMjApKQ0KICAgICAgICBpZihoZWFsdGg8ZG1nSSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZUkgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyBhbmQgR2V0RGlzdGFuY2UodW5pdCk8NjAwKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RJKHVuaXQpDQogICAgICAgIGVuZA0KICAgICAgICBsb2NhbCBkbWdSID1nZXREbWcoIlIiLHVuaXQsbXlIZXJvKSsoKG15SGVyby5hcCkqMC42MCkgDQogICAgICAgIGlmKHNlbGYudHNyLnRhcmdldCB+PSBuaWwgYW5kICBzZWxmLlJTcGVsbDpJc1JlYWR5KCkgYW5kIG5vdCBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgYW5kIGhlYWx0aDxkbWdSIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlUiBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzIGFuZCBHZXREaXN0YW5jZSh1bml0KTw2MDApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFIodW5pdCkNCiAgICAgICAgZW5kDQogICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpoYXJhc3MoKQ0KICAgIHNlbGYudHNxOnVwZGF0ZSgpDQogICAgIHNlbGYudHN3OnVwZGF0ZSgpDQogICAgaWYgc2VsZi5Db25maWcuS2V5cy5oYXJhc3NrZXkgIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmhhcmFzcy5NYW5hIC8xMDAgKSAgdGhlbg0KICAgIHNlbGY6Q2FzdFFXSCgpDQogICAgICBlbmQgICANCiAgIGVuZA0KICAgZnVuY3Rpb24gTGVibGFuYzpMYW5lQ2xlYXIoKQ0KICBsb2NhbCBjbGVhcnRhcmdldCA9IHNlbGYuY2xlYXJ0YXJnZXQNCiAgc2VsZi5lbmVteU1pbmlvbnM6dXBkYXRlKCkNCiAgIHNlbGYub3RoZXJNaW5pb25zOnVwZGF0ZSgpDQogICAgICBzZWxmLmp1bmdsZU1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIGZvciBpLCBtaW5pb24gaW4gaXBhaXJzKHNlbGYuZW5lbXlNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICAgIGlmIFZhbGlkVGFyZ2V0KG1pbmlvbiwgNjAwKSBhbmQgKGNsZWFydGFyZ2V0ID09IG5pbCBvciBub3QgVmFsaWRUYXJnZXQoY2xlYXJ0YXJnZXQpKSB0aGVuDQogICAgICAgICAgY2xlYXJ0YXJnZXQgPSBtaW5pb24NCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGZvciBpLCBtaW5pb24gaW4gcGFpcnMoc2VsZi5lbmVteU1pbmlvbnMub2JqZWN0cykgZG8NCiAgICAgICAgaWYgVmFsaWRUYXJnZXQobWluaW9uKSBhbmQgbWluaW9uIH49IG5pbCB0aGVuDQogICAgICAgICAgaWYgc2VsZi5Db25maWcuS2V5cy5sYW5lY2xlYXJrZXkgIGFuZCBzZWxmLkNvbmZpZy5sYW5lY2xlYXIudXNlUSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5sYW5lY2xlYXIuTWFuYSAvMTAwICkgYW5kIEdldERpc3RhbmNlKG1pbmlvbikgPD0gc2VsZi5RU3BlbGwuUmFuZ2UgdGhlbiANCiAgICAgICAgICAgICBzZWxmOkNhc3RRKGNsZWFydGFyZ2V0KQ0KICAgICAgICAgIGVuZA0KICAgICAgICAgIGlmIHNlbGYuQ29uZmlnLktleXMubGFuZWNsZWFya2V5ICBhbmQgc2VsZi5Db25maWcubGFuZWNsZWFyLnVzZVcgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcubGFuZWNsZWFyLk1hbmEgLzEwMCApIGFuZCBHZXREaXN0YW5jZShtaW5pb24pIDw9IHNlbGYuV1NwZWxsLlJhbmdlIHRoZW4gDQogICAgICAgICAgICBsb2NhbCBCZXN0UG9zLCBCZXN0SGl0ID0gR2V0QmVzdENpcmN1bGFyRmFybVBvc2l0aW9uKHNlbGYuV1NwZWxsLlJhbmdlLCBzZWxmLldTcGVsbC5XaWR0aCwgc2VsZi5lbmVteU1pbmlvbnMub2JqZWN0cykNCiAgICAgICAgICAgIGlmIEJlc3RQb3Mgfj0gbmlsIHRoZW4NCiAgICAgICAgICAgICAgQ2FzdFNwZWxsKF9XLCBCZXN0UG9zLngsIEJlc3RQb3MueikNCiAgICAgICAgICBlbmQNCiAgICAgICAgZW5kDQogICAgICAgIGlmIHNlbGYuQ29uZmlnLktleXMubGFuZWNsZWFya2V5ICBhbmQgc2VsZi5Db25maWcubGFuZWNsZWFyLnVzZVIgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcubGFuZWNsZWFyLk1hbmEgLzEwMCApIGFuZCBHZXREaXN0YW5jZShtaW5pb24pIDw9IHNlbGYuV1NwZWxsLlJhbmdlIHRoZW4gDQogICAgICAgICAgICBsb2NhbCBCZXN0UG9zLCBCZXN0SGl0ID0gR2V0QmVzdENpcmN1bGFyRmFybVBvc2l0aW9uKHNlbGYuV1NwZWxsLlJhbmdlLCBzZWxmLldTcGVsbC5XaWR0aCwgc2VsZi5lbmVteU1pbmlvbnMub2JqZWN0cykNCiAgICAgICAgICAgIGlmIEJlc3RQb3Mgfj0gbmlsIHRoZW4NCiAgICAgICAgICAgICAgQ2FzdFNwZWxsKF9SLCBCZXN0UG9zLngsIEJlc3RQb3MueikNCiAgICAgICAgICBlbmQNCiAgICAgICAgZW5kICAgICAgICANCiAgICAgIGVuZA0KICAgIGVuZA0KICBlbmQNCiAgDQogIGZ1bmN0aW9uIExlYmxhbmM6SnVuZ2xlQ2xlYXIoKQ0KICBsb2NhbCBjbGVhcnRhcmdldCA9IG5pbA0KICAgICAgc2VsZi5lbmVteU1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIHNlbGYub3RoZXJNaW5pb25zOnVwZGF0ZSgpDQogICAgICBzZWxmLmp1bmdsZU1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIGZvciBpLCBtaW5pb24gaW4gaXBhaXJzKHNlbGYuZW5lbXlNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICAgIGlmIFZhbGlkVGFyZ2V0KG1pbmlvbiwgNjAwKSBhbmQgKGNsZWFydGFyZ2V0ID09IG5pbCBvciBub3QgVmFsaWRUYXJnZXQoY2xlYXJ0YXJnZXQpKSB0aGVuDQogICAgICAgICAgY2xlYXJ0YXJnZXQgPSBtaW5pb24NCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGZvciBpLCBqdW5nbGVtaW5pb24gaW4gaXBhaXJzKHNlbGYuanVuZ2xlTWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgICBpZiBWYWxpZFRhcmdldChqdW5nbGVtaW5pb24sIDYwMCkgYW5kIChjbGVhcnRhcmdldCA9PSBuaWwgb3Igbm90IFZhbGlkVGFyZ2V0KGNsZWFydGFyZ2V0KSkgdGhlbg0KICAgICAgICAgIGNsZWFydGFyZ2V0ID0ganVuZ2xlbWluaW9uDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBmb3IgaSwgb3RoZXJtaW5pb24gaW4gaXBhaXJzKHNlbGYub3RoZXJNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICAgIGlmIFZhbGlkVGFyZ2V0KG90aGVybWluaW9uLCA2MDApIGFuZCAoY2xlYXJ0YXJnZXQgPT0gbmlsIG9yIG5vdCBWYWxpZFRhcmdldChjbGVhcnRhcmdldCkpIHRoZW4NCiAgICAgICAgICBjbGVhcnRhcmdldCA9IG90aGVybWluaW9uDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBpZiBjbGVhcnRhcmdldCB+PSBuaWwgdGhlbg0KICAgICAgICBpZihzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyLnVzZVEgYW5kIHNlbGYuQ29uZmlnLktleXMuanVuZ2xlY2xlYXJrZXkgKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0UShjbGVhcnRhcmdldCkNCiAgICAgICAgZW5kDQogICAgICAgIGlmIGNsZWFydGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGlmKHNlbGYuV1NwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcuanVuZ2xlY2xlYXIudXNlVyBhbmQgc2VsZi5Db25maWcuS2V5cy5qdW5nbGVjbGVhcmtleSApIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyLk1hbmEgLzEwMCApIHRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RXKGNsZWFydGFyZ2V0KQ0KICAgICAgICBlbmQNCiAgICAgICAgaWYgY2xlYXJ0YXJnZXQgfj0gbmlsIHRoZW4NCiAgICAgICAgaWYoc2VsZi5FU3BlbGw6SXNSZWFkeSgpIGFuZCBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhci51c2VFIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmp1bmdsZWNsZWFya2V5ICkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuanVuZ2xlY2xlYXIuTWFuYSAvMTAwICkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEUoY2xlYXJ0YXJnZXQpDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgZW5kDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzp3VXNlZCgpIA0KICAgIGxvY2FsIGxlYmxhbmNXID0gbXlIZXJvOkdldFNwZWxsRGF0YShfVykNCiAgICBpZiBsZWJsYW5jVy5uYW1lID09ICJsZWJsYW5jc2xpZGVyZXR1cm4iIHRoZW4gDQogICAgICByZXR1cm4gdHJ1ZSANCiAgICBlbHNlIA0KICAgICAgcmV0dXJuIGZhbHNlDQogICAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOnJVc2VkKCkgDQogICAgbG9jYWwgbGVibGFuY1IgPSBteUhlcm86R2V0U3BlbGxEYXRhKF9SKQ0KICAgIGlmIGxlYmxhbmNSLm5hbWUgPT0gIkxlYmxhbmNTbGlkZU0iIHRoZW4gDQogICAgICByZXR1cm4gZmFsc2UNCiAgICBlbHNlIA0KICAgICAgcmV0dXJuIHRydWUNCiAgICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6UUV1c2VkKCkgDQogICAgbG9jYWwgbGVibGFuY1EgPSBzZWxmLlFTcGVsbDpJc1JlYWR5KCkNCiAgICBsb2NhbCBsZWJsYW5jRSA9IHNlbGYuRVNwZWxsOklzUmVhZHkoKQ0KICAgIGlmIChsZWJsYW5jUSBhbmQgbGVibGFuY0UpIHRoZW4gDQogICAgICByZXR1cm4gZmFsc2UgDQogICAgZWxzZSANCiAgICAgIHJldHVybiB0cnVlDQogICAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOkVRdXNlZCgpIA0KICAgIGxvY2FsIGxlYmxhbmNXID0gc2VsZi5FU3BlbGw6SXNSZWFkeSgpDQogICAgbG9jYWwgbGVibGFuY0UgPSBzZWxmLlFTcGVsbDpJc1JlYWR5KCkNCiAgICBpZiAobGVibGFuY1cgYW5kIGxlYmxhbmNFKSB0aGVuIA0KICAgICAgcmV0dXJuIGZhbHNlIA0KICAgIGVsc2UgDQogICAgICByZXR1cm4gdHJ1ZQ0KICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpFV3VzZWQoKSANCiAgICBsb2NhbCBsZWJsYW5jVyA9IHNlbGYuRVNwZWxsOklzUmVhZHkoKQ0KICAgIGxvY2FsIGxlYmxhbmNFID0gc2VsZi5XU3BlbGw6SXNSZWFkeSgpDQogICAgaWYgKGxlYmxhbmNXIGFuZCBsZWJsYW5jRSkgdGhlbiANCiAgICAgIHJldHVybiBmYWxzZSANCiAgICBlbHNlIA0KICAgICAgcmV0dXJuIHRydWUNCiAgICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6UVJ1c2VkKCkgDQogICAgbG9jYWwgbGVibGFuY1cgPSBzZWxmLlFTcGVsbDpJc1JlYWR5KCkNCiAgICBsb2NhbCBsZWJsYW5jRSA9IHNlbGYuUlNwZWxsOklzUmVhZHkoKQ0KICAgIGlmIChsZWJsYW5jVyBhbmQgbGVibGFuY0UpIHRoZW4gDQogICAgICByZXR1cm4gZmFsc2UgDQogICAgZWxzZSANCiAgICAgIHJldHVybiB0cnVlDQogICAgZW5kDQogIGVuZA0KICBsb2NhbCBzcGVsbExldmVsID0gMA0KICBmdW5jdGlvbiBMZWJsYW5jOmF1dG9sZXZlbCgpDQppZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDEgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2UxID0gICB7IDEsMiwzLDEsMSw0LDEsMiwxLDIsNCwyLDIsMywzLDQsMywzfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2UxKQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gMiBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTIgPSAgIHsgMSwyLDMsMSwxLDQsMSwzLDEsMyw0LDMsMywyLDIsNCwyLDJ9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTIpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSAzIGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlMyA9ICB7IDIsMywxLDIsMiw0LDIsMSwyLDEsNCwxLDEsMywzLDQsMywzfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2UzKQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gNCBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTQgPSAgeyAyLDMsMSwyLDIsNCwyLDMsMiwzLDQsMywzLDEsMSw0LDEsMX0NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlNCkNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDUgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2U1ID0gIHsgMywxLDIsMywzLDQsMywyLDMsMiw0LDIsMiwxLDEsNCwxLDF9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTUpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSA2IGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlNiA9ICB7IDMsMSwyLDMsMyw0LDMsMSwzLDEsNCwxLDEsMiwyLDQsMiwyfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2U2KQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogICAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSA3IGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlNiA9ICB7IDIsMSwzLDIsMSw0LDIsMiwxLDMsNCwyLDEsMSwzLDQsMywzfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2U2KQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOmF1dG96aG9ueWEoKQ0KICAgIGlmIHNlbGYuQ29uZmlnLml0ZW0uZW5hYmxlYXV0b3pob255YSB0aGVuDQogICAgIGZvciBfID0gSVRFTV8xLCBJVEVNXzcgZG8NCiAgICAgIGlmIG15SGVyby5oZWFsdGggPD0gKG15SGVyby5tYXhIZWFsdGggKiBzZWxmLkNvbmZpZy5pdGVtLmF1dG96aG9ueWEgLyAxMDApIGFuZCAoIG15SGVybzpDYW5Vc2VTcGVsbChfKSA9PSAwIGFuZCBteUhlcm86R2V0U3BlbGxEYXRhKF8pLm5hbWUgPT0gIlpob255YXNIb3VyZ2xhc3MiICl0aGVuIENhc3RTcGVsbChfKQ0KICAgIGVuZA0KICAgIGVuZA0KICAgIGVuZA0KICAgIGVuZA0KICAgIGZ1bmN0aW9uIExlYmxhbmM6ZXNjYXBlZm9yZ2FwKCkNCiAgaWYgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLmdhcGNsb3NlIGFuZCBub3Qgc2VsZjp3VXNlZCgpIHRoZW4NCiAgQ2FzdFNwZWxsKF9XLG1vdXNlUG9zLngsbW91c2VQb3MueikNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOmVzY2FwZSgpDQogIGlmIHNlbGYuQ29uZmlnLktleXMuZXNjYXBla2V5ICBhbmQgc2VsZi5Db25maWcuZXNjYXBlLnVzZVcgYW5kIG5vdCBzZWxmOndVc2VkKCkgdGhlbg0KICBDYXN0U3BlbGwoX1csbW91c2VQb3MueCxtb3VzZVBvcy56KQ0KICBlbmQNCiAgaWYgc2VsZi5Db25maWcuS2V5cy5lc2NhcGVrZXkgIHRoZW4gDQogIHNlbGY6d2FsaygpDQogIGVuZA0KICBpZiBzZWxmLkNvbmZpZy5LZXlzLmVzY2FwZWtleSAgYW5kIHNlbGYuQ29uZmlnLmVzY2FwZS51c2VSIGFuZCBub3QgIHNlbGY6clVzZWQoKSB0aGVuDQogIENhc3RTcGVsbChfUixtb3VzZVBvcy54LG1vdXNlUG9zLnopDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzp3YWxrKCkNCiAgICBteUhlcm86TW92ZVRvKG1vdXNlUG9zLngsbW91c2VQb3MueikNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6Z2FwY2xvc2UoKQ0KICBpZiB0YXJnZXQgYW5kIEdldERpc3RhbmNlKHRhcmdldCxteUhlcm8pPjgwMCB0aGVuIA0KICBzZWxmOmVzY2FwZWZvcmdhcCgpDQogICAgICBlbmQgDQogIA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpUQVJHRVRDUygpDQogICAgICBsb2NhbCBUYXJnZXQgPSBuaWwNCiAgICAgIGlmIHNlbGYuc2VsZWN0ZWRUYXIgdGhlbiBUYXJnZXQgPSBzZWxmLnNlbGVjdGVkVGFyDQogICAgICBlbHNlIFRhcmdldCA9IHNlbGYudHN3LnRhcmdldA0KICAgICAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOlduZE1zZyhNc2csIEtleSkNCiAgaWYgc2VsZi5Db25maWcuS2V5cy5jb21ib21vZGUgdGhlbg0KICBzZWxmLkNvbmZpZy5jb21iby5sb2dpYyA9IHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljICsxDQogIGlmIHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID4gNSB0aGVuIHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID0gMSBlbmQNCiAgZW5kDQogIGlmIHNlbGYuQ29uZmlnLnRhcmdldHNlbC50cyB0aGVuICAgICAgDQogICAgICAgICAgaWYgTXNnID09IFdNX0xCVVRUT05ET1dOIHRoZW4NCiAgICAgICAgICAgICAgbG9jYWwgbWluRCA9IDEwDQogICAgICAgICAgICAgIGxvY2FsIHN0YXJnZXQgPSBuaWwNCiAgICAgICAgICAgICAgZm9yIGksIGVuZW15IGluIGlwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbw0KICAgICAgICAgICAgICAgICAgaWYgVmFsaWRUYXJnZXQoZW5lbXkpIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICBpZiBHZXREaXN0YW5jZShlbmVteSwgbW91c2VQb3MpIDw9IG1pbkQgb3Igc3RhcmdldCA9PSBuaWwgdGhlbg0KICAgICAgICAgICAgICAgICAgICAgICAgICBtaW5EID0gR2V0RGlzdGFuY2UoZW5lbXksIG1vdXNlUG9zKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFyZ2V0ID0gZW5lbXkNCiAgICAgICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICBlbmQgICAgIA0KICAgICAgICAgICAgICBpZiBzdGFyZ2V0IGFuZCBtaW5EIDwgNTAwIHRoZW4NCiAgICAgICAgICAgICAgICAgIGlmIHNlbGYuc2VsZWN0ZWRUYXIgYW5kIHN0YXJnZXQuY2hhck5hbWUgPT0gc2VsZi5zZWxlY3RlZFRhci5jaGFyTmFtZSB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgc2VsZi5zZWxlY3RlZFRhciA9IG5pbA0KICAgICAgICAgICAgICAgICAgICAgIHByaW50KCI8Zm9udCBjb2xvcj1cIiNDQkY2RkZcIj5UYXJnZXQgPGI+aXMgbm8gbG9nZXIgc2VsZWN0ZWQuPC9iPjogIi4uc3RhcmdldC5jaGFyTmFtZS4uIjwvZm9udD4iKQ0KICAgICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWRUYXIgPSBzdGFyZ2V0ICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgcHJpbnQoIjxmb250IGNvbG9yPVwiI0NCRjZGRlwiPk5ldyB0YXJnZXQgPGI+c2VsZWN0ZWQuPC9iPjogIi4uc3RhcmdldC5jaGFyTmFtZS4uIjwvZm9udD4iKQ0KICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgIGVuZA0KICAgICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBlbmQNCiAgIC0tLS8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cXC0tLQ0KLS18fCA+IEFrYWxpIFN0YXJ0ICAgICAgICAgICAgICAgICAgICAgICAgICB8fC0tDQotLS1cXD09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ly8tLS0NCiAgY2xhc3MgIkFrYWxpIg0KICBmdW5jdGlvbiBBa2FsaTpfX2luaXQoKQ0Kc2VsZi50cz0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgNzAwLCBEQU1BR0VfUEhZU0lDQUwsIGZhbHNlLCB0cnVlKQ0Kc2VsZi50c3E9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDYwMCwgREFNQUdFX1BIWVNJQ0FMLCBmYWxzZSwgdHJ1ZSkNCnNlbGYudHN3PSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCA3MDAsIERBTUFHRV9QSFlTSUNBTCwgZmFsc2UsIHRydWUpDQpzZWxmLnRzZT0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgMzI1LCBEQU1BR0VfUEhZU0lDQUwsIGZhbHNlLCB0cnVlKQ0Kc2VsZi50c3I9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDcwMCwgREFNQUdFX1BIWVNJQ0FMLCBmYWxzZSwgdHJ1ZSkNCnNlbGYudHNnPSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCA5MjUsIERBTUFHRV9NQUdJQywgZmFsc2UsIHRydWUpDQogICBzZWxmLlFTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9RLCBEYW1hZ2VOYW1lID0gIlEiLCBSYW5nZSA9IDYwMCwgQ29sbGlzaW9uID0gZmFsc2UsIEFvZSA9IGZhbHNlLCBUeXBlID0gU1BFTExfVFlQRS5UQVJHRVRURUR9KQ0KICAgc2VsZi5XU3BlbGwgPSBfU3BlbGwoe1Nsb3QgPSBfVywgRGFtYWdlTmFtZSA9ICJXIiwgUmFuZ2UgPSA3MDAsIENvbGxpc2lvbiA9IGZhbHNlLCBBb2UgPSB0cnVlLCBUeXBlID0gU1BFTExfVFlQRS5TRUxGfSkNCiAgIHNlbGYuRVNwZWxsID0gX1NwZWxsKHtTbG90ID0gX0UsIERhbWFnZU5hbWUgPSAiRSIsIFJhbmdlID0gMzI1LCBDb2xsaXNpb24gPSBmYWxzZSwgQW9lID0gdHJ1ZSwgVHlwZSA9IFNQRUxMX1RZUEUuU0VMRn0pDQogICBzZWxmLlJTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9SLCBEYW1hZ2VOYW1lID0gIlIiLCBSYW5nZSA9NzAwLCAgQ29sbGlzaW9uID0gZmFsc2UsIEFvZSA9IGZhbHNlLCBUeXBlID0gU1BFTExfVFlQRS5UQVJHRVRURUR9KQ0KICAgc2VsZi5JZ25pdGUgPSBfU3BlbGwoe1Nsb3QgPSBGaW5kU3VtbW9uZXJTbG90KCJzdW1tb25lcmRvdCIpLCBEYW1hZ2VOYW1lID0gIklHTklURSIsIFJhbmdlID0gNjAwLCBUeXBlID0gU1BFTExfVFlQRS5UQVJHRVRURUR9KQ0KLS18PiBNaW5pb24gTWFuYWdlcnMNCiAgICBzZWxmLmVuZW15TWluaW9ucyAgID0gbWluaW9uTWFuYWdlcihNSU5JT05fRU5FTVksICAgNjUwLCBteUhlcm8sIE1JTklPTl9TT1JUX01BWEhFQUxUSF9ERUMpDQogICAgc2VsZi5hbGx5TWluaW9ucyAgICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX0FMTFksICAgNjUwLCBteUhlcm8sIE1JTklPTl9TT1JUX01BWEhFQUxUSF9ERUMpDQogICAgc2VsZi5qdW5nbGVNaW5pb25zICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX0pVTkdMRSwgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgIHNlbGYub3RoZXJNaW5pb25zICAgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9PVEhFUiwgICA2NTAsIG15SGVybywgTUlOSU9OX1NPUlRfTUFYSEVBTFRIX0RFQykNCiAgICBzZWxmOkxvYWRNZW51KCkNCiAgICBMYXN0X0xldmVsU3BlbGwgPSAwDQogICAgICBzZWxmOmZpbmRvcmJ3YWxrZXIoKQ0KICAgICAgDQogICAgICBBZGRUaWNrQ2FsbGJhY2soZnVuY3Rpb24oKSBzZWxmOlRpY2soKSBlbmQpDQogIEFkZERyYXdDYWxsYmFjayhmdW5jdGlvbigpIHNlbGY6RHJhdygpIGVuZCkNCiAgQWRkTXNnQ2FsbGJhY2soZnVuY3Rpb24obXNnLEtleSkgc2VsZjpXbmRNc2cobXNnLEtleSkgZW5kKQ0KICAtLUFkZEFuaW1hdGlvbkNhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIGFuaW1hdGlvbikgc2VsZjpBbmltYXRpb24odW5pdCwgYW5pbWF0aW9uKSBlbmQpDQogIC0tQWRkUHJvY2Vzc1NwZWxsQ2FsbGJhY2soZnVuY3Rpb24odW5pdCwgc3BlbGwpIHNlbGY6UHJvY2Vzc1NwZWxsKHVuaXQsIHNwZWxsKSBlbmQpDQogIC0tQWRkQXBwbHlCdWZmQ2FsbGJhY2soZnVuY3Rpb24oc291cmNlLCB1bml0LCBidWZmKSBzZWxmOk9uQXBwbHlCdWZmKHNvdXJjZSwgdW5pdCwgYnVmZikgZW5kKQ0KICAtLUFkZFVwZGF0ZUJ1ZmZDYWxsYmFjayhmdW5jdGlvbih1bml0LCBidWZmLCBzdGFja3MpIHNlbGY6VXBkYXRlQnVmZih1bml0LCBidWZmLCBzdGFja3MpIGVuZCkNCiAgLS1BZGRSZW1vdmVCdWZmQ2FsbGJhY2soZnVuY3Rpb24odW5pdCwgYnVmZikgc2VsZjpPblJlbW92ZUJ1ZmYodW5pdCwgYnVmZikgZW5kKSANCiAgZW5kDQogIGZ1bmN0aW9uIEFrYWxpOlRpY2soKQ0KICBzZWxmOmF1dG96aG9ueWEoKQ0KICBzZWxmOkF1dG9zdGVhbHRoKCkNCiAgc2VsZjphdXRvcSgpDQogIHNlbGY6aXRlbXMoKQ0KICAgICAgICBzZWxmOmNoZWNrdHMoKQ0KICAgICAgICBpZiBWSVBfVVNFUiB0aGVuIHNlbGY6YXV0b2xldmVsKCkgZW5kDQogICAgICAgICBpZiBWSVBfVVNFUiB0aGVuIHNlbGY6c2tpbmhhY2soKSBlbmQNCiBpZihzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5IGFuZCBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLlJsb2dpYy5sb2dpYyA9PSAxICl0aGVuDQogICAgc2VsZjpjb21ibygpDQogIGVuZA0KICAgaWYoc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSBhbmQgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5SbG9naWMubG9naWMgPT0gMiApdGhlbg0KICAgIHNlbGY6Y29tYm8yKCkNCiAgZW5kDQogICAgICBpZihzZWxmLkNvbmZpZy5LZXlzLmp1bmdsZWNsZWFya2V5ICl0aGVuDQogICBzZWxmOkp1bmdsZUNsZWFyKCkNCiAgZW5kDQogICAgaWYoc2VsZi5Db25maWcuS2V5cy5sYW5lY2xlYXJrZXkgKXRoZW4NCiAgICBzZWxmOkxhbmVDbGVhcigpDQogIGVuZA0KICBpZihzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgKSB0aGVuDQogICAgc2VsZjpraWxsc3RlYWwoKQ0KICBlbmQNCiAgaWYoc2VsZi5Db25maWcuS2V5cy5oYXJhc3NrZXkgICkgdGhlbg0KICAgIHNlbGY6aGFyYXNzKCkNCiAgZW5kDQogICAgICBpZihzZWxmLkNvbmZpZy5LZXlzLmVzY2FwZWtleSApdGhlbg0KICAgICAgc2VsZjplc2NhcGUoKQ0KICAgIGVuZA0KICBlbmQNCiAgICBmdW5jdGlvbiBBa2FsaTp3YWxrKCkNCiAgICBteUhlcm86TW92ZVRvKG1vdXNlUG9zLngsbW91c2VQb3MueikNCiAgZW5kDQogIGZ1bmN0aW9uIEFrYWxpOmVzY2FwZSgpDQogICBpZiBzZWxmLkNvbmZpZy5LZXlzLmVzY2FwZWtleSAgYW5kIHNlbGYuQ29uZmlnLmVzY2FwZS51c2VXIHRoZW4NCiAgQ2FzdFNwZWxsKF9XLG1vdXNlUG9zLngsbW91c2VQb3MueikNCiAgZW5kDQogIGlmIHNlbGYuQ29uZmlnLktleXMuZXNjYXBla2V5ICB0aGVuIA0KICBzZWxmOndhbGsoKQ0KICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIEFrYWxpOkRyYXcoKQ0KICAgIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcucWRyYXcgYW5kIHNlbGYuUVNwZWxsOklzUmVhZHkoKSB0aGVuDQogICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDYwMCwgMSxyZWQpDQogIGVuZA0KDQogIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcud2RyYXcgYW5kIHNlbGYuV1NwZWxsOklzUmVhZHkoKSB0aGVuDQogICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDcwMCwgMSwgcmVkKQ0KICBlbmQNCg0KICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LmVkcmF3IGFuZCBzZWxmLkVTcGVsbDpJc1JlYWR5KCkgdGhlbg0KICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCAzMjUsIDEsIHJlZCkNCiAgZW5kDQogIA0KICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LnJkcmF3IGFuZCBzZWxmLlJTcGVsbDpJc1JlYWR5KCkgdGhlbg0KICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCA3MDAsMSwgcmVkKQ0KICBlbmQNCiAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5hYWRyYXcgdGhlbg0KICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCAxMDAsMSwgQVJHQigyNTUsIDI1NSwwLDApKQ0KICBlbmQNCiAgICAgICAgICBpZiBzZWxmLkNvbmZpZy5vdGhlci50YXJnZXQgYW5kIHNlbGYuc2VsZWN0ZWRUYXIgfj0gbmlsIHRoZW4NCiAgICAgICAgIERyYXdDaXJjbGUzRChzZWxmLnNlbGVjdGVkVGFyLngsIHNlbGYuc2VsZWN0ZWRUYXIueSwgc2VsZi5zZWxlY3RlZFRhci56LCA4MCw2LCBBUkdCKDI1NSwgMjU1LDAsMCkpDQplbmQNCiAgaWYgc2VsZi5Db25maWcub3RoZXIudGFyZ2V0Y2FsIGFuZCBub3QgbXlIZXJvLmRlYWQgdGhlbg0KICAgICAgaWYgdGFyZ2V0IGFuZCB0YXJnZXQgfj0gbmlsIHRoZW4NCiAgICAgICAgbG9jYWwgZHJhd3Bvcz1Xb3JsZFRvU2NyZWVuKEQzRFhWRUNUT1IzKHRhcmdldC54LCB0YXJnZXQueSwgdGFyZ2V0LnopKQ0KICAgICAgICBsb2NhbCBjb21ib1RleHQsY29sb3IgPSBzZWxmOkdldERyYXdzKHRhcmdldCkNCiAgICAgICAgaWYgY29tYm9UZXh0IHRoZW4NCiAgICAgICAgICBEcmF3VGV4dChjb21ib1RleHQsMTUsZHJhd3Bvcy54LTIwLGRyYXdwb3MueS0yMCxjb2xvcikNCiAgICAgICAgZW5kIA0KICAgICAgZW5kIA0KICAgICAgZW5kDQogICAgICBlbmQNCiANCmZ1bmN0aW9uIEFrYWxpOmJ1ZmYodW5pdCkNCiByZXR1cm4gVGFyZ2V0SGF2ZUJ1ZmYoJ0FrYWxpTW90YScsIHVuaXQpDQplbmQNCg0KZnVuY3Rpb24gQWthbGk6c2tpbmhhY2soKQ0KICBpZiBub3QgRmFrZUxvYWQgdGhlbg0KICBpZiAoKEN1cnJlbnRUaW1lSW5NaWxsaXMoKSAtIGxhc3RUaW1lVGlja0NhbGxlZCkgPiAyMDApIHRoZW4NCiAgICAgIGxhc3RUaW1lVGlja0NhbGxlZCA9IEN1cnJlbnRUaW1lSW5NaWxsaXMoKQ0KICAgIGlmIHNlbGYuQ29uZmlnLnZpcC5za2luLmtleSBhbmQgc2VsZi5Db25maWcudmlwLnBhY2tldCAgdGhlbg0KICAgIGlmIHNlbGYuQ29uZmlnLnZpcC5za2luWydzZWxlY3RlZCcgLi4gbXlIZXJvLmNoYXJOYW1lIC4uICdTa2luJ10gfj0gbGFzdFNraW4gdGhlbg0KICAgICAgICBsYXN0U2tpbiA9IHNlbGYuQ29uZmlnLnZpcC5za2luWydzZWxlY3RlZCcgLi4gbXlIZXJvLmNoYXJOYW1lIC4uICdTa2luJ10NCiAgU2VuZFNraW5QYWNrZXQobXlIZXJvLmNoYXJOYW1lLCBza2luc1BCW3NlbGYuQ29uZmlnLnZpcC5za2luWydzZWxlY3RlZCcgLi4gbXlIZXJvLmNoYXJOYW1lIC4uICdTa2luJ11dLCBteUhlcm8ubmV0d29ya0lEKTsNCiAgZW5kDQogIGVuZA0KICBlbmQNCiAgZW5kDQogIGVuZA0KDQogZnVuY3Rpb24gQWthbGk6YXV0b2xldmVsKCkNCmlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gMSBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTEgPSAgIHsgMSwyLDMsMSwxLDQsMSwyLDEsMiw0LDIsMiwzLDMsNCwzLDN9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTEpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSAyIGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlMiA9ICAgeyAxLDIsMywxLDEsNCwxLDMsMSwzLDQsMywzLDIsMiw0LDIsMn0NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlMikNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDMgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2UzID0gIHsgMiwzLDEsMiwyLDQsMiwxLDIsMSw0LDEsMSwzLDMsNCwzLDN9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTMpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSA0IGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlNCA9ICB7IDIsMywxLDIsMiw0LDIsMywyLDMsNCwzLDMsMSwxLDQsMSwxfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2U0KQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gNSBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTUgPSAgeyAzLDEsMiwzLDMsNCwzLDIsMywyLDQsMiwyLDEsMSw0LDEsMX0NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlNSkNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDYgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2U2ID0gIHsgMywxLDIsMywzLDQsMywxLDMsMSw0LDEsMSwyLDIsNCwyLDJ9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTYpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDcgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2U2ID0gIHsgMSwzLDIsMSwxLDQsMSwzLDEsMyw0LDMsMywyLDIsNCwyLDJ9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTYpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIEFrYWxpOmF1dG96aG9ueWEoKQ0KICBpZiBzZWxmLkNvbmZpZy5pdGVtLmVuYWJsZWF1dG96aG9ueWEgdGhlbg0KICAgZm9yIF8gPSBJVEVNXzEsIElURU1fNyBkbw0KICAgIGlmIG15SGVyby5oZWFsdGggPD0gKG15SGVyby5tYXhIZWFsdGggKiBzZWxmLkNvbmZpZy5pdGVtLmF1dG96aG9ueWEgLyAxMDApIGFuZCAoIG15SGVybzpDYW5Vc2VTcGVsbChfKSA9PSAwIGFuZCBteUhlcm86R2V0U3BlbGxEYXRhKF8pLm5hbWUgPT0gIlpob255YXNIb3VyZ2xhc3MiICl0aGVuIENhc3RTcGVsbChfKQ0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gQWthbGk6Y2hlY2t0cygpDQogICAgICAgc2VsZi50czp1cGRhdGUoKQ0KICAgICAgIHNlbGYudHNlOnVwZGF0ZSgpDQogICAgICAgc2VsZi50c3E6dXBkYXRlKCkNCiAgICAgICBzZWxmLnRzcjp1cGRhdGUoKQ0KICAgICAgIHNlbGYudHN3OnVwZGF0ZSgpDQogICAgICAgc2VsZi50c2c6dXBkYXRlKCkNCmlmIG5vdCBzZWxmLnRzZy50YXJnZXR+PW5pbCBvciBub3Qgc2VsZi5Db25maWcudGFyZ2V0c2VsLnRzIHRoZW4NCnRhcmdldCA9IHNlbGYudHMudGFyZ2V0DQplbHNlaWYgc2VsZi50c2cudGFyZ2V0fj1uaWwgb3Igc2VsZi5zZWxlY3RlZFRhciB0aGVuDQp0YXJnZXQgPSBzZWxmLnNlbGVjdGVkVGFyDQplbmQNCmVuZA0KICBmdW5jdGlvbiBBa2FsaTpjb21ibygpDQogIGxvY2FsIGFidWZmID0gc2VsZjpidWZmKHRhcmdldCkNCiAgaWYoc2VsZi50c3EudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVEgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICBhbmQgc2VsZi5RU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0USh0YXJnZXQpDQogICBlbmQNCiAgICBpZihzZWxmLnRzci50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUiBhbmQgYWJ1ZmYgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICBhbmQgbm90IHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5SU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0Uih0YXJnZXQpDQogICBlbmQNCiAgICBpZihzZWxmLnRzZS50YXJnZXR+PW5pbCAgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZUUgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICBhbmQgc2VsZi5FU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0RSh0YXJnZXQpDQogICBlbmQNCiAgICAgICBpZihzZWxmLkNvbmZpZy5jb21iby51c2VJIGFuZCBzZWxmLkNvbmZpZy5jb21iby5jb21ib2tleSApdGhlbg0KICAgIGZvciBfLCB1bml0IGluIHBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvDQogICAgICBsb2NhbCBkbWdJID0oNTArICgobXlIZXJvLmxldmVsKSoyMCkpDQogICAgICBsb2NhbCBoZWFsdGg9dW5pdC5oZWFsdGgNCiAgICAgIGlmKGhlYWx0aDxkbWdJIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VJIGFuZCBHZXREaXN0YW5jZSh1bml0KTw2MDApdGhlbg0KICAgICAgICBzZWxmOkNhc3RJKHVuaXQpDQogICAgZW5kDQogICAgZW5kDQogIGVuZA0KICBlbmQNCiAgICBmdW5jdGlvbiBBa2FsaTpjb21ibzIoKQ0KICBpZihzZWxmLnRzcS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgIGFuZCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICBzZWxmOkNhc3RRKHRhcmdldCkNCiAgIGVuZA0KICAgIGlmKHNlbGYudHNyLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VSIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgYW5kIG5vdCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYuUlNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgIHNlbGY6Q2FzdFIodGFyZ2V0KQ0KICAgZW5kDQogICAgaWYoc2VsZi50c2UudGFyZ2V0fj1uaWwgIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VFIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgIHNlbGY6Q2FzdEUodGFyZ2V0KQ0KICAgZW5kDQogICAgICAgaWYoc2VsZi5Db25maWcuY29tYm8udXNlSSBhbmQgc2VsZi5Db25maWcuY29tYm8uY29tYm9rZXkgKXRoZW4NCiAgICBmb3IgXywgdW5pdCBpbiBwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbw0KICAgICAgbG9jYWwgZG1nSSA9KDUwKyAoKG15SGVyby5sZXZlbCkqMjApKQ0KICAgICAgbG9jYWwgaGVhbHRoPXVuaXQuaGVhbHRoDQogICAgICBpZihoZWFsdGg8ZG1nSSBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlSSBhbmQgR2V0RGlzdGFuY2UodW5pdCk8NjAwKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0SSh1bml0KQ0KICAgIGVuZA0KICAgIGVuZA0KICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIEFrYWxpOmhhcmFzcygpDQogIGlmKHNlbGYudHNxLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5oYXJhc3MudXNlUSBhbmQgIHNlbGYuQ29uZmlnLktleXMuaGFyYXNza2V5ICBhbmQgc2VsZi5RU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0USh0YXJnZXQpDQogICBlbmQNCiAgICBpZihzZWxmLnRzZS50YXJnZXR+PW5pbCAgYW5kIHNlbGYuQ29uZmlnLmhhcmFzcy51c2VFIGFuZCAgc2VsZi5Db25maWcuS2V5cy5oYXJhc3NrZXkgIGFuZCBzZWxmLkVTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICBzZWxmOkNhc3RFKHRhcmdldCkNCiAgIGVuZA0KICBlbmQNCiAgICBmdW5jdGlvbiBBa2FsaTpKdW5nbGVDbGVhcigpDQogICBsb2NhbCBjbGVhcnRhcmdldCA9IG5pbA0KICAgICAgc2VsZi5lbmVteU1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIHNlbGYub3RoZXJNaW5pb25zOnVwZGF0ZSgpDQogICAgICBzZWxmLmp1bmdsZU1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIGZvciBpLCBtaW5pb24gaW4gaXBhaXJzKHNlbGYuZW5lbXlNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICAgIGlmIFZhbGlkVGFyZ2V0KG1pbmlvbiwgNjAwKSBhbmQgKGNsZWFydGFyZ2V0ID09IG5pbCBvciBub3QgVmFsaWRUYXJnZXQoY2xlYXJ0YXJnZXQpKSB0aGVuDQogICAgICAgICAgY2xlYXJ0YXJnZXQgPSBtaW5pb24NCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGZvciBpLCBqdW5nbGVtaW5pb24gaW4gaXBhaXJzKHNlbGYuanVuZ2xlTWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgICBpZiBWYWxpZFRhcmdldChqdW5nbGVtaW5pb24sIDYwMCkgYW5kIChjbGVhcnRhcmdldCA9PSBuaWwgb3Igbm90IFZhbGlkVGFyZ2V0KGNsZWFydGFyZ2V0KSkgdGhlbg0KICAgICAgICAgIGNsZWFydGFyZ2V0ID0ganVuZ2xlbWluaW9uDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBmb3IgaSwgb3RoZXJtaW5pb24gaW4gaXBhaXJzKHNlbGYub3RoZXJNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICAgIGlmIFZhbGlkVGFyZ2V0KG90aGVybWluaW9uLCA2MDApIGFuZCAoY2xlYXJ0YXJnZXQgPT0gbmlsIG9yIG5vdCBWYWxpZFRhcmdldChjbGVhcnRhcmdldCkpIHRoZW4NCiAgICAgICAgICBjbGVhcnRhcmdldCA9IG90aGVybWluaW9uDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBpZiBjbGVhcnRhcmdldCB+PSBuaWwgdGhlbg0KICAgICAgICBpZihzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXIudXNlUSBhbmQgc2VsZi5Db25maWcuS2V5cy5qdW5nbGVjbGVhcmtleSApIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXIuTWFuYSAvMTAwICkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFEoY2xlYXJ0YXJnZXQpDQogICAgICAgIGVuZA0KICAgICAgICBpZiBjbGVhcnRhcmdldCB+PSBuaWwgdGhlbg0KICAgICAgICBpZihzZWxmLlJTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXIudXNlUiBhbmQgc2VsZi5Db25maWcuS2V5cy5qdW5nbGVjbGVhcmtleSApIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXIuTWFuYSAvMTAwICkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFIoY2xlYXJ0YXJnZXQpDQogICAgICAgIGVuZA0KICAgICAgICBpZiBjbGVhcnRhcmdldCB+PSBuaWwgdGhlbg0KICAgICAgICBpZihzZWxmLkVTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXIudXNlRSBhbmQgc2VsZi5Db25maWcuS2V5cy5qdW5nbGVjbGVhcmtleSApIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXIuTWFuYSAvMTAwICkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEUoY2xlYXJ0YXJnZXQpDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgZW5kDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gQWthbGk6TGFuZUNsZWFyKCkNCiAgIGxvY2FsIGNsZWFydGFyZ2V0ID0gbmlsDQogICAgICBzZWxmLmVuZW15TWluaW9uczp1cGRhdGUoKQ0KICAgICAgc2VsZi5vdGhlck1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIHNlbGYuanVuZ2xlTWluaW9uczp1cGRhdGUoKQ0KICAgICAgZm9yIGksIG1pbmlvbiBpbiBpcGFpcnMoc2VsZi5lbmVteU1pbmlvbnMub2JqZWN0cykgZG8NCiAgICAgICAgaWYgVmFsaWRUYXJnZXQobWluaW9uLCA2MDApIGFuZCAoY2xlYXJ0YXJnZXQgPT0gbmlsIG9yIG5vdCBWYWxpZFRhcmdldChjbGVhcnRhcmdldCkpIHRoZW4NCiAgICAgICAgICBjbGVhcnRhcmdldCA9IG1pbmlvbg0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgZm9yIGksIGp1bmdsZW1pbmlvbiBpbiBpcGFpcnMoc2VsZi5qdW5nbGVNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICAgIGlmIFZhbGlkVGFyZ2V0KGp1bmdsZW1pbmlvbiwgNjAwKSBhbmQgKGNsZWFydGFyZ2V0ID09IG5pbCBvciBub3QgVmFsaWRUYXJnZXQoY2xlYXJ0YXJnZXQpKSB0aGVuDQogICAgICAgICAgY2xlYXJ0YXJnZXQgPSBqdW5nbGVtaW5pb24NCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGZvciBpLCBvdGhlcm1pbmlvbiBpbiBpcGFpcnMoc2VsZi5vdGhlck1pbmlvbnMub2JqZWN0cykgZG8NCiAgICAgICAgaWYgVmFsaWRUYXJnZXQob3RoZXJtaW5pb24sIDYwMCkgYW5kIChjbGVhcnRhcmdldCA9PSBuaWwgb3Igbm90IFZhbGlkVGFyZ2V0KGNsZWFydGFyZ2V0KSkgdGhlbg0KICAgICAgICAgIGNsZWFydGFyZ2V0ID0gb3RoZXJtaW5pb24NCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGlmIGNsZWFydGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGlmKHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcuZmFybS5sYW5lY2xlYXIudXNlUSBhbmQgc2VsZi5Db25maWcuS2V5cy5qdW5nbGVjbGVhcmtleSApIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXIuTWFuYSAvMTAwICkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFEoY2xlYXJ0YXJnZXQpDQogICAgICAgIGVuZA0KICAgICAgICBpZiBjbGVhcnRhcmdldCB+PSBuaWwgdGhlbg0KICAgICAgICBpZihzZWxmLlJTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYuQ29uZmlnLmZhcm0ubGFuZWNsZWFyLnVzZVIgYW5kIHNlbGYuQ29uZmlnLktleXMuanVuZ2xlY2xlYXJrZXkgKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyLk1hbmEgLzEwMCApIHRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RSKGNsZWFydGFyZ2V0KQ0KICAgICAgICBlbmQNCiAgICAgICAgaWYgY2xlYXJ0YXJnZXQgfj0gbmlsIHRoZW4NCiAgICAgICAgaWYoc2VsZi5FU3BlbGw6SXNSZWFkeSgpIGFuZCBzZWxmLkNvbmZpZy5mYXJtLmxhbmVjbGVhci51c2VFIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmp1bmdsZWNsZWFya2V5ICkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0RShjbGVhcnRhcmdldCkNCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICBlbmQNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBBa2FsaTpDYXN0USh1bml0KQ0KICBzZWxmLlFTcGVsbDpDYXN0KHVuaXQpDQplbmQNCg0KZnVuY3Rpb24gQWthbGk6Q2FzdFcodW5pdCkNCiAgc2VsZi5XU3BlbGw6Q2FzdCh1bml0KQ0KZW5kDQoNCmZ1bmN0aW9uIEFrYWxpOkNhc3RFKHVuaXQpDQogIHNlbGYuRVNwZWxsOkNhc3QodW5pdCkNCmVuZA0KDQpmdW5jdGlvbiBBa2FsaTpDYXN0Uih1bml0KQ0KICBzZWxmLlJTcGVsbDpDYXN0KHVuaXQpDQplbmQNCmZ1bmN0aW9uIEFrYWxpOkNhc3RJKHVuaXQpDQogIHNlbGYuSWduaXRlOkNhc3QodW5pdCkNCmVuZA0KICBmdW5jdGlvbiBBa2FsaTphdXRvcSgpDQogICAgICAgICBpZihzZWxmLnRzcS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuS2V5cy5hdXRvcSBhbmQgIHNlbGYuUVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgIHNlbGY6Q2FzdFEodGFyZ2V0KQ0KICAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBBa2FsaTpHZXREcmF3cyh0YXJnZXQpDQpsb2NhbCBRZG1nPWdldERtZygiUSIsdGFyZ2V0LG15SGVybykNCmxvY2FsIFFkbWcyPShteUhlcm8uYXAqMC41KQ0KbG9jYWwgRWRtZz1nZXREbWcoIkUiLHRhcmdldCxteUhlcm8pDQpsb2NhbCBSZG1nPWdldERtZygiUiIsdGFyZ2V0LG15SGVybykNCmxvY2FsIElkbWc9KDUwKyAoKG15SGVyby5sZXZlbCkqMjApKQ0KICANCiAgaWYgUWRtZyA+IHRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUScsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBRZG1nK0lkbWc+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgSWduaXRlJywgUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIEVkbWc+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdFJywgUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIEVkbWcrSWRtZz50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ0UgKyBJZ25pdGUnLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICAgICAgZWxzZWlmIFJkbWc+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdSJywgUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIFJkbWcrSWRtZz50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1IgKyBJZ25pdGUnLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgUWRtZytFZG1nPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIEUnLFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogICAgICBlbHNlaWYgUWRtZytSZG1nPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIFInLFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBRZG1nK0VkbWcrSWRtZz50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBFICsgSWduaXRlJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICAgICAgZWxzZWlmIFFkbWcrUmRtZytJZG1nPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIFIgKyBJZ25pdGUnLFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBRZG1nK0VkbWcrUmRtZytJZG1nPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIFIgKyBFICsgSWduaXRlJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgUWRtZytSZG1nK0VkbWcgPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIFIgKyBFJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgUWRtZytRZG1nMiA+IHRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIFEyJywgUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIFFkbWcrSWRtZytRZG1nMj50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBRMiArIElnbml0ZScsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBFZG1nPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnRScsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBFZG1nK0lkbWc+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdFICsgSWduaXRlJywgUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgICAgIGVsc2VpZiBSZG1nPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUicsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBSZG1nK0lkbWc+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdSICsgSWduaXRlJywgUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIFFkbWcrRWRtZytRZG1nMj50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBRMiArIEUnLFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogICAgICBlbHNlaWYgUWRtZytSZG1nK1FkbWcyPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIFEyICsgUicsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIFFkbWcrRWRtZytJZG1nK1FkbWcyPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIFEyICsgRSArIElnbml0ZScsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgICAgIGVsc2VpZiBRZG1nK1JkbWcrSWRtZytRZG1nMj50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBRMiArIFIgKyBJZ25pdGUnLFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBRZG1nK0VkbWcrUmRtZytJZG1nK1FkbWcyPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIFEyICsgUiArIEUgKyBJZ25pdGUnLFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBRZG1nK1JkbWcrRWRtZytRZG1nMiA+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgUTIgKyBSICsgRScsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgICAgIGVsc2VpZiAoUWRtZytFZG1nK1JkbWcrSWRtZytRZG1nMikrKFFkbWcrRWRtZytSZG1nK0lkbWcrUWRtZzIpID50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ0tpbGwgV2l0aCAyIENvbWJvJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlIA0KICAgIHJldHVybiAiQ2FudCBLaWxsIHlldCIsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVuZCANCmVuZA0KICBmdW5jdGlvbiBBa2FsaTpraWxsc3RlYWwoKQ0KZm9yIF8sIHVuaXQgaW4gcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8NCiAgICBsb2NhbCBoZWFsdGggPSB1bml0LmhlYWx0aA0KICAgIGxvY2FsIGRtZ0UgPSBnZXREbWcoIkUiLCB1bml0LCBteUhlcm8pDQogICAgICBpZihzZWxmLnRzZS50YXJnZXQgfj0gbmlsIGFuZCAgc2VsZi5FU3BlbGw6SXNSZWFkeSgpIGFuZCBoZWFsdGg8ZG1nRSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZUUgICBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0RSh1bml0KSAgDQogICAgICBlbmQNCiAgICAgIGxvY2FsIGRtZ1EgPSBnZXREbWcoIlEiLCB1bml0LCBteUhlcm8pIA0KICAgICAgaWYoc2VsZi50c3EudGFyZ2V0IH49IG5pbCBhbmQgIHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgaGVhbHRoPGRtZ1EgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VRIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0USh1bml0KSAgDQogICAgICBlbmQNCiAgICAgICBsb2NhbCBkbWdJID0oNTArICgobXlIZXJvLmxldmVsKSoyMCkpDQogICAgICBpZihoZWFsdGg8ZG1nSSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZUkgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyBhbmQgR2V0RGlzdGFuY2UodW5pdCk8NjAwKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0SSh1bml0KQ0KICAgICAgZW5kDQogICAgICBsb2NhbCBkbWdSID1nZXREbWcoIlIiLHVuaXQsbXlIZXJvKQ0KICAgICAgaWYoc2VsZi50c3IudGFyZ2V0IH49IG5pbCBhbmQgIHNlbGYuUlNwZWxsOklzUmVhZHkoKSBhbmQgaGVhbHRoPGRtZ1IgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VSIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgYW5kIEdldERpc3RhbmNlKHVuaXQpPDU1MCl0aGVuDQogICAgICAgIHNlbGY6Q2FzdFIodW5pdCkNCiAgICAgIGVuZA0KICAgZW5kDQplbmQNCmZ1bmN0aW9uIEFrYWxpOml0ZW1zKCkNCiAgaWYgc2VsZi5Db25maWcuaXRlbS51c2ViZyBhbmQgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSB0aGVuDQogICBmb3IgXyA9IElURU1fMSwgSVRFTV83IGRvDQogICAgaWYgKCBteUhlcm86Q2FuVXNlU3BlbGwoXykgPT0gMCBhbmQgbXlIZXJvOkdldFNwZWxsRGF0YShfKS5uYW1lID09ICJCaWxnZXdhdGVyQ3V0bGFzcyIgKXRoZW4gQ2FzdFNwZWxsKF8pDQogIGVuZA0KICBlbmQNCiAgZW5kDQogIGlmIHNlbGYuQ29uZmlnLml0ZW0udXNlaGcgYW5kIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgdGhlbg0KICAgZm9yIF8gPSBJVEVNXzEsIElURU1fNyBkbw0KICAgIGlmICggbXlIZXJvOkNhblVzZVNwZWxsKF8pID09IDAgYW5kIG15SGVybzpHZXRTcGVsbERhdGEoXykubmFtZSA9PSAiSGV4dGVjaEd1bmJsYWRlIiApdGhlbiBDYXN0U3BlbGwoXykNCiAgZW5kDQogIGVuZA0KICBlbmQNCiAgZW5kDQogZnVuY3Rpb24gQWthbGk6QXV0b3N0ZWFsdGgoKQ0KICAgIGlmIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuV2xvZ2ljLnVzZVcgYW5kIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuV2xvZ2ljLnVzZVdlbiB0aGVuDQogICAgICAgIGlmIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuV2xvZ2ljLnVzZVdlID09IDEgdGhlbg0KICAgICAgICAgICAgaWYgQ291bnRFbmVteUhlcm9JblJhbmdlKDkwMCkgPj0gMiB0aGVuDQogICAgICAgICAgICAgICAgQ2FzdFNwZWxsKF9XLCBteUhlcm8ueCwgbXlIZXJvLnopDQogICAgICAgICAgICBlbmQNCiAgICAgICAgZWxzZWlmIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuV2xvZ2ljLnVzZVdlID09IDIgdGhlbg0KICAgICAgICAgICAgaWYgQ291bnRFbmVteUhlcm9JblJhbmdlKDkwMCkgPj0gMyB0aGVuDQogICAgICAgICAgICAgICAgQ2FzdFNwZWxsKF9XLCBteUhlcm8ueCwgbXlIZXJvLnopDQogICAgICAgICAgICBlbmQNCiAgICAgICAgZWxzZWlmIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuV2xvZ2ljLnVzZVdlID09IDMgdGhlbg0KICAgICAgICAgICAgaWYgQ291bnRFbmVteUhlcm9JblJhbmdlKDkwMCkgPj0gNCB0aGVuDQogICAgICAgICAgICAgICAgQ2FzdFNwZWxsKF9XLCBteUhlcm8ueCwgbXlIZXJvLnopDQogICAgICAgICAgICBlbmQNCiAgICAgICAgZWxzZWlmIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuV2xvZ2ljLnVzZVdlID09IDQgdGhlbg0KICAgICAgICAgICAgaWYgQ291bnRFbmVteUhlcm9JblJhbmdlKDkwMCkgPj0gNSB0aGVuDQogICAgICAgICAgICAgICAgQ2FzdFNwZWxsKF9XLCBteUhlcm8ueCwgbXlIZXJvLnopDQogICAgICAgICAgICBlbmQNCiAgICAgICAgZW5kDQogICAgZW5kDQogICAgaWYgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5XbG9naWMudXNlV2hwIGFuZCBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLldsb2dpYy51c2VXIHRoZW4NCiAgICAgICAgaWYgbXlIZXJvLmhlYWx0aCA8PSAobXlIZXJvLm1heEhlYWx0aCAqIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuV2xvZ2ljLmhwIC8gMTAwKSB0aGVuIA0KICAgICAgICAgICAgQ2FzdFNwZWxsKF9XLCBteUhlcm8ueCwgbXlIZXJvLnopDQogICAgICAgIGVuZA0KICAgIGVuZA0KZW5kDQoNCiAgZnVuY3Rpb24gQWthbGk6TG9hZE1lbnUoKQ0KICAgICAgIHNlbGYuQ29uZmlnPXNjcmlwdENvbmZpZygiIi4uU2NyaXB0bmFtZS4uIiBbIiAuLiBteUhlcm8uY2hhck5hbWUuLiJdIiAsIm1lbnUiKQ0KDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJDb21ibyBTZXR0aW5ncyIsICJjb21ibyIpDQogICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlUSIsICJVc2UgUSBpbiBDb21ibyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VFIiwgIlVzZSBFIGluIGNvbWJvIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZVIiLCAiVXNlIFIgaW4gY29tYm8iLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlSSIsICJVc2UgSWduaXRlIGlmIHRhcmdldCBraWxsYWJsZSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJNYW5hIiwiTWFuYSBNYW5hZ2VyICUiLFNDUklQVF9QQVJBTV9TTElDRSwgMTAsIDEwLCAxMDAsIDApDQogICAgIA0KICAgICAgDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJIYXJhc3MgU2V0dGluZ3MiLCAiaGFyYXNzIikNCiAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczphZGRQYXJhbSgidXNlUSIsICJIYXJhc3MgV2l0aCBRIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgc2VsZi5Db25maWcuaGFyYXNzOmFkZFBhcmFtKCJ1c2VFIiwgIkhhcmFzcyBXaXRoIEUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6YWRkUGFyYW0oIk1hbmEiLCJNYW5hIE1hbmFnZXIgJSIsU0NSSVBUX1BBUkFNX1NMSUNFLCAxMCwgMTAsIDEwMCwgMCkNCiAgICAgIA0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiU2tpbGwgTG9naWNzIiwgInNraWxsbG9naWMiKQ0KICAgICAgc2VsZi5Db25maWcuc2tpbGxsb2dpYzphZGRTdWJNZW51KCJXIFNraWxsIExvZ2ljIiwgIldsb2dpYyIpIA0KICAgICAgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5XbG9naWM6YWRkUGFyYW0oInVzZVciLCAiVXNlIFN0ZWFsdGggKFcpIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5XbG9naWM6YWRkUGFyYW0oInVzZVdocCIsICJVc2UgU3RlYWx0aCBpZiBoZWFsdCAlIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCBmYWxzZSkNCiAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuV2xvZ2ljOmFkZFBhcmFtKCJocCIsIkhlYWx0aCBNYW5hZ2VyICUiLFNDUklQVF9QQVJBTV9TTElDRSwgMzAsIDEwLCAxMDAsIDApDQogICAgICBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLldsb2dpYzphZGRQYXJhbSgidXNlV2VuIiwgIlVzZSBTdGVhbHRoIGlmIGVuZW15ID4iLCBTQ1JJUFRfUEFSQU1fT05PRkYsIGZhbHNlKQ0KICAgICAgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5XbG9naWM6YWRkUGFyYW0oInVzZVdlIiwgIlVzZSBTdGVhbHRoIGlmIGVuZW15ID4iLCBTQ1JJUFRfUEFSQU1fTElTVCwgMSwgeyIyIGVuZW15IiwgIjMgZW5lbXkiICwgIjQgZW5lbXkiLCI1IGVuZW15IiB9KQ0KICAgICAgc2VsZi5Db25maWcuc2tpbGxsb2dpYzphZGRTdWJNZW51KCJSIFNraWxsIExvZ2ljIiwgIlJsb2dpYyIpIA0KICAgICAgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5SbG9naWM6YWRkUGFyYW0oImxvZ2ljIiwgIlIgU2tpbGwgTG9naWMiLCBTQ1JJUFRfUEFSQU1fTElTVCwgMSwgeyJVc2UgUiBpZiBRIGlzIG9uIHRhcmdldCIsICJSdXNoIFNraWxscyIgfSkNCiAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJGYXJtIFNldHRpbmdzIiwgImZhcm0iKQ0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWcuZmFybTphZGRTdWJNZW51KCJMYW5lQ2xlYXIgU2V0dGluZ3MiLCJsYW5lY2xlYXIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5mYXJtLmxhbmVjbGVhcjphZGRQYXJhbSgidXNlUSIsIlVzZSBRIG9uIExhbmVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmZhcm0ubGFuZWNsZWFyOmFkZFBhcmFtKCJ1c2VFIiwiVXNlIEUgb24gTGFuZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuZmFybS5sYW5lY2xlYXI6YWRkUGFyYW0oInVzZVIiLCJVc2UgUiBvbiBMYW5lY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcuZmFybS5sYW5lY2xlYXI6YWRkUGFyYW0oIk1hbmEiLCJNYW5hIE1hbmFnZXIgJSIsU0NSSVBUX1BBUkFNX1NMSUNFLCAzMCwgMTAsIDEwMCwgMCkNCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnLmZhcm06YWRkU3ViTWVudSgiSnVuZ2xlQ2xlYXIgU2V0dGluZ3MiLCJqdW5nbGVjbGVhciIpDQogICAgICAgIHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXI6YWRkUGFyYW0oInVzZVEiLCJVc2UgUSBvbiBKdW5nbGVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXI6YWRkUGFyYW0oInVzZUUiLCJVc2UgRSBvbiBKdW5nbGVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXI6YWRkUGFyYW0oInVzZVIiLCJVc2UgUiBvbiBKdW5nbGVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyOmFkZFBhcmFtKCJNYW5hIiwiTWFuYSBNYW5hZ2VyICUiLFNDUklQVF9QQVJBTV9TTElDRSwgMzAsIDEwLCAxMDAsIDApDQogICAgICANCiAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIktpbGxTdGVhbCBTZXR0aW5ncyIsICJraWxsc3RlYWwiKQ0KICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJrcyIsIktpbGxzdGVhbCBPbi9PZmYiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJ1c2VRIiwgIlN0ZWFsIFdpdGggUSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgidXNlRSIsICJTdGVhbCBXaXRoIEUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZVIiLCAiU3RlYWwgV2l0aCBSIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJ1c2VJIiwgIlN0ZWFsIFdpdGggSWduaXRlIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJFc2NhcGUgU2V0dGluZ3MiLCJlc2NhcGUiKQ0KICAgICAgc2VsZi5Db25maWcuZXNjYXBlOmFkZFBhcmFtKCJ1c2VXIiwiVXNlIFcgV2hpbGUgRXNjYXBlIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJJdGVtIFNldHRpbmdzIiwgIml0ZW0iKQ0KICAgICAgc2VsZi5Db25maWcuaXRlbTphZGRQYXJhbSgiZW5hYmxlYXV0b3pob255YSIsICJBdXRvIFpob255YSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgZmFsc2UpDQogICAgICBzZWxmLkNvbmZpZy5pdGVtOmFkZFBhcmFtKCJhdXRvemhvbnlhIiwgIlpob255YSBpZiBIZWFsdGggdW5kZXIgLT4gJSIsIFNDUklQVF9QQVJBTV9TTElDRSwgMTAsIDAsIDEwMCwgMCkNCiAgICAgIHNlbGYuQ29uZmlnLml0ZW06YWRkUGFyYW0oInVzZWhnIiwgIlVzZSBIZXh0ZWNoIEd1bmJsYWRlIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgc2VsZi5Db25maWcuaXRlbTphZGRQYXJhbSgidXNlYmciLCAiVXNlIEJpbGdld2F0ZXIgQ3V0bGFzcyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIA0KICAgICAgaWYgVklQX1VTRVIgdGhlbg0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiVklQIFNldHRpbmdzIiwgInZpcCIpDQogICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oInBhY2tldCIsIlVzZSBQYWNrZXQgQ2FzdGluZyIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvMSIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzIiLCAiVG8gdXNlIHZpcCBzZXR0aW5ncywgUGFja2V0IENhc3Rpbmcgc2hvdWxkIGJlIG9wZW4uIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICBzZWxmLkNvbmZpZy52aXA6YWRkU3ViTWVudSgiQXV0byBMZXZlbCBTZXR0aW5ncyIsICJsZXZlbCIpDQogICAgICBzZWxmLkNvbmZpZy52aXAubGV2ZWw6YWRkUGFyYW0oImtleSIsIlVzZSBBdXRvIExldmVsIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICBzZWxmLkNvbmZpZy52aXAubGV2ZWw6YWRkUGFyYW0oImxvZ2ljIiwgIlNlbGVjdCBTa2lsbCBPcmRlciIsIFNDUklQVF9QQVJBTV9MSVNULCA3LCB7IkZvY3VzIFE+Vz5FIiwgIkZvY3VzIFE+RT5XIiwiRm9jdXMgVz5RPkUiLCJGb2N1cyBXPkU+USIsIkZvY3VzIEU+Vz5RIiwgIkZvY3VzIEU+UT5XIiwiU21hcnQiICB9KQ0KICAgICAgc2VsZi5Db25maWcudmlwOmFkZFN1Yk1lbnUoIlNraW4gSGFjayBTZXR0aW5ncyIsICJza2luIikNCiAgICAgIHNlbGYuQ29uZmlnLnZpcC5za2luOmFkZFBhcmFtKCJrZXkiLCJVc2UgU2tpbiBIYWNrIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICBzZWxmLkNvbmZpZy52aXAuc2tpbjphZGRQYXJhbSgnc2VsZWN0ZWQnIC4uIG15SGVyby5jaGFyTmFtZSAuLiAnU2tpbicsICJTZWxlY3QgU2tpbiIsIFNDUklQVF9QQVJBTV9MSVNULCAxLCBza2luTWV0YVtteUhlcm8uY2hhck5hbWVdKQ0KICAgICAgc2VsZi5Db25maWcudmlwLnNraW46YWRkUGFyYW0oImluZm81IiwgIk1ha2Ugc3VyZSB0aGF0IHVzaW5nIHBhY2tldCBjYXN0aW5nIGlzIE9OLiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgLS1zZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm81IiwgIlNraW4gSGFjayB0ZW1wb3JhcnkgZGlzYWJsZWQgdW50aWwgbmV4dCB1cGRhdGUuIC4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIC0tW1tzZWxmLkNvbmZpZy52aXA6YWRkU3ViTWVudSgiQW50aS1BRksgU2V0dGluZ3MiLCAiYW50aWFmayIpDQogICAgICBzZWxmLkNvbmZpZy52aXAuYW50aWFmazphZGRQYXJhbSgiYW50aWFmayIsIlVzZSBBbnRpIEFmayIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKSBdXQ0KICAgICAgc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvMyIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzQiLCAiVG8gdXNlIHZpcCBzZXR0aW5ncywgWW91IG5lZWQgdG8gYmUgYSBWSVAgdXNlciBvbiBCT0wgY29tbXVuaXR5LiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICBlbmQNCiAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkRyYXcgU2V0dGluZ3MiLCJvdGhlciIpDQogICAgICAtLXNlbGYuQ29uZmlnLm90aGVyOmFkZFN1Yk1lbnUoIlNob3cgRGFtYWdlIE9uIEhwIEJhciIsICJIUEJBUiIpDQogICAgICAtLXNlbGYuQ29uZmlnLm90aGVyLkhQQkFSOmFkZFBhcmFtKCJrZXkiLCJPTi9PRkYiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgc2VsZi5Db25maWcub3RoZXI6YWRkU3ViTWVudSgiU2tpbGwgRHJhd2luZyBTZXR0aW5ncyIsICJkcmF3IikNCiAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oInFkcmF3IiwiUSBTa2lsbCBEcmF3aW5ncyIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5vdGhlci5kcmF3OmFkZFBhcmFtKCJ3ZHJhdyIsIlcgU2tpbGwgRHJhd2luZ3MiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgiZWRyYXciLCJFIFNraWxsIERyYXdpbmdzIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oInJkcmF3IiwiUiBTa2lsbCBEcmF3aW5ncyIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5vdGhlci5kcmF3OmFkZFBhcmFtKCJhYWRyYXciLCJBdXRvIEF0dGFjayBSYW5nZSIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgc2VsZi5Db25maWcub3RoZXI6YWRkU3ViTWVudSgiRHJhdyBQZXJtYWJveCIsICJwZXJtYSIpDQogICAgICBzZWxmLkNvbmZpZy5vdGhlci5wZXJtYTphZGRQYXJhbSgicGVybWEiLCJEcmF3IFBlcm1hYm94ICggTmVlZHMgMnggRjkgKSIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5vdGhlcjphZGRQYXJhbSgidGFyZ2V0IiwiRHJhdyBjaXJjbGUgZm9yIHRhcmdldCBzZWxlY3RlZCIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5vdGhlcjphZGRQYXJhbSgidGFyZ2V0Y2FsIiwiVGFyZ2V0IGNhbGN1bGF0aW9uIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIA0KICAgICAgDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJUYXJnZXRzZWxlY3RvcnMiLCJ0YXJnZXRzZWwiKQ0KICAgICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFBhcmFtKCJpbmZvSzIiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkUGFyYW0oImluZm9LIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFBhcmFtKCJ0cyIsIkxlZnQgQ2xpY2sgRm9yIFRhcmdldCBTZWxlY3Rpb24iLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgIHNlbGYudHMubmFtZSAgPSAiQWthbGkiDQogICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFRTKHNlbGYudHMpDQogICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIktleXMgU2V0dGluZ3MiLCAiS2V5cyIpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0szIiwgIjwtLS0tLS0tLS0tLS0tLS0tLS1Db21ibyBLZXkgU2V0dGluZ3MtLS0tLS0tLS0tLS0tLS0tLS0+IiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiY29tYm9rZXkiLCAiQ29tYm8gS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIDMyKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LNCIsICI8LS0tLS0tLS0tLS0tLS0tLS0tSGFyYXNzIEtleSBTZXR0aW5ncy0tLS0tLS0tLS0tLS0tLS0tLT4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJoYXJhc3NrZXkiLCAiU21hcnQgSGFyYXNzIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiQyIpKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImF1dG9xIiwgIkF1dG8gSGFyYXNzIFEiLCBTQ1JJUFRfUEFSQU1fT05LRVlUT0dHTEUsIGZhbHNlLCBzdHJpbmcuYnl0ZSgiVCIpKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LNSIsICI8LS0tLS0tLS0tLS0tLS0tLS0tQ2xlYXIgS2V5IFNldHRpbmdzLS0tLS0tLS0tLS0tLS0tLS0tLS0+IiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgibGFuZWNsZWFya2V5IiwgIkxhbmVDbGVhciBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIlYiKSkNCiAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJqdW5nbGVjbGVhcmtleSIsICJKdW5nbGVDbGVhciBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIlYiKSkNCiAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJpbmZvSzYiLCAiPC0tLS0tLS0tLS0tLS0tLS0tLU90aGVyIEtleSBTZXR0aW5ncy0tLS0tLS0tLS0tLS0tLS0tLS0tPiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImVzY2FwZWtleSIsICJFc2NhcGUgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJZIikpDQogICAgLS1zZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJsYXN0aGl0a2V5IiwgIkxhc3RoaXQgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJYIikpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0siLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0syIiwgIk1ha2UgU3VyZSBUaGF0IFlvdXIgT3Jid2Fsa2VyIEtleXMgYXJlIFNhbWUgQXMgSGVyZSIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIk9yd1dhbGtlcktleSBTZXR0aW5ncyIsICJLZXlzMiIpDQogICAgDQogICAgT3Jid2Fsa01hbmFnZXI6TG9hZENvbW1vbktleXMoc2VsZi5Db25maWcuS2V5czIpDQogICAgDQogICAgIA0KICAgICBpZiBzZWxmLkNvbmZpZy5vdGhlci5wZXJtYS5wZXJtYSB0aGVuDQogICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHNlbGYuQ29uZmlnOnBlcm1hU2hvdygiaW5mb2JveCIpIGVuZCwgMSkNCiAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgc2VsZi5Db25maWcuS2V5czpwZXJtYVNob3coImNvbWJva2V5IikgZW5kLCAxLjIpDQogICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBzZWxmLkNvbmZpZy5LZXlzOnBlcm1hU2hvdygiaGFyYXNza2V5IikgZW5kLCAxLjIpDQogICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBzZWxmLkNvbmZpZy5LZXlzOnBlcm1hU2hvdygiYXV0b3EiKSBlbmQsIDEuMikNCmVuZA0KICBlbmQNCmZ1bmN0aW9uIEFrYWxpOlduZE1zZyhNc2csIEtleSkNCmlmIHNlbGYuQ29uZmlnLnRhcmdldHNlbC50cyB0aGVuICAgICAgDQogICAgICAgIGlmIE1zZyA9PSBXTV9MQlVUVE9ORE9XTiB0aGVuDQogICAgICAgICAgICBsb2NhbCBtaW5EID0gMTANCiAgICAgICAgICAgIGxvY2FsIHN0YXJnZXQgPSBuaWwNCiAgICAgICAgICAgIGZvciBpLCBlbmVteSBpbiBpcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8NCiAgICAgICAgICAgICAgICBpZiBWYWxpZFRhcmdldChlbmVteSkgdGhlbg0KICAgICAgICAgICAgICAgICAgICBpZiBHZXREaXN0YW5jZShlbmVteSwgbW91c2VQb3MpIDw9IG1pbkQgb3Igc3RhcmdldCA9PSBuaWwgdGhlbg0KICAgICAgICAgICAgICAgICAgICAgICAgbWluRCA9IEdldERpc3RhbmNlKGVuZW15LCBtb3VzZVBvcykNCiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJnZXQgPSBlbmVteQ0KICAgICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgIGVuZCAgICAgDQogICAgICAgICAgICBpZiBzdGFyZ2V0IGFuZCBtaW5EIDwgNTAwIHRoZW4NCiAgICAgICAgICAgICAgICBpZiBzZWxmLnNlbGVjdGVkVGFyIGFuZCBzdGFyZ2V0LmNoYXJOYW1lID09IHNlbGYuc2VsZWN0ZWRUYXIuY2hhck5hbWUgdGhlbg0KICAgICAgICAgICAgICAgICAgICBzZWxmLnNlbGVjdGVkVGFyID0gbmlsDQogICAgICAgICAgICAgICAgICAgIHByaW50KCI8Zm9udCBjb2xvcj1cIiNDQkY2RkZcIj5UYXJnZXQgPGI+aXMgbm8gbG9nZXIgc2VsZWN0ZWQuPC9iPjogIi4uc3RhcmdldC5jaGFyTmFtZS4uIjwvZm9udD4iKQ0KICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICAgICAgc2VsZi5zZWxlY3RlZFRhciA9IHN0YXJnZXQgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoIjxmb250IGNvbG9yPVwiI0NCRjZGRlwiPk5ldyB0YXJnZXQgPGI+c2VsZWN0ZWQuPC9iPjogIi4uc3RhcmdldC5jaGFyTmFtZS4uIjwvZm9udD4iKQ0KICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgZW5kDQogICAgICAgIGVuZA0KICAgIGVuZA0KICAgIGVuZA0KICAgLS0tLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxcLS0tDQotLXx8ID4gTGlzc2FuZHJhIFN0YXJ0cyAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fC0tDQotLS1cXD09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ly8tLS0NCiAgY2xhc3MgIkxpc3NhbmRyYSINCiAgZnVuY3Rpb24gTGlzc2FuZHJhOl9faW5pdCgpDQogICBzZWxmLnRzPSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCA1NTAsIERBTUFHRV9QSFlTSUNBTCwgZmFsc2UsIHRydWUpDQogIHNlbGYudHNxPSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCA3MjUsIERBTUFHRV9QSFlTSUNBTCwgZmFsc2UsIHRydWUpDQogIHNlbGYudHN3PSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCA0NTAsIERBTUFHRV9NQUdJQywgZmFsc2UsIHRydWUpDQogIHNlbGYudHNlPSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCAxMDUwLCBEQU1BR0VfTUFHSUMsIGZhbHNlLCB0cnVlKQ0KICBzZWxmLnRzcj0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgNTUwLCBEQU1BR0VfTUFHSUMsIGZhbHNlLCB0cnVlKSANCiAgICAgc2VsZi5RU3BlbGwgPSBfU3BlbGwoe1Nsb3QgPSBfUSwgRGFtYWdlTmFtZSA9ICJRIiwgUmFuZ2UgPSA3MjUsIFdpZHRoID0gMjAsIERlbGF5ID0gMC4yNSwgU3BlZWQgPSBtYXRoLmh1Z2UsIENvbGxpc2lvbiA9IGZhbHNlLCBBb2UgPSBmYWxzZSwgVHlwZSA9IFNQRUxMX1RZUEUuTElORUFSfSkNCiAgICAgc2VsZi5XU3BlbGwgPSBfU3BlbGwoe1Nsb3QgPSBfVywgRGFtYWdlTmFtZSA9ICJXIiwgUmFuZ2UgPSA0NTAsIFdpZHRoID0gMCwgRGVsYXkgPSAwLjUsIFNwZWVkID0gbWF0aC5odWdlLCBDb2xsaXNpb24gPSBmYWxzZSwgQW9lID0gdHJ1ZSwgVHlwZSA9IFNQRUxMX1RZUEUuU0VMRn0pDQogICAgIHNlbGYuRVNwZWxsID0gX1NwZWxsKHtTbG90ID0gX0UsIERhbWFnZU5hbWUgPSAiRSIsIFJhbmdlID0gMTA1MCwgV2lkdGggPSAxMTAsIERlbGF5ID0gLjI1LCBTcGVlZCA9IG1hdGguaHVnZSwgQ29sbGlzaW9uID0gZmFsc2UsIEFvZSA9IGZhbHNlLCBUeXBlID0gU1BFTExfVFlQRS5MSU5FQVJ9KQ0KICAgICBzZWxmLlJTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9SLCBEYW1hZ2VOYW1lID0gIlIiLCBSYW5nZSA9NTUwLCBXaWR0aCA9IDAsIERlbGF5ID0gMC4yNSwgU3BlZWQgPSBtYXRoLmh1Z2UsIENvbGxpc2lvbiA9IGZhbHNlLCBBb2UgPSB0cnVlLCBUeXBlID0gU1BFTExfVFlQRS5UQVJHRVRURUR9KQ0KICAgICBzZWxmLlJTU3BlbGwgPSBfU3BlbGwoe1Nsb3QgPSBfUiwgRGFtYWdlTmFtZSA9ICJSIiwgUmFuZ2UgPTU1MCwgV2lkdGggPSAwLCBEZWxheSA9IDAuMjUsIFNwZWVkID0gbWF0aC5odWdlLCBDb2xsaXNpb24gPSBmYWxzZSwgQW9lID0gdHJ1ZSwgVHlwZSA9IFNQRUxMX1RZUEUuVEFSR0VUVEVEfSkNCiAgICAgc2VsZi5JZ25pdGUgPSBfU3BlbGwoe1Nsb3QgPSBGaW5kU3VtbW9uZXJTbG90KCJzdW1tb25lcmRvdCIpLCBEYW1hZ2VOYW1lID0gIklHTklURSIsIFJhbmdlID0gNjAwLCBUeXBlID0gU1BFTExfVFlQRS5UQVJHRVRURUR9KQ0KICAtLXw+IE1pbmlvbiBNYW5hZ2Vycw0KICAgICAgc2VsZi5lbmVteU1pbmlvbnMgICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX0VORU1ZLCAgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgICAgc2VsZi5hbGx5TWluaW9ucyAgICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX0FMTFksICAgNjUwLCBteUhlcm8sIE1JTklPTl9TT1JUX01BWEhFQUxUSF9ERUMpDQogICAgICBzZWxmLmp1bmdsZU1pbmlvbnMgID0gbWluaW9uTWFuYWdlcihNSU5JT05fSlVOR0xFLCAgNjUwLCBteUhlcm8sIE1JTklPTl9TT1JUX01BWEhFQUxUSF9ERUMpDQogICAgICBzZWxmLm90aGVyTWluaW9ucyAgID0gbWluaW9uTWFuYWdlcihNSU5JT05fT1RIRVIsICAgNjUwLCBteUhlcm8sIE1JTklPTl9TT1JUX01BWEhFQUxUSF9ERUMpDQogICAgICAgICAgc2VsZjpMb2FkTWVudSgpDQogICAgICAgICAgICBMYXN0X0xldmVsU3BlbGwgPSAwDQogICAgICAgICAgICBzZWxmOmZpbmRvcmJ3YWxrZXIoKQ0KICAgICAgICAgICAgICAgIA0KICAgICAgICBBZGRUaWNrQ2FsbGJhY2soZnVuY3Rpb24oKSBzZWxmOlRpY2soKSBlbmQpDQogICAgQWRkRHJhd0NhbGxiYWNrKGZ1bmN0aW9uKCkgc2VsZjpEcmF3KCkgZW5kKQ0KICAgIC0tQWRkTXNnQ2FsbGJhY2soZnVuY3Rpb24obXNnLEtleSkgc2VsZjpXbmRNc2cobXNnLEtleSkgZW5kKQ0KICAgIC0tQWRkQW5pbWF0aW9uQ2FsbGJhY2soZnVuY3Rpb24odW5pdCwgYW5pbWF0aW9uKSBzZWxmOkFuaW1hdGlvbih1bml0LCBhbmltYXRpb24pIGVuZCkNCiAgICAtLUFkZFByb2Nlc3NTcGVsbENhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIHNwZWxsKSBzZWxmOlByb2Nlc3NTcGVsbCh1bml0LCBzcGVsbCkgZW5kKQ0KICAgIC0tQWRkQXBwbHlCdWZmQ2FsbGJhY2soZnVuY3Rpb24oc291cmNlLCB1bml0LCBidWZmKSBzZWxmOk9uQXBwbHlCdWZmKHNvdXJjZSwgdW5pdCwgYnVmZikgZW5kKQ0KICAgIC0tQWRkVXBkYXRlQnVmZkNhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIGJ1ZmYsIHN0YWNrcykgc2VsZjpVcGRhdGVCdWZmKHVuaXQsIGJ1ZmYsIHN0YWNrcykgZW5kKQ0KICAgIC0tQWRkUmVtb3ZlQnVmZkNhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIGJ1ZmYpIHNlbGY6T25SZW1vdmVCdWZmKHVuaXQsIGJ1ZmYpIGVuZCkgDQogICAgICBlbmQNCiAgICAgIGZ1bmN0aW9uIExpc3NhbmRyYTpUaWNrKCkNCiAgICAgICBzZWxmOmF1dG96aG9ueWEoKQ0KICAgICAgIHNlbGY6ZW5nYWdld2l0aHIoKQ0KICAgICAgICAgaWYgVklQX1VTRVIgdGhlbiBzZWxmOmF1dG9sZXZlbCgpIGVuZA0KICAgICAgICAgIGlmIFZJUF9VU0VSIHRoZW4gc2VsZjpza2luaGFjaygpIGVuZA0KICAgICAgIHNlbGY6YXV0b1IoKQ0KICAgICAgIHNlbGY6YXV0b3EoKQ0KICAgaWYoc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSApdGhlbg0KICAgICAgc2VsZjpjb21ibygpDQogICAgZW5kDQogICAgICAgIGlmKHNlbGYuQ29uZmlnLktleXMuanVuZ2xlY2xlYXJrZXkgKXRoZW4NCiAgICAgc2VsZjpKdW5nbGVDbGVhcigpDQogICAgZW5kDQogICAgICBpZihzZWxmLkNvbmZpZy5LZXlzLmxhbmVjbGVhcmtleSApdGhlbg0KICAgICAgc2VsZjpMYW5lQ2xlYXIoKQ0KICAgIGVuZA0KICAgICBpZihzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ciApdGhlbg0KICAgICAgc2VsZjplbmdhZ2V3aXRocigpDQogICAgZW5kDQogICAgICBpZihzZWxmLkNvbmZpZy5LZXlzLmVzY2FwZWtleSl0aGVuDQogICAgICBzZWxmOmVzY2FwZSgpDQogICAgZW5kDQogICAgaWYoc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzICkgdGhlbg0KICAgICAgc2VsZjpraWxsc3RlYWwoKQ0KICAgIGVuZA0KICAgIGlmKHNlbGYuQ29uZmlnLktleXMuaGFyYXNza2V5IG9yIHNlbGYuQ29uZmlnLktleXMuaGFyYXNzdG9nbGVrZXkgICkgdGhlbg0KICAgICAgc2VsZjpoYXJhc3MoKQ0KICAgIGVuZA0KICAgICAgZW5kDQogICAgICBmdW5jdGlvbiBMaXNzYW5kcmE6TG9hZE1lbnUoKQ0KICAgICAgc2VsZi5Db25maWc9c2NyaXB0Q29uZmlnKCIiLi5TY3JpcHRuYW1lLi4iIFsiIC4uIG15SGVyby5jaGFyTmFtZS4uIl0iICwibWVudSIpDQogICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJDb21ibyBTZXR0aW5ncyIsICJjb21ibyIpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VRIiwgIlVzZSBRIGluIENvbWJvIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlVyIsICJVc2UgVyBpbiBDb21ibyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZUUiLCAiVXNlIEUgaW4gY29tYm8iLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VSIiwgIlVzZSBSIGluIGNvbWJvIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlSSIsICJVc2UgSWduaXRlIGlmIHRhcmdldCBraWxsYWJsZSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oIk1hbmEiLCJNYW5hIE1hbmFnZXIgJSIsU0NSSVBUX1BBUkFNX1NMSUNFLCAxMCwgMTAsIDEwMCwgMCkNCiAgDQogICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJIYXJhc3MgU2V0dGluZ3MiLCAiaGFyYXNzIikNCiAgICAgICAgc2VsZi5Db25maWcuaGFyYXNzOmFkZFBhcmFtKCJ1c2VRIiwgIkhhcmFzcyBXaXRoIFEiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczphZGRQYXJhbSgidXNlVyIsICJIYXJhc3MgV2l0aCBXIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6YWRkUGFyYW0oInVzZUUiLCAiSGFyYXNzIFdpdGggRSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczphZGRQYXJhbSgiYXV0b3EiLCAiQXV0byBIYXJhc3Mgd2l0aCBRIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCBmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcuaGFyYXNzOmFkZFBhcmFtKCJNYW5hIiwiTWFuYSBNYW5hZ2VyICUiLFNDUklQVF9QQVJBTV9TTElDRSwgMzAsIDEwLCAxMDAsIDApDQogICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJTa2lsbCBMb2dpY3MiLCAic2tpbGxsb2dpYyIpDQogICAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWM6YWRkU3ViTWVudSgiRSBTa2lsbCBMb2dpYyIsICJFbG9naWMiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLkVsb2dpYzphZGRQYXJhbSgiY29tYm8iLCAiRSBMb2dpYyBmb3IgY29tYm8gbW9kZSIsIFNDUklQVF9QQVJBTV9MSVNULCAyLCB7IkVuZ2FnZSB3aXRoIHNlY29uZCBFIiwgIkRvIG5vdCB1c2UgU2Vjb25kIEUgKCBSZWNvbWVuZGVkKSIgfSkNCiAgICAgICAgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5FbG9naWM6YWRkUGFyYW0oImhhcmFzcyIsICJFIExvZ2ljIGZvciBIYXJhc3MgbW9kZSIsIFNDUklQVF9QQVJBTV9MSVNULCAxLCB7IkRvIG5vdCB1c2UgU2Vjb25kIEUgKCBSZWNvbWVuZGVkKSIsICJFbmdhZ2Ugd2l0aCBzZWNvbmQgRSIgfSkNCiAgICAgICAgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5FbG9naWM6YWRkUGFyYW0oImJsYW5rIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLkVsb2dpYzphZGRQYXJhbSgiaW5mb0UiLCAiRW5nYWdlIHdpdGggc2Vjb25kIEUgb3B0aW9uIGlzIHN0aWxsIG9uIEJldGEuLiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljOmFkZFN1Yk1lbnUoIlIgU2tpbGwgTG9naWMiLCAiUmxvZ2ljIikNCiAgICAgICAgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5SbG9naWM6YWRkUGFyYW0oIlJsb2dpYyIsICJSIExvZ2ljIGZvciBjb21ibyBtb2RlIiwgU0NSSVBUX1BBUkFNX0xJU1QsIDEsIHsiU21hcnQiLCAic2F2ZSBmb3IgeW91cnNlbGYiLCAiVXNlIGZvciBlbmVteSIgfSkNCiAgICAgICAgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5SbG9naWM6YWRkUGFyYW0oImVuYWJsZWF1dG9SIiwgIkF1dG8gUiBmb3IgeW91cnNlbGYiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljOmFkZFBhcmFtKCJhdXRvUiIsICJBdXRvUiBpZiBIZWFsdGggdW5kZXIgLT4gJSIsIFNDUklQVF9QQVJBTV9TTElDRSwgMTAsIDAsIDEwMCwgMCkNCiAgICAgICAgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5SbG9naWM6YWRkUGFyYW0oImluZm9SMiIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5SbG9naWM6YWRkUGFyYW0oImluZm9SIiwgIkZvciB1c2luZyBTbWFydCBSIGxvZ2ljLCBBdXRvUiBzaG91bGQgYmUgb3Blbi4uIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWM6YWRkU3ViTWVudSgiVyBTa2lsbCBMb2dpYyIsICJXbG9naWMiKSANCiAgICAgICAgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5XbG9naWM6YWRkUGFyYW0oInVzZVciLCAiVXNlIFcgZm9yIEFudGkgR2FwQ2xvc2UiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIGZhbHNlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLldsb2dpYzphZGRQYXJhbSgiaW5mb3cyIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLldsb2dpYzphZGRQYXJhbSgiaW5mb1czIiwgIlRoaXMgRnVuY3Rpb24gaXMgb24gYmV0YS4uIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIA0KICAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiRXNjYXBlIFNldHRpbmdzIiwiZXNjYXBlIikNCiAgICAgICAgc2VsZi5Db25maWcuZXNjYXBlOmFkZFBhcmFtKCJ1c2VFIiwiVXNlIEUgV2hpbGUgRXNjYXBlIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuZXNjYXBlOmFkZFBhcmFtKCJ1c2VXIiwiVXNlIFcgV2hpbGUgRXNjYXBlIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkZhcm0gU2V0dGluZ3MiLCAiZmFybSIpDQogICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZy5mYXJtOmFkZFN1Yk1lbnUoIkxhbmVDbGVhciBTZXR0aW5ncyIsImxhbmVjbGVhciIpDQogICAgICAgIHNlbGYuQ29uZmlnLmZhcm0ubGFuZWNsZWFyOmFkZFBhcmFtKCJ1c2VRIiwiVXNlIFEgb24gTGFuZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuZmFybS5sYW5lY2xlYXI6YWRkUGFyYW0oInVzZVciLCJVc2UgVyBvbiBMYW5lY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgICAgLS1zZWxmLkNvbmZpZy5mYXJtLmxhbmVjbGVhcjphZGRQYXJhbSgidXNlRSIsIlVzZSBFIG9uIExhbmVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmZhcm0ubGFuZWNsZWFyOmFkZFBhcmFtKCJNYW5hIiwiTWFuYSBNYW5hZ2VyICUiLFNDUklQVF9QQVJBTV9TTElDRSwgMzAsIDEwLCAxMDAsIDApDQogICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZy5mYXJtOmFkZFN1Yk1lbnUoIkp1bmdsZUNsZWFyIFNldHRpbmdzIiwianVuZ2xlY2xlYXIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyOmFkZFBhcmFtKCJ1c2VRIiwiVXNlIFEgb24ganVuZ2xlY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyOmFkZFBhcmFtKCJ1c2VXIiwiVXNlIFcgb24ganVuZ2xlY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyOmFkZFBhcmFtKCJ1c2VFIiwiVXNlIEUgb24ganVuZ2xlY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyOmFkZFBhcmFtKCJNYW5hIiwiTWFuYSBNYW5hZ2VyICUiLFNDUklQVF9QQVJBTV9TTElDRSwgMzAsIDEwLCAxMDAsIDApDQogICAgICAgIA0KICAgICAgICAtLXNlbGYuQ29uZmlnLmZhcm06YWRkU3ViTWVudSgiTGFzdGhpdCBTZXR0aW5ncyIsImxhc3RoaXQiKQ0KICAgICAgICAtLXNlbGYuQ29uZmlnLmZhcm0ubGFzdGhpdDphZGRQYXJhbSgidXNlUSIsIlVzZSBRIG9uIExhc3RoaXQiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICAtLXNlbGYuQ29uZmlnLmZhcm0ubGFzdGhpdDphZGRQYXJhbSgidXNlVyIsIlVzZSBXIG9uIExhc3RoaXQiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICAtLXNlbGYuQ29uZmlnLmZhcm0ubGFzdGhpdDphZGRQYXJhbSgidXNlRSIsIlVzZSBFIG9uIExhc3RoaXQiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICAtLXNlbGYuQ29uZmlnLmZhcm0ubGFzdGhpdDphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDMwLCAxMCwgMTAwLCAwKQ0KICAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIktpbGxTdGVhbCBTZXR0aW5ncyIsICJraWxsc3RlYWwiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oImtzIiwiS2lsbHN0ZWFsIE9uL09mZiIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgidXNlUSIsICJTdGVhbCBXaXRoIFEiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgidXNlRSIsICJTdGVhbCBXaXRoIEUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgidXNlUiIsICJTdGVhbCBXaXRoIFIiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgidXNlSSIsICJTdGVhbCBXaXRoIElnbml0ZSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkl0ZW0gU2V0dGluZ3MiLCAiaXRlbSIpDQogICAgICAgIHNlbGYuQ29uZmlnLml0ZW06YWRkUGFyYW0oImVuYWJsZWF1dG96aG9ueWEiLCAiQXV0byBaaG9ueWEiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIGZhbHNlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5pdGVtOmFkZFBhcmFtKCJhdXRvemhvbnlhIiwgIlpob255YSBpZiBIZWFsdGggdW5kZXIgLT4gJSIsIFNDUklQVF9QQVJBTV9TTElDRSwgMTAsIDAsIDEwMCwgMCkNCiAgICAgICAgDQogICAgICAgICAgICAgIGlmIFZJUF9VU0VSIHRoZW4NCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiVklQIFNldHRpbmdzIiwgInZpcCIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgicGFja2V0IiwiVXNlIFBhY2tldCBDYXN0aW5nIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzEiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzIiLCAiVG8gdXNlIHZpcCBzZXR0aW5ncywgUGFja2V0IENhc3Rpbmcgc2hvdWxkIGJlIG9wZW4uIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRTdWJNZW51KCJBdXRvIExldmVsIFNldHRpbmdzIiwgImxldmVsIikNCiAgICAgICAgc2VsZi5Db25maWcudmlwLmxldmVsOmFkZFBhcmFtKCJrZXkiLCJVc2UgQXV0byBMZXZlbCIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXAubGV2ZWw6YWRkUGFyYW0oImxvZ2ljIiwgIlNlbGVjdCBTa2lsbCBPcmRlciIsIFNDUklQVF9QQVJBTV9MSVNULCA3LCB7IkZvY3VzIFE+Vz5FIiwgIkZvY3VzIFE+RT5XIiwiRm9jdXMgVz5RPkUiLCJGb2N1cyBXPkU+USIsIkZvY3VzIEU+Vz5RIiwgIkZvY3VzIEU+UT5XIiAsICJTbWFydCIgIH0pDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRTdWJNZW51KCJTa2luIEhhY2sgU2V0dGluZ3MiLCAic2tpbiIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcC5za2luOmFkZFBhcmFtKCJrZXkiLCJVc2UgU2tpbiBIYWNrIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcC5za2luOmFkZFBhcmFtKCdzZWxlY3RlZCcgLi4gbXlIZXJvLmNoYXJOYW1lIC4uICdTa2luJywgIlNlbGVjdCBTa2luIiwgU0NSSVBUX1BBUkFNX0xJU1QsIDEsIHNraW5NZXRhW215SGVyby5jaGFyTmFtZV0pDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcC5za2luOmFkZFBhcmFtKCJpbmZvNSIsICJNYWtlIHN1cmUgdGhhdCB1c2luZyBwYWNrZXQgY2FzdGluZyBpcyBPTi4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgLS1zZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm81IiwgIlNraW4gSGFjayB0ZW1wb3JhcnkgZGlzYWJsZWQgdW50aWwgbmV4dCB1cGRhdGUuIC4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgLS1bW3NlbGYuQ29uZmlnLnZpcDphZGRTdWJNZW51KCJBbnRpLUFGSyBTZXR0aW5ncyIsICJhbnRpYWZrIikNCiAgICAgICAgc2VsZi5Db25maWcudmlwLmFudGlhZms6YWRkUGFyYW0oImFudGlhZmsiLCJVc2UgQW50aSBBZmsiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkgXV0NCiAgICAgICAgc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvMyIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvNCIsICJUbyB1c2UgdmlwIHNldHRpbmdzLCBZb3UgbmVlZCB0byBiZSBhIFZJUCB1c2VyIG9uIEJPTCBjb21tdW5pdHkuIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgZW5kDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkRyYXcgU2V0dGluZ3MiLCJvdGhlciIpDQogICAgICAgIC0tc2VsZi5Db25maWcub3RoZXI6YWRkU3ViTWVudSgiU2hvdyBEYW1hZ2UgT24gSHAgQmFyIiwgIkhQQkFSIikNCiAgICAgICAgLS1zZWxmLkNvbmZpZy5vdGhlci5IUEJBUjphZGRQYXJhbSgia2V5IiwiT04vT0ZGIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXI6YWRkU3ViTWVudSgiU2tpbGwgRHJhd2luZyBTZXR0aW5ncyIsICJkcmF3IikNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgicWRyYXciLCJRIFNraWxsIERyYXdpbmdzIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgid2RyYXciLCJXIFNraWxsIERyYXdpbmdzIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgiZWRyYXciLCJFIFNraWxsIERyYXdpbmdzIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgicmRyYXciLCJSIFNraWxsIERyYXdpbmdzIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgiYWFkcmF3IiwiQXV0byBBdHRhY2sgUmFuZ2UiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgDQogICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJUYXJnZXRzZWxlY3RvcnMiLCJ0YXJnZXRzZWwiKQ0KICAgICAgc2VsZi50cy5uYW1lICA9ICJMaXNzYW5kcmEgR2VuZXJhbCINCiAgICAgIHNlbGYudHNxLm5hbWUgPSAiTGlzc2FuZHJhIFEgU2tpbGwiDQogICAgICBzZWxmLnRzdy5uYW1lID0gIkxpc3NhbmRyYSBXIFNraWxsIg0KICAgICAgc2VsZi50c2UubmFtZSA9ICJMaXNzYW5kcmEgRSBTa2lsbCINCiAgICAgIHNlbGYudHNyLm5hbWUgPSAiTGlzc2FuZHJhIFIgU2tpbGwiDQogICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkVFMoc2VsZi50cykNCiAgICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRUUyhzZWxmLnRzcSkNCiAgICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRUUyhzZWxmLnRzdykNCiAgICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRUUyhzZWxmLnRzZSkNCiAgICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRUUyhzZWxmLnRzcikgDQogICAgICANCiAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIktleXMgU2V0dGluZ3MiLCAiS2V5cyIpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJpbmZvSzMiLCAiPC0tLS0tLS0tLS0tLS0tLS0tLUNvbWJvIEtleSBTZXR0aW5ncy0tLS0tLS0tLS0tLS0tLS0tLT4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImNvbWJva2V5IiwgIkNvbWJvIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCAzMikNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImNvbWJva2V5ciIsICJTdGFydCBFbmdhZ2UgV2l0aCBZb3VyIFVsdGkgIiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJVIikpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJpbmZvSzQiLCAiPC0tLS0tLS0tLS0tLS0tLS0tLUhhcmFzcyBLZXkgU2V0dGluZ3MtLS0tLS0tLS0tLS0tLS0tLS0+IiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJoYXJhc3NrZXkiLCAiU21hcnQgSGFyYXNzIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiQyIpKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaGFyYXNzdG9nbGVrZXkiLCAiSGFyYXNzIFRvZ2xlIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWVRPR0dMRSwgZmFsc2UsIHN0cmluZy5ieXRlKCJUIikpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJpbmZvSzUiLCAiPC0tLS0tLS0tLS0tLS0tLS0tLUNsZWFyIEtleSBTZXR0aW5ncy0tLS0tLS0tLS0tLS0tLS0tLS0tPiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgibGFuZWNsZWFya2V5IiwgIkxhbmVDbGVhciBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIlYiKSkNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImp1bmdsZWNsZWFya2V5IiwgIkp1bmdsZUNsZWFyIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiWiIpKQ0KICAgICAgLS1zZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJsYXN0aGl0a2V5IiwgIkxhc3RoaXQgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJYIikpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJpbmZvSzYiLCAiPC0tLS0tLS0tLS0tLS0tLS0tLU90aGVyIEtleSBTZXR0aW5ncy0tLS0tLS0tLS0tLS0tLS0tLS0tPiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiZXNjYXBla2V5IiwgIkVzY2FwZSBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIlkiKSkNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0syIiwgIk1ha2UgU3VyZSBUaGF0IFlvdXIgT3Jid2Fsa2VyIEtleXMgYXJlIFNhbWUgQXMgSGVyZSIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgDQogICAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiT3Jid2Fsa2VyIEtleSBTZXR0aW5ncyIsICJLZXlzMiIpDQogICAgICBPcmJ3YWxrTWFuYWdlcjpMb2FkQ29tbW9uS2V5cyhzZWxmLkNvbmZpZy5LZXlzMikNCiAgICAgIHNlbGYuQ29uZmlnLktleXMyOmFkZFBhcmFtKCJpbmZvSzQiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzMjphZGRQYXJhbSgiaW5mb0syMiIsICJNYWtlIFN1cmUgVGhhdCBZb3VyIFNjcmlwdCBLZXlzIGFyZSBTYW1lIEFzIEhlcmUiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICANCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mbzMiLCAiX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXyIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94IiwgIiAgICAgICAgICAgICAgICIuLlNjcmlwdG5hbWUuLiIiLCBTQ1JJUFRfUEFSQU1fSU5GTywgIiIpIA0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94MiIsICIgICAgICAgICAgICAgICAgIFNjcmlwdCBWZXJzaW9uOiAgIi4uVmVyc2lvbi4uICIgICAgICAgICAiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDYiLCAiICAgICAgICAgICAgU2NyaXB0IHdhcyBtYWRlIGJ5ICAiLi5BdXRob3IuLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3g1IiwgIiAgICAgICBMZWF1Z2UgT2YgTGVnZW5kcyBWZXJzaW9uOiAgIi4uTFZlcnNpb24uLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgDQogICAgICAgc2VsZi5Db25maWc6cGVybWFTaG93KCJpbmZvYm94IikNCiAgICAgICBzZWxmLkNvbmZpZy5LZXlzOnBlcm1hU2hvdygiY29tYm9rZXkiKQ0KICAgICAgIHNlbGYuQ29uZmlnLktleXM6cGVybWFTaG93KCJoYXJhc3N0b2dsZWtleSIpDQogICAgICAgc2VsZi5Db25maWcuS2V5czpwZXJtYVNob3coImhhcmFzc2tleSIpDQogICAgDQogIA0KICBlbmQNCmZ1bmN0aW9uIExpc3NhbmRyYTpza2luaGFjaygpDQogIGlmIG5vdCBGYWtlTG9hZCB0aGVuDQogIGlmICgoQ3VycmVudFRpbWVJbk1pbGxpcygpIC0gbGFzdFRpbWVUaWNrQ2FsbGVkKSA+IDIwMCkgdGhlbg0KICAgICAgbGFzdFRpbWVUaWNrQ2FsbGVkID0gQ3VycmVudFRpbWVJbk1pbGxpcygpDQogICAgaWYgc2VsZi5Db25maWcudmlwLnNraW4ua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAucGFja2V0ICB0aGVuDQogICAgaWYgc2VsZi5Db25maWcudmlwLnNraW5bJ3NlbGVjdGVkJyAuLiBteUhlcm8uY2hhck5hbWUgLi4gJ1NraW4nXSB+PSBsYXN0U2tpbiB0aGVuDQogICAgICAgIGxhc3RTa2luID0gc2VsZi5Db25maWcudmlwLnNraW5bJ3NlbGVjdGVkJyAuLiBteUhlcm8uY2hhck5hbWUgLi4gJ1NraW4nXQ0KICBTZW5kU2tpblBhY2tldChteUhlcm8uY2hhck5hbWUsIHNraW5zUEJbc2VsZi5Db25maWcudmlwLnNraW5bJ3NlbGVjdGVkJyAuLiBteUhlcm8uY2hhck5hbWUgLi4gJ1NraW4nXV0sIG15SGVyby5uZXR3b3JrSUQpOw0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExpc3NhbmRyYTphdXRvbGV2ZWwoKQ0KaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSAxIGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlMSA9ICAgeyAxLDIsMywxLDEsNCwxLDIsMSwyLDQsMiwyLDMsMyw0LDMsM30NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlMSkNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDIgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2UyID0gICB7IDEsMiwzLDEsMSw0LDEsMywxLDMsNCwzLDMsMiwyLDQsMiwyfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2UyKQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gMyBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTMgPSAgeyAyLDMsMSwyLDIsNCwyLDEsMiwxLDQsMSwxLDMsMyw0LDMsM30NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlMykNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDQgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2U0ID0gIHsgMiwzLDEsMiwyLDQsMiwzLDIsMyw0LDMsMywxLDEsNCwxLDF9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTQpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSA1IGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlNSA9ICB7IDMsMSwyLDMsMyw0LDMsMiwzLDIsNCwyLDIsMSwxLDQsMSwxfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2U1KQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gNiBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTYgPSAgeyAzLDEsMiwzLDMsNCwzLDEsMywxLDQsMSwxLDIsMiw0LDIsMn0NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlNikNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICAgIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gNyBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTYgPSAgeyAxLDMsMiwxLDEsNCwxLDIsMSwyLDQsMiwyLDMsMyw0LDMsM30NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlNikNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGlzc2FuZHJhOmF1dG96aG9ueWEoKQ0KICAgIGlmIHNlbGYuQ29uZmlnLml0ZW0uZW5hYmxlYXV0b3pob255YSB0aGVuDQogICAgIGZvciBfID0gSVRFTV8xLCBJVEVNXzcgZG8NCiAgICAgIGlmIG15SGVyby5oZWFsdGggPD0gKG15SGVyby5tYXhIZWFsdGggKiBzZWxmLkNvbmZpZy5pdGVtLmF1dG96aG9ueWEgLyAxMDApIGFuZCAoIG15SGVybzpDYW5Vc2VTcGVsbChfKSA9PSAwIGFuZCBteUhlcm86R2V0U3BlbGxEYXRhKF8pLm5hbWUgPT0gIlpob255YXNIb3VyZ2xhc3MiICl0aGVuIENhc3RTcGVsbChfKQ0KICAgIGVuZA0KICAgIGVuZA0KICAgIGVuZA0KICAgIGVuZA0KICANCiAgZnVuY3Rpb24gTGlzc2FuZHJhOmF1dG9SKCkNCiAgICBpZiAoIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljLmVuYWJsZWF1dG9SIGFuZCAoc2VsZi5Db25maWcuc2tpbGxsb2dpYy5SbG9naWMuUmxvZ2ljID09IDIgb3Igc2VsZi5Db25maWcuc2tpbGxsb2dpYy5SbG9naWMuUmxvZ2ljID09IDEpKSB0aGVuDQogICAgICBpZiBteUhlcm8uaGVhbHRoIDw9IChteUhlcm8ubWF4SGVhbHRoICogc2VsZi5Db25maWcuc2tpbGxsb2dpYy5SbG9naWMuYXV0b1IgLyAxMDApIHRoZW4gc2VsZjpDYXN0UlMobXlIZXJvKQ0KICAgICAgZW5kDQogICAgZW5kDQogICAgZW5kDQogIA0KICBmdW5jdGlvbiBMaXNzYW5kcmE6ZW5nYWdld2l0aHIoKQ0KICAgc2VsZi50c3E6dXBkYXRlKCkNCiAgIGlmIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXlyIHRoZW4NCiAgIHNlbGY6d2FsaygpDQogICBlbmQNCiAgICAgIGlmKHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKWFuZCBzZWxmLnRzcS50YXJnZXR+PW5pbCAgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVEgYW5kIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXlyICApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFEoc2VsZi50c3EudGFyZ2V0KQ0KICAgICAgZW5kDQogICAgICBzZWxmLnRzZTp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi5FU3BlbGw6SXNSZWFkeSgpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmNvbWJvLk1hbmEgLzEwMCApYW5kIHNlbGYudHNlLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VFIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ciApdGhlbg0KICAgICAgICAgICAgICAgIGxvY2FsIFRpY2tlciA9IEdldFRpY2tDb3VudCgpDQogIGlmIChnbG9iYWxfdGlja3MgKyAyMDAwKSA8IFRpY2tlciB0aGVuDQogIGlmIChteUhlcm86Q2FuVXNlU3BlbGwoX0UpID09IFJFQURZICkgdGhlbg0KICAgICBDYXN0U3BlbGwoX0UsIHNlbGYudHNlLnRhcmdldC54LCBzZWxmLnRzZS50YXJnZXQueikNCiAgICAgZ2xvYmFsX3RpY2tzID0gVGlja2VyDQogICAgICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBDYXN0U3BlbGwoX0UpIGVuZCwgMS41KQ0KICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgICAgIGlmKHNlbGYuV1NwZWxsOklzUmVhZHkoKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKSBhbmQgc2VsZi50c3cudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVcgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ciAgKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RXKHNlbGYudHN3LnRhcmdldCkNCiAgICAgIGVuZA0KICAgICAgc2VsZi50c3I6dXBkYXRlKCkNCiAgICAgIGlmKHNlbGYuUlNwZWxsOklzUmVhZHkoKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKSBhbmQgc2VsZi50c3IudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVIgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ciApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFIoc2VsZi50c3IudGFyZ2V0KQ0KICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExpc3NhbmRyYTpEcmF3KCkNCiAgICAgIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcucWRyYXcgYW5kIHNlbGYuUVNwZWxsOklzUmVhZHkoKSB0aGVuDQogICAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgNzI1LCAxLHJlZCkNCiAgICBlbmQNCiAgDQogICAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy53ZHJhdyBhbmQgc2VsZi5XU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCAxMDUwLCAxLCByZWQpDQogICAgZW5kDQogIA0KICAgIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcuZWRyYXcgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSB0aGVuDQogICAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgNDIwLCAxLCByZWQpDQogICAgZW5kDQogICAgDQogICAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5yZHJhdyBhbmQgc2VsZi5SU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCA1MDAsMSwgcmVkKQ0KICAgIGVuZA0KICAgIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcuYWFkcmF3IHRoZW4NCiAgICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCA1NTAsMSwgQVJHQigyNTUsIDI1NSwwLDApKQ0KICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGlzc2FuZHJhOmFudGlnYXB3KCkNCiAgICAgIGlmKHNlbGYuV1NwZWxsOklzUmVhZHkoKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKWFuZCBzZWxmLnRzdy50YXJnZXR+PW5pbCAgYW5kIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuV2xvZ2ljLnVzZVcgICl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0VyhzZWxmLnRzdy50YXJnZXQpDQogICAgICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExpc3NhbmRyYTpjb21ibygpDQogICAgICAgIHNlbGYudHNxOnVwZGF0ZSgpDQogICAgICBpZihzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwIClhbmQgc2VsZi50c3EudGFyZ2V0fj1uaWwgIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VRIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFEoc2VsZi50c3EudGFyZ2V0KQ0KICAgICAgZW5kDQogICAgICBzZWxmLnRzZTp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi5Db25maWcuc2tpbGxsb2dpYy5FbG9naWMuY29tYm8gPT0gMSBhbmQgIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwIClhbmQgc2VsZi5Db25maWcuY29tYm8udXNlRSBhbmQgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgKXRoZW4NCiAgICAgIGxvY2FsIFRpY2tlciA9IEdldFRpY2tDb3VudCgpDQogIGlmIChnbG9iYWxfdGlja3MgKyAyMDAwKSA8IFRpY2tlciB0aGVuDQogIGlmIChteUhlcm86Q2FuVXNlU3BlbGwoX0UpID09IFJFQURZIGFuZCBzZWxmLnRzZS50YXJnZXR+PW5pbCkgdGhlbg0KICAgICBDYXN0U3BlbGwoX0UsIHNlbGYudHNlLnRhcmdldC54LCBzZWxmLnRzZS50YXJnZXQueikNCiAgICAgZ2xvYmFsX3RpY2tzID0gVGlja2VyDQogICAgICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBDYXN0U3BlbGwoX0UpIGVuZCwgMS41KQ0KICAgICAgICAgIGVuZA0KICAgICAgICAgIGVuZA0KICAgICAgICAgIGVuZA0KICAgICAgICAgaWYoc2VsZi5Db25maWcuc2tpbGxsb2dpYy5FbG9naWMuY29tYm8gPT0gMiBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKSBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlRSBhbmQgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgKXRoZW4NCiAgICAgICAgIGxvY2FsIFRpY2tlciA9IEdldFRpY2tDb3VudCgpDQogIGlmIChnbG9iYWxfdGlja3MgKyAyMDAwKSA8IFRpY2tlciB0aGVuDQogIGlmIChteUhlcm86Q2FuVXNlU3BlbGwoX0UpID09IFJFQURZIGFuZCBzZWxmLnRzZS50YXJnZXR+PW5pbCkgdGhlbg0KICAgICBDYXN0U3BlbGwoX0UsIHNlbGYudHNlLnRhcmdldC54LCBzZWxmLnRzZS50YXJnZXQueikNCiAgICAgZ2xvYmFsX3RpY2tzID0gVGlja2VyDQogICAgICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBDYXN0U3BlbGwoX0UpIGVuZCwgMikNCiAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIHNlbGYudHN3OnVwZGF0ZSgpDQogICAgICBpZihzZWxmLldTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwICkgYW5kIHNlbGYudHN3LnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VXIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgICl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0VyhzZWxmLnRzdy50YXJnZXQpDQogICAgICBlbmQNCiAgICAgIGlmKHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljLlJsb2dpYyA9PSAzIG9yIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljLlJsb2dpYyA9PSAxIGFuZCBzZWxmLlJTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwICkgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVIgYW5kIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICl0aGVuDQogICAgICBmb3IgXywgdW5pdCBpbiBwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbw0KICAgICAgICBsb2NhbCBkbWdSID1nZXREbWcoIlIiLHVuaXQsbXlIZXJvKSsgKChteUhlcm8uYXApKjAuNzApIA0KICAgICAgICBsb2NhbCBoZWFsdGg9dW5pdC5oZWFsdGgNCiAgICAgICAgaWYoaGVhbHRoPGRtZ1IgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVIgYW5kIEdldERpc3RhbmNlKHVuaXQpPDU1MCl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0Uih1bml0KQ0KICAgICAgZWxzZWlmIChzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLlJsb2dpYy5SbG9naWMgPT0gMiBhbmQgIG15SGVyby5oZWFsdGggPD0gKG15SGVyby5tYXhIZWFsdGggKiBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLlJsb2dpYy5hdXRvUiAvIDEwMCkpIHRoZW4gDQogICAgICAgc2VsZjpDYXN0UlMobXlIZXJvKQ0KICAgICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIA0KICAgICAgaWYoc2VsZi5Db25maWcuY29tYm8udXNlSSBhbmQgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgKXRoZW4NCiAgICAgIGZvciBfLCB1bml0IGluIHBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvDQogICAgICAgIGxvY2FsIGRtZ0kgPSg1MCsgKChteUhlcm8ubGV2ZWwpKjIwKSkNCiAgICAgICAgbG9jYWwgaGVhbHRoPXVuaXQuaGVhbHRoDQogICAgICAgIGlmKGhlYWx0aDxkbWdJIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VJIGFuZCBHZXREaXN0YW5jZSh1bml0KTw2MDApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEkodW5pdCkNCiAgICAgIGVuZA0KICAgICAgZW5kDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGlzc2FuZHJhOkNhc3RRKHVuaXQpDQogICAgc2VsZi5RU3BlbGw6Q2FzdCh1bml0KQ0KICBlbmQNCiAgDQogIGZ1bmN0aW9uIExpc3NhbmRyYTpDYXN0Vyh1bml0KQ0KICAgIHNlbGYuV1NwZWxsOkNhc3QodW5pdCkNCiAgZW5kDQogIA0KICBmdW5jdGlvbiBMaXNzYW5kcmE6Q2FzdEUodW5pdCkNCiAgICBzZWxmLkVTcGVsbDpDYXN0KHVuaXQpDQogIGVuZA0KICANCiAgZnVuY3Rpb24gTGlzc2FuZHJhOkNhc3RSKHVuaXQpDQogICAgc2VsZi5SU3BlbGw6Q2FzdCh1bml0KQ0KICBlbmQNCiAgZnVuY3Rpb24gTGlzc2FuZHJhOkNhc3RSUyh1bml0KQ0KICAgQ2FzdFNwZWxsKF9SICwgbXlIZXJvKQ0KICBlbmQNCiAgDQogIGZ1bmN0aW9uIExpc3NhbmRyYTpDYXN0SSh1bml0KQ0KICAgIHNlbGYuSWduaXRlOkNhc3QodW5pdCkNCiAgZW5kDQogIGZ1bmN0aW9uIExpc3NhbmRyYTpraWxsc3RlYWwoKQ0KICBmb3IgXywgdW5pdCBpbiBwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbw0KICAgICAgbG9jYWwgaGVhbHRoID0gdW5pdC5oZWFsdGgNCiAgICAgIGxvY2FsIGRtZ0UgPSBnZXREbWcoIkUiLCB1bml0LCBteUhlcm8pICsgKChteUhlcm8uYXApKjAuNikgDQogICAgICAgIGlmKHNlbGYudHNlLnRhcmdldCB+PSBuaWwgYW5kICBzZWxmLkVTcGVsbDpJc1JlYWR5KCkgYW5kIGhlYWx0aDxkbWdFIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlRSAgIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MpdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEUodW5pdCkgIA0KICAgICAgICBlbmQNCiAgICAgICAgbG9jYWwgZG1nUSA9IGdldERtZygiUSIsIHVuaXQsIG15SGVybykgKyAoKG15SGVyby5hcCkqMC42NSkNCiAgICAgICAgaWYoc2VsZi50c3EudGFyZ2V0IH49IG5pbCBhbmQgIHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgaGVhbHRoPGRtZ1EgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VRIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RRKHVuaXQpICANCiAgICAgICAgZW5kDQogICAgICAgIGxvY2FsIGRtZ1cgPSBnZXREbWcoIlciLCB1bml0LCBteUhlcm8pICsgKChteUhlcm8uYXApKjAuNDApDQogICAgICAgIGlmKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgYW5kICBzZWxmLldTcGVsbDpJc1JlYWR5KCkgYW5kIGhlYWx0aDxkbWdRIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlVyBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzICl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0Vyh1bml0KSAgDQogICAgICAgIGVuZA0KICAgICAgICAgbG9jYWwgZG1nSSA9KDUwKyAoKG15SGVyby5sZXZlbCkqMjApKQ0KICAgICAgICBpZihoZWFsdGg8ZG1nSSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZUkgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyBhbmQgR2V0RGlzdGFuY2UodW5pdCk8NjAwKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RJKHVuaXQpDQogICAgICAgIGVuZA0KICAgICAgICBsb2NhbCBkbWdSID1nZXREbWcoIlIiLHVuaXQsbXlIZXJvKSsoKG15SGVyby5hcCkqMC43MCkgDQogICAgICAgIGlmKHNlbGYudHNyLnRhcmdldCB+PSBuaWwgYW5kICBzZWxmLlJTcGVsbDpJc1JlYWR5KCkgYW5kIGhlYWx0aDxkbWdSIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlUiBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzIGFuZCBHZXREaXN0YW5jZSh1bml0KTw1NTApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFIodW5pdCkNCiAgICAgICAgZW5kDQogICAgIGVuZA0KICBlbmQNCiAgDQogIGZ1bmN0aW9uIExpc3NhbmRyYTplc2NhcGUoKQ0KICBsb2NhbCBUaWNrZXIgPSBHZXRUaWNrQ291bnQoKQ0KICBpZiAoZ2xvYmFsX3RpY2tzICsgMjAwMCkgPCBUaWNrZXIgdGhlbg0KICBpZiBzZWxmLkNvbmZpZy5LZXlzLmVzY2FwZWtleSBhbmQgc2VsZi5Db25maWcuZXNjYXBlLnVzZUUgIHRoZW4NCiAgaWYgKG15SGVybzpDYW5Vc2VTcGVsbChfRSkgPT0gUkVBRFkgKSB0aGVuDQogICAgIENhc3RTcGVsbChfRSxtb3VzZVBvcy54LG1vdXNlUG9zLnopDQogICAgIGdsb2JhbF90aWNrcyA9IFRpY2tlcg0KICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgQ2FzdFNwZWxsKF9FKSBlbmQsIDEuNSkNCiAgZW5kDQogIGVuZA0KICBlbmQNCiAgaWYgc2VsZi5Db25maWcuS2V5cy5lc2NhcGVrZXkgdGhlbiANCiAgc2VsZjp3YWxrKCkNCiAgZW5kDQogIGlmIHNlbGYuQ29uZmlnLktleXMuZXNjYXBla2V5IGFuZCBzZWxmLkNvbmZpZy5lc2NhcGUudXNlVyBhbmQgc2VsZi50c3cudGFyZ2V0fj1uaWwgdGhlbg0KICBDYXN0U3BlbGwoX1csdHN3LnRhcmdldCkNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMaXNzYW5kcmE6d2FsaygpDQogICAgbXlIZXJvOk1vdmVUbyhtb3VzZVBvcy54LG1vdXNlUG9zLnopDQogIGVuZA0KICBmdW5jdGlvbiBMaXNzYW5kcmE6aGFyYXNzKCkNCiAgICBzZWxmLnRzOnVwZGF0ZSgpDQogICAgc2VsZi50c3E6dXBkYXRlKCkNCiAgICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgICAgIHNlbGYudHNlOnVwZGF0ZSgpDQogICAgaWYgc2VsZi5Db25maWcuS2V5cy5oYXJhc3NrZXkgb3Igc2VsZi5Db25maWcuS2V5cy5oYXJhc3N0b2dsZWtleSB0aGVuDQogICAgICAgIGlmKHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5oYXJhc3MuTWFuYSAvMTAwICkgYW5kIHNlbGYudHNxLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5oYXJhc3MudXNlUSApIHRoZW4gICAgICAgIA0KICAgICAgICAgIHNlbGY6Q2FzdFEoc2VsZi50c3EudGFyZ2V0KQ0KICAgICAgICBlbmQgICANCiAgICAgICAgZW5kDQogICAgaWYgc2VsZi5Db25maWcuS2V5cy5oYXJhc3NrZXkgb3Igc2VsZi5Db25maWcuS2V5cy5oYXJhc3N0b2dsZWtleSB0aGVuDQogICAgICAgIGlmKHNlbGYuV1NwZWxsOklzUmVhZHkoKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5oYXJhc3MuTWFuYSAvMTAwICkgYW5kIHNlbGYudHN3LnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5oYXJhc3MudXNlVyApIHRoZW4gICAgICAgIA0KICAgICAgICAgIHNlbGY6Q2FzdFcoc2VsZi50c3cudGFyZ2V0KQ0KICAgICAgICBlbmQgIA0KICAgICAgICBlbmQgDQogICAgICAgICAgaWYgc2VsZi5Db25maWcuS2V5cy5oYXJhc3NrZXkgb3Igc2VsZi5Db25maWcuS2V5cy5oYXJhc3N0b2dsZWtleSAgdGhlbg0KICAgICAgICBpZihzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLkVsb2dpYy5oYXJhc3MgPT0gMSAgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuaGFyYXNzLk1hbmEgLzEwMCApICBhbmQgc2VsZi5Db25maWcuaGFyYXNzLnVzZUUgKSB0aGVuICAgICAgICANCiAgICAgICAgIGxvY2FsIFRpY2tlciA9IEdldFRpY2tDb3VudCgpDQogIGlmIChnbG9iYWxfdGlja3MgKyAyMDAwKSA8IFRpY2tlciB0aGVuDQogIGlmIChteUhlcm86Q2FuVXNlU3BlbGwoX0UpID09IFJFQURZIGFuZCBzZWxmLnRzZS50YXJnZXR+PW5pbCkgdGhlbg0KICAgICBDYXN0U3BlbGwoX0UsIHNlbGYudHNlLnRhcmdldC54LCBzZWxmLnRzZS50YXJnZXQueikNCiAgICAgZ2xvYmFsX3RpY2tzID0gVGlja2VyDQogICAgICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBDYXN0U3BlbGwoX0UpIGVuZCwgMikNCiAgICAgICAgICBlbmQNCiAgICAgICAgICBlbmQNCiAgICAgICAgICBlbmQNCiAgICAgICAgICBlbmQNCiAgICAgICAgICAgaWYgc2VsZi5Db25maWcuS2V5cy5oYXJhc3NrZXkgb3Igc2VsZi5Db25maWcuS2V5cy5oYXJhc3N0b2dsZWtleSAgdGhlbg0KICAgICAgICAgICAgICAgaWYoc2VsZi5Db25maWcuc2tpbGxsb2dpYy5FbG9naWMuaGFyYXNzID09IDIgYW5kICAgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5oYXJhc3MuTWFuYSAvMTAwICkgIGFuZCBzZWxmLkNvbmZpZy5oYXJhc3MudXNlRSApIHRoZW4gICAgICAgIA0KICAgICAgICAgbG9jYWwgVGlja2VyID0gR2V0VGlja0NvdW50KCkNCiAgaWYgKGdsb2JhbF90aWNrcyArIDIwMDApIDwgVGlja2VyIHRoZW4NCiAgaWYgKG15SGVybzpDYW5Vc2VTcGVsbChfRSkgPT0gUkVBRFkgYW5kIHNlbGYudHNlLnRhcmdldH49bmlsKSB0aGVuDQogICAgIENhc3RTcGVsbChfRSwgc2VsZi50c2UudGFyZ2V0LngsIHNlbGYudHNlLnRhcmdldC56KQ0KICAgICBnbG9iYWxfdGlja3MgPSBUaWNrZXINCiAgICAgICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIENhc3RTcGVsbChfRSkgZW5kLCAxLjUpDQogICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGVuZA0KICBmdW5jdGlvbiBMaXNzYW5kcmE6TGFuZUNsZWFyKCkNCiAgIGxvY2FsIGNsZWFydGFyZ2V0ID0gbmlsDQogIHNlbGYuZW5lbXlNaW5pb25zOnVwZGF0ZSgpDQogICBzZWxmLm90aGVyTWluaW9uczp1cGRhdGUoKQ0KICAgICAgc2VsZi5qdW5nbGVNaW5pb25zOnVwZGF0ZSgpDQogICAgICBmb3IgaSwgbWluaW9uIGluIGlwYWlycyhzZWxmLmVuZW15TWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgICBpZiBWYWxpZFRhcmdldChtaW5pb24sIDYwMCkgYW5kIChjbGVhcnRhcmdldCA9PSBuaWwgb3Igbm90IFZhbGlkVGFyZ2V0KGNsZWFydGFyZ2V0KSkgdGhlbg0KICAgICAgICAgIGNsZWFydGFyZ2V0ID0gbWluaW9uDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBmb3IgaSwgbWluaW9uIGluIHBhaXJzKHNlbGYuZW5lbXlNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICAgIGlmIFZhbGlkVGFyZ2V0KG1pbmlvbikgYW5kIG1pbmlvbiB+PSBuaWwgdGhlbg0KICAgICAgICAgIGlmIHNlbGYuQ29uZmlnLktleXMubGFuZWNsZWFya2V5ICBhbmQgc2VsZi5Db25maWcuZmFybS5sYW5lY2xlYXIudXNlUSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5mYXJtLmxhbmVjbGVhci5NYW5hIC8xMDAgKSBhbmQgR2V0RGlzdGFuY2UobWluaW9uKSA8PSBzZWxmLlFTcGVsbC5SYW5nZSB0aGVuIA0KICAgICAgICAgbG9jYWwgQmVzdFBvcywgQmVzdEhpdCA9IEdldEJlc3RMaW5lRmFybVBvc2l0aW9uKHNlbGYuUVNwZWxsLlJhbmdlLCBzZWxmLlFTcGVsbC5XaWR0aCwgc2VsZi5lbmVteU1pbmlvbnMub2JqZWN0cyApDQogICAgICAgIGlmIEJlc3RQb3MgIGFuZCBCZXN0SGl0ID4gMCB0aGVuDQogICAgICAgICBDYXN0U3BlbGwoX1EsIEJlc3RQb3MueCwgQmVzdFBvcy56KQ0KICAgICAgICAgIGVuZA0KICAgICAgICBpZiBjbGVhcnRhcmdldCB+PSBuaWwgdGhlbg0KICAgICAgICBpZihzZWxmLldTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYuQ29uZmlnLmZhcm0ubGFuZWNsZWFyLnVzZVcgYW5kIHNlbGYuQ29uZmlnLktleXMubGFuZWNsZWFya2V5ICkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuZmFybS5sYW5lY2xlYXIuTWFuYSAvMTAwICkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFcoY2xlYXJ0YXJnZXQpDQogICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgICAgICAgZW5kDQogICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExpc3NhbmRyYTphdXRvcSgpDQogIA0KICAgICAgICBpZihzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuaGFyYXNzLk1hbmEgLzEwMCApIGFuZCBzZWxmLnRzcS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuaGFyYXNzLmF1dG9xICkgdGhlbiAgICAgICAgDQogICAgICAgICAgc2VsZjpDYXN0UShzZWxmLnRzcS50YXJnZXQpDQogICAgICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExpc3NhbmRyYTpKdW5nbGVDbGVhcigpDQogIGxvY2FsIGNsZWFydGFyZ2V0ID0gbmlsDQogICAgICBzZWxmLmVuZW15TWluaW9uczp1cGRhdGUoKQ0KICAgICAgc2VsZi5vdGhlck1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIHNlbGYuanVuZ2xlTWluaW9uczp1cGRhdGUoKQ0KICAgICAgZm9yIGksIG1pbmlvbiBpbiBpcGFpcnMoc2VsZi5lbmVteU1pbmlvbnMub2JqZWN0cykgZG8NCiAgICAgICAgaWYgVmFsaWRUYXJnZXQobWluaW9uLCA2MDApIGFuZCAoY2xlYXJ0YXJnZXQgPT0gbmlsIG9yIG5vdCBWYWxpZFRhcmdldChjbGVhcnRhcmdldCkpIHRoZW4NCiAgICAgICAgICBjbGVhcnRhcmdldCA9IG1pbmlvbg0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgZm9yIGksIGp1bmdsZW1pbmlvbiBpbiBpcGFpcnMoc2VsZi5qdW5nbGVNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICAgIGlmIFZhbGlkVGFyZ2V0KGp1bmdsZW1pbmlvbiwgNjAwKSBhbmQgKGNsZWFydGFyZ2V0ID09IG5pbCBvciBub3QgVmFsaWRUYXJnZXQoY2xlYXJ0YXJnZXQpKSB0aGVuDQogICAgICAgICAgY2xlYXJ0YXJnZXQgPSBqdW5nbGVtaW5pb24NCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGZvciBpLCBvdGhlcm1pbmlvbiBpbiBpcGFpcnMoc2VsZi5vdGhlck1pbmlvbnMub2JqZWN0cykgZG8NCiAgICAgICAgaWYgVmFsaWRUYXJnZXQob3RoZXJtaW5pb24sIDYwMCkgYW5kIChjbGVhcnRhcmdldCA9PSBuaWwgb3Igbm90IFZhbGlkVGFyZ2V0KGNsZWFydGFyZ2V0KSkgdGhlbg0KICAgICAgICAgIGNsZWFydGFyZ2V0ID0gb3RoZXJtaW5pb24NCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGlmIGNsZWFydGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGlmKHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci51c2VRIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmp1bmdsZWNsZWFya2V5ICkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0UShjbGVhcnRhcmdldCkNCiAgICAgICAgZW5kDQogICAgICAgIGlmIGNsZWFydGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGlmKHNlbGYuV1NwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci51c2VXIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmp1bmdsZWNsZWFya2V5ICkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0VyhjbGVhcnRhcmdldCkNCiAgICAgICAgZW5kDQogICAgICAgIGlmIGNsZWFydGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGlmKHNlbGYuRVNwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci51c2VFIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmp1bmdsZWNsZWFya2V5ICkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0RShjbGVhcnRhcmdldCkNCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICBlbmQNCiAgZW5kDQogIGVuZA0KICAgLS0tLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxcLS0tDQotLXx8ID4gVmlrdG9yIFN0YXJ0cyAgICAgICAgICAgICAgICAgICAgICAgICB8fC0tDQotLS1cXD09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ly8tLS0NCiAgY2xhc3MgIlZpa3RvciINCiAgcmVxdWlyZSAnSFByZWRpY3Rpb24nDQogIGZ1bmN0aW9uIFZpa3RvcjpfX2luaXQoKQ0KICAgc2VsZi50cz0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgNTI1LCBEQU1BR0VfUEhZU0lDQUwsIGZhbHNlLCB0cnVlKQ0KICAgIHNlbGYudHNxPSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCA2MDAsIERBTUFHRV9QSFlTSUNBTCwgZmFsc2UsIHRydWUpDQogICAgc2VsZi50c3c9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDcwMCwgREFNQUdFX01BR0lDLCBmYWxzZSwgdHJ1ZSkNCiAgICBzZWxmLnRzZT0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgMTIwMCwgREFNQUdFX01BR0lDLCBmYWxzZSwgdHJ1ZSkNCiAgICBzZWxmLnRzcj0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgNzAwLCBEQU1BR0VfTUFHSUMsIGZhbHNlLCB0cnVlKSANCiAgICAgc2VsZi5RU3BlbGwgPSBfU3BlbGwoe1Nsb3QgPSBfUSwgRGFtYWdlTmFtZSA9ICJRIiwgUmFuZ2UgPSBtYXRoLmh1Z2UsIFdpZHRoID0gMSwgRGVsYXkgPSAwLCBTcGVlZCA9IG1hdGguaHVnZSwgQ29sbGlzaW9uID0gdHJ1ZSwgQW9lID0gZmFsc2UsIFR5cGUgPSBTUEVMTF9UWVBFLlRBUkdFVFRFRH0pDQogICAgIHNlbGYuV1NwZWxsID0gX1NwZWxsKHtTbG90ID0gX1csIERhbWFnZU5hbWUgPSAiVyIsIFJhbmdlID0gbWF0aC5odWdlLCBXaWR0aCA9IDEyNSwgRGVsYXkgPSAwLjUsIFNwZWVkID0gNzUwLCBDb2xsaXNpb24gPSBmYWxzZSwgQW9lID0gdHJ1ZSwgVHlwZSA9IFNQRUxMX1RZUEUuQ0lSQ1VMQVJ9KQ0KICAgICBzZWxmLkVTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9FLCBEYW1hZ2VOYW1lID0gIkUiLCBSYW5nZSA9IDEyMDAsIFdpZHRoID0gOTAsIERlbGF5ID0gMCwgU3BlZWQgPSBtYXRoLmh1Z2UsIENvbGxpc2lvbiA9IHRydWUsIEFvZSA9IGZhbHNlLCBUeXBlID0gU1BFTExfVFlQRS5MSU5FQVJ9KQ0KICAgICBzZWxmLlJTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9SLCBEYW1hZ2VOYW1lID0gIlIiLCBSYW5nZSA9NzAwLCBXaWR0aCA9IDAsIERlbGF5ID0gMC4yNSwgU3BlZWQgPSAxMDAwLCBDb2xsaXNpb24gPSBmYWxzZSwgQW9lID0gdHJ1ZSwgVHlwZSA9IFNQRUxMX1RZUEUuQ0lSQ1VMQVJ9KQ0KICAgICBzZWxmLklnbml0ZSA9IF9TcGVsbCh7U2xvdCA9IEZpbmRTdW1tb25lclNsb3QoInN1bW1vbmVyZG90IiksIERhbWFnZU5hbWUgPSAiSUdOSVRFIiwgUmFuZ2UgPSA2MDAsIFR5cGUgPSBTUEVMTF9UWVBFLlRBUkdFVFRFRH0pDQogICAgIHNlbGYuSFByZWQgPSBIUHJlZGljdGlvbigpDQogICAgIHNlbGYuRSA9IHtSYW5nZTEgPSA1NTAsIFJhbmdlMiA9IDcwMCwgd2lkdGggPSAxODAsIHJlYWR5fQ0KICAgICBzZWxmLkVSYW5nZSA9IHNlbGYuRS5SYW5nZTErc2VsZi5FLlJhbmdlMg0KICAtLXw+IE1pbmlvbiBNYW5hZ2Vycw0KICAgICAgc2VsZi5lbmVteU1pbmlvbnMgICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX0VORU1ZLCAgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgICAgc2VsZi5hbGx5TWluaW9ucyAgICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX0FMTFksICAgNjUwLCBteUhlcm8sIE1JTklPTl9TT1JUX01BWEhFQUxUSF9ERUMpDQogICAgICBzZWxmLmp1bmdsZU1pbmlvbnMgID0gbWluaW9uTWFuYWdlcihNSU5JT05fSlVOR0xFLCAgNjUwLCBteUhlcm8sIE1JTklPTl9TT1JUX01BWEhFQUxUSF9ERUMpDQogICAgICBzZWxmLm90aGVyTWluaW9ucyAgID0gbWluaW9uTWFuYWdlcihNSU5JT05fT1RIRVIsICAgNjUwLCBteUhlcm8sIE1JTklPTl9TT1JUX01BWEhFQUxUSF9ERUMpDQogICAgICAgICAgICAgIHNlbGY6TG9hZE1lbnUoKQ0KICAgICAgICAgICAgICBzZWxmOmZpbmRvcmJ3YWxrZXIoKQ0KICAgICAgICAgICAgICAgIExhc3RfTGV2ZWxTcGVsbCA9IDANCiAgICAgIA0KICAgICAgICBBZGRUaWNrQ2FsbGJhY2soZnVuY3Rpb24oKSBzZWxmOlRpY2soKSBlbmQpDQogICAgQWRkRHJhd0NhbGxiYWNrKGZ1bmN0aW9uKCkgc2VsZjpEcmF3KCkgZW5kKQ0KICAgIC0tQWRkTXNnQ2FsbGJhY2soZnVuY3Rpb24obXNnLEtleSkgc2VsZjpXbmRNc2cobXNnLEtleSkgZW5kKQ0KICAgIC0tQWRkQW5pbWF0aW9uQ2FsbGJhY2soZnVuY3Rpb24odW5pdCwgYW5pbWF0aW9uKSBzZWxmOkFuaW1hdGlvbih1bml0LCBhbmltYXRpb24pIGVuZCkNCiAgICAtLUFkZFByb2Nlc3NTcGVsbENhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIHNwZWxsKSBzZWxmOlByb2Nlc3NTcGVsbCh1bml0LCBzcGVsbCkgZW5kKQ0KICAgIC0tQWRkQXBwbHlCdWZmQ2FsbGJhY2soZnVuY3Rpb24oc291cmNlLCB1bml0LCBidWZmKSBzZWxmOk9uQXBwbHlCdWZmKHNvdXJjZSwgdW5pdCwgYnVmZikgZW5kKQ0KICAgIC0tQWRkVXBkYXRlQnVmZkNhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIGJ1ZmYsIHN0YWNrcykgc2VsZjpVcGRhdGVCdWZmKHVuaXQsIGJ1ZmYsIHN0YWNrcykgZW5kKQ0KICAgIC0tQWRkUmVtb3ZlQnVmZkNhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIGJ1ZmYpIHNlbGY6T25SZW1vdmVCdWZmKHVuaXQsIGJ1ZmYpIGVuZCkgDQogICAgICBlbmQNCiAgLS0gaGFuZGxlcyBzY3JpcHQgbG9naWMsIGEgcHVyZSBoaWdoIHNwZWVkIGxvb3ANCiAgZnVuY3Rpb24gVmlrdG9yOlRpY2soKQ0KICAgICAgIHNlbGY6YXV0b3pob255YSgpDQogICAgICAgICAgIGlmIFZJUF9VU0VSIHRoZW4gc2VsZjphdXRvbGV2ZWwoKSBlbmQNCiAgICAgICAgICAgIGlmIFZJUF9VU0VSIHRoZW4gc2VsZjpza2luaGFjaygpIGVuZA0KICAgaWYoc2VsZi5Db25maWcuY29tYm8uY29tYm9rZXkgKXRoZW4NCiAgICAgIHNlbGY6Y29tYm8oKQ0KICAgIGVuZA0KICAgIGlmKHNlbGYuQ29uZmlnLmxhbmVjbGVhci5sYW5lY2xlYXJrZXkpdGhlbg0KICAgICAgc2VsZjpMYW5lQ2xlYXIoKQ0KICAgIGVuZA0KICAgICAgaWYoc2VsZi5Db25maWcuanVuZ2xlY2xlYXIuanVuZ2xlY2xlYXJrZXkpdGhlbg0KICAgICAgc2VsZjpKdW5nbGVDbGVhcigpDQogICAgZW5kDQogICAgaWYoc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzICkgdGhlbg0KICAgICAgc2VsZjpraWxsc3RlYWwoKQ0KICAgIGVuZA0KICAgIGlmKHNlbGYuQ29uZmlnLmhhcmFzcy5oYXJhc3NrZXkgb3Igc2VsZi5Db25maWcuaGFyYXNzLmhhcmFzc3RvZ2xlICkgdGhlbg0KICAgICAgc2VsZjpoYXJhc3MoKQ0KICAgIGVuZA0KICAgICAgZW5kDQogIGZ1bmN0aW9uIFZpa3RvcjpMb2FkTWVudSgpDQogICAgICAgICBzZWxmLkNvbmZpZz1zY3JpcHRDb25maWcoIiIuLlNjcmlwdG5hbWUuLiIgWyIgLi4gbXlIZXJvLmNoYXJOYW1lLi4iXSIgLCJtZW51IikNCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiSGl0Y2hhbmNlIiwgImhpdCIpDQogICAgICAgIHNlbGYuQ29uZmlnLmhpdDphZGRQYXJhbSgiRSIsICJFIEhpdENoYW5jZSAoRGVmYXVsdCB2YWx1ZSA9IDEuNikiLCBTQ1JJUFRfUEFSQU1fU0xJQ0UsIDEuNiwgMSwgMywgMikNCiAgICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiQ29tYm8gU2V0dGluZ3MiLCAiY29tYm8iKQ0KICAgICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgiY29tYm9rZXkiLCAiQ29tYm8gS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIDMyKQ0KICAgICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlUSIsICJVc2UgUSBpbiBDb21ibyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZVciLCAiVXNlIFcgaW4gQ29tYm8iLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VFIiwgIlVzZSBFIGluIGNvbWJvIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlUiIsICJVc2UgUiBpbiBjb21ibyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZUkiLCAiVXNlIElnbml0ZSBpZiB0YXJnZXQga2lsbGFibGUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJsb2dpYyIsICJVbHRpIExvZ2ljIiwgU0NSSVBUX1BBUkFNX0xJU1QsIDEsIHsiVXNlIFVsdGkgSWYgVGFyZ2V0IElzIEtpbGxhYmxlIix9KSAtLSgiVXNlIFVsdGkgRGlyZWN0bHkiIH0pDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJNYW5hIiwiTWFuYSBNYW5hZ2VyICUiLFNDUklQVF9QQVJBTV9TTElDRSwgMTAsIDEwLCAxMDAsIDApDQogICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJIYXJhc3MgU2V0dGluZ3MiLCAiaGFyYXNzIikNCiAgICAgICAgc2VsZi5Db25maWcuaGFyYXNzOmFkZFBhcmFtKCJoYXJhc3NrZXkiLCAiU21hcnQgSGFyYXNzIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiQyIpKQ0KICAgICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6YWRkUGFyYW0oImhhcmFzc3RvZ2xlIiwgIlNtYXJ0IEF1dG8gSGFyYXNzIiwgICBTQ1JJUFRfUEFSQU1fT05LRVlUT0dHTEUsIGZhbHNlLCBzdHJpbmcuYnl0ZSgiVCIpKQ0KICAgICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6YWRkUGFyYW0oInVzZVEiLCAiSGFyYXNzIFdpdGggUSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuaGFyYXNzOmFkZFBhcmFtKCJ1c2VFIiwgIkhhcmFzcyBXaXRoIEUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczphZGRQYXJhbSgiRSIsICJFIEhpdENoYW5jZSAoRGVmYXVsdCB2YWx1ZSA9IDIpIiwgU0NSSVBUX1BBUkFNX1NMSUNFLCAyLCAxLCAzLCAyKQ0KICAgICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6YWRkUGFyYW0oIk1hbmEiLCJNYW5hIE1hbmFnZXIgJSIsU0NSSVBUX1BBUkFNX1NMSUNFLCAzMCwgMTAsIDEwMCwgMCkNCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkxhbmVDbGVhciBTZXR0aW5ncyIsImxhbmVjbGVhciIpDQogICAgICAgIHNlbGYuQ29uZmlnLmxhbmVjbGVhcjphZGRQYXJhbSgibGFuZWNsZWFya2V5IiwgIkxhbmUgQ2xlYXIgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJWIikpDQogICAgICAgIHNlbGYuQ29uZmlnLmxhbmVjbGVhcjphZGRQYXJhbSgidXNlUSIsIlVzZSBRIG9uIExhbmVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmxhbmVjbGVhcjphZGRQYXJhbSgidXNlRSIsIlVzZSBFIG9uIExhbmVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmxhbmVjbGVhcjphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDMwLCAxMCwgMTAwLCAwKQ0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiSnVuZ2xlQ2xlYXIgU2V0dGluZ3MiLCJqdW5nbGVjbGVhciIpDQogICAgICAgIHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyOmFkZFBhcmFtKCJqdW5nbGVjbGVhcmtleSIsICJKdW5nbGVDbGVhciBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIlYiKSkNCiAgICAgICAgc2VsZi5Db25maWcuanVuZ2xlY2xlYXI6YWRkUGFyYW0oInVzZVEiLCJVc2UgUSBvbiBqdW5nbGVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyOmFkZFBhcmFtKCJ1c2VFIiwiVXNlIEUgb24ganVuZ2xlY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhcjphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDMwLCAxMCwgMTAwLCAwKQ0KICAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIktpbGxTdGVhbCBTZXR0aW5ncyIsICJraWxsc3RlYWwiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oImtzIiwiS2lsbHN0ZWFsIE9uL09mZiIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgidXNlUSIsICJTdGVhbCBXaXRoIFEiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgidXNlRSIsICJTdGVhbCBXaXRoIEUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgidXNlUiIsICJTdGVhbCBXaXRoIFIiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgidXNlSSIsICJTdGVhbCBXaXRoIElnbml0ZSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkl0ZW0gU2V0dGluZ3MiLCAiaXRlbSIpDQogICAgICAgIHNlbGYuQ29uZmlnLml0ZW06YWRkUGFyYW0oImVuYWJsZWF1dG96aG9ueWEiLCAiQXV0byBaaG9ueWEiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIGZhbHNlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5pdGVtOmFkZFBhcmFtKCJhdXRvemhvbnlhIiwgIlpob255YSBpZiBIZWFsdGggdW5kZXIgLT4gJSIsIFNDUklQVF9QQVJBTV9TTElDRSwgMTAsIDAsIDEwMCwgMCkNCiAgICAgICAgDQogICAgICAgICAgICAgIGlmIFZJUF9VU0VSIHRoZW4NCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiVklQIFNldHRpbmdzIiwgInZpcCIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgicGFja2V0IiwiVXNlIFBhY2tldCBDYXN0aW5nIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzEiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzIiLCAiVG8gdXNlIHZpcCBzZXR0aW5ncywgUGFja2V0IENhc3Rpbmcgc2hvdWxkIGJlIG9wZW4uIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRTdWJNZW51KCJBdXRvIExldmVsIFNldHRpbmdzIiwgImxldmVsIikNCiAgICAgICAgc2VsZi5Db25maWcudmlwLmxldmVsOmFkZFBhcmFtKCJrZXkiLCJVc2UgQXV0byBMZXZlbCIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXAubGV2ZWw6YWRkUGFyYW0oImxvZ2ljIiwgIlNlbGVjdCBTa2lsbCBPcmRlciIsIFNDUklQVF9QQVJBTV9MSVNULCA3LCB7IkZvY3VzIFE+Vz5FIiwgIkZvY3VzIFE+RT5XIiwiRm9jdXMgVz5RPkUiLCJGb2N1cyBXPkU+USIsIkZvY3VzIEU+Vz5RIiwgIkZvY3VzIEU+UT5XIiwgIlNtYXJ0IiAgfSkNCiAgICAgICAgc2VsZi5Db25maWcudmlwOmFkZFN1Yk1lbnUoIlNraW4gSGFjayBTZXR0aW5ncyIsICJza2luIikNCiAgICAgICAgc2VsZi5Db25maWcudmlwLnNraW46YWRkUGFyYW0oImtleSIsIlVzZSBTa2luIEhhY2siLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcudmlwLnNraW46YWRkUGFyYW0oJ3NlbGVjdGVkJyAuLiBteUhlcm8uY2hhck5hbWUgLi4gJ1NraW4nLCAiU2VsZWN0IFNraW4iLCBTQ1JJUFRfUEFSQU1fTElTVCwgMSwgc2tpbk1ldGFbbXlIZXJvLmNoYXJOYW1lXSkNCiAgICAgICAgc2VsZi5Db25maWcudmlwLnNraW46YWRkUGFyYW0oImluZm81IiwgIk1ha2Ugc3VyZSB0aGF0IHVzaW5nIHBhY2tldCBjYXN0aW5nIGlzIE9OLiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICAtLXNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzUiLCAiU2tpbiBIYWNrIHRlbXBvcmFyeSBkaXNhYmxlZCB1bnRpbCBuZXh0IHVwZGF0ZS4gLiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICAtLVtbc2VsZi5Db25maWcudmlwOmFkZFN1Yk1lbnUoIkFudGktQUZLIFNldHRpbmdzIiwgImFudGlhZmsiKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXAuYW50aWFmazphZGRQYXJhbSgiYW50aWFmayIsIlVzZSBBbnRpIEFmayIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKSBdXQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm8zIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm80IiwgIlRvIHVzZSB2aXAgc2V0dGluZ3MsIFlvdSBuZWVkIHRvIGJlIGEgVklQIHVzZXIgb24gQk9MIGNvbW11bml0eS4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBlbmQNCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiRHJhdyBTZXR0aW5ncyIsIm90aGVyIikNCiAgICAgICAgLS1zZWxmLkNvbmZpZy5vdGhlcjphZGRTdWJNZW51KCJTaG93IERhbWFnZSBPbiBIcCBCYXIiLCAiSFBCQVIiKQ0KICAgICAgICAtLXNlbGYuQ29uZmlnLm90aGVyLkhQQkFSOmFkZFBhcmFtKCJrZXkiLCJPTi9PRkYiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5vdGhlcjphZGRTdWJNZW51KCJTa2lsbCBEcmF3aW5nIFNldHRpbmdzIiwgImRyYXciKQ0KICAgICAgICBzZWxmLkNvbmZpZy5vdGhlci5kcmF3OmFkZFBhcmFtKCJxZHJhdyIsIlEgU2tpbGwgRHJhd2luZ3MiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5vdGhlci5kcmF3OmFkZFBhcmFtKCJ3ZHJhdyIsIlcgU2tpbGwgRHJhd2luZ3MiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5vdGhlci5kcmF3OmFkZFBhcmFtKCJlZHJhdyIsIkUgU2tpbGwgRHJhd2luZ3MiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5vdGhlci5kcmF3OmFkZFBhcmFtKCJyZHJhdyIsIlIgU2tpbGwgRHJhd2luZ3MiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5vdGhlci5kcmF3OmFkZFBhcmFtKCJhYWRyYXciLCJBdXRvIEF0dGFjayBSYW5nZSIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiVGFyZ2V0c2VsZWN0b3JzIiwidGFyZ2V0c2VsIikNCiAgICAgc2VsZi50cy5uYW1lICA9ICJWaWt0b3IiDQogICAgICBzZWxmLnRzcS5uYW1lID0gIlZpa3RvclEiDQogICAgICBzZWxmLnRzdy5uYW1lID0gIlZpa3RvclciDQogICAgICBzZWxmLnRzZS5uYW1lID0gIlZpa3RvckUiDQogICAgICBzZWxmLnRzci5uYW1lID0gIlZpa3RvclIiDQogICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkVFMoc2VsZi50cykNCiAgICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRUUyhzZWxmLnRzcSkNCiAgICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRUUyhzZWxmLnRzdykNCiAgICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRUUyhzZWxmLnRzZSkNCiAgICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRUUyhzZWxmLnRzcikgDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJLZXlzIFNldHRpbmdzIiwgIktleXMiKQ0KICAgICAgT3Jid2Fsa01hbmFnZXI6TG9hZENvbW1vbktleXMoc2VsZi5Db25maWcuS2V5cykNCiAgICAgICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm8zIiwgIl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveCIsICIgICAgICAgICAgICAgICAiLi5TY3JpcHRuYW1lLi4iIiwgU0NSSVBUX1BBUkFNX0lORk8sICIiKSANCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDIiLCAiICAgICAgICAgICAgICAgICBTY3JpcHQgVmVyc2lvbjogICIuLlZlcnNpb24uLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3g2IiwgIiAgICAgICAgICAgIFNjcmlwdCB3YXMgbWFkZSBieSAgIi4uQXV0aG9yLi4gIiAgICAgICAgICIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94NSIsICIgICAgICAgTGVhdWdlIE9mIExlZ2VuZHMgVmVyc2lvbjogICIuLkxWZXJzaW9uLi4gIiAgICAgICAgICIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIA0KICAgICAgIHNlbGYuQ29uZmlnOnBlcm1hU2hvdygiaW5mb2JveCIpDQogICAgICAgc2VsZi5Db25maWcuY29tYm86cGVybWFTaG93KCJjb21ib2tleSIpDQogICAgICAgc2VsZi5Db25maWcuaGFyYXNzOnBlcm1hU2hvdygiaGFyYXNzdG9nbGUiKQ0KICAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczpwZXJtYVNob3coImhhcmFzc2tleSIpDQogICAgDQogIGVuZA0KICBmdW5jdGlvbiBWaWt0b3I6RHJhdygpDQogICAgICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LnFkcmF3IGFuZCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkgdGhlbg0KICAgICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDYwMCwgMSxyZWQpDQogICAgZW5kDQogIA0KICAgIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcud2RyYXcgYW5kIHNlbGYuV1NwZWxsOklzUmVhZHkoKSB0aGVuDQogICAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgNzAwLCAxLCByZWQpDQogICAgZW5kDQogIA0KICAgIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcuZWRyYXcgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSB0aGVuDQogICAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgMTIwMCwgMSwgcmVkKQ0KICAgIGVuZA0KICAgIA0KICAgIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcucmRyYXcgYW5kIHNlbGYuUlNwZWxsOklzUmVhZHkoKSB0aGVuDQogICAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgNzAwLDEsIHJlZCkNCiAgICBlbmQNCiAgICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LmFhZHJhdyB0aGVuDQogICAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgNTI1LDEsIEFSR0IoMjU1LCAyNTUsMCwwKSkNCiAgICBlbmQNCiAgZW5kDQogIA0KZnVuY3Rpb24gVmlrdG9yOnNraW5oYWNrKCkNCiAgaWYgbm90IEZha2VMb2FkIHRoZW4NCiAgaWYgKChDdXJyZW50VGltZUluTWlsbGlzKCkgLSBsYXN0VGltZVRpY2tDYWxsZWQpID4gMjAwKSB0aGVuDQogICAgICBsYXN0VGltZVRpY2tDYWxsZWQgPSBDdXJyZW50VGltZUluTWlsbGlzKCkNCiAgICBpZiBzZWxmLkNvbmZpZy52aXAuc2tpbi5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgIHRoZW4NCiAgICBpZiBzZWxmLkNvbmZpZy52aXAuc2tpblsnc2VsZWN0ZWQnIC4uIG15SGVyby5jaGFyTmFtZSAuLiAnU2tpbiddIH49IGxhc3RTa2luIHRoZW4NCiAgICAgICAgbGFzdFNraW4gPSBzZWxmLkNvbmZpZy52aXAuc2tpblsnc2VsZWN0ZWQnIC4uIG15SGVyby5jaGFyTmFtZSAuLiAnU2tpbiddDQogIFNlbmRTa2luUGFja2V0KG15SGVyby5jaGFyTmFtZSwgc2tpbnNQQltzZWxmLkNvbmZpZy52aXAuc2tpblsnc2VsZWN0ZWQnIC4uIG15SGVyby5jaGFyTmFtZSAuLiAnU2tpbiddXSwgbXlIZXJvLm5ldHdvcmtJRCk7DQogIGVuZA0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gVmlrdG9yOmF1dG9sZXZlbCgpDQppZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDEgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2UxID0gICB7IDEsMiwzLDEsMSw0LDEsMiwxLDIsNCwyLDIsMywzLDQsMywzfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2UxKQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gMiBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTIgPSAgIHsgMSwyLDMsMSwxLDQsMSwzLDEsMyw0LDMsMywyLDIsNCwyLDJ9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTIpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSAzIGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlMyA9ICB7IDIsMywxLDIsMiw0LDIsMSwyLDEsNCwxLDEsMywzLDQsMywzfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2UzKQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gNCBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTQgPSAgeyAyLDMsMSwyLDIsNCwyLDMsMiwzLDQsMywzLDEsMSw0LDEsMX0NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlNCkNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDUgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2U1ID0gIHsgMywxLDIsMywzLDQsMywyLDMsMiw0LDIsMiwxLDEsNCwxLDF9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTUpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSA2IGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlNiA9ICB7IDMsMSwyLDMsMyw0LDMsMSwzLDEsNCwxLDEsMiwyLDQsMiwyfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2U2KQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogICAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSA3IGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlNiA9ICB7IDEsMywzLDIsMyw0LDMsMSwzLDEsNCwxLDIsMSwyLDQsMiwyfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2U2KQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBWaWt0b3I6YXV0b3pob255YSgpDQogICAgaWYgc2VsZi5Db25maWcuaXRlbS5lbmFibGVhdXRvemhvbnlhIHRoZW4NCiAgICAgZm9yIF8gPSBJVEVNXzEsIElURU1fNyBkbw0KICAgICAgaWYgbXlIZXJvLmhlYWx0aCA8PSAobXlIZXJvLm1heEhlYWx0aCAqIHNlbGYuQ29uZmlnLml0ZW0uYXV0b3pob255YSAvIDEwMCkgYW5kICggbXlIZXJvOkNhblVzZVNwZWxsKF8pID09IDAgYW5kIG15SGVybzpHZXRTcGVsbERhdGEoXykubmFtZSA9PSAiWmhvbnlhc0hvdXJnbGFzcyIgKXRoZW4gQ2FzdFNwZWxsKF8pDQogICAgZW5kDQogICAgZW5kDQogICAgZW5kDQogICAgZW5kDQogICAgZnVuY3Rpb24gVmlrdG9yOm9ubHlyKCkNCiAgICBpZiAoc2VsZi5SU3BlbGw6SXNSZWFkeSgpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmNvbWJvLk1hbmEgLzEwMCApIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VSIGFuZCBzZWxmLkNvbmZpZy5jb21iby5jb21ib2tleSBhbmQgR2V0RGlzdGFuY2Uoc2VsZi50c3IudGFyZ2V0KTw3MDAgKXRoZW4NCiAgICAgIHNlbGY6Q2FzdFIoc2VsZi50c3IudGFyZ2V0KQ0KICAgICAgZW5kDQogICAgZW5kDQogIGZ1bmN0aW9uIFZpa3Rvcjpjb21ibygpDQogICAgICAgIHNlbGYudHNxOnVwZGF0ZSgpDQogICAgICBpZihzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwIClhbmQgc2VsZi50c3EudGFyZ2V0fj1uaWwgIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VRIGFuZCBzZWxmLkNvbmZpZy5jb21iby5jb21ib2tleSAgKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RRKHNlbGYudHNxLnRhcmdldCkNCiAgICAgIGVuZA0KICAgICAgc2VsZi50c2U6dXBkYXRlKCkNCiAgICAgIGlmKHNlbGYuRVNwZWxsOklzUmVhZHkoKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKWFuZCBzZWxmLnRzZS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlRSBhbmQgc2VsZi5Db25maWcuY29tYm8uY29tYm9rZXkgICl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0RShzZWxmLnRzZS50YXJnZXQpDQogICAgICBlbmQNCiAgICAgIHNlbGYudHN3OnVwZGF0ZSgpDQogICAgICBpZihzZWxmLldTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwICkgYW5kIHNlbGYudHN3LnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VXIGFuZCAgc2VsZi5Db25maWcuY29tYm8uY29tYm9rZXkgICl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0VyhzZWxmLnRzdy50YXJnZXQpDQogICAgICBlbmQNCiAgICAgIGlmKCBzZWxmLlJTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwICkgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVIgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLmNvbWJva2V5ICl0aGVuDQogICAgICBmb3IgXywgdW5pdCBpbiBwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbw0KICAgICAgICBsb2NhbCBkbWdSID1nZXREbWcoIlIiLHVuaXQsbXlIZXJvKSsgKChteUhlcm8uYXApKjAuNTUpIA0KICAgICAgICBsb2NhbCBoZWFsdGg9dW5pdC5oZWFsdGgNCiAgICAgICAgaWYoaGVhbHRoPGRtZ1IgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID09IDEgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVIgYW5kIEdldERpc3RhbmNlKHVuaXQpPDcwMCl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0Uih1bml0KQ0KICAgICAgIGVuZA0KICAgICAgIGVuZA0KICAgICAgIGlmIChzZWxmLkNvbmZpZy5jb21iby5sb2dpYyA9PSAyIGFuZCBzZWxmLnRzci50YXJnZXR+PW5pbCkgdGhlbg0KICAgICAgIHNlbGY6b25seXIoKQ0KICAgICAgZW5kDQogICAgDQogICAgICBpZihzZWxmLkNvbmZpZy5jb21iby51c2VJIGFuZCBzZWxmLkNvbmZpZy5jb21iby5jb21ib2tleSApdGhlbg0KICAgICAgZm9yIF8sIHVuaXQgaW4gcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8NCiAgICAgICAgbG9jYWwgZG1nSSA9KDUwKyAoKG15SGVyby5sZXZlbCkqMjApKQ0KICAgICAgICBsb2NhbCBoZWFsdGg9dW5pdC5oZWFsdGgNCiAgICAgICAgaWYoaGVhbHRoPGRtZ0kgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZUkgYW5kIEdldERpc3RhbmNlKHVuaXQpPDYwMCl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0SSh1bml0KQ0KICAgICAgZW5kDQogICAgICBlbmQNCiAgZW5kDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gVmlrdG9yOkNhc3RRKHVuaXQpDQogICAgc2VsZi5RU3BlbGw6Q2FzdCh1bml0KQ0KICBlbmQNCiAgDQogIGZ1bmN0aW9uIFZpa3RvcjpDYXN0Vyh1bml0KQ0KICAgIHNlbGYuV1NwZWxsOkNhc3QodW5pdCkNCiAgZW5kDQogIA0KICBmdW5jdGlvbiBWaWt0b3I6Q2FzdEUodW5pdCkNCiAgIA0KICAgIGlmIHVuaXQuZGVhZCBvciB1bml0LmhlYWx0aCA9PSAwIHRoZW4NCiAgICAgIHJldHVybg0KICAgIGVuZA0KICAgIA0KICAgIGlmIEdldERpc3RhbmNlKHVuaXQsIG15SGVybykgPiBzZWxmLkUuUmFuZ2UxLTUgdGhlbg0KICAgICBFU3RhcnRQb3MgPSBDaXJjbGVJbnRlcnNlY3Rpb24obXlIZXJvLCB1bml0LCBteUhlcm8sIHNlbGYuRS5SYW5nZTEtNSkNCiAgICBlbHNlDQogICAgIEVTdGFydFBvcyA9IFZlY3Rvcih1bml0LngsIHVuaXQueSwgdW5pdC56KQ0KICAgIGVuZA0KICAgIA0KICAgICBFUG9zLCBFSGl0Q2hhbmNlID0gc2VsZi5IUHJlZDpHZXRQcmVkaWN0KHNlbGYuSFByZWQuUHJlc2V0c1snVmlrdG9yJ11bIkUiXSwgdW5pdCwgRVN0YXJ0UG9zKQ0KICAgIA0KICAgIGlmIG1vZGUgPT0gIkNvbWJvIiBhbmQgRUhpdENoYW5jZSA+PSBzZWxmLkNvbmZpZy5oaXQuRSBvciBtb2RlID09ICJIYXJhc3MiIGFuZCBFSGl0Q2hhbmNlID49IHNlbGYuQ29uZmlnLmhhcmFzcy5FIG9yICBtb2RlID09IG5pbCBhbmQgRUhpdENoYW5jZSA+IDEgdGhlbg0KICAgICAgQ2FzdFNwZWxsMyhfRSwgRDNEWFZFQ1RPUjMoRVN0YXJ0UG9zLngsIDAsIEVTdGFydFBvcy56KSwgRDNEWFZFQ1RPUjMoRVBvcy54LCAwLCBFUG9zLnopKQ0KICAgIGVuZA0KICAgIA0KICBlbmQNCiAgDQogIGZ1bmN0aW9uIFZpa3RvcjpDYXN0Uih1bml0KQ0KICAgIHNlbGYuUlNwZWxsOkNhc3QodW5pdCkNCiAgZW5kDQogIGZ1bmN0aW9uIFZpa3RvcjpDYXN0SSh1bml0KQ0KICAgIHNlbGYuSWduaXRlOkNhc3QodW5pdCkNCiAgZW5kDQogIGZ1bmN0aW9uIFZpa3RvcjpraWxsc3RlYWwoKQ0KICBmb3IgXywgdW5pdCBpbiBwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbw0KICAgICAgbG9jYWwgaGVhbHRoID0gdW5pdC5oZWFsdGgNCiAgICAgIGxvY2FsIGRtZ0UgPSBnZXREbWcoIkUiLCB1bml0LCBteUhlcm8pICsgKChteUhlcm8uYXApKjAuNykgKyAoKGdldERtZygiRSIsIHVuaXQsIG15SGVybykgKyAoKG15SGVyby5hcCkqMC43KSkqMC40KQ0KICAgICAgICBpZihzZWxmLnRzZS50YXJnZXQgfj0gbmlsIGFuZCAgc2VsZi5FU3BlbGw6SXNSZWFkeSgpIGFuZCBoZWFsdGg8ZG1nRSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZUUgYW5kIEdldERpc3RhbmNlKHVuaXQpPDcwMCAgIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MpdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEUodW5pdCkgIA0KICAgICAgICBlbmQNCiAgICAgICAgbG9jYWwgZG1nUSA9IGdldERtZygiUSIsIHVuaXQsIG15SGVybykgKyAoKG15SGVyby5hcCkqMC4zMCkNCiAgICAgICAgaWYoc2VsZi50c3EudGFyZ2V0IH49IG5pbCBhbmQgIHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgaGVhbHRoPGRtZ1EgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VRIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RRKHVuaXQpICANCiAgICAgICAgZW5kDQogICAgICAgICBsb2NhbCBkbWdJID0oNTArICgobXlIZXJvLmxldmVsKSoyMCkpDQogICAgICAgIGlmKGhlYWx0aDxkbWdJIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlSSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzIGFuZCBHZXREaXN0YW5jZSh1bml0KTw2MDApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEkodW5pdCkNCiAgICAgICAgZW5kDQogICAgICAgIGxvY2FsIGRtZ1IgPWdldERtZygiUiIsdW5pdCxteUhlcm8pKygobXlIZXJvLmFwKSowLjU1KSANCiAgICAgICAgaWYoc2VsZi50c3IudGFyZ2V0IH49IG5pbCBhbmQgIHNlbGYuUlNwZWxsOklzUmVhZHkoKSBhbmQgaGVhbHRoPGRtZ1IgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VSIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgYW5kIEdldERpc3RhbmNlKHVuaXQpPDcwMCl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0Uih1bml0KQ0KICAgICAgICBlbmQNCiAgICAgZW5kDQogIGVuZA0KICANCiAgZnVuY3Rpb24gVmlrdG9yOmhhcmFzcygpDQogICAgc2VsZi50czp1cGRhdGUoKQ0KICAgIHNlbGYudHNxOnVwZGF0ZSgpDQogICAgaWYgc2VsZi5Db25maWcuaGFyYXNzLmhhcmFzc2tleSBvciBzZWxmLkNvbmZpZy5oYXJhc3MuaGFyYXNzdG9nbGUgIHRoZW4NCiAgICAgICAgaWYoc2VsZi5RU3BlbGw6SXNSZWFkeSgpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmhhcmFzcy5NYW5hIC8xMDAgKSBhbmQgc2VsZi50c3EudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmhhcmFzcy51c2VRICkgdGhlbiAgICAgICAgDQogICAgICAgICAgc2VsZjpDYXN0UShzZWxmLnRzcS50YXJnZXQpDQogICAgICAgIGVuZCAgIA0KICAgICAgICBzZWxmLnRzZTp1cGRhdGUoKQ0KICAgICAgICAgaWYoc2VsZi5FU3BlbGw6SXNSZWFkeSgpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmhhcmFzcy5NYW5hIC8xMDAgKSBhbmQgc2VsZi50c2UudGFyZ2V0IH49IG5pbCBhbmQgc2VsZi5Db25maWcuaGFyYXNzLnVzZUUgIGFuZCBWYWxpZFRhcmdldChzZWxmLnRzZS50YXJnZXQsIHNlbGYuRVJhbmdlKSkgdGhlbg0KICAgICAgICBzZWxmOkNhc3RFKHNlbGYudHNlLnRhcmdldCkNCiAgICBlbmQNCiAgDQogICAgICAgIGVuZA0KICAgICAgZW5kICAgDQogICANCiAgZnVuY3Rpb24gVmlrdG9yOkxhbmVDbGVhcigpDQogICBsb2NhbCBjbGVhcnRhcmdldCA9IG5pbA0KICAgICAgc2VsZi5lbmVteU1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIHNlbGYub3RoZXJNaW5pb25zOnVwZGF0ZSgpDQogICAgICBzZWxmLmp1bmdsZU1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIGZvciBpLCBtaW5pb24gaW4gaXBhaXJzKHNlbGYuZW5lbXlNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICAgIGlmIFZhbGlkVGFyZ2V0KG1pbmlvbiwgNjAwKSBhbmQgKGNsZWFydGFyZ2V0ID09IG5pbCBvciBub3QgVmFsaWRUYXJnZXQoY2xlYXJ0YXJnZXQpKSB0aGVuDQogICAgICAgICAgY2xlYXJ0YXJnZXQgPSBtaW5pb24NCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGZvciBpLCBqdW5nbGVtaW5pb24gaW4gaXBhaXJzKHNlbGYuanVuZ2xlTWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgICBpZiBWYWxpZFRhcmdldChqdW5nbGVtaW5pb24sIDYwMCkgYW5kIChjbGVhcnRhcmdldCA9PSBuaWwgb3Igbm90IFZhbGlkVGFyZ2V0KGNsZWFydGFyZ2V0KSkgdGhlbg0KICAgICAgICAgIGNsZWFydGFyZ2V0ID0ganVuZ2xlbWluaW9uDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBmb3IgaSwgb3RoZXJtaW5pb24gaW4gaXBhaXJzKHNlbGYub3RoZXJNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICAgIGlmIFZhbGlkVGFyZ2V0KG90aGVybWluaW9uLCA2MDApIGFuZCAoY2xlYXJ0YXJnZXQgPT0gbmlsIG9yIG5vdCBWYWxpZFRhcmdldChjbGVhcnRhcmdldCkpIHRoZW4NCiAgICAgICAgICBjbGVhcnRhcmdldCA9IG90aGVybWluaW9uDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBpZiBjbGVhcnRhcmdldCB+PSBuaWwgdGhlbg0KICAgICAgICBpZihzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYuQ29uZmlnLmxhbmVjbGVhci51c2VRIGFuZCBzZWxmLkNvbmZpZy5sYW5lY2xlYXIubGFuZWNsZWFya2V5KSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5sYW5lY2xlYXIuTWFuYSAvMTAwICkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFEoY2xlYXJ0YXJnZXQpDQogICAgICAgIGVuZA0KICAgICAgIGlmIGNsZWFydGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGlmKHNlbGYuRVNwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcubGFuZWNsZWFyLnVzZUUgYW5kIHNlbGYuQ29uZmlnLmxhbmVjbGVhci5sYW5lY2xlYXJrZXkpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmxhbmVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgIGxvY2FsIEJlc3RQb3MsIEJlc3RIaXQgPSBHZXRCZXN0TGluZUZhcm1Qb3NpdGlvbihzZWxmLkVTcGVsbC5SYW5nZSwgc2VsZi5FU3BlbGwuV2lkdGgsIHNlbGYuZW5lbXlNaW5pb25zLm9iamVjdHMgKQ0KICAgICAgICBpZiBCZXN0UG9zIH49IG5pbCBhbmQgQmVzdEhpdCA+PSAxIHRoZW4NCiAgICAgICAgIENhc3RTcGVsbChfRSwgQmVzdFBvcy54LCBCZXN0UG9zLnopDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgZW5kDQogICAgZW5kDQogICAgZW5kDQogICAgZnVuY3Rpb24gVmlrdG9yOkp1bmdsZUNsZWFyKCkNCiAgIGxvY2FsIGNsZWFydGFyZ2V0ID0gbmlsDQogICAgICBzZWxmLmVuZW15TWluaW9uczp1cGRhdGUoKQ0KICAgICAgc2VsZi5vdGhlck1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIHNlbGYuanVuZ2xlTWluaW9uczp1cGRhdGUoKQ0KICAgICAgZm9yIGksIGp1bmdsZW1pbmlvbiBpbiBpcGFpcnMoc2VsZi5qdW5nbGVNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICAgIGlmIFZhbGlkVGFyZ2V0KGp1bmdsZW1pbmlvbiwgNjAwKSBhbmQgKGNsZWFydGFyZ2V0ID09IG5pbCBvciBub3QgVmFsaWRUYXJnZXQoY2xlYXJ0YXJnZXQpKSB0aGVuDQogICAgICAgICAgY2xlYXJ0YXJnZXQgPSBqdW5nbGVtaW5pb24NCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGlmIGNsZWFydGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGlmKHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcuanVuZ2xlY2xlYXIudXNlUSBhbmQgc2VsZi5Db25maWcuanVuZ2xlY2xlYXIuanVuZ2xlY2xlYXJrZXkpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyLk1hbmEgLzEwMCApIHRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RRKGNsZWFydGFyZ2V0KQ0KICAgICAgICBlbmQNCiAgICAgICAgaWYgY2xlYXJ0YXJnZXQgfj0gbmlsIHRoZW4NCiAgICAgICAgaWYoc2VsZi5FU3BlbGw6SXNSZWFkeSgpIGFuZCBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhci51c2VFIGFuZCBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhci5qdW5nbGVjbGVhcmtleSkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuanVuZ2xlY2xlYXIuTWFuYSAvMTAwICkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEUoY2xlYXJ0YXJnZXQpDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgZW5kDQogICAgZW5kDQogIGNsYXNzICJEaWFuYSINCiAtLS0vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XFwtLS0NCi0tfHwgPiBEaWFuYSBTdGFydHMgICAgICAgICAgICAgICAgICAgICAgICAgfHwtLQ0KLS0tXFw9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PS8vLS0tDQogIGZ1bmN0aW9uIERpYW5hOl9faW5pdCgpDQpzZWxmLnRzPSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCA4MzAsIERBTUFHRV9QSFlTSUNBTCwgZmFsc2UsIHRydWUpDQpzZWxmLnRzcT0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgODMwLCBEQU1BR0VfUEhZU0lDQUwsIGZhbHNlLCB0cnVlKQ0Kc2VsZi50c3c9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDIwMCwgREFNQUdFX1BIWVNJQ0FMLCBmYWxzZSwgdHJ1ZSkNCnNlbGYudHNlPSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCAzNTAsIERBTUFHRV9QSFlTSUNBTCwgZmFsc2UsIHRydWUpDQpzZWxmLnRzcj0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgODI1LCBEQU1BR0VfUEhZU0lDQUwsIGZhbHNlLCB0cnVlKQ0Kc2VsZi50c2c9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDEwMDAsIERBTUFHRV9NQUdJQywgZmFsc2UsIHRydWUpDQogICBzZWxmLlFTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9RLCBEYW1hZ2VOYW1lID0gIlEiLCBSYW5nZSA9IDgzMCwgV2lkdGggPSA3NSwgRGVsYXkgPSAwLjI1LCBTcGVlZCA9IDIwMDAsIENvbGxpc2lvbiA9IGZhbHNlLCBBb2UgPSBmYWxzZSwgVHlwZSA9IFNQRUxMX1RZUEUuTElORUFSfSkNCiAgIHNlbGYuV1NwZWxsID0gX1NwZWxsKHtTbG90ID0gX1csIERhbWFnZU5hbWUgPSAiVyIsIFJhbmdlID0gMjAwLCBDb2xsaXNpb24gPSBmYWxzZSwgQW9lID0gdHJ1ZSwgVHlwZSA9IFNQRUxMX1RZUEUuU0VMRn0pDQogICBzZWxmLkVTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9FLCBEYW1hZ2VOYW1lID0gIkUiLCBSYW5nZSA9IDM1MCwgQ29sbGlzaW9uID0gdHJ1ZSwgQW9lID0gZmFsc2UsIFR5cGUgPSBTUEVMTF9UWVBFLlNFTEZ9KQ0KICAgc2VsZi5SU3BlbGwgPSBfU3BlbGwoe1Nsb3QgPSBfUiwgRGFtYWdlTmFtZSA9ICJSIiwgUmFuZ2UgPSA4MjUsICBDb2xsaXNpb24gPSBmYWxzZSwgQW9lID0gdHJ1ZSwgVHlwZSA9IFNQRUxMX1RZUEUuVEFSR0VUVEVEfSkNCiAgIHNlbGYuSWduaXRlID0gX1NwZWxsKHtTbG90ID0gRmluZFN1bW1vbmVyU2xvdCgic3VtbW9uZXJkb3QiKSwgRGFtYWdlTmFtZSA9ICJJR05JVEUiLCBSYW5nZSA9IDYwMCwgVHlwZSA9IFNQRUxMX1RZUEUuVEFSR0VUVEVEfSkNCi0tfD4gTWluaW9uIE1hbmFnZXJzDQogICAgc2VsZi5lbmVteU1pbmlvbnMgICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX0VORU1ZLCAgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgIHNlbGYuYWxseU1pbmlvbnMgICAgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9BTExZLCAgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgIHNlbGYuanVuZ2xlTWluaW9ucyAgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9KVU5HTEUsICA2NTAsIG15SGVybywgTUlOSU9OX1NPUlRfTUFYSEVBTFRIX0RFQykNCiAgICBzZWxmLm90aGVyTWluaW9ucyAgID0gbWluaW9uTWFuYWdlcihNSU5JT05fT1RIRVIsICAgNjUwLCBteUhlcm8sIE1JTklPTl9TT1JUX01BWEhFQUxUSF9ERUMpDQogICAgc2VsZjpMb2FkTWVudSgpDQogICAgICBzZWxmOmZpbmRvcmJ3YWxrZXIoKQ0KICAgICAgICAgTGFzdF9MZXZlbFNwZWxsID0gMA0KICAgICAgQ2xvY2sgPSBvcy5jbG9jaygpDQogICAgICBBZGRUaWNrQ2FsbGJhY2soZnVuY3Rpb24oKSBzZWxmOlRpY2soKSBlbmQpDQogIEFkZERyYXdDYWxsYmFjayhmdW5jdGlvbigpIHNlbGY6RHJhdygpIGVuZCkNCiAgQWRkTXNnQ2FsbGJhY2soZnVuY3Rpb24obXNnLEtleSkgc2VsZjpXbmRNc2cobXNnLEtleSkgZW5kKQ0KICAtLUFkZEFuaW1hdGlvbkNhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIGFuaW1hdGlvbikgc2VsZjpBbmltYXRpb24odW5pdCwgYW5pbWF0aW9uKSBlbmQpDQogIEFkZFByb2Nlc3NTcGVsbENhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIHNwZWxsKSBzZWxmOlByb2Nlc3NTcGVsbCh1bml0LCBzcGVsbCkgZW5kKQ0KICAtLUFkZEFwcGx5QnVmZkNhbGxiYWNrKGZ1bmN0aW9uKHNvdXJjZSwgdW5pdCwgYnVmZikgc2VsZjpPbkFwcGx5QnVmZihzb3VyY2UsIHVuaXQsIGJ1ZmYpIGVuZCkNCiAgLS1BZGRVcGRhdGVCdWZmQ2FsbGJhY2soZnVuY3Rpb24odW5pdCwgYnVmZiwgc3RhY2tzKSBzZWxmOlVwZGF0ZUJ1ZmYodW5pdCwgYnVmZiwgc3RhY2tzKSBlbmQpDQogIC0tQWRkUmVtb3ZlQnVmZkNhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIGJ1ZmYpIHNlbGY6T25SZW1vdmVCdWZmKHVuaXQsIGJ1ZmYpIGVuZCkgDQogICAgZW5kDQogICAgIGZ1bmN0aW9uIERpYW5hOlRpY2soKQ0KICBzZWxmOmF1dG96aG9ueWEoKQ0KICBzZWxmOmF1dG9xKCkNCiAgLS1zZWxmOmdhcGNsb3NlKCkNCiAgc2VsZjppdGVtcygpDQogICAgICAgIHNlbGY6Y2hlY2t0cygpDQogICAgICAgIGlmIFZJUF9VU0VSIHRoZW4gc2VsZjphdXRvbGV2ZWwoKSBlbmQNCiAgICAgICAgIGlmIFZJUF9VU0VSIHRoZW4gc2VsZjpza2luaGFjaygpIGVuZA0KICAgICAgaWYoc2VsZi5Db25maWcuS2V5cy5qdW5nbGVjbGVhcmtleSApdGhlbg0KICAgc2VsZjpKdW5nbGVDbGVhcigpDQogIGVuZA0KICAgaWYoc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSBhbmQgc2VsZi5Db25maWcuY29tYm8ubG9naWMgPT0gMSApdGhlbg0KICAgIHNlbGY6Y29tYm8xKCkNCiAgZW5kDQogICBpZihzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5IGFuZCBzZWxmLkNvbmZpZy5jb21iby5sb2dpYyA9PSAyICl0aGVuDQogICAgc2VsZjpjb21ibzIoKQ0KICBlbmQNCiAgICAgaWYoc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSBhbmQgc2VsZi5Db25maWcuY29tYm8ubG9naWMgPT0gMyApdGhlbg0KICAgIHNlbGY6Y29tYm8zKCkNCiAgZW5kDQogICAgaWYoc2VsZi5Db25maWcuS2V5cy5sYW5lY2xlYXJrZXkgKXRoZW4NCiAgICBzZWxmOkxhbmVDbGVhcigpDQogIGVuZA0KICBpZihzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgKSB0aGVuDQogICAgc2VsZjpraWxsc3RlYWwoKQ0KICBlbmQNCiAgaWYoc2VsZi5Db25maWcuS2V5cy5oYXJhc3NrZXkgICkgdGhlbg0KICAgIHNlbGY6aGFyYXNzKCkNCiAgZW5kDQogICAgICBpZihzZWxmLkNvbmZpZy5LZXlzLmVzY2FwZWtleSApdGhlbg0KICAgICAgc2VsZjplc2NhcGUoKQ0KICAgIGVuZA0KICBlbmQNCiAgICBmdW5jdGlvbiBEaWFuYTpEcmF3KCkNCiAgICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LnFkcmF3IGFuZCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkgdGhlbg0KICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCA4MzAsIDEscmVkKQ0KICBlbmQNCg0KICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LndkcmF3IGFuZCBzZWxmLldTcGVsbDpJc1JlYWR5KCkgdGhlbg0KICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCAyMDAsIDEsIHJlZCkNCiAgZW5kDQoNCiAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5lZHJhdyBhbmQgc2VsZi5FU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgMzU1LCAxLCByZWQpDQogIGVuZA0KICANCiAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5yZHJhdyBhbmQgc2VsZi5SU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgODIwLDEsIHJlZCkNCiAgZW5kDQogIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcuYWFkcmF3IHRoZW4NCiAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgMTAwLDEsIEFSR0IoMjU1LCAyNTUsMCwwKSkNCiAgZW5kDQogICAgICAgICAgaWYgc2VsZi5Db25maWcub3RoZXIudGFyZ2V0IGFuZCBzZWxmLnNlbGVjdGVkVGFyIH49IG5pbCB0aGVuDQogICAgICAgICBEcmF3Q2lyY2xlM0Qoc2VsZi5zZWxlY3RlZFRhci54LCBzZWxmLnNlbGVjdGVkVGFyLnksIHNlbGYuc2VsZWN0ZWRUYXIueiwgODAsNiwgQVJHQigyNTUsIDI1NSwwLDApKQ0KZW5kDQogIGlmIHNlbGYuQ29uZmlnLm90aGVyLnRhcmdldGNhbCBhbmQgbm90IG15SGVyby5kZWFkIHRoZW4NCiAgICAgIGlmIHRhcmdldCBhbmQgdGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGxvY2FsIGRyYXdwb3M9V29ybGRUb1NjcmVlbihEM0RYVkVDVE9SMyh0YXJnZXQueCwgdGFyZ2V0LnksIHRhcmdldC56KSkNCiAgICAgICAgbG9jYWwgY29tYm9UZXh0LGNvbG9yID0gc2VsZjpHZXREcmF3cyh0YXJnZXQpDQogICAgICAgIGlmIGNvbWJvVGV4dCB0aGVuDQogICAgICAgICAgRHJhd1RleHQoY29tYm9UZXh0LDE1LGRyYXdwb3MueC0yMCxkcmF3cG9zLnktMjAsY29sb3IpDQogICAgICAgIGVuZCANCiAgICAgIGVuZCANCiAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBmdW5jdGlvbiBEaWFuYTpraWxsc3RlYWwoKQ0KZm9yIF8sIHVuaXQgaW4gcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8NCiAgICBsb2NhbCBoZWFsdGggPSB1bml0LmhlYWx0aA0KICAgIGxvY2FsIGRtZ0UgPSBnZXREbWcoIkUiLCB1bml0LCBteUhlcm8pDQogICAgICBpZihzZWxmLnRzZS50YXJnZXQgfj0gbmlsIGFuZCAgc2VsZi5FU3BlbGw6SXNSZWFkeSgpIGFuZCBoZWFsdGg8ZG1nRSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZUUgICBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0RSh1bml0KSAgDQogICAgICBlbmQNCiAgICAgIGxvY2FsIGRtZ1EgPSBnZXREbWcoIlEiLCB1bml0LCBteUhlcm8pIA0KICAgICAgaWYoc2VsZi50c3EudGFyZ2V0IH49IG5pbCBhbmQgIHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgaGVhbHRoPGRtZ1EgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VRIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0USh1bml0KSAgDQogICAgICBlbmQNCiAgICAgICAgICBsb2NhbCBkbWdXID0gZ2V0RG1nKCJXIiwgdW5pdCwgbXlIZXJvKQ0KICAgICAgaWYoc2VsZi50c3cudGFyZ2V0IH49IG5pbCBhbmQgIHNlbGYuV1NwZWxsOklzUmVhZHkoKSBhbmQgaGVhbHRoPGRtZ1cgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VXICAgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyl0aGVuDQogICAgICAgIHNlbGY6Q2FzdFcodW5pdCkgIA0KICAgICAgZW5kDQogICAgICAgbG9jYWwgZG1nSSA9KDUwKyAoKG15SGVyby5sZXZlbCkqMjApKQ0KICAgICAgaWYoaGVhbHRoPGRtZ0kgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VJIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgYW5kIEdldERpc3RhbmNlKHVuaXQpPDYwMCl0aGVuDQogICAgICAgIHNlbGY6Q2FzdEkodW5pdCkNCiAgICAgIGVuZA0KICAgICAgbG9jYWwgZG1nUiA9Z2V0RG1nKCJSIix1bml0LG15SGVybykNCiAgICAgIGlmKHNlbGYudHNyLnRhcmdldCB+PSBuaWwgYW5kICBzZWxmLlJTcGVsbDpJc1JlYWR5KCkgYW5kIGhlYWx0aDxkbWdSIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlUiBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzIGFuZCBHZXREaXN0YW5jZSh1bml0KTw1NTApdGhlbg0KICAgICAgICBzZWxmOkNhc3RSKHVuaXQpDQogICAgICBlbmQNCiAgIGVuZA0KZW5kDQpmdW5jdGlvbiBEaWFuYTpQcm9jZXNzU3BlbGwodW5pdCwgc3BlbGwpDQogLS1bWyBpZiBzcGVsbC5uYW1lID09ICJhdHRhY2siICB0aGVuDQogICAgIGlmIHVuaXQgYW5kIHVuaXQudHlwZSA9PSBteUhlcm8udHlwZSBhbmQgdW5pdC50ZWFtIH49IG15SGVyby50ZWFtIGFuZCBzcGVsbCBhbmQgc3BlbGwudGFyZ2V0IGFuZCBzcGVsbC50YXJnZXQgfj0gbmlsIGFuZCBzcGVsbC50YXJnZXQuaXNNZSB0aGVuDQogaWYgKHNlbGYuQ29uZmlnLnNraWxsbG9naWMuV2xvZ2ljLnVzZVcgYW5kIHNlbGYuV1NwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi50c3cudGFyZ2V0fj1uaWwpIHRoZW4NCnNlbGY6Q2FzdFcodW5pdCkNCiAgICAgICAgZW5kDQogICAgIGVuZA0KICBlbmRdXQ0KaWYgSW50ZXJydXB0W3VuaXQuY2hhck5hbWVdIH49IG5pbCB0aGVuDQogICAgICAgIHNwZWxsID0gSW50ZXJydXB0W3VuaXQuY2hhck5hbWVdLnN0b3Bbc3BlbGwubmFtZV0NCiAgICAgICAgaWYgc3BlbGwgfj0gbmlsIHRoZW4NCiAgICAgICAgICAgIGlmIHNlbGYuQ29uZmlnLm1pc2MuaW50ZXJydXB0W3NwZWxsLm5hbWVdIHRoZW4NCiAgICAgICAgICAgICAgICBpZiBWYWxpZFRhcmdldCh1bml0KSBhbmQgR2V0RGlzdGFuY2UodW5pdCkgPCBzZWxmLkVTcGVsbC5SYW5nZSAgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSAgYW5kIHNlbGYuQ29uZmlnLm1pc2MuaW50ZXJydXB0LnIgdGhlbg0KICAgICAgICAgICAgICAgICAgICBzZWxmOkNhc3RFKHVuaXQpDQogICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICBlbmQNCiAgICAgICAgZW5kDQogICAgZW5kDQplbmQNCiAgICAgIA0KICAgICAgICBmdW5jdGlvbiBEaWFuYTpjaGVja3RzKCkNCiAgICAgICBzZWxmLnRzOnVwZGF0ZSgpDQogICAgICAgc2VsZi50c2U6dXBkYXRlKCkNCiAgICAgICBzZWxmLnRzcTp1cGRhdGUoKQ0KICAgICAgIHNlbGYudHNyOnVwZGF0ZSgpDQogICAgICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgICAgICBzZWxmLnRzZzp1cGRhdGUoKQ0KaWYgbm90IHNlbGYudHNnLnRhcmdldH49bmlsIG9yIG5vdCBzZWxmLkNvbmZpZy50YXJnZXRzZWwudHMgdGhlbg0KdGFyZ2V0ID0gc2VsZi50cy50YXJnZXQNCmVsc2VpZiBzZWxmLnRzZy50YXJnZXR+PW5pbCBvciBzZWxmLnNlbGVjdGVkVGFyIHRoZW4NCnRhcmdldCA9IHNlbGYuc2VsZWN0ZWRUYXINCmVuZA0KZW5kDQogICAgZnVuY3Rpb24gRGlhbmE6d2FsaygpDQogICAgbXlIZXJvOk1vdmVUbyhtb3VzZVBvcy54LG1vdXNlUG9zLnopDQogIGVuZA0KICBmdW5jdGlvbiBEaWFuYTplc2NhcGUoKQ0KICBpZiBzZWxmLkNvbmZpZy5LZXlzLmVzY2FwZWtleSAgdGhlbiANCiAgc2VsZjp3YWxrKCkNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBEaWFuYTpoYXJhc3MoKQ0KICBpZihzZWxmLnRzcS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuaGFyYXNzLnVzZVEgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmhhcmFzc2tleSAgYW5kIHNlbGYuUVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgIHNlbGY6Q2FzdFEodGFyZ2V0KQ0KICAgZW5kDQogICAgICAgIGlmKHNlbGYudHN3LnRhcmdldH49bmlsICBhbmQgc2VsZi5Db25maWcuaGFyYXNzLnVzZVcgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmhhcmFzc2tleSAgYW5kIHNlbGYuV1NwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgIHNlbGY6Q2FzdFcodGFyZ2V0KQ0KICAgZW5kDQogICAgaWYoc2VsZi50c2UudGFyZ2V0fj1uaWwgIGFuZCBzZWxmLkNvbmZpZy5oYXJhc3MudXNlRSBhbmQgIHNlbGYuQ29uZmlnLktleXMuaGFyYXNza2V5ICBhbmQgc2VsZi5FU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0RSh0YXJnZXQpDQogICBlbmQNCiAgZW5kDQogICAgZnVuY3Rpb24gRGlhbmE6YXV0b3EoKQ0KICAgICAgICAgaWYoc2VsZi50c3EudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLktleXMuYXV0b3EgYW5kICBzZWxmLlFTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICBzZWxmOkNhc3RRKHRhcmdldCkNCiAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gRGlhbmE6Q2FzdFEodW5pdCkNCiAgc2VsZi5RU3BlbGw6Q2FzdCh1bml0KQ0KZW5kDQoNCmZ1bmN0aW9uIERpYW5hOkNhc3RXKHVuaXQpDQogIHNlbGYuV1NwZWxsOkNhc3QodW5pdCkNCmVuZA0KDQpmdW5jdGlvbiBEaWFuYTpDYXN0RSh1bml0KQ0KICBzZWxmLkVTcGVsbDpDYXN0KHVuaXQpDQplbmQNCg0KZnVuY3Rpb24gRGlhbmE6Q2FzdFIodW5pdCkNCiAgc2VsZi5SU3BlbGw6Q2FzdCh1bml0KQ0KZW5kDQpmdW5jdGlvbiBEaWFuYTpDYXN0SSh1bml0KQ0KICBzZWxmLklnbml0ZTpDYXN0KHVuaXQpDQplbmQNCiAgICBmdW5jdGlvbiBEaWFuYTphdXRvemhvbnlhKCkNCiAgICBpZiBzZWxmLkNvbmZpZy5pdGVtLmVuYWJsZWF1dG96aG9ueWEgdGhlbg0KICAgICBmb3IgXyA9IElURU1fMSwgSVRFTV83IGRvDQogICAgICBpZiBteUhlcm8uaGVhbHRoIDw9IChteUhlcm8ubWF4SGVhbHRoICogc2VsZi5Db25maWcuaXRlbS5hdXRvemhvbnlhIC8gMTAwKSBhbmQgKCBteUhlcm86Q2FuVXNlU3BlbGwoXykgPT0gMCBhbmQgbXlIZXJvOkdldFNwZWxsRGF0YShfKS5uYW1lID09ICJaaG9ueWFzSG91cmdsYXNzIiApdGhlbiBDYXN0U3BlbGwoXykNCiAgICBlbmQNCiAgICBlbmQNCiAgICBlbmQNCiAgICBlbmQNCiAgICBmdW5jdGlvbiBEaWFuYTppdGVtcygpDQogIGlmIHNlbGYuQ29uZmlnLml0ZW0udXNlYmcgYW5kIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgdGhlbg0KICAgZm9yIF8gPSBJVEVNXzEsIElURU1fNyBkbw0KICAgIGlmICggbXlIZXJvOkNhblVzZVNwZWxsKF8pID09IDAgYW5kIG15SGVybzpHZXRTcGVsbERhdGEoXykubmFtZSA9PSAiQmlsZ2V3YXRlckN1dGxhc3MiICl0aGVuIENhc3RTcGVsbChfKQ0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBpZiBzZWxmLkNvbmZpZy5pdGVtLnVzZWhnIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5IHRoZW4NCiAgIGZvciBfID0gSVRFTV8xLCBJVEVNXzcgZG8NCiAgICBpZiAoIG15SGVybzpDYW5Vc2VTcGVsbChfKSA9PSAwIGFuZCBteUhlcm86R2V0U3BlbGxEYXRhKF8pLm5hbWUgPT0gIkhleHRlY2hHdW5ibGFkZSIgKXRoZW4gQ2FzdFNwZWxsKF8pDQogIGVuZA0KICBlbmQNCiAgZW5kDQogIGVuZA0KZnVuY3Rpb24gRGlhbmE6TG9hZE1lbnUoKQ0KICAgICAgc2VsZi5Db25maWc9c2NyaXB0Q29uZmlnKCIiLi5TY3JpcHRuYW1lLi4iIFsiIC4uIG15SGVyby5jaGFyTmFtZS4uIl0iICwibWVudSIpDQoNCiAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkNvbWJvIFNldHRpbmdzIiwgImNvbWJvIikNCiAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VRIiwgIlVzZSBRIGluIENvbWJvIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZVciLCAiVXNlIFcgaW4gY29tYm8iLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlRSIsICJVc2UgRSBpbiBjb21ibyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VSIiwgIlVzZSBSIGluIGNvbWJvIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZUkiLCAiVXNlIElnbml0ZSBpZiB0YXJnZXQga2lsbGFibGUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDEwLCAxMCwgMTAwLCAwKQ0KICAgICAgLS1zZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgibG9naWNnYXAiLCAiVXNlIFFSIHRvIGdhcGNsb3NlIiwgU0NSSVBUX1BBUkFNX0xJU1QsIDEsIHsiT25seSBpZiB0YXJnZXQgS2lsbGFibGUiLCAiQWx3YXlzIiAsICJOZXZlciIgfSkNCiAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJsb2dpYyIsICJDb21ibyBMb2dpYyIsIFNDUklQVF9QQVJBTV9MSVNULCAxLCB7IlNtYXJ0IENvbWJvIiwgIlVzZSBSIGlmIHRhcmdldCBtYXJrZWQiICwgIlNwYW0gZXZlcnl0aGluZyBmYXN0IiB9KQ0KICAgICANCiAgICAgIA0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiSGFyYXNzIFNldHRpbmdzIiwgImhhcmFzcyIpDQogICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6YWRkUGFyYW0oInVzZVEiLCAiSGFyYXNzIFdpdGggUSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczphZGRQYXJhbSgidXNlVyIsICJIYXJhc3MgV2l0aCBXIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgc2VsZi5Db25maWcuaGFyYXNzOmFkZFBhcmFtKCJ1c2VFIiwgIkhhcmFzcyBXaXRoIEUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6YWRkUGFyYW0oIk1hbmEiLCJNYW5hIE1hbmFnZXIgJSIsU0NSSVBUX1BBUkFNX1NMSUNFLCAxMCwgMTAsIDEwMCwgMCkNCiAgICAgIA0KICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkZhcm0gU2V0dGluZ3MiLCAiZmFybSIpDQogICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZy5mYXJtOmFkZFN1Yk1lbnUoIkxhbmVDbGVhciBTZXR0aW5ncyIsImxhbmVjbGVhciIpDQogICAgICAgIHNlbGYuQ29uZmlnLmZhcm0ubGFuZWNsZWFyOmFkZFBhcmFtKCJ1c2VRIiwiVXNlIFEgb24gTGFuZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuZmFybS5sYW5lY2xlYXI6YWRkUGFyYW0oInVzZVciLCJVc2UgVyBvbiBMYW5lY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5mYXJtLmxhbmVjbGVhcjphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDMwLCAxMCwgMTAwLCAwKQ0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWcuZmFybTphZGRTdWJNZW51KCJKdW5nbGVDbGVhciBTZXR0aW5ncyIsImp1bmdsZWNsZWFyIikNCiAgICAgICAgc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhcjphZGRQYXJhbSgidXNlUSIsIlVzZSBRIG9uIEp1bmdsZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhcjphZGRQYXJhbSgidXNlVyIsIlVzZSBXIG9uIEp1bmdsZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhcjphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDMwLCAxMCwgMTAwLCAwKQ0KICAgICAgDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJLaWxsU3RlYWwgU2V0dGluZ3MiLCAia2lsbHN0ZWFsIikNCiAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgia3MiLCJLaWxsc3RlYWwgT24vT2ZmIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgidXNlUSIsICJTdGVhbCBXaXRoIFEiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZUUiLCAiU3RlYWwgV2l0aCBFIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJ1c2VSIiwgIlN0ZWFsIFdpdGggUiIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgidXNlSSIsICJTdGVhbCBXaXRoIElnbml0ZSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIA0KICAgIC0tW1sgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkVzY2FwZSBTZXR0aW5ncyIsImVzY2FwZSIpDQogICAgICBzZWxmLkNvbmZpZy5lc2NhcGU6YWRkUGFyYW0oInVzZVIiLCJVc2UgUiBNaW5pb24gVG8gRXNjYXBlIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmVzY2FwZTphZGRQYXJhbSgidXNlUVIiLCJVc2UgUVIgTWluaW9uIFRvIEVzY2FwZSIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpXV0NCiAgICAgICAgDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJJdGVtIFNldHRpbmdzIiwgIml0ZW0iKQ0KICAgICAgc2VsZi5Db25maWcuaXRlbTphZGRQYXJhbSgiZW5hYmxlYXV0b3pob255YSIsICJBdXRvIFpob255YSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgZmFsc2UpDQogICAgICBzZWxmLkNvbmZpZy5pdGVtOmFkZFBhcmFtKCJhdXRvemhvbnlhIiwgIlpob255YSBpZiBIZWFsdGggdW5kZXIgLT4gJSIsIFNDUklQVF9QQVJBTV9TTElDRSwgMTAsIDAsIDEwMCwgMCkNCiAgICAgIHNlbGYuQ29uZmlnLml0ZW06YWRkUGFyYW0oInVzZWhnIiwgIlVzZSBIZXh0ZWNoIEd1bmJsYWRlIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCBmYWxzZSkNCiAgICAgIHNlbGYuQ29uZmlnLml0ZW06YWRkUGFyYW0oInVzZWJnIiwgIlVzZSBCaWxnZXdhdGVyIEN1dGxhc3MiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIGZhbHNlKQ0KICAgICAgDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJNaXNjIFNldHRpbmdzIiwgIm1pc2MiKQ0KICAgICAgc2VsZi5Db25maWcubWlzYzphZGRTdWJNZW51KCJbIiAuLiBteUhlcm8uY2hhck5hbWUuLiAiXSAtIEF1dG8tSW50ZXJydXB0IiwgImludGVycnVwdCIpDQogICAgICAgIHNlbGYuQ29uZmlnLm1pc2MuaW50ZXJydXB0OmFkZFBhcmFtKCJyIiwgIkludGVycnVwdCB3aXRoIEUgU2tpbGwiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLm1pc2MuaW50ZXJydXB0OmFkZFBhcmFtKCJpbmZvMyIsICIgICAgICAgICAgICAgICAgICBbU3VwcG9ydGVkIFNraWxsc10iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgZm9yIGksIGEgaW4gcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8NCiAgICAgICAgICAgIGlmIEludGVycnVwdFthLmNoYXJOYW1lXSB+PSBuaWwgdGhlbg0KICAgICAgICAgICAgICAgIGZvciBpLCBzcGVsbCBpbiBwYWlycyhJbnRlcnJ1cHRbYS5jaGFyTmFtZV0uc3RvcCkgZG8NCiAgICAgICAgICAgICAgICAgICAgIHNlbGYuQ29uZmlnLm1pc2MuaW50ZXJydXB0OmFkZFBhcmFtKHNwZWxsLnNwZWxsTmFtZSwgYS5jaGFyTmFtZS4uIiAtICIuLnNwZWxsLm5hbWUsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgDQogICAgICAgIGVuZA0KICAgICAgDQogICAgICBzZWxmLkNvbmZpZy5taXNjOmFkZFBhcmFtKCJlbWF4IiwgIlVzZSBFIG9ubHkgaWYgZW5lbXkgZGlzdGFuY2UgPiAyODAiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAtLXNlbGYuQ29uZmlnLm1pc2M6YWRkUGFyYW0oInVzZVciLCAiQXV0byBXIHNraWxsIGlmIGVuZW15IGF0dGFja3MuIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgDQogICAgICBpZiBWSVBfVVNFUiB0aGVuDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJWSVAgU2V0dGluZ3MiLCAidmlwIikNCiAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgicGFja2V0IiwiVXNlIFBhY2tldCBDYXN0aW5nIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm8xIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvMiIsICJUbyB1c2UgdmlwIHNldHRpbmdzLCBQYWNrZXQgQ2FzdGluZyBzaG91bGQgYmUgb3Blbi4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRTdWJNZW51KCJBdXRvIExldmVsIFNldHRpbmdzIiwgImxldmVsIikNCiAgICAgIHNlbGYuQ29uZmlnLnZpcC5sZXZlbDphZGRQYXJhbSgia2V5IiwiVXNlIEF1dG8gTGV2ZWwiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgIHNlbGYuQ29uZmlnLnZpcC5sZXZlbDphZGRQYXJhbSgibG9naWMiLCAiU2VsZWN0IFNraWxsIE9yZGVyIiwgU0NSSVBUX1BBUkFNX0xJU1QsIDcsIHsiRm9jdXMgUT5XPkUiLCAiRm9jdXMgUT5FPlciLCJGb2N1cyBXPlE+RSIsIkZvY3VzIFc+RT5RIiwiRm9jdXMgRT5XPlEiLCAiRm9jdXMgRT5RPlciLCJTbWFydCIgIH0pDQogICAgICBzZWxmLkNvbmZpZy52aXA6YWRkU3ViTWVudSgiU2tpbiBIYWNrIFNldHRpbmdzIiwgInNraW4iKQ0KICAgICAgc2VsZi5Db25maWcudmlwLnNraW46YWRkUGFyYW0oImtleSIsIlVzZSBTa2luIEhhY2siLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgIHNlbGYuQ29uZmlnLnZpcC5za2luOmFkZFBhcmFtKCdzZWxlY3RlZCcgLi4gbXlIZXJvLmNoYXJOYW1lIC4uICdTa2luJywgIlNlbGVjdCBTa2luIiwgU0NSSVBUX1BBUkFNX0xJU1QsIDEsIHNraW5NZXRhW215SGVyby5jaGFyTmFtZV0pDQogICAgICBzZWxmLkNvbmZpZy52aXAuc2tpbjphZGRQYXJhbSgiaW5mbzUiLCAiTWFrZSBzdXJlIHRoYXQgdXNpbmcgcGFja2V0IGNhc3RpbmcgaXMgT04uIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAtLXNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzUiLCAiU2tpbiBIYWNrIHRlbXBvcmFyeSBkaXNhYmxlZCB1bnRpbCBuZXh0IHVwZGF0ZS4gLiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgLS1bW3NlbGYuQ29uZmlnLnZpcDphZGRTdWJNZW51KCJBbnRpLUFGSyBTZXR0aW5ncyIsICJhbnRpYWZrIikNCiAgICAgIHNlbGYuQ29uZmlnLnZpcC5hbnRpYWZrOmFkZFBhcmFtKCJhbnRpYWZrIiwiVXNlIEFudGkgQWZrIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpIF1dDQogICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm8zIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvNCIsICJUbyB1c2UgdmlwIHNldHRpbmdzLCBZb3UgbmVlZCB0byBiZSBhIFZJUCB1c2VyIG9uIEJPTCBjb21tdW5pdHkuIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgIGVuZA0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiRHJhdyBTZXR0aW5ncyIsIm90aGVyIikNCiAgICAgIC0tc2VsZi5Db25maWcub3RoZXI6YWRkU3ViTWVudSgiU2hvdyBEYW1hZ2UgT24gSHAgQmFyIiwgIkhQQkFSIikNCiAgICAgIC0tc2VsZi5Db25maWcub3RoZXIuSFBCQVI6YWRkUGFyYW0oImtleSIsIk9OL09GRiIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5vdGhlcjphZGRTdWJNZW51KCJTa2lsbCBEcmF3aW5nIFNldHRpbmdzIiwgImRyYXciKQ0KICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgicWRyYXciLCJRIFNraWxsIERyYXdpbmdzIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oIndkcmF3IiwiVyBTa2lsbCBEcmF3aW5ncyIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5vdGhlci5kcmF3OmFkZFBhcmFtKCJlZHJhdyIsIkUgU2tpbGwgRHJhd2luZ3MiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgicmRyYXciLCJSIFNraWxsIERyYXdpbmdzIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oImFhZHJhdyIsIkF1dG8gQXR0YWNrIFJhbmdlIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICBzZWxmLkNvbmZpZy5vdGhlcjphZGRTdWJNZW51KCJEcmF3IFBlcm1hYm94IiwgInBlcm1hIikNCiAgICAgIHNlbGYuQ29uZmlnLm90aGVyLnBlcm1hOmFkZFBhcmFtKCJwZXJtYSIsIkRyYXcgUGVybWFib3ggKCBOZWVkcyAyeCBGOSApIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLm90aGVyOmFkZFBhcmFtKCJ0YXJnZXQiLCJEcmF3IGNpcmNsZSBmb3IgdGFyZ2V0IHNlbGVjdGVkIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLm90aGVyOmFkZFBhcmFtKCJ0YXJnZXRjYWwiLCJUYXJnZXQgY2FsY3VsYXRpb24iLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgDQogICAgICANCiAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIlRhcmdldHNlbGVjdG9ycyIsInRhcmdldHNlbCIpDQogICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkUGFyYW0oImluZm9LMiIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRQYXJhbSgiaW5mb0siLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkUGFyYW0oInRzIiwiTGVmdCBDbGljayBGb3IgVGFyZ2V0IFNlbGVjdGlvbiIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgIHNlbGYudHMubmFtZSAgPSAiRGlhbmEiDQogICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFRTKHNlbGYudHMpDQogICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIktleXMgU2V0dGluZ3MiLCAiS2V5cyIpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0szIiwgIjwtLS0tLS0tLS0tLS0tLS0tLS1Db21ibyBLZXkgU2V0dGluZ3MtLS0tLS0tLS0tLS0tLS0tLS0+IiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiY29tYm9rZXkiLCAiQ29tYm8gS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIDMyKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LNCIsICI8LS0tLS0tLS0tLS0tLS0tLS0tSGFyYXNzIEtleSBTZXR0aW5ncy0tLS0tLS0tLS0tLS0tLS0tLT4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJoYXJhc3NrZXkiLCAiU21hcnQgSGFyYXNzIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiQyIpKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImF1dG9xIiwgIkF1dG8gSGFyYXNzIFEiLCBTQ1JJUFRfUEFSQU1fT05LRVlUT0dHTEUsIGZhbHNlLCBzdHJpbmcuYnl0ZSgiVCIpKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LNSIsICI8LS0tLS0tLS0tLS0tLS0tLS0tQ2xlYXIgS2V5IFNldHRpbmdzLS0tLS0tLS0tLS0tLS0tLS0tLS0+IiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgibGFuZWNsZWFya2V5IiwgIkxhbmVDbGVhciBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIlYiKSkNCiAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJqdW5nbGVjbGVhcmtleSIsICJKdW5nbGVDbGVhciBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIloiKSkNCiAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJpbmZvSzYiLCAiPC0tLS0tLS0tLS0tLS0tLS0tLU90aGVyIEtleSBTZXR0aW5ncy0tLS0tLS0tLS0tLS0tLS0tLS0tPiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImVzY2FwZWtleSIsICJFc2NhcGUgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJZIikpDQogICAgLS1zZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJsYXN0aGl0a2V5IiwgIkxhc3RoaXQgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJYIikpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0siLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0syIiwgIk1ha2UgU3VyZSBUaGF0IFlvdXIgT3Jid2Fsa2VyIEtleXMgYXJlIFNhbWUgQXMgSGVyZSIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIk9yd1dhbGtlcktleSBTZXR0aW5ncyIsICJLZXlzMiIpDQogICAgDQogICAgT3Jid2Fsa01hbmFnZXI6TG9hZENvbW1vbktleXMoc2VsZi5Db25maWcuS2V5czIpDQogICAgDQogICAgIA0KICAgICBpZiBzZWxmLkNvbmZpZy5vdGhlci5wZXJtYS5wZXJtYSB0aGVuDQogICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBzZWxmLkNvbmZpZzpwZXJtYVNob3coImluZm9ib3giKSBlbmQsIDEpDQogICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKXNlbGYuQ29uZmlnLktleXM6cGVybWFTaG93KCJjb21ib2tleSIpIGVuZCwgMS4yKQ0KICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpc2VsZi5Db25maWcuS2V5czpwZXJtYVNob3coImhhcmFzc2tleSIpIGVuZCwgMS4yKQ0KICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgc2VsZi5Db25maWcuS2V5czpwZXJtYVNob3coImF1dG9xIikgZW5kLCAxLjIpDQogIGVuZA0KZW5kDQotLVtbZnVuY3Rpb24gRGlhbmE6Z2FwY2xvc2UoKQ0KbG9jYWwgUWRtZz1nZXREbWcoIlEiLHRhcmdldCxteUhlcm8pDQpsb2NhbCBXZG1nPWdldERtZygiVyIsdGFyZ2V0LG15SGVybykNCmxvY2FsIEVkbWc9Z2V0RG1nKCJFIix0YXJnZXQsbXlIZXJvKQ0KbG9jYWwgUmRtZz1nZXREbWcoIlIiLHRhcmdldCxteUhlcm8pDQpsb2NhbCBJZG1nPSg1MCsgKChteUhlcm8ubGV2ZWwpKjIwKSkNCmxvY2FsIGZ1bGNvbWJvPSBRZG1nICsgV2RtZyArIEVkbWcgKyBSZG1nDQppZiAodGFyZ2V0LmhlYWx0aCA8IGZ1bGNvbWJvIGFuZCBzZWxmLkNvbmZpZy5jb21iby5sb2dpY2dhcCA9PSAxIGFuZCBHZXREaXN0YW5jZSh1bml0KT44MzAgYW5kIHNlbGYudHNnLnRhcmdldH49bmlsKSB0aGVuDQpzZWxmOkNhc3RRUihtaW5pb24pDQplbHNlaWYgIChzZWxmLkNvbmZpZy5jb21iby5sb2dpY2dhcCA9PSAyIGFuZCBHZXREaXN0YW5jZSh1bml0KT44MzAgYW5kIHNlbGYudHNnLnRhcmdldH49bmlsKSB0aGVuDQpzZWxmOkNhc3RRUihtaW5pb24pDQplbmQNCmVuZF1dDQogIGZ1bmN0aW9uIERpYW5hOkNhc3RSUSh1bml0KQ0KICAgICAgICAgICAgaWYoc2VsZi50c3EudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVEgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgYW5kIHNlbGYuUVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgICBzZWxmOkNhc3RRKHRhcmdldCkgDQogICAgIGVuZA0KICAgICAgaWYoc2VsZi50c3IudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVIgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgYW5kIHNlbGYuUlNwZWxsOklzUmVhZHkoKSkgdGhlbg0KICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKClzZWxmOkNhc3RSKHRhcmdldCkgZW5kLCAwLjUpDQogICAgICAgICAgZW5kDQogICAgICAgICAgZW5kDQogICAgZnVuY3Rpb24gRGlhbmE6Q2FzdFFSKHVuaXQpDQogIGxvY2FsIGFidWZmID0gc2VsZjpidWZmKG1pbmlvbikNCiAgICAgIGlmKHNlbGYudHNxLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VRIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgICBhbmQgc2VsZi5RU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RRKG1pbmlvbikNCiAgICAgZW5kDQogICAgICAgICAgIGlmKHNlbGYudHNyLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VSIGFuZCBhYnVmZiBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICBhbmQgc2VsZi5SU3BlbGw6SXNSZWFkeSgpKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0UihtaW5pb24pDQogICAgICAgICAgZW5kDQogIGVuZA0KIGZ1bmN0aW9uIERpYW5hOmNvbWJvMSgpDQogICAgc2VsZjpDYXN0UlEodGFyZ2V0KQ0KICAgICAgICBpZihzZWxmLnRzdy50YXJnZXR+PW5pbCAgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVcgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICBhbmQgc2VsZi5XU3BlbGw6SXNSZWFkeSgpIGFuZCBub3Qgc2VsZi5RU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0Vyh0YXJnZXQpDQogICBlbmQNCiAgIGlmIHNlbGYuQ29uZmlnLm1pc2MuZW1heCB0aGVuDQogICAgaWYoc2VsZi50c2UudGFyZ2V0fj1uaWwgIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VFIGFuZCBHZXREaXN0YW5jZSh0YXJnZXQpPjI4MCBhbmQgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgIHNlbGY6Q2FzdEUodGFyZ2V0KQ0KICAgZW5kDQogICBlbHNlaWYgbm90IHNlbGYuQ29uZmlnLm1pc2MuZW1heCB0aGVuDQogICAgICAgaWYoc2VsZi50c2UudGFyZ2V0fj1uaWwgIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VFIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgIHNlbGY6Q2FzdEUodGFyZ2V0KQ0KICAgZW5kDQogICBlbmQNCiAgICAgICBpZihzZWxmLkNvbmZpZy5jb21iby51c2VJIGFuZCBzZWxmLkNvbmZpZy5jb21iby5jb21ib2tleSApdGhlbg0KICAgIGZvciBfLCB1bml0IGluIHBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvDQogICAgICBsb2NhbCBkbWdJID0oNTArICgobXlIZXJvLmxldmVsKSoyMCkpDQogICAgICBsb2NhbCBoZWFsdGg9dW5pdC5oZWFsdGgNCiAgICAgIGlmKGhlYWx0aDxkbWdJIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VJIGFuZCBHZXREaXN0YW5jZSh1bml0KTw2MDApdGhlbg0KICAgICAgICBzZWxmOkNhc3RJKHVuaXQpDQogICAgZW5kDQogICAgZW5kDQogIGVuZA0KICBlbmQNCiAgIGZ1bmN0aW9uIERpYW5hOmNvbWJvMigpDQogIGxvY2FsIGFidWZmID0gc2VsZjpidWZmKHRhcmdldCkNCiAgaWYoc2VsZi50c3EudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVEgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICBhbmQgc2VsZi5RU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0USh0YXJnZXQpDQogICBlbmQNCiAgICBpZihzZWxmLnRzci50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUiBhbmQgYWJ1ZmYgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICBhbmQgbm90IHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5SU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0Uih0YXJnZXQpDQogICBlbmQNCiAgICAgICAgaWYoc2VsZi50c3cudGFyZ2V0fj1uaWwgIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VXIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgYW5kIHNlbGYuV1NwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgIHNlbGY6Q2FzdFcodGFyZ2V0KQ0KICAgZW5kDQogICAgaWYgc2VsZi5Db25maWcubWlzYy5lbWF4IHRoZW4NCiAgICBpZihzZWxmLnRzZS50YXJnZXR+PW5pbCAgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZUUgYW5kIEdldERpc3RhbmNlKHRhcmdldCk+MjgwIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICBhbmQgc2VsZi5FU3BlbGw6SXNSZWFkeSgpICApdGhlbg0KICAgICAgICBzZWxmOkNhc3RFKHRhcmdldCkNCiAgIGVuZA0KICAgZWxzZWlmIG5vdCBzZWxmLkNvbmZpZy5taXNjLmVtYXggdGhlbg0KICAgICAgIGlmKHNlbGYudHNlLnRhcmdldH49bmlsICBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlRSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgIGFuZCBzZWxmLkVTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICBzZWxmOkNhc3RFKHRhcmdldCkNCiAgIGVuZA0KICAgZW5kDQogICAgICAgaWYoc2VsZi5Db25maWcuY29tYm8udXNlSSBhbmQgc2VsZi5Db25maWcuY29tYm8uY29tYm9rZXkgKXRoZW4NCiAgICBmb3IgXywgdW5pdCBpbiBwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbw0KICAgICAgbG9jYWwgZG1nSSA9KDUwKyAoKG15SGVyby5sZXZlbCkqMjApKQ0KICAgICAgbG9jYWwgaGVhbHRoPXVuaXQuaGVhbHRoDQogICAgICBpZihoZWFsdGg8ZG1nSSBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlSSBhbmQgR2V0RGlzdGFuY2UodW5pdCk8NjAwKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0SSh1bml0KQ0KICAgIGVuZA0KICAgIGVuZA0KICBlbmQNCiAgZW5kDQogICBmdW5jdGlvbiBEaWFuYTpjb21ibzMoKQ0KICBpZihzZWxmLnRzcS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgIGFuZCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICBzZWxmOkNhc3RRKHRhcmdldCkNCiAgIGVuZA0KICAgICAgIGlmKHNlbGYudHN3LnRhcmdldH49bmlsICBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlVyBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgIGFuZCBzZWxmLldTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICBzZWxmOkNhc3RXKHRhcmdldCkNCiAgIGVuZA0KICAgIGlmKHNlbGYudHNyLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VSIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgYW5kIG5vdCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYuUlNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgIHNlbGY6Q2FzdFIodGFyZ2V0KQ0KICAgZW5kDQogICAgaWYgc2VsZi5Db25maWcubWlzYy5lbWF4IHRoZW4NCiAgICBpZihzZWxmLnRzZS50YXJnZXR+PW5pbCAgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZUUgYW5kIEdldERpc3RhbmNlKHRhcmdldCk+MjgwIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICBhbmQgc2VsZi5FU3BlbGw6SXNSZWFkeSgpICl0aGVuDQogICAgICAgIHNlbGY6Q2FzdEUodGFyZ2V0KQ0KICAgZW5kDQogICBlbHNlaWYgbm90IHNlbGYuQ29uZmlnLm1pc2MuZW1heCB0aGVuDQogICAgICAgaWYoc2VsZi50c2UudGFyZ2V0fj1uaWwgIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VFIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgIHNlbGY6Q2FzdEUodGFyZ2V0KQ0KICAgZW5kDQogICBlbmQNCiAgICAgICBpZihzZWxmLkNvbmZpZy5jb21iby51c2VJIGFuZCBzZWxmLkNvbmZpZy5jb21iby5jb21ib2tleSApdGhlbg0KICAgIGZvciBfLCB1bml0IGluIHBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvDQogICAgICBsb2NhbCBkbWdJID0oNTArICgobXlIZXJvLmxldmVsKSoyMCkpDQogICAgICBsb2NhbCBoZWFsdGg9dW5pdC5oZWFsdGgNCiAgICAgIGlmKGhlYWx0aDxkbWdJIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VJIGFuZCBHZXREaXN0YW5jZSh1bml0KTw2MDApdGhlbg0KICAgICAgICBzZWxmOkNhc3RJKHVuaXQpDQogICAgZW5kDQogICAgZW5kDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gRGlhbmE6YnVmZih1bml0KQ0KIHJldHVybiBUYXJnZXRIYXZlQnVmZignZGlhbmFtb29ubGlnaHQnLCB1bml0KQ0KZW5kDQpmdW5jdGlvbiBEaWFuYTpXbmRNc2coTXNnLCBLZXkpDQppZiBzZWxmLkNvbmZpZy50YXJnZXRzZWwudHMgdGhlbiAgICAgIA0KICAgICAgICBpZiBNc2cgPT0gV01fTEJVVFRPTkRPV04gdGhlbg0KICAgICAgICAgICAgbG9jYWwgbWluRCA9IDEwDQogICAgICAgICAgICBsb2NhbCBzdGFyZ2V0ID0gbmlsDQogICAgICAgICAgICBmb3IgaSwgZW5lbXkgaW4gaXBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvDQogICAgICAgICAgICAgICAgaWYgVmFsaWRUYXJnZXQoZW5lbXkpIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgaWYgR2V0RGlzdGFuY2UoZW5lbXksIG1vdXNlUG9zKSA8PSBtaW5EIG9yIHN0YXJnZXQgPT0gbmlsIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICAgIG1pbkQgPSBHZXREaXN0YW5jZShlbmVteSwgbW91c2VQb3MpDQogICAgICAgICAgICAgICAgICAgICAgICBzdGFyZ2V0ID0gZW5lbXkNCiAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICBlbmQgICAgIA0KICAgICAgICAgICAgaWYgc3RhcmdldCBhbmQgbWluRCA8IDUwMCB0aGVuDQogICAgICAgICAgICAgICAgaWYgc2VsZi5zZWxlY3RlZFRhciBhbmQgc3RhcmdldC5jaGFyTmFtZSA9PSBzZWxmLnNlbGVjdGVkVGFyLmNoYXJOYW1lIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgc2VsZi5zZWxlY3RlZFRhciA9IG5pbA0KICAgICAgICAgICAgICAgICAgICBwcmludCgiPGZvbnQgY29sb3I9XCIjQ0JGNkZGXCI+VGFyZ2V0IDxiPmlzIG5vIGxvZ2VyIHNlbGVjdGVkLjwvYj46ICIuLnN0YXJnZXQuY2hhck5hbWUuLiI8L2ZvbnQ+IikNCiAgICAgICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWRUYXIgPSBzdGFyZ2V0ICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIHByaW50KCI8Zm9udCBjb2xvcj1cIiNDQkY2RkZcIj5OZXcgdGFyZ2V0IDxiPnNlbGVjdGVkLjwvYj46ICIuLnN0YXJnZXQuY2hhck5hbWUuLiI8L2ZvbnQ+IikNCiAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgICBlbmQNCiAgICBlbmQNCiAgICBmdW5jdGlvbiBEaWFuYTpHZXREcmF3cyh0YXJnZXQpDQpsb2NhbCBRZG1nPWdldERtZygiUSIsdGFyZ2V0LG15SGVybykNCmxvY2FsIFdkbWc9Z2V0RG1nKCJXIix0YXJnZXQsbXlIZXJvKQ0KbG9jYWwgRWRtZz1nZXREbWcoIkUiLHRhcmdldCxteUhlcm8pDQpsb2NhbCBSZG1nPWdldERtZygiUiIsdGFyZ2V0LG15SGVybykNCmxvY2FsIElkbWc9KDUwKyAoKG15SGVyby5sZXZlbCkqMjApKQ0KICANCiAgaWYgUWRtZyA+IHRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUScsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBRZG1nK0lkbWc+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgSWduaXRlJywgUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgICAgZWxzZWlmIFdkbWcgPiB0YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1cnLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgV2RtZytJZG1nPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnVyArIElnbml0ZScsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBFZG1nPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnRScsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBFZG1nK0lkbWc+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdFICsgSWduaXRlJywgUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgICAgIGVsc2VpZiBSZG1nPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUicsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBSZG1nK0lkbWc+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdSICsgSWduaXRlJywgUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIFFkbWcrRWRtZz50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBFJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICAgICAgZWxzZWlmIFFkbWcrV2RtZz50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBXJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICAgICAgZWxzZWlmIFFkbWcrUmRtZz50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBSJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgUWRtZytFZG1nK0lkbWc+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgRSArIElnbml0ZScsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgICAgIGVsc2VpZiBRZG1nK1dkbWcrSWRtZz50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBXICsgSWduaXRlJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICAgICAgZWxzZWlmIFFkbWcrUmRtZytJZG1nPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIFIgKyBJZ25pdGUnLFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBRZG1nK0VkbWcrUmRtZytJZG1nPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIFIgKyBFICsgSWduaXRlJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgUWRtZytSZG1nK0VkbWcgPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIFIgKyBFJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICAgICAgICAgICAgICBlbHNlaWYgKFFkbWcrRWRtZytSZG1nK0lkbWcrV2RtZykgPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnS2lsbCBXaXRoIGZ1bGwgQ29tYm8nLFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogICAgICAgICAgZWxzZWlmIChRZG1nK0VkbWcrUmRtZytJZG1nK1dkbWcpKyhRZG1nK0VkbWcrUmRtZytJZG1nK1dkbWcpID50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ0tpbGwgV2l0aCAyIENvbWJvJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlIA0KICAgIHJldHVybiAiQ2FudCBLaWxsIHlldCIsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVuZCANCmVuZA0KZnVuY3Rpb24gRGlhbmE6c2tpbmhhY2soKQ0KICBpZiBub3QgRmFrZUxvYWQgdGhlbg0KICBpZiAoKEN1cnJlbnRUaW1lSW5NaWxsaXMoKSAtIGxhc3RUaW1lVGlja0NhbGxlZCkgPiAyMDApIHRoZW4NCiAgICAgIGxhc3RUaW1lVGlja0NhbGxlZCA9IEN1cnJlbnRUaW1lSW5NaWxsaXMoKQ0KICAgIGlmIHNlbGYuQ29uZmlnLnZpcC5za2luLmtleSBhbmQgc2VsZi5Db25maWcudmlwLnBhY2tldCAgdGhlbg0KICAgIGlmIHNlbGYuQ29uZmlnLnZpcC5za2luWydzZWxlY3RlZCcgLi4gbXlIZXJvLmNoYXJOYW1lIC4uICdTa2luJ10gfj0gbGFzdFNraW4gdGhlbg0KICAgICAgICBsYXN0U2tpbiA9IHNlbGYuQ29uZmlnLnZpcC5za2luWydzZWxlY3RlZCcgLi4gbXlIZXJvLmNoYXJOYW1lIC4uICdTa2luJ10NCiAgU2VuZFNraW5QYWNrZXQobXlIZXJvLmNoYXJOYW1lLCBza2luc1BCW3NlbGYuQ29uZmlnLnZpcC5za2luWydzZWxlY3RlZCcgLi4gbXlIZXJvLmNoYXJOYW1lIC4uICdTa2luJ11dLCBteUhlcm8ubmV0d29ya0lEKTsNCiAgZW5kDQogIGVuZA0KICBlbmQNCiAgZW5kDQogIGVuZA0KIGZ1bmN0aW9uIERpYW5hOmF1dG9sZXZlbCgpDQppZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDEgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2UxID0gICB7IDEsMiwzLDEsMSw0LDEsMiwxLDIsNCwyLDIsMywzLDQsMywzfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2UxKQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gMiBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTIgPSAgIHsgMSwyLDMsMSwxLDQsMSwzLDEsMyw0LDMsMywyLDIsNCwyLDJ9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTIpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSAzIGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlMyA9ICB7IDIsMywxLDIsMiw0LDIsMSwyLDEsNCwxLDEsMywzLDQsMywzfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2UzKQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gNCBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTQgPSAgeyAyLDMsMSwyLDIsNCwyLDMsMiwzLDQsMywzLDEsMSw0LDEsMX0NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlNCkNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDUgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2U1ID0gIHsgMywxLDIsMywzLDQsMywyLDMsMiw0LDIsMiwxLDEsNCwxLDF9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTUpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSA2IGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlNiA9ICB7IDMsMSwyLDMsMyw0LDMsMSwzLDEsNCwxLDEsMiwyLDQsMiwyfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2U2KQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogICAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSA3IGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlNiA9ICB7IDEsMiwzLDEsMSw0LDEsMiwxLDIsNCwyLDIsMywzLDQsMywzfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2U2KQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBEaWFuYTpKdW5nbGVDbGVhcigpDQogICBsb2NhbCBjbGVhcnRhcmdldCA9IG5pbA0KICAgICAgc2VsZi5lbmVteU1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIHNlbGYub3RoZXJNaW5pb25zOnVwZGF0ZSgpDQogICAgICBzZWxmLmp1bmdsZU1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIGZvciBpLCBtaW5pb24gaW4gaXBhaXJzKHNlbGYuZW5lbXlNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICAgIGlmIFZhbGlkVGFyZ2V0KG1pbmlvbiwgNjAwKSBhbmQgKGNsZWFydGFyZ2V0ID09IG5pbCBvciBub3QgVmFsaWRUYXJnZXQoY2xlYXJ0YXJnZXQpKSB0aGVuDQogICAgICAgICAgY2xlYXJ0YXJnZXQgPSBtaW5pb24NCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGZvciBpLCBqdW5nbGVtaW5pb24gaW4gaXBhaXJzKHNlbGYuanVuZ2xlTWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgICBpZiBWYWxpZFRhcmdldChqdW5nbGVtaW5pb24sIDYwMCkgYW5kIChjbGVhcnRhcmdldCA9PSBuaWwgb3Igbm90IFZhbGlkVGFyZ2V0KGNsZWFydGFyZ2V0KSkgdGhlbg0KICAgICAgICAgIGNsZWFydGFyZ2V0ID0ganVuZ2xlbWluaW9uDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBmb3IgaSwgb3RoZXJtaW5pb24gaW4gaXBhaXJzKHNlbGYub3RoZXJNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICAgIGlmIFZhbGlkVGFyZ2V0KG90aGVybWluaW9uLCA2MDApIGFuZCAoY2xlYXJ0YXJnZXQgPT0gbmlsIG9yIG5vdCBWYWxpZFRhcmdldChjbGVhcnRhcmdldCkpIHRoZW4NCiAgICAgICAgICBjbGVhcnRhcmdldCA9IG90aGVybWluaW9uDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBpZiBjbGVhcnRhcmdldCB+PSBuaWwgdGhlbg0KICAgICAgICBpZihzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXIudXNlUSBhbmQgc2VsZi5Db25maWcuS2V5cy5qdW5nbGVjbGVhcmtleSApIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXIuTWFuYSAvMTAwICkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFEoY2xlYXJ0YXJnZXQpDQogICAgICAgIGVuZA0KICAgICAgICAgICAgICAgIGlmKHNlbGYuV1NwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci51c2VXIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmp1bmdsZWNsZWFya2V5ICkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0VyhjbGVhcnRhcmdldCkNCiAgICAgICAgZW5kDQogICAgIA0KICBlbmQNCiAgZW5kDQogICBmdW5jdGlvbiBEaWFuYTpMYW5lQ2xlYXIoKQ0KICAgICAgc2VsZi5lbmVteU1pbmlvbnM6dXBkYXRlKCkNCiAgIGlmKHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcuZmFybS5sYW5lY2xlYXIudXNlUSBhbmQgc2VsZi5Db25maWcuS2V5cy5sYW5lY2xlYXJrZXkpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmZhcm0ubGFuZWNsZWFyLk1hbmEgLzEwMCApIHRoZW4NCiAgICAgICAgbG9jYWwgQmVzdFBvcywgQmVzdEhpdCA9IEdldEJlc3RMaW5lRmFybVBvc2l0aW9uKHNlbGYuUVNwZWxsLlJhbmdlLCBzZWxmLlFTcGVsbC5XaWR0aCwgc2VsZi5lbmVteU1pbmlvbnMub2JqZWN0cyApDQogICAgICAgIGlmIEJlc3RQb3Mgfj0gbmlsIGFuZCBCZXN0SGl0ID49IDEgdGhlbg0KICAgICAgICAgQ2FzdFNwZWxsKF9RLCBCZXN0UG9zLngsIEJlc3RQb3MueikNCiAgICAgICAgZW5kDQogICAgICAgIGVuZA0KICAgICAgICBpZihzZWxmLldTcGVsbDpJc1JlYWR5KCkgYW5kICBzZWxmLkNvbmZpZy5mYXJtLmxhbmVjbGVhci51c2VXIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmxhbmVjbGVhcmtleSkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuZmFybS5sYW5lY2xlYXIuTWFuYSAvMTAwICkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFcoc2VsZi5lbmVteU1pbmlvbnMub2JqZWN0KQ0KICAgICAgICBlbmQNCmVuZA0KICAgIC0tLS8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cXC0tLQ0KLS18fCA+IFNpbXBsZUxpYiAgICAgICAgICAgICAgICAgICAgICAgICAgfHwtLQ0KLS0tXFw9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PS8vLS0tDQogIGZ1bmN0aW9uIFJlcXVpcmVTaW1wbGVMaWIoKQ0KICAgICAgaWYgRmlsZUV4aXN0KExJQl9QQVRILi4iU2ltcGxlTGliLmx1YSIpIGFuZCBub3QgRmlsZUV4aXN0KFNDUklQVF9QQVRILi4iU2ltcGxlTGliLmx1YSIpIHRoZW4NCiAgICAgICAgICByZXF1aXJlICJTaW1wbGVMaWIiDQogICAgICAgICAgaWYgX0cuU2ltcGxlTGliVmVyc2lvbiA9PSBuaWwgdGhlbiANCiAgICAgICAgICAgICAgcHJpbnQoIllvdXIgU2ltcGxlTGliIGZpbGUgaXMgd3JvbmcuIikNCiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgICAgICAgZW5kDQogICAgICAgICAgaWYgX0cuU2ltcGxlTGliVmVyc2lvbiA8IDEuMDIgdGhlbg0KICAgICAgICAgICAgICBwcmludCgiWW91IG5lZWQgdGhlIGxhc3Rlc3QgdmVyc2lvbiBvZiBTaW1wbGVMaWIuIikNCiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgICAgICAgZW5kDQogICAgICAgICAgcmV0dXJuIHRydWUNCiAgICAgIGVsc2VpZiBGaWxlRXhpc3QoTElCX1BBVEguLiJTaW1wbGVMaWIubHVhIikgYW5kIEZpbGVFeGlzdChTQ1JJUFRfUEFUSC4uIlNpbXBsZUxpYi5sdWEiKSB0aGVuDQogICAgICAgICAgcHJpbnQoIlNpbXBsZUxpYi5sdWEgc2hvdWxkIG5vdCBiZSBpbiBDdXN0b20gU2NyaXB0IChPbmx5IG9uIENvbW1vbiBmb2xkZXIpLCBkZWxldGUgaXQgZnJvbSB0aGVyZS4uLiIpDQogICAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgICBlbHNlDQogICAgICAgICAgbG9jYWwgZnVuY3Rpb24gQmFzZTY0RW5jb2RlMihkYXRhKQ0KICAgICAgICAgICAgICBsb2NhbCBiPSdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvJw0KICAgICAgICAgICAgICByZXR1cm4gKChkYXRhOmdzdWIoJy4nLCBmdW5jdGlvbih4KQ0KICAgICAgICAgICAgICAgICAgbG9jYWwgcixiPScnLHg6Ynl0ZSgpDQogICAgICAgICAgICAgICAgICBmb3IgaT04LDEsLTEgZG8gcj1yLi4oYiUyXmktYiUyXihpLTEpPjAgYW5kICcxJyBvciAnMCcpIGVuZA0KICAgICAgICAgICAgICAgICAgcmV0dXJuIHI7DQogICAgICAgICAgICAgIGVuZCkuLicwMDAwJyk6Z3N1YignJWQlZCVkPyVkPyVkPyVkPycsIGZ1bmN0aW9uKHgpDQogICAgICAgICAgICAgICAgICBpZiAoI3ggPCA2KSB0aGVuIHJldHVybiAnJyBlbmQNCiAgICAgICAgICAgICAgICAgIGxvY2FsIGM9MA0KICAgICAgICAgICAgICAgICAgZm9yIGk9MSw2IGRvIGM9YysoeDpzdWIoaSxpKT09JzEnIGFuZCAyXig2LWkpIG9yIDApIGVuZA0KICAgICAgICAgICAgICAgICAgcmV0dXJuIGI6c3ViKGMrMSxjKzEpDQogICAgICAgICAgICAgIGVuZCkuLih7ICcnLCAnPT0nLCAnPScgfSlbI2RhdGElMysxXSkNCiAgICAgICAgICBlbmQNCiAgICAgICAgICBsb2NhbCBTYXZlUGF0aCA9IExJQl9QQVRILi4iU2ltcGxlTGliLmx1YSINCiAgICAgICAgICBsb2NhbCBTY3JpcHRQYXRoID0gJy9Cb0wvVENQVXBkYXRlci9HZXRTY3JpcHQ1LnBocD9zY3JpcHQ9Jy4uQmFzZTY0RW5jb2RlMigicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9qYWNoaWNhby9Cb0wvbWFzdGVyL1NpbXBsZUxpYi5sdWEiKS4uJyZyYW5kPScuLm1hdGgucmFuZG9tKDk5OTk5OTk5KQ0KICAgICAgICAgIGxvY2FsIEdvdFNjcmlwdCA9IGZhbHNlDQogICAgICAgICAgbG9jYWwgTHVhU29ja2V0ID0gbmlsDQogICAgICAgICAgbG9jYWwgU29ja2V0ID0gbmlsDQogICAgICAgICAgbG9jYWwgU2l6ZSA9IG5pbA0KICAgICAgICAgIGxvY2FsIFJlY3ZTdGFydGVkID0gZmFsc2UNCiAgICAgICAgICBsb2NhbCBSZWNlaXZlLCBTdGF0dXMsIFNuaXBwZWQgPSBuaWwsIG5pbCwgbmlsDQogICAgICAgICAgbG9jYWwgU3RhcnRlZCA9IGZhbHNlDQogICAgICAgICAgbG9jYWwgRmlsZSA9ICIiDQogICAgICAgICAgbG9jYWwgTmV3RmlsZSA9ICIiDQogICAgICAgICAgaWYgbm90IEx1YVNvY2tldCB0aGVuDQogICAgICAgICAgICAgIEx1YVNvY2tldCA9IHJlcXVpcmUoInNvY2tldCIpDQogICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICBTb2NrZXQ6Y2xvc2UoKQ0KICAgICAgICAgICAgICBTb2NrZXQgPSBuaWwNCiAgICAgICAgICAgICAgU2l6ZSA9IG5pbA0KICAgICAgICAgICAgICBSZWN2U3RhcnRlZCA9IGZhbHNlDQogICAgICAgICAgZW5kDQogICAgICAgICAgU29ja2V0ID0gTHVhU29ja2V0LnRjcCgpDQogICAgICAgICAgaWYgbm90IFNvY2tldCB0aGVuDQogICAgICAgICAgICAgIHByaW50KCdTb2NrZXQgRXJyb3InKQ0KICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgU29ja2V0OnNldHRpbWVvdXQoMCwgJ2InKQ0KICAgICAgICAgICAgICBTb2NrZXQ6c2V0dGltZW91dCg5OTk5OTk5OSwgJ3QnKQ0KICAgICAgICAgICAgICBTb2NrZXQ6Y29ubmVjdCgnc3gtYm9sLmV1JywgODApDQogICAgICAgICAgICAgIFN0YXJ0ZWQgPSBmYWxzZQ0KICAgICAgICAgICAgICBGaWxlID0gIiINCiAgICAgICAgICBlbmQNCiAgICAgICAgICBBZGRUaWNrQ2FsbGJhY2soZnVuY3Rpb24oKQ0KICAgICAgICAgICAgICBpZiBHb3RTY3JpcHQgdGhlbiByZXR1cm4gZW5kDQogICAgICAgICAgICAgIFJlY2VpdmUsIFN0YXR1cywgU25pcHBlZCA9IFNvY2tldDpyZWNlaXZlKDEwMjQpDQogICAgICAgICAgICAgIGlmIFN0YXR1cyA9PSAndGltZW91dCcgYW5kIG5vdCBTdGFydGVkIHRoZW4NCiAgICAgICAgICAgICAgICAgIFN0YXJ0ZWQgPSB0cnVlDQogICAgICAgICAgICAgICAgICBwcmludCgiRG93bmxvYWRpbmcgYSBsaWJyYXJ5IGNhbGxlZCBTaW1wbGVMaWIuIFBsZWFzZSB3YWl0Li4uIikNCiAgICAgICAgICAgICAgICAgIFNvY2tldDpzZW5kKCJHRVQgIi4uU2NyaXB0UGF0aC4uIiBIVFRQLzEuMVxyXG5Ib3N0OiBzeC1ib2wuZXVcclxuXHJcbiIpDQogICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICBpZiAoUmVjZWl2ZSBvciAoI1NuaXBwZWQgPiAwKSkgYW5kIG5vdCBSZWN2U3RhcnRlZCB0aGVuDQogICAgICAgICAgICAgICAgICBSZWN2U3RhcnRlZCA9IHRydWUNCiAgICAgICAgICAgICAgZW5kDQogIA0KICAgICAgICAgICAgICBGaWxlID0gRmlsZSAuLiAoUmVjZWl2ZSBvciBTbmlwcGVkKQ0KICAgICAgICAgICAgICBpZiBGaWxlOmZpbmQoJzwvc2knLi4nemU+JykgdGhlbg0KICAgICAgICAgICAgICAgICAgaWYgbm90IFNpemUgdGhlbg0KICAgICAgICAgICAgICAgICAgICAgIFNpemUgPSB0b251bWJlcihGaWxlOnN1YihGaWxlOmZpbmQoJzxzaScuLid6ZT4nKSArIDYsIEZpbGU6ZmluZCgnPC9zaScuLid6ZT4nKSAtIDEpKQ0KICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgICBpZiBGaWxlOmZpbmQoJzxzY3InLi4naXB0PicpIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBfLCBTY3JpcHRGaW5kID0gRmlsZTpmaW5kKCc8c2NyJy4uJ2lwdD4nKQ0KICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIFNjcmlwdEVuZCA9IEZpbGU6ZmluZCgnPC9zY3InLi4naXB0PicpDQogICAgICAgICAgICAgICAgICAgICAgaWYgU2NyaXB0RW5kIHRoZW4gU2NyaXB0RW5kID0gU2NyaXB0RW5kIC0gMSBlbmQNCiAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBEb3dubG9hZGVkU2l6ZSA9IEZpbGU6c3ViKFNjcmlwdEZpbmQgKyAxLFNjcmlwdEVuZCBvciAtMSk6bGVuKCkNCiAgICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgaWYgRmlsZTpmaW5kKCc8L3NjcicuLidpcHQ+JykgdGhlbg0KICAgICAgICAgICAgICAgICAgbG9jYWwgYSxiID0gRmlsZTpmaW5kKCdcclxuXHJcbicpDQogICAgICAgICAgICAgICAgICBGaWxlID0gRmlsZTpzdWIoYSwtMSkNCiAgICAgICAgICAgICAgICAgIE5ld0ZpbGUgPSAnJw0KICAgICAgICAgICAgICAgICAgZm9yIGxpbmUsY29udGVudCBpbiBpcGFpcnMoRmlsZTpzcGxpdCgnXG4nKSkgZG8NCiAgICAgICAgICAgICAgICAgICAgICBpZiBjb250ZW50OmxlbigpID4gNSB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgICAgIE5ld0ZpbGUgPSBOZXdGaWxlIC4uIGNvbnRlbnQNCiAgICAgICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICAgICAgbG9jYWwgSGVhZGVyRW5kLCBDb250ZW50U3RhcnQgPSBOZXdGaWxlOmZpbmQoJzxzYycuLidyaXB0PicpDQogICAgICAgICAgICAgICAgICBsb2NhbCBDb250ZW50RW5kLCBfID0gTmV3RmlsZTpmaW5kKCc8L3NjcicuLidpcHQ+JykNCiAgICAgICAgICAgICAgICAgIGlmIG5vdCBDb250ZW50U3RhcnQgb3Igbm90IENvbnRlbnRFbmQgdGhlbg0KICAgICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIG5ld2YgPSBOZXdGaWxlOnN1YihDb250ZW50U3RhcnQgKyAxLENvbnRlbnRFbmQgLSAxKQ0KICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIG5ld2YgPSBuZXdmOmdzdWIoJ1xyJywnJykNCiAgICAgICAgICAgICAgICAgICAgICBpZiBuZXdmOmxlbigpIH49IFNpemUgdGhlbg0KICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4NCiAgICAgICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBuZXdmID0gQmFzZTY0RGVjb2RlKG5ld2YpDQogICAgICAgICAgICAgICAgICAgICAgaWYgdHlwZShsb2FkKG5ld2YpKSB+PSAnZnVuY3Rpb24nIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGYgPSBpby5vcGVuKFNhdmVQYXRoLCAidytiIikNCiAgICAgICAgICAgICAgICAgICAgICAgICAgZjp3cml0ZShuZXdmKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICBmOmNsb3NlKCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoIlJlcXVpcmVkIGxpYnJhcnkgZG93bmxvYWRlZC4gUGxlYXNlIHJlbG9hZCB3aXRoIDJ4IEY5LiIpDQogICAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICAgIEdvdFNjcmlwdCA9IHRydWUNCiAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgZW5kKQ0KICAgICAgICAgIHJldHVybiBmYWxzZQ0KICAgICAgZW5kDQogIGVuZA0KICANCiAgIC0tLS8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cXC0tLQ0KLS18fCA+IE9yYldhbGtzICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8LS0NCi0tLVxcPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0vLy0tLQ0KICANCiAgZnVuY3Rpb24gVmlrdG9yOmZpbmRvcmJ3YWxrZXIoKQ0KICAgaWYgX0cuUmVib3JuX0xvYWRlZCB0aGVuDQogICAgICBTQUM9dHJ1ZSBhbmQNCiAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj5TaWRhcyBBdXRvIENhcnJ5IGhhcyBiZWVuIGZvdW5kIikgZW5kLCAyKQ0KICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj5TaWRhcyBBdXRvIENhcnJ5IGludGVncmF0aW9uIGhhcyBiZWVuIGZpbmlzaGVkIHN1Y2Nlc2Z1bGx5IikgZW5kLCA4KQ0KICAgIGVsc2VpZiBub3QgX0cuUmVib3JuX0xvYWRlZCBhbmQgRmlsZUV4aXN0KExJQl9QQVRIIC4uICJTeE9yYldhbGsubHVhIikgdGhlbg0KICAgICAgU3hPcmI9dHJ1ZSBhbmQgDQogICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBwcmludCgiPGZvbnQgY29sb3I9XCIjRkYwMDAwXCI+PGI+ICIuLlNjcmlwdG5hbWUuLiIgLSA8L2I+PC9mb250Pjxmb250IGNvbG9yPVwiI0ZGRkZGRlwiPiBTeE9yYldhbGsgaGFzIGJlZW4gZm91bmQiKSBlbmQsIDIpDQogICAgICAgICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+IFN4T3JiV2FsayBpbnRlZ3JhdGlvbiBoYXMgYmVlbiBmaW5pc2hlZCBzdWNjZXNmdWxseSIpIGVuZCwgNCkNCiAgICAgIHJlcXVpcmUoIlN4T3JiV2FsayIpDQogICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJTeE9yYldhbGsiLCJvcmJXYWxrIikgZW5kLDUpDQogICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIF9HLlN4T3JiOkxvYWRUb01lbnUoc2VsZi5Db25maWcub3JiV2FsaykgZW5kLDUpDQogICAgZWxzZWlmIFNBQ349dHJ1ZSBhbmQgU3hPcmJ+PSB0cnVlIHRoZW4NCiAgICAgIHAoIj09PT09PT09PT09PT09PT09IikNCiAgICAgIHAoIj09PT09PT09PT09PT09PT09IikNCiAgICAgIHAoIlN4T3JiIG9yIFNBQzpSIGlzIHJlcXVpcmVkLiIpDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgZW5kDQogIGVuZA0KICAgIGZ1bmN0aW9uIEFrYWxpOmZpbmRvcmJ3YWxrZXIoKQ0KaWYgX0cuUmVib3JuX0xvYWRlZCB0aGVuDQogICAgICBTQUM9dHJ1ZSBhbmQNCiAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj5TaWRhcyBBdXRvIENhcnJ5IGhhcyBiZWVuIGZvdW5kIikgZW5kLCAyKQ0KICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj5TaWRhcyBBdXRvIENhcnJ5IGludGVncmF0aW9uIGhhcyBiZWVuIGZpbmlzaGVkIHN1Y2Nlc2Z1bGx5IikgZW5kLCA4KQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94MjIiLCAiQ3VycmVudCBPcmJ3YWxrZXI6ICAgICAgICAgICAgICAgICAgICAgIFNpZGFzIEF1dG8gQ2FycnkiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mbzMiLCAiX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXyIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94IiwgIiAgICAgICAgICAgICAgICIuLlNjcmlwdG5hbWUuLiIiLCBTQ1JJUFRfUEFSQU1fSU5GTywgIiIpIA0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94MiIsICIgICAgICAgICAgICAgICAgIFNjcmlwdCBWZXJzaW9uOiAgIi4uVmVyc2lvbi4uICIgICAgICAgICAiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDYiLCAiICAgICAgICAgICAgU2NyaXB0IHdhcyBtYWRlIGJ5ICAiLi5BdXRob3IuLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3g1IiwgIiAgICAgICBMZWF1Z2UgT2YgTGVnZW5kcyBWZXJzaW9uOiAgIi4uTFZlcnNpb24uLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpICAgDQogICAgZWxzZWlmIG5vdCBfRy5SZWJvcm5fTG9hZGVkIGFuZCBGaWxlRXhpc3QoTElCX1BBVEggLi4gIlN4T3JiV2Fsay5sdWEiKSB0aGVuDQogICAgICBTeE9yYj10cnVlIGFuZCANCiAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+IFN4T3JiV2FsayBoYXMgYmVlbiBmb3VuZCIpIGVuZCwgMikNCiAgICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj4gU3hPcmJXYWxrIGludGVncmF0aW9uIGhhcyBiZWVuIGZpbmlzaGVkIHN1Y2Nlc2Z1bGx5IikgZW5kLCA0KQ0KICAgICAgcmVxdWlyZSgiU3hPcmJXYWxrIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDIyIiwgIkN1cnJlbnQgT3Jid2Fsa2VyOiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3hPcmJXYWxrIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm8zIiwgIl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveCIsICIgICAgICAgICAgICAgICAiLi5TY3JpcHRuYW1lLi4iIiwgU0NSSVBUX1BBUkFNX0lORk8sICIiKSANCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDIiLCAiICAgICAgICAgICAgICAgICBTY3JpcHQgVmVyc2lvbjogICIuLlZlcnNpb24uLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3g2IiwgIiAgICAgICAgICAgIFNjcmlwdCB3YXMgbWFkZSBieSAgIi4uQXV0aG9yLi4gIiAgICAgICAgICIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94NSIsICIgICAgICAgTGVhdWdlIE9mIExlZ2VuZHMgVmVyc2lvbjogICIuLkxWZXJzaW9uLi4gIiAgICAgICAgICIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKSAgIA0KICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiU3hPcmJXYWxrIiwib3JiV2FsayIpIGVuZCw1KQ0KICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBfRy5TeE9yYjpMb2FkVG9NZW51KHNlbGYuQ29uZmlnLm9yYldhbGspIGVuZCw1KQ0KICAgIGVsc2VpZiBTQUN+PXRydWUgYW5kIFN4T3Jifj0gdHJ1ZSB0aGVuDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgICBwKCJTeE9yYiBvciBTQUM6UiBpcyByZXF1aXJlZC4iKQ0KICAgICAgcCgiPT09PT09PT09PT09PT09PT0iKQ0KICAgICAgcCgiPT09PT09PT09PT09PT09PT0iKQ0KICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gRGlhbmE6ZmluZG9yYndhbGtlcigpDQppZiBfRy5SZWJvcm5fTG9hZGVkIHRoZW4NCiAgICAgIFNBQz10cnVlIGFuZA0KICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBwcmludCgiPGZvbnQgY29sb3I9XCIjRkYwMDAwXCI+PGI+ICIuLlNjcmlwdG5hbWUuLiIgLSA8L2I+PC9mb250Pjxmb250IGNvbG9yPVwiI0ZGRkZGRlwiPlNpZGFzIEF1dG8gQ2FycnkgaGFzIGJlZW4gZm91bmQiKSBlbmQsIDIpDQogICAgICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBwcmludCgiPGZvbnQgY29sb3I9XCIjRkYwMDAwXCI+PGI+ICIuLlNjcmlwdG5hbWUuLiIgLSA8L2I+PC9mb250Pjxmb250IGNvbG9yPVwiI0ZGRkZGRlwiPlNpZGFzIEF1dG8gQ2FycnkgaW50ZWdyYXRpb24gaGFzIGJlZW4gZmluaXNoZWQgc3VjY2VzZnVsbHkiKSBlbmQsIDgpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3gyMiIsICJDdXJyZW50IE9yYndhbGtlcjogICAgICAgICAgICAgICAgICAgICAgU2lkYXMgQXV0byBDYXJyeSIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvMyIsICJfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3giLCAiICAgICAgICAgICAgICAgIi4uU2NyaXB0bmFtZS4uIiIsIFNDUklQVF9QQVJBTV9JTkZPLCAiIikgDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3gyIiwgIiAgICAgICAgICAgICAgICAgU2NyaXB0IFZlcnNpb246ICAiLi5WZXJzaW9uLi4gIiAgICAgICAgICIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94NiIsICIgICAgICAgICAgICBTY3JpcHQgd2FzIG1hZGUgYnkgICIuLkF1dGhvci4uICIgICAgICAgICAiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDUiLCAiICAgICAgIExlYXVnZSBPZiBMZWdlbmRzIFZlcnNpb246ICAiLi5MVmVyc2lvbi4uICIgICAgICAgICAiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikgICANCiAgICBlbHNlaWYgbm90IF9HLlJlYm9ybl9Mb2FkZWQgYW5kIEZpbGVFeGlzdChMSUJfUEFUSCAuLiAiU3hPcmJXYWxrLmx1YSIpIHRoZW4NCiAgICAgIFN4T3JiPXRydWUgYW5kIA0KICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj4gU3hPcmJXYWxrIGhhcyBiZWVuIGZvdW5kIikgZW5kLCAyKQ0KICAgICAgICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBwcmludCgiPGZvbnQgY29sb3I9XCIjRkYwMDAwXCI+PGI+ICIuLlNjcmlwdG5hbWUuLiIgLSA8L2I+PC9mb250Pjxmb250IGNvbG9yPVwiI0ZGRkZGRlwiPiBTeE9yYldhbGsgaW50ZWdyYXRpb24gaGFzIGJlZW4gZmluaXNoZWQgc3VjY2VzZnVsbHkiKSBlbmQsIDQpDQogICAgICByZXF1aXJlKCJTeE9yYldhbGsiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94MjIiLCAiQ3VycmVudCBPcmJ3YWxrZXI6ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTeE9yYldhbGsiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mbzMiLCAiX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXyIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94IiwgIiAgICAgICAgICAgICAgICIuLlNjcmlwdG5hbWUuLiIiLCBTQ1JJUFRfUEFSQU1fSU5GTywgIiIpIA0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94MiIsICIgICAgICAgICAgICAgICAgIFNjcmlwdCBWZXJzaW9uOiAgIi4uVmVyc2lvbi4uICIgICAgICAgICAiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDYiLCAiICAgICAgICAgICAgU2NyaXB0IHdhcyBtYWRlIGJ5ICAiLi5BdXRob3IuLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3g1IiwgIiAgICAgICBMZWF1Z2UgT2YgTGVnZW5kcyBWZXJzaW9uOiAgIi4uTFZlcnNpb24uLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpICAgDQogICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJTeE9yYldhbGsiLCJvcmJXYWxrIikgZW5kLDUpDQogICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIF9HLlN4T3JiOkxvYWRUb01lbnUoc2VsZi5Db25maWcub3JiV2FsaykgZW5kLDUpDQogICAgZWxzZWlmIFNBQ349dHJ1ZSBhbmQgU3hPcmJ+PSB0cnVlIHRoZW4NCiAgICAgIHAoIj09PT09PT09PT09PT09PT09IikNCiAgICAgIHAoIj09PT09PT09PT09PT09PT09IikNCiAgICAgIHAoIlN4T3JiIG9yIFNBQzpSIGlzIHJlcXVpcmVkLiIpDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMaXNzYW5kcmE6ZmluZG9yYndhbGtlcigpDQogICBpZiBfRy5SZWJvcm5fTG9hZGVkIHRoZW4NCiAgICAgIFNBQz10cnVlIGFuZA0KICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBwcmludCgiPGZvbnQgY29sb3I9XCIjRkYwMDAwXCI+PGI+ICIuLlNjcmlwdG5hbWUuLiIgLSA8L2I+PC9mb250Pjxmb250IGNvbG9yPVwiI0ZGRkZGRlwiPlNpZGFzIEF1dG8gQ2FycnkgaGFzIGJlZW4gZm91bmQiKSBlbmQsIDIpDQogICAgICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBwcmludCgiPGZvbnQgY29sb3I9XCIjRkYwMDAwXCI+PGI+ICIuLlNjcmlwdG5hbWUuLiIgLSA8L2I+PC9mb250Pjxmb250IGNvbG9yPVwiI0ZGRkZGRlwiPlNpZGFzIEF1dG8gQ2FycnkgaW50ZWdyYXRpb24gaGFzIGJlZW4gZmluaXNoZWQgc3VjY2VzZnVsbHkiKSBlbmQsIDgpDQogICAgZWxzZWlmIG5vdCBfRy5SZWJvcm5fTG9hZGVkIGFuZCBGaWxlRXhpc3QoTElCX1BBVEggLi4gIlN4T3JiV2Fsay5sdWEiKSB0aGVuDQogICAgICBTeE9yYj10cnVlIGFuZCANCiAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+IFN4T3JiV2FsayBoYXMgYmVlbiBmb3VuZCIpIGVuZCwgMikNCiAgICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj4gU3hPcmJXYWxrIGludGVncmF0aW9uIGhhcyBiZWVuIGZpbmlzaGVkIHN1Y2Nlc2Z1bGx5IikgZW5kLCA0KQ0KICAgICAgcmVxdWlyZSgiU3hPcmJXYWxrIikNCiAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIlN4T3JiV2FsayIsIm9yYldhbGsiKSBlbmQsNSkNCiAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgX0cuU3hPcmI6TG9hZFRvTWVudShzZWxmLkNvbmZpZy5vcmJXYWxrKSBlbmQsNSkNCiAgICBlbHNlaWYgU0FDfj10cnVlIGFuZCBTeE9yYn49IHRydWUgdGhlbg0KICAgICAgcCgiPT09PT09PT09PT09PT09PT0iKQ0KICAgICAgcCgiPT09PT09PT09PT09PT09PT0iKQ0KICAgICAgcCgiU3hPcmIgb3IgU0FDOlIgaXMgcmVxdWlyZWQuIikNCiAgICAgIHAoIj09PT09PT09PT09PT09PT09IikNCiAgICAgIHAoIj09PT09PT09PT09PT09PT09IikNCiAgICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6ZmluZG9yYndhbGtlcigpDQogICBpZiBfRy5SZWJvcm5fTG9hZGVkIHRoZW4NCiAgICAgIFNBQz10cnVlIGFuZA0KICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBwcmludCgiPGZvbnQgY29sb3I9XCIjRkYwMDAwXCI+PGI+ICIuLlNjcmlwdG5hbWUuLiIgLSA8L2I+PC9mb250Pjxmb250IGNvbG9yPVwiI0ZGRkZGRlwiPlNpZGFzIEF1dG8gQ2FycnkgaGFzIGJlZW4gZm91bmQiKSBlbmQsIDIpDQogICAgICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBwcmludCgiPGZvbnQgY29sb3I9XCIjRkYwMDAwXCI+PGI+ICIuLlNjcmlwdG5hbWUuLiIgLSA8L2I+PC9mb250Pjxmb250IGNvbG9yPVwiI0ZGRkZGRlwiPlNpZGFzIEF1dG8gQ2FycnkgaW50ZWdyYXRpb24gaGFzIGJlZW4gZmluaXNoZWQgc3VjY2VzZnVsbHkiKSBlbmQsIDgpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3gyMiIsICJDdXJyZW50IE9yYndhbGtlcjogICAgICAgICAgICAgICAgICAgICAgU2lkYXMgQXV0byBDYXJyeSIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvMyIsICJfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3giLCAiICAgICAgICAgICAgICAgIi4uU2NyaXB0bmFtZS4uIiIsIFNDUklQVF9QQVJBTV9JTkZPLCAiIikgDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3gyIiwgIiAgICAgICAgICAgICAgICAgU2NyaXB0IFZlcnNpb246ICAiLi5WZXJzaW9uLi4gIiAgICAgICAgICIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94NiIsICIgICAgICAgICAgICBTY3JpcHQgd2FzIG1hZGUgYnkgICIuLkF1dGhvci4uICIgICAgICAgICAiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDUiLCAiICAgICAgIExlYXVnZSBPZiBMZWdlbmRzIFZlcnNpb246ICAiLi5MVmVyc2lvbi4uICIgICAgICAgICAiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikgICANCiAgICBlbHNlaWYgbm90IF9HLlJlYm9ybl9Mb2FkZWQgYW5kIEZpbGVFeGlzdChMSUJfUEFUSCAuLiAiU3hPcmJXYWxrLmx1YSIpIHRoZW4NCiAgICAgIFN4T3JiPXRydWUgYW5kIA0KICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj4gU3hPcmJXYWxrIGhhcyBiZWVuIGZvdW5kIikgZW5kLCAyKQ0KICAgICAgICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBwcmludCgiPGZvbnQgY29sb3I9XCIjRkYwMDAwXCI+PGI+ICIuLlNjcmlwdG5hbWUuLiIgLSA8L2I+PC9mb250Pjxmb250IGNvbG9yPVwiI0ZGRkZGRlwiPiBTeE9yYldhbGsgaW50ZWdyYXRpb24gaGFzIGJlZW4gZmluaXNoZWQgc3VjY2VzZnVsbHkiKSBlbmQsIDQpDQogICAgICByZXF1aXJlKCJTeE9yYldhbGsiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94MjIiLCAiQ3VycmVudCBPcmJ3YWxrZXI6ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTeE9yYldhbGsiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mbzMiLCAiX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXyIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94IiwgIiAgICAgICAgICAgICAgICIuLlNjcmlwdG5hbWUuLiIiLCBTQ1JJUFRfUEFSQU1fSU5GTywgIiIpIA0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94MiIsICIgICAgICAgICAgICAgICAgIFNjcmlwdCBWZXJzaW9uOiAgIi4uVmVyc2lvbi4uICIgICAgICAgICAiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDYiLCAiICAgICAgICAgICAgU2NyaXB0IHdhcyBtYWRlIGJ5ICAiLi5BdXRob3IuLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3g1IiwgIiAgICAgICBMZWF1Z2UgT2YgTGVnZW5kcyBWZXJzaW9uOiAgIi4uTFZlcnNpb24uLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpICAgDQogICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJTeE9yYldhbGsiLCJvcmJXYWxrIikgZW5kLDUpDQogICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIF9HLlN4T3JiOkxvYWRUb01lbnUoc2VsZi5Db25maWcub3JiV2FsaykgZW5kLDUpDQogICAgZWxzZWlmIFNBQ349dHJ1ZSBhbmQgU3hPcmJ+PSB0cnVlIHRoZW4NCiAgICAgIHAoIj09PT09PT09PT09PT09PT09IikNCiAgICAgIHAoIj09PT09PT09PT09PT09PT09IikNCiAgICAgIHAoIlN4T3JiIG9yIFNBQzpSIGlzIHJlcXVpcmVkLiIpDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgZW5kDQogIGVuZA0KIA0KIGZ1bmN0aW9uIE9uVW5sb2FkKCkNCiAgaWYgVklQX1VTRVIgYW5kIG5vdCBGYWtlTG9hZCAgdGhlbg0KICAgIFNlbmRTa2luUGFja2V0KG15SGVyby5jaGFyTmFtZSwgbmlsLCBteUhlcm8ubmV0d29ya0lEKQ0KICBlbmQNCmVuZA=="), nil, "bt", _ENV))()
-- easy c/p