
--[[
One Click to Challenger
Keyboard Master Series by Ensuluyn
Current Leauge Of Legends Version :5.22
Current Script Version :2.05
Last Update: 14.11.2015
--Credits to Nebelwolfi for mentoring <3
]]

assert(load(Base64Decode("ICANCiAgDQogIC0tIE9uZSBDbGljayB0byBDaGFsbGVuZ2VyDQogIC0tIEtleWJvYXJkIE1hc3RlciBTZXJpZXMgYnkgRW5zdWx1eW4NCiAgDQogIC0tQ3JlZGl0cyB0byBOZWJlbHdvbGZpIGZvciBtZW50b3JpbmcgPDMNCiAgDQogIGxvY2FsIFZlcnNpb24gPSAiMi4wNSIgIA0KICBsb2NhbCBMVmVyc2lvbiA9ICI1LjIyIg0KICBsb2NhbCBTY3JpcHRuYW1lID0gIktleWJvYXJkIE1hc3RlciBTZXJpZXMiDQogIGxvY2FsIEF1dGhvciA9ICJFbnN1bHV5biINCiAgbG9jYWwgbGlzdCA9ICJMZWJsYW5jICwgTGlzc2FuZHJhICwgVmlrdG9yLCBBa2FsaSINCiAgbG9jYWwgbGluayA9ICJHbyB0byBodHRwOi8vZm9ydW0uYm90b2ZsZWdlbmRzLmNvbS9mb3J1bS8yMC1jaGFtcGlvbi1zY3JpcHRzLyB0aGVuIHlvdSBjYW4gc2VlIG15IHRvcGljICIuLlNjcmlwdG5hbWUuLiIgb24gdGhlIGZpcnN0IG9yIHNlY29uZCBwYWdlLiINCiAgbG9jYWwgZGF0ZSA9ICIxNC4xMS4yMDE1Ig0KICBnbG9iYWxfdGlja3MgPSAwDQogIC0tIHN0YXJ0aW5nIHNjcmlwdA0KICAtLWF1dG8gdXBkYXRlDQogIGxvY2FsIHZlcnNpb24gPSAyLjA1DQogIGxvY2FsIGF1dGhvciA9ICJFbnN1bHV5biINCiAgbG9jYWwgU0NSSVBUX05BTUUgPSAiS2V5Ym9hcmRNYXN0ZXJTZXJpZXMiDQogIGxvY2FsIEFVVE9VUERBVEUgPSB0cnVlDQogIGxvY2FsIFVQREFURV9IT1NUID0gInJhdy5naXRodWIuY29tIg0KICBsb2NhbCBVUERBVEVfUEFUSCA9ICIvTG9uc2VtYXJpYS9zY3JpcHRzL21hc3Rlci9LZXlib2FyZE1hc3RlclNlcmllcy5sdWEiLi4iP3JhbmQ9Ii4ubWF0aC5yYW5kb20oMSwxMDAwMCkNCiAgbG9jYWwgVVBEQVRFX0ZJTEVfUEFUSCA9IFNDUklQVF9QQVRILi5HZXRDdXJyZW50RW52KCkuRklMRV9OQU1FDQogIGxvY2FsIFVQREFURV9VUkwgPSAiaHR0cHM6Ly8iLi5VUERBVEVfSE9TVC4uVVBEQVRFX1BBVEgNCiAgZnVuY3Rpb24gU2F5KHRleHQpDQogICAgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPktleWJvYXJkIE1hc3RlciBTZXJpZXM6PC9iPjwvZm9udD4gPGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+IiAuLiB0ZXh0IC4uICI8L2ZvbnQ+IikNCiAgZW5kDQogIA0KICBpZiBBVVRPVVBEQVRFIHRoZW4NCiAgICBsb2NhbCBTZXJ2ZXJEYXRhID0gR2V0V2ViUmVzdWx0KFVQREFURV9IT1NULCAiL0xvbnNlbWFyaWEvc2NyaXB0cy9tYXN0ZXIvdmVyc2lvbi9CdW5kbGUudmVyc2lvbiIpDQogICAgaWYgU2VydmVyRGF0YSB0aGVuDQogICAgICBTZXJ2ZXJWZXJzaW9uID0gdHlwZSh0b251bWJlcihTZXJ2ZXJEYXRhKSkgPT0gIm51bWJlciIgYW5kIHRvbnVtYmVyKFNlcnZlckRhdGEpIG9yIG5pbA0KICAgICAgaWYgU2VydmVyVmVyc2lvbiB0aGVuDQogICAgICAgIGlmIHRvbnVtYmVyKHZlcnNpb24pIDwgU2VydmVyVmVyc2lvbiB0aGVuDQogICAgICAgICAgU2F5KCJOZXcgdmVyc2lvbiBhdmFpbGFibGUgIi4uU2VydmVyVmVyc2lvbikNCiAgICAgICAgICBTYXkoIlVwZGF0aW5nLCBwbGVhc2UgZG9uJ3QgcHJlc3MgRjkiKQ0KICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgRG93bmxvYWRGaWxlKFVQREFURV9VUkwsIFVQREFURV9GSUxFX1BBVEgsIGZ1bmN0aW9uICgpIFNheSgiU3VjY2Vzc2Z1bGx5IHVwZGF0ZWQuICgiLi52ZXJzaW9uLi4iID0+ICIuLlNlcnZlclZlcnNpb24uLiIpLCBwcmVzcyBGOSB0d2ljZSB0byBsb2FkIHRoZSB1cGRhdGVkIHZlcnNpb24uIikgZW5kKSBlbmQsIDMpDQogICAgICAgIGVsc2UNCiAgICAgICAgICBTYXkoIi1XZWxjb21lLCBZb3UgaGF2ZSBnb3QgdGhlIGxhdGVzdCB2ZXJzaW9uICh2Ii4uU2VydmVyVmVyc2lvbi4uIikgb2YgIi4uU2NyaXB0bmFtZS4uIiAsIHVwZGF0ZWQgYXQgKCIuLmRhdGUuLiIpIGJ5ICIgLi4gYXV0aG9yKQ0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgIGVsc2UgDQogICAgICBTYXkoIkVycm9yIGRvd25sb2FkaW5nIHZlcnNpb24gaW5mbyIpDQogICAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBPbkxvYWQoKQ0KICAgICAgICAgIGlmIG5vdCBSZXF1aXJlU2ltcGxlTGliKCkgdGhlbiByZXR1cm4gZW5kDQogICAgICAgICAgaXRlbWZpeCgpDQogICAgICAgICAgIGlmIF9HW215SGVyby5jaGFyTmFtZV0gdGhlbg0KICAgICAgICAgICAgICAgICAgX0dbbXlIZXJvLmNoYXJOYW1lXSgpDQogICAgICAgICAgICAgICAgICAtLURlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj4gUGFja2V0cyAmIFZJUCBmZWF0dXJlcyBjdXJyZW50bHkgZGlzYWJsZWQgdW50aWwgdGhlIG5leHQgdXBkYXRlIikgZW5kLCAxNCkNCiAgICAgICAgICBlbHNlDQogICAgICAgICAgIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjQ0JGNkZGXCI+IDpUaGlzIGNoYW1waW9uIGlzIG5vdCBzdXBwb3J0ZWQuIEN1cnJlbnRseSBzdXBwb3J0ZWQgY2hhbXBpb25zIGFyZTogIi4ubGlzdC4uIiAiICkNCiAgICAgICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjQ0JGNkZGXCI+RmVlbCBmcmVlIHRvIGNoZWNrIG15IGZvcnVtIHRvcGljIGFuZCBhc2sgYSBuZXcgY2hhbXBpb24gb3IgZ2l2ZSBmZWVkYmFjayIpIGVuZCwgMC41KQ0KICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNDQkY2RkZcIj4iLi5saW5rLi4iIikgZW5kLCAwLjUpDQogICAgICAgICAgZW5kDQogIGVuZA0KICAtLSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1MZUJsYW5jIFN0YXJ0aW5nLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAtLSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1MZUJsYW5jIFN0YXJ0aW5nLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAtLSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1MZUJsYW5jIFN0YXJ0aW5nLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAtLSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1MZUJsYW5jIFN0YXJ0aW5nLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICBjbGFzcyAiTGVibGFuYyINCiAgZnVuY3Rpb24gTGVibGFuYzpfX2luaXQoKQ0KICBzZWxmLnRzPSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCA1MjUsIERBTUFHRV9QSFlTSUNBTCwgZmFsc2UsIHRydWUpDQogICAgc2VsZi50c3E9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDcwMCwgREFNQUdFX1BIWVNJQ0FMLCBmYWxzZSwgdHJ1ZSkNCiAgIHNlbGYudHN3PSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCA2MDAsIERBTUFHRV9NQUdJQywgZmFsc2UsIHRydWUpDQogICAgc2VsZi50c2U9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDkyNSwgREFNQUdFX01BR0lDLCBmYWxzZSwgdHJ1ZSkNCiAgICBzZWxmLnRzcj0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgOTI1LCBEQU1BR0VfTUFHSUMsIGZhbHNlLCB0cnVlKSANCiAgICBzZWxmLnRzZz0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgOTUwLCBEQU1BR0VfTUFHSUMsIGZhbHNlLCB0cnVlKSANCiAgICAgc2VsZi5RU3BlbGwgPSBfU3BlbGwoe1Nsb3QgPSBfUSwgRGFtYWdlTmFtZSA9ICJRIiwgUmFuZ2UgPSA3MDAsIFdpZHRoID0gMSwgRGVsYXkgPSAwLCBTcGVlZCA9IG1hdGguaHVnZSwgQ29sbGlzaW9uID0gZmFsc2UsIEFvZSA9IGZhbHNlLCBUeXBlID0gU1BFTExfVFlQRS5UQVJHRVRURUR9KQ0KICAgICBzZWxmLldTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9XLCBEYW1hZ2VOYW1lID0gIlciLCBSYW5nZSA9IDYwMCwgV2lkdGggPSAxMjUsIERlbGF5ID0gMC41LCBTcGVlZCA9IDEzMDAsIFJhZGl1cyA9IDI1MCAsIENvbGxpc2lvbiA9IGZhbHNlLCBBb2UgPSB0cnVlLCBUeXBlID0gU1BFTExfVFlQRS5UQVJHRVRURUR9KQ0KICAgICBzZWxmLkVTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9FLCBEYW1hZ2VOYW1lID0gIkUiLCBSYW5nZSA9IDkyNSwgV2lkdGggPSA1NSwgRGVsYXkgPSAwLjI1LCBTcGVlZCA9IDE2MDAsIENvbGxpc2lvbiA9IHRydWUsIEFvZSA9IGZhbHNlLCBUeXBlID0gU1BFTExfVFlQRS5MSU5FQVJ9KQ0KICAgICBzZWxmLlJTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9SLCBEYW1hZ2VOYW1lID0gIlIiLCBSYW5nZSA9NjAwLCBXaWR0aCA9IDEyNSwgRGVsYXkgPSAwLjUsIFNwZWVkID0gMTMwMCwgQ29sbGlzaW9uID0gZmFsc2UsIEFvZSA9IHRydWUsIFR5cGUgPSBTUEVMTF9UWVBFLlRBUkdFVFRFRH0pDQogICAgIHNlbGYuSWduaXRlID0gX1NwZWxsKHtTbG90ID0gRmluZFN1bW1vbmVyU2xvdCgic3VtbW9uZXJkb3QiKSwgRGFtYWdlTmFtZSA9ICJJR05JVEUiLCBSYW5nZSA9IDYwMCwgVHlwZSA9IFNQRUxMX1RZUEUuVEFSR0VUVEVEfSkNCiAgICAgc2VsZi5sZWJsYW5jVywgc2VsZi5sZWJsYW5jSW1hZ2UsIHNlbGYuY2xvbmVJZCA9IG5pbCwgbmlsLCBuaWwNCiAgLS18PiBNaW5pb24gTWFuYWdlcnMNCiAgICAgIHNlbGYuZW5lbXlNaW5pb25zICAgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9FTkVNWSwgICA2NTAsIG15SGVybywgTUlOSU9OX1NPUlRfTUFYSEVBTFRIX0RFQykNCiAgICAgIHNlbGYuYWxseU1pbmlvbnMgICAgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9BTExZLCAgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgICAgc2VsZi5qdW5nbGVNaW5pb25zICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX0pVTkdMRSwgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgICAgc2VsZi5vdGhlck1pbmlvbnMgICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX09USEVSLCAgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgICAgc2VsZjpMb2FkTWVudSgpDQogICAgICAgIHNlbGY6ZmluZG9yYndhbGtlcigpDQogICAgICAgICAgTGFzdF9MZXZlbFNwZWxsID0gMA0KICAgICAgICBDbG9jayA9IG9zLmNsb2NrKCkNCiAgICAgICAgICAgaWYgVklQX1VTRVIgdGhlbiAgc2VsZjpza2luaGFjaygpIGVuZA0KICAgICAgICBBZGRUaWNrQ2FsbGJhY2soZnVuY3Rpb24oKSBzZWxmOlRpY2soKSBlbmQpDQogICAgQWRkRHJhd0NhbGxiYWNrKGZ1bmN0aW9uKCkgc2VsZjpEcmF3KCkgZW5kKQ0KICAgIEFkZE1zZ0NhbGxiYWNrKGZ1bmN0aW9uKG1zZyxLZXkpIHNlbGY6V25kTXNnKG1zZyxLZXkpIGVuZCkNCiAgICAtLUFkZEFuaW1hdGlvbkNhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIGFuaW1hdGlvbikgc2VsZjpBbmltYXRpb24odW5pdCwgYW5pbWF0aW9uKSBlbmQpDQogICAgLS1BZGRQcm9jZXNzU3BlbGxDYWxsYmFjayhmdW5jdGlvbih1bml0LCBzcGVsbCkgc2VsZjpQcm9jZXNzU3BlbGwodW5pdCwgc3BlbGwpIGVuZCkNCiAgICAtLUFkZEFwcGx5QnVmZkNhbGxiYWNrKGZ1bmN0aW9uKHNvdXJjZSwgdW5pdCwgYnVmZikgc2VsZjpPbkFwcGx5QnVmZihzb3VyY2UsIHVuaXQsIGJ1ZmYpIGVuZCkNCiAgICAtLUFkZFVwZGF0ZUJ1ZmZDYWxsYmFjayhmdW5jdGlvbih1bml0LCBidWZmLCBzdGFja3MpIHNlbGY6VXBkYXRlQnVmZih1bml0LCBidWZmLCBzdGFja3MpIGVuZCkNCiAgICAtLUFkZFJlbW92ZUJ1ZmZDYWxsYmFjayhmdW5jdGlvbih1bml0LCBidWZmKSBzZWxmOk9uUmVtb3ZlQnVmZih1bml0LCBidWZmKSBlbmQpIA0KICAgICAgZW5kDQogICAgICBmdW5jdGlvbiBMZWJsYW5jOkxvYWRNZW51KCkNCiAgICAgICAgc2VsZi5Db25maWc9c2NyaXB0Q29uZmlnKCIiLi5TY3JpcHRuYW1lLi4iIiwibWVudSIpDQogIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJDb21ibyBTZXR0aW5ncyIsICJjb21ibyIpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VRIiwgIlVzZSBRIGluIENvbWJvIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlVyIsICJVc2UgVyBpbiBDb21ibyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZUUiLCAiVXNlIEUgaW4gY29tYm8iLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VSIiwgIlVzZSBSIGluIGNvbWJvIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlSSIsICJVc2UgSWduaXRlIGlmIHRhcmdldCBraWxsYWJsZSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgLS1zZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgiZ2FwY2xvc2UiLCAiVXNlIFcgYXMgYSBnYXBjbG9zZSAoIEJldGEgKSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJsb2dpYyIsICJDb21ibyBsb2dpYyIsIFNDUklQVF9QQVJBTV9MSVNULCAxLCB7IlE+RT5XPlIiLCAiUT5SPkU+VyIsICJFPlE+Vz5SIiwgIkU+Vz5RPlIiICwiUmFuZG9tIFNraWxsIE9yZGVyIn0pDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFN1Yk1lbnUoIlcgU2tpbGwgdHVybiBiYWNrIHNldHRpbmdzIiwgInR1cm53IikNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm8udHVybnc6YWRkUGFyYW0oIncxIiwiVHVybiBiYWNrIHRvIFcgc3BvdCBvbiBRPkU+Vz5SIG1vZGUgIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvLnR1cm53OmFkZFBhcmFtKCJ3MiIsIlR1cm4gYmFjayB0byBXIHNwb3Qgb24gUT5SPkU+VyBtb2RlICIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5jb21iby50dXJudzphZGRQYXJhbSgidzMiLCJUdXJuIGJhY2sgdG8gVyBzcG90IG9uIEU+UT5XPlIgbW9kZSAiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm8udHVybnc6YWRkUGFyYW0oInc0IiwiVHVybiBiYWNrIHRvIFcgc3BvdCBvbiBFPlc+UT5SIG1vZGUgIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvLnR1cm53OmFkZFBhcmFtKCJ3NSIsIlR1cm4gYmFjayB0byBXIHNwb3Qgb24gUmFuZG9tIFNraWxsIE9yZGVyIG1vZGUgIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJNYW5hIiwiTWFuYSBNYW5hZ2VyICUiLFNDUklQVF9QQVJBTV9TTElDRSwgMTAsIDEwLCAxMDAsIDApDQogICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJIYXJhc3MgU2V0dGluZ3MiLCAiaGFyYXNzIikNCiAgICAgICAgc2VsZi5Db25maWcuaGFyYXNzOmFkZFBhcmFtKCJ1c2VRIiwgIkhhcmFzcyBXaXRoIFEiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczphZGRQYXJhbSgidXNlVyIsICJIYXJhc3MgV2l0aCBXIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6YWRkUGFyYW0oIk1hbmEiLCJNYW5hIE1hbmFnZXIgJSIsU0NSSVBUX1BBUkFNX1NMSUNFLCAxMCwgMTAsIDEwMCwgMCkNCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkxhbmVDbGVhciBTZXR0aW5ncyIsImxhbmVjbGVhciIpDQogICAgICAgIHNlbGYuQ29uZmlnLmxhbmVjbGVhcjphZGRQYXJhbSgidXNlUSIsIlVzZSBRIG9uIExhbmVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmxhbmVjbGVhcjphZGRQYXJhbSgidXNlVyIsIlVzZSBXIG9uIExhbmVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmxhbmVjbGVhcjphZGRQYXJhbSgidXNlUiIsIlVzZSBSIG9uIExhbmVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5sYW5lY2xlYXI6YWRkUGFyYW0oIk1hbmEiLCJNYW5hIE1hbmFnZXIgJSIsU0NSSVBUX1BBUkFNX1NMSUNFLCAzMCwgMTAsIDEwMCwgMCkNCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkp1bmdsZUNsZWFyIFNldHRpbmdzIiwianVuZ2xlY2xlYXIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhcjphZGRQYXJhbSgidXNlUSIsIlVzZSBRIG9uIGp1bmdsZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuanVuZ2xlY2xlYXI6YWRkUGFyYW0oInVzZVciLCJVc2UgVyBvbiBMYW5lY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhcjphZGRQYXJhbSgidXNlRSIsIlVzZSBFIG9uIGp1bmdsZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuanVuZ2xlY2xlYXI6YWRkUGFyYW0oIk1hbmEiLCJNYW5hIE1hbmFnZXIgJSIsU0NSSVBUX1BBUkFNX1NMSUNFLCAzMCwgMTAsIDEwMCwgMCkNCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkVzY2FwZSBTZXR0aW5ncyIsImVzY2FwZSIpDQogICAgICAgIHNlbGYuQ29uZmlnLmVzY2FwZTphZGRQYXJhbSgidXNlVyIsIlVzZSBXIFdoaWxlIEVzY2FwZSIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmVzY2FwZTphZGRQYXJhbSgidXNlUiIsIlVzZSBSIFdoaWxlIEVzY2FwZSIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogIA0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiS2lsbFN0ZWFsIFNldHRpbmdzIiwgImtpbGxzdGVhbCIpDQogICAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgia3MiLCJLaWxsc3RlYWwgT24vT2ZmIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJ1c2VRIiwgIlN0ZWFsIFdpdGggUSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJ1c2VXIiwgIlN0ZWFsIFdpdGggVyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJ1c2VFIiwgIlN0ZWFsIFdpdGggRSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJ1c2VSIiwgIlN0ZWFsIFdpdGggUiIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJ1c2VRVyIsICJTdGVhbCBXaXRoIFFXIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZUkiLCAiU3RlYWwgV2l0aCBJZ25pdGUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJJdGVtIFNldHRpbmdzIiwgIml0ZW0iKQ0KICAgICAgICBzZWxmLkNvbmZpZy5pdGVtOmFkZFBhcmFtKCJlbmFibGVhdXRvemhvbnlhIiwgIkF1dG8gWmhvbnlhIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCBmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcuaXRlbTphZGRQYXJhbSgiYXV0b3pob255YSIsICJaaG9ueWEgaWYgSGVhbHRoIHVuZGVyIC0+ICUiLCBTQ1JJUFRfUEFSQU1fU0xJQ0UsIDEwLCAwLCAxMDAsIDApDQogICAgICAgIA0KICAgICAgICBpZiBWSVBfVVNFUiB0aGVuDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIlZJUCBTZXR0aW5ncyIsICJ2aXAiKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oInBhY2tldCIsIlVzZSBQYWNrZXQgQ2FzdGluZyIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm8xIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm8yIiwgIlRvIHVzZSB2aXAgc2V0dGluZ3MsIFBhY2tldCBDYXN0aW5nIHNob3VsZCBiZSBvcGVuLiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXA6YWRkU3ViTWVudSgiQXV0byBMZXZlbCBTZXR0aW5ncyIsICJsZXZlbCIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcC5sZXZlbDphZGRQYXJhbSgia2V5IiwiVXNlIEF1dG8gTGV2ZWwiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcudmlwLmxldmVsOmFkZFBhcmFtKCJsb2dpYyIsICJTZWxlY3QgU2tpbGwgT3JkZXIiLCBTQ1JJUFRfUEFSQU1fTElTVCwgNywgeyJGb2N1cyBRPlc+RSIsICJGb2N1cyBRPkU+VyIsIkZvY3VzIFc+UT5FIiwiRm9jdXMgVz5FPlEiLCJGb2N1cyBFPlc+USIsICJGb2N1cyBFPlE+VyIsICJTbWFydCIgIH0pDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRTdWJNZW51KCJTa2luIEhhY2sgU2V0dGluZ3MiLCAic2tpbiIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcC5za2luOmFkZFBhcmFtKCJrZXkiLCJVc2UgU2tpbiBIYWNrIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcC5za2luOmFkZFBhcmFtKCdzZWxlY3RlZCcgLi4gbXlIZXJvLmNoYXJOYW1lIC4uICdTa2luJywgIlNlbGVjdCBTa2luIiwgU0NSSVBUX1BBUkFNX0xJU1QsIDEsIHsiT3JpZ2luYWwiLCAiV2lja2VkIExlQmxhbmMgIiwiUHJlc3RpZ2lvdXMgTGVCbGFuYyIsIk1pc3RsZXRvZSBMZUJsYW5jIiwiUmF2ZW5ib3JuIExlYmxhbmMiLCB9KQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXAuc2tpbjphZGRQYXJhbSgiaW5mbzQiLCAiVG8gdXNlIHNraW4gaGFjaywgWW91IG5lZWQgdG8gMnggRjkgYWZ0ZXIgeW91IHNlbGVjdCB0aGUgc2tpbiB5b3UgZGVzaXJlLiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXAuc2tpbjphZGRQYXJhbSgiaW5mbzUiLCAiTWFrZSBzdXJlIHRoYXQgdXNpbmcgcGFja2V0IGNhc3RpbmcgaXMgT04uIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIC0tc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvNSIsICJTa2luIEhhY2sgdGVtcG9yYXJ5IGRpc2FibGVkIHVudGlsIG5leHQgdXBkYXRlLiAuIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIC0tW1tzZWxmLkNvbmZpZy52aXA6YWRkU3ViTWVudSgiQW50aS1BRksgU2V0dGluZ3MiLCAiYW50aWFmayIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcC5hbnRpYWZrOmFkZFBhcmFtKCJhbnRpYWZrIiwiVXNlIEFudGkgQWZrIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpIF1dDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzMiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzQiLCAiVG8gdXNlIHZpcCBzZXR0aW5ncywgWW91IG5lZWQgdG8gYmUgYSBWSVAgdXNlciBvbiBCT0wgY29tbXVuaXR5LiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIGVuZA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJEcmF3IFNldHRpbmdzIiwib3RoZXIiKQ0KICAgICAgICAtLXNlbGYuQ29uZmlnLm90aGVyOmFkZFN1Yk1lbnUoIlNob3cgRGFtYWdlIE9uIEhwIEJhciIsICJIUEJBUiIpDQogICAgICAgIC0tc2VsZi5Db25maWcub3RoZXIuSFBCQVI6YWRkUGFyYW0oImtleSIsIk9OL09GRiIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLm90aGVyOmFkZFN1Yk1lbnUoIlNraWxsIERyYXdpbmcgU2V0dGluZ3MiLCAiZHJhdyIpDQogICAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oInFkcmF3IiwiUSBTa2lsbCBEcmF3aW5ncyIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oIndkcmF3IiwiVyBTa2lsbCBEcmF3aW5ncyIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oImVkcmF3IiwiRSBTa2lsbCBEcmF3aW5ncyIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oInJkcmF3IiwiUiBTa2lsbCBEcmF3aW5ncyIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oImFhZHJhdyIsIkF1dG8gQXR0YWNrIFJhbmdlIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLm90aGVyOmFkZFBhcmFtKCJjb21ib21vZGUiLCJEcmF3IENvbWJvIE1vZGUiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5vdGhlcjphZGRTdWJNZW51KCJEcmF3IFBlcm1hYm94IiwgInBlcm1hIikNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXIucGVybWE6YWRkUGFyYW0oInBlcm1hIiwiRHJhdyBQZXJtYWJveCAoIE5lZWRzIDJ4IEY5ICkiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5vdGhlcjphZGRQYXJhbSgidGFyZ2V0IiwiRHJhdyBjaXJjbGUgZm9yIHRhcmdldCBzZWxlY3RlZCIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLm90aGVyOmFkZFBhcmFtKCJ0YXJnZXRjYWwiLCJUYXJnZXQgY2FsY3VsYXRpb24iLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiVGFyZ2V0c2VsZWN0b3JzIiwidGFyZ2V0c2VsIikNCiAgICAgICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFBhcmFtKCJpbmZvSzIiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRQYXJhbSgiaW5mb0siLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRQYXJhbSgidHMiLCJMZWZ0IENsaWNrIEZvciBUYXJnZXQgU2VsZWN0aW9uIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICBzZWxmLnRzLm5hbWUgID0gIkxlYmxhbmMiDQogICAgICBzZWxmLnRzcS5uYW1lID0gIkxlYmxhbmNRIg0KICAgICAgc2VsZi50c3cubmFtZSA9ICJMZWJsYW5jVyINCiAgICAgIHNlbGYudHNlLm5hbWUgPSAiTGVibGFuY0UiDQogICAgICBzZWxmLnRzci5uYW1lID0gIkxlYmxhbmNSIg0KICAgICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFRTKHNlbGYudHMpDQogICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkVFMoc2VsZi50c3EpDQogICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkVFMoc2VsZi50c3cpDQogICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkVFMoc2VsZi50c2UpDQogICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkVFMoc2VsZi50c3IpIA0KICAgICAgDQogICAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiS2V5cyBTZXR0aW5ncyIsICJLZXlzIikNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LMyIsICI8LS0tLS0tLS0tLS0tLS0tLS0tQ29tYm8gS2V5IFNldHRpbmdzLS0tLS0tLS0tLS0tLS0tLS0tPiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiY29tYm9rZXkiLCAiQ29tYm8gS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIDMyKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgib25seWUiLCAiT25seSB1c2UgRSBTa2lsbCAoT25seSBTdHVuKSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sZmFsc2UsIHN0cmluZy5ieXRlKCJPIikpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJjb21ib21vZGUiLCAiIFNlbGVjdCBDb21ib21vZGUgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTixmYWxzZSwgc3RyaW5nLmJ5dGUoIjIiKSkNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LNCIsICI8LS0tLS0tLS0tLS0tLS0tLS0tSGFyYXNzIEtleSBTZXR0aW5ncy0tLS0tLS0tLS0tLS0tLS0tLT4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImhhcmFzc2tleSIsICJTbWFydCBIYXJhc3MgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJDIikpDQogICAgIC0tIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImhhcmFzc3RvZ2xla2V5IiwgIkhhcmFzcyBUb2dsZSBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlUT0dHTEUsIGZhbHNlLCBzdHJpbmcuYnl0ZSgiVCIpKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0s1IiwgIjwtLS0tLS0tLS0tLS0tLS0tLS1DbGVhciBLZXkgU2V0dGluZ3MtLS0tLS0tLS0tLS0tLS0tLS0tLT4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImxhbmVjbGVhcmtleSIsICJMYW5lQ2xlYXIgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJWIikpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJqdW5nbGVjbGVhcmtleSIsICJKdW5nbGVDbGVhciBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIloiKSkNCiAgICAgIC0tc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgibGFzdGhpdGtleSIsICJMYXN0aGl0IEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiWCIpKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0s2IiwgIjwtLS0tLS0tLS0tLS0tLS0tLS1PdGhlciBLZXkgU2V0dGluZ3MtLS0tLS0tLS0tLS0tLS0tLS0tLT4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImVzY2FwZWtleSIsICJFc2NhcGUgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJZIikpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJpbmZvSyIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LMiIsICJNYWtlIFN1cmUgVGhhdCBZb3VyIE9yYndhbGtlciBLZXlzIGFyZSBTYW1lIEFzIEhlcmUiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIk9yd1dhbGtlcktleSBTZXR0aW5ncyIsICJLZXlzMiIpDQogICAgICANCiAgICAgIE9yYndhbGtNYW5hZ2VyOkxvYWRDb21tb25LZXlzKHNlbGYuQ29uZmlnLktleXMyKQ0KICAgICAgIA0KICAgICAgIA0KICAgICAgIGlmIHNlbGYuQ29uZmlnLm90aGVyLnBlcm1hLnBlcm1hIHRoZW4NCiAgICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHNlbGYuQ29uZmlnOnBlcm1hU2hvdygiaW5mb2JveCIpIGVuZCwgMSkNCiAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgc2VsZi5Db25maWcuS2V5czpwZXJtYVNob3coImNvbWJva2V5IikgIGVuZCwgMS4yKQ0KICAgICAgLS1zZWxmLkNvbmZpZy5LZXlzOnBlcm1hU2hvdygiaGFyYXNzdG9nbGVrZXkiKQ0KICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgc2VsZi5Db25maWcuS2V5czpwZXJtYVNob3coImhhcmFzc2tleSIpICBlbmQsIDEuMikNCiAgICBlbmQNCiAgZW5kDQogIC0tZHJhd2luZyBzZXR0aW5ncyBzdGFydA0KICBmdW5jdGlvbiBMZWJsYW5jOmNvbWJvbW9kZSgpDQogIGxvY2FsIGRyYXdwb3MgPSBHZXRVbml0SFBCYXJQb3MobXlIZXJvKQ0KICBpZiBzZWxmLkNvbmZpZy5jb21iby5sb2dpYyA9PSAxIHRoZW4NCiAgRHJhd1RleHQoIkN1cnJlbnQgQ29tYm8gTW9kZTogUT5FPlc+UiIsIDEyLCBkcmF3cG9zLngtNDAsIGRyYXdwb3MueSsxNiwgMHhmZjAwZmZmZikgZW5kDQogIGlmIHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID09IDIgdGhlbg0KICBEcmF3VGV4dCgiQ3VycmVudCBDb21ibyBNb2RlOiBRPlI+RT5XIiwgMTIsIGRyYXdwb3MueC00MCwgZHJhd3Bvcy55KzE2LCAweGZmMDBmZmZmKSBlbmQNCiAgaWYgc2VsZi5Db25maWcuY29tYm8ubG9naWMgPT0gMyB0aGVuDQogIERyYXdUZXh0KCJDdXJyZW50IENvbWJvIE1vZGU6IEU+UT5XPlIiLCAxMiwgZHJhd3Bvcy54LTQwLCBkcmF3cG9zLnkrMTYsIDB4ZmYwMGZmZmYpIGVuZA0KICBpZiBzZWxmLkNvbmZpZy5jb21iby5sb2dpYyA9PSA0IHRoZW4NCiAgRHJhd1RleHQoIkN1cnJlbnQgQ29tYm8gTW9kZTogRT5XPlE+UiIsIDEyLCBkcmF3cG9zLngtNDAsIGRyYXdwb3MueSsxNiwgMHhmZjAwZmZmZikgZW5kDQogIGlmIHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID09IDUgdGhlbg0KICBEcmF3VGV4dCgiQ3VycmVudCBDb21ibyBNb2RlOiBSYW5kb20gU2tpbGwgT3JkZXIiLCAxMiwgZHJhd3Bvcy54LTQwLCBkcmF3cG9zLnkrMTYsIDB4ZmYwMGZmZmYpIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpEcmF3KCkNCiAgaWYgc2VsZi5Db25maWcub3RoZXIuY29tYm9tb2RlIHRoZW4NCiAgbG9jYWwgZHJhd3BvcyA9IEdldFVuaXRIUEJhclBvcyhteUhlcm8pDQogIHNlbGY6Y29tYm9tb2RlKCkNCiAgZW5kDQogICAgIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcucWRyYXcgYW5kIHNlbGYuUVNwZWxsOklzUmVhZHkoKSB0aGVuDQogICAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgNjUwLCAxLHJlZCkNCiAgICBlbmQNCiAgDQogICAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy53ZHJhdyBhbmQgc2VsZi5XU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCA2MDAsIDEsIHJlZCkNCiAgICBlbmQNCiAgDQogICAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5lZHJhdyBhbmQgc2VsZi5FU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCA5MjUsIDEsIHJlZCkNCiAgICBlbmQNCiAgICANCiAgICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LnJkcmF3IGFuZCBzZWxmLlJTcGVsbDpJc1JlYWR5KCkgdGhlbg0KICAgICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDcwMCwxLCByZWQpDQogICAgZW5kDQogICAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5hYWRyYXcgdGhlbg0KICAgICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDU1MCwxLCBBUkdCKDI1NSwgMjU1LDAsMCkpDQogICAgZW5kDQogICAgICAgICAgICAgIGlmIHNlbGYuQ29uZmlnLm90aGVyLnRhcmdldCBhbmQgc2VsZi5zZWxlY3RlZFRhciB+PSBuaWwgdGhlbg0KICAgICAgICAgRHJhd0NpcmNsZTNEKHNlbGYuc2VsZWN0ZWRUYXIueCwgc2VsZi5zZWxlY3RlZFRhci55LCBzZWxmLnNlbGVjdGVkVGFyLnosIDgwLDYsIEFSR0IoMjU1LCAyNTUsMCwwKSkNCmVuZA0KICBpZiBzZWxmLkNvbmZpZy5vdGhlci50YXJnZXRjYWwgYW5kIG5vdCBteUhlcm8uZGVhZCB0aGVuDQogICAgICBpZiB0YXJnZXQgYW5kIHRhcmdldCB+PSBuaWwgdGhlbg0KICAgICAgICBsb2NhbCBkcmF3cG9zPVdvcmxkVG9TY3JlZW4oRDNEWFZFQ1RPUjModGFyZ2V0LngsIHRhcmdldC55LCB0YXJnZXQueikpDQogICAgICAgIGxvY2FsIGNvbWJvVGV4dCxjb2xvciA9IHNlbGY6R2V0RHJhd3ModGFyZ2V0KQ0KICAgICAgICBpZiBjb21ib1RleHQgdGhlbg0KICAgICAgICAgIERyYXdUZXh0KGNvbWJvVGV4dCwxNSxkcmF3cG9zLngtMjAsZHJhd3Bvcy55LTIwLGNvbG9yKQ0KICAgICAgICBlbmQgDQogICAgICBlbmQgDQogICAgICBlbmQNCiAgICAgIGVuZA0KIA0KICAtLWRyYXdpbmcgc2V0dGluZ3MgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6R2V0RHJhd3ModGFyZ2V0KQ0KRG1nPXtRPXNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgZ2V0RG1nKCJRIix0YXJnZXQsbXlIZXJvKW9yIDAsUTI9Z2V0RG1nKCJRIix0YXJnZXQsbXlIZXJvLDIpb3IgMCxXPXNlbGYuV1NwZWxsOklzUmVhZHkoKSBhbmQgZ2V0RG1nKCJXIix0YXJnZXQsbXlIZXJvKW9yIDAsRT1zZWxmLkVTcGVsbDpJc1JlYWR5KCkgYW5kIGdldERtZygiRSIsdGFyZ2V0LG15SGVybylvciAwLFI9c2VsZi5SU3BlbGw6SXNSZWFkeSgpIGFuZCBnZXREbWcoIlIiLHRhcmdldCxteUhlcm8pb3IgMCxSMj1nZXREbWcoIlIiLHRhcmdldCxteUhlcm8sMilvciAwLEk9c2VsZi5JZ25pdGU6SXNSZWFkeSgpIGFuZCBnZXREbWcoIklHTklURSIsdGFyZ2V0LG15SGVybylvciAwfQ0KICBpZiBEbWcuUSA+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRJywgUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIERtZy5RKyBEbWcuST50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBJZ25pdGUnLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgRG1nLlcgPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnVycsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBEbWcuVysgRG1nLkk+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdXICsgSWduaXRlJywgUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIERtZy5FID50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ0UnLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgRG1nLkUrIERtZy5JPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnRSArIElnbml0ZScsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBEbWcuUStEbWcuUTIrRG1nLlcgPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIFcnLFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBEbWcuUStEbWcuUTIrRG1nLkUgPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIEUnLFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBEbWcuUStEbWcuUTIrRG1nLlcrIERtZy5JPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIFcgKyBJZ25pdGUnLFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBEbWcuUStEbWcuUTIrRG1nLkUrIERtZy5JPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIEUgKyBJZ25pdGUnLFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBEbWcuUStEbWcuUTIrRG1nLkUrRG1nLlcgPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIFcgKyBFJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgRG1nLlErRG1nLlEyK0RtZy5FK0RtZy5XKyBEbWcuST50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBXICsgRSArIElnbml0ZScsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIERtZy5RK0RtZy5SK0RtZy5SMitEbWcuUTIrRG1nLkUrRG1nLlcgPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIFIgKyBXICsgRScsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIERtZy5RK0RtZy5SK0RtZy5SMitEbWcuUTIrRG1nLkUrRG1nLlcrIERtZy5JPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIFIgKyBXICsgRSArIElnbml0ZScsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZSANCiAgICByZXR1cm4gIkNhbnQgS2lsbCB5ZXQiLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbmQgDQplbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpUaWNrKCkNCiAgICAgICBzZWxmOmF1dG96aG9ueWEoKQ0KICAgICAgICBzZWxmOmNoZWNrdHMoKQ0KICAgICAgIGlmIFZJUF9VU0VSIHRoZW4gc2VsZjphdXRvbGV2ZWwoKSBlbmQNCiAgDQogICAgICAgc2VsZjpnYXBjbG9zZSgpDQogICBpZihzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgKXRoZW4NCiAgICAgIHNlbGY6Y29tYm8oKQ0KICAgIGVuZA0KICAgICBpZihzZWxmLkNvbmZpZy5LZXlzLm9ubHllICAgKXRoZW4NCiAgICAgIHNlbGY6b25seWUoKQ0KICAgIGVuZA0KICAgIGlmKHNlbGYuQ29uZmlnLktleXMubGFuZWNsZWFya2V5ICl0aGVuDQogICAgICBzZWxmOkxhbmVDbGVhcigpDQogICAgZW5kDQogICAgaWYoc2VsZi5Db25maWcuS2V5cy5lc2NhcGVrZXkgKXRoZW4NCiAgICAgIHNlbGY6ZXNjYXBlKCkNCiAgICBlbmQNCiAgICAgIGlmKHNlbGYuQ29uZmlnLktleXMuanVuZ2xlY2xlYXJrZXkgKXRoZW4NCiAgICAgc2VsZjpKdW5nbGVDbGVhcigpDQogICAgZW5kDQogICAgaWYoc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzICkgdGhlbg0KICAgICAgc2VsZjpraWxsc3RlYWwoKQ0KICAgIGVuZA0KICAgIGlmKHNlbGYuQ29uZmlnLktleXMuaGFyYXNza2V5ICAgKSB0aGVuDQogICAgICBzZWxmOmhhcmFzcygpDQogICAgZW5kDQogICAgICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpjaGVja3RzKCkNCiAgICAgICAgIHNlbGYudHM6dXBkYXRlKCkNCiAgICAgICBzZWxmLnRzZTp1cGRhdGUoKQ0KICAgICAgIHNlbGYudHNxOnVwZGF0ZSgpDQogICAgICAgc2VsZi50c3I6dXBkYXRlKCkNCiAgICAgICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgICAgIHNlbGYudHNnOnVwZGF0ZSgpDQogIGlmIG5vdCBzZWxmLnRzZy50YXJnZXR+PW5pbCBvciBub3Qgc2VsZi5Db25maWcudGFyZ2V0c2VsLnRzIHRoZW4NCiAgdGFyZ2V0ID0gc2VsZi50c3cudGFyZ2V0DQogIGVsc2VpZiBzZWxmLnRzZy50YXJnZXR+PW5pbCBvciBzZWxmLnNlbGVjdGVkVGFyIHRoZW4NCiAgdGFyZ2V0ID0gc2VsZi5zZWxlY3RlZFRhcg0KICBlbmQNCiAgZW5kDQogIGxvY2FsIHNraW5zUEIgPSB7fTsNCiAgbG9jYWwgc2tpbk9iamVjdFBvcyA9IG5pbDsNCiAgbG9jYWwgc2tpbkhlYWRlciA9IG5pbDsNCiAgbG9jYWwgZGlzcGVsbEhlYWRlciA9IG5pbDsNCiAgbG9jYWwgc2tpbkggPSBuaWw7DQogIGxvY2FsIHNraW5IUG9zID0gbmlsOw0KICBmdW5jdGlvbiBMZWJsYW5jOnNraW5oYWNrKCkNCiAgaWYgbm90IHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgdGhlbiBTZW5kU2tpblBhY2tldChteUhlcm8uY2hhck5hbWUsIHNraW5zUEJbMV0sIG15SGVyby5uZXR3b3JrSUQpOyBlbHNlDQogIGlmIHNlbGYuQ29uZmlnLnZpcC5za2luLmtleSBhbmQgc2VsZi5Db25maWcudmlwLnBhY2tldCAgdGhlbg0KICBTZW5kU2tpblBhY2tldChteUhlcm8uY2hhck5hbWUsIHNraW5zUEJbc2VsZi5Db25maWcudmlwLnNraW5bJ3NlbGVjdGVkJyAuLiBteUhlcm8uY2hhck5hbWUgLi4gJ1NraW4nXV0sIG15SGVyby5uZXR3b3JrSUQpOw0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOm9ubHllKCkNCiAgICAgICAgIHNlbGYudHNlOnVwZGF0ZSgpDQogICAgICAgICAgaWYoc2VsZi50c2UudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZUUgYW5kICBzZWxmLkNvbmZpZy5LZXlzLm9ubHllICAgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEUoc2VsZi50c2UudGFyZ2V0KQ0KICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6YW50aWFmaygpDQogIGlmIG9zLmNsb2NrKCkgPCBDbG9jayBvciBub3Qgc2VsZi5Db25maWcudmlwLmFudGlhZmsgdGhlbiByZXR1cm4gZW5kDQogICAgICBDbG9jayA9IG9zLmNsb2NrKCkgKyBtYXRoLnJhbmRvbSg2MCwxMjApDQogIG15SGVybzpNb3ZlVG8obXlIZXJvLngsIG15SGVyby56KQ0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpjb21ibygpDQogIGlmIHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID09IDEgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwICkgdGhlbg0KICBzZWxmOmNvbWJvUUVXUigpDQogIGVuZA0KICBpZiBzZWxmLkNvbmZpZy5jb21iby5sb2dpYyA9PSAyIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmNvbWJvLk1hbmEgLzEwMCApIHRoZW4NCiAgc2VsZjpjb21ib1FSRVcoKQ0KICBlbmQNCiAgaWYgc2VsZi5Db25maWcuY29tYm8ubG9naWMgPT0gMyBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKSB0aGVuDQogIHNlbGY6Y29tYm9FUVdSKCkNCiAgZW5kDQogIGlmIHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID09IDQgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwICkgdGhlbg0KICBzZWxmOmNvbWJvRVdRUigpDQogIGVuZA0KICBpZiBzZWxmLkNvbmZpZy5jb21iby5sb2dpYyA9PSA1IGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmNvbWJvLk1hbmEgLzEwMCApIHRoZW4NCiAgc2VsZjpyYW5kb21jb21ibygpDQogIGVuZA0KICAgICAgaWYoc2VsZi5Db25maWcuY29tYm8udXNlSSBhbmQgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgICl0aGVuDQogICAgICBmb3IgXywgdW5pdCBpbiBwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbw0KICAgICAgICBsb2NhbCBkbWdJID0oNTArICgobXlIZXJvLmxldmVsKSoyMCkpDQogICAgICAgIGxvY2FsIGhlYWx0aD11bml0LmhlYWx0aA0KICAgICAgICBpZihoZWFsdGg8ZG1nSSBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlSSBhbmQgR2V0RGlzdGFuY2UodW5pdCk8NjAwKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RJKHVuaXQpDQogICAgICBlbmQNCiAgICAgIGVuZA0KICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6Y29tYm9RUkVXKCkNCiAgIHNlbGYudHN3OnVwZGF0ZSgpDQogICBpZiBub3Qgc2VsZi5Db25maWcuY29tYm8udHVybncudzIgdGhlbg0KICBpZiAoc2VsZi50c3cudGFyZ2V0IH49IG5pbCApdGhlbg0KICBzZWxmOkNhc3RRUih0YXJnZXQpDQogIGVuZA0KICBpZihzZWxmLnRzdy50YXJnZXQgfj0gbmlsICkgYW5kIHNlbGY6UVJ1c2VkKCkgdGhlbg0KICBzZWxmOkNhc3RFVyh0YXJnZXQpDQogIGVuZA0KICBlbmQNCiAgIGlmIHNlbGYuQ29uZmlnLmNvbWJvLnR1cm53LncyIHRoZW4NCiAgaWYgKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgKXRoZW4NCiAgc2VsZjpDYXN0UVIodGFyZ2V0KQ0KICBlbmQNCiAgaWYoc2VsZi50c3cudGFyZ2V0IH49IG5pbCApIGFuZCBzZWxmOlFFdXNlZCgpIHRoZW4NCiAgc2VsZjpDYXN0RVdCKHRhcmdldCkNCiAgZW5kDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpjb21ib0VXUVIoKQ0KICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgIGlmIG5vdCBzZWxmLkNvbmZpZy5jb21iby50dXJudy53NCB0aGVuDQogIGlmIChzZWxmLnRzdy50YXJnZXQgfj0gbmlsICl0aGVuDQogIHNlbGY6Q2FzdEVXKHRhcmdldCkNCiAgZW5kDQogIGlmKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgKSBhbmQgc2VsZjpFV3VzZWQoKSB0aGVuDQogIHNlbGY6Q2FzdFFSKHRhcmdldCkNCiAgZW5kDQogIGVuZA0KICAgaWYgIHNlbGYuQ29uZmlnLmNvbWJvLnR1cm53Lnc0IHRoZW4NCiAgaWYgKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgKXRoZW4NCiAgc2VsZjpDYXN0RVdCKHRhcmdldCkNCiAgZW5kDQogIGlmKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgKSBhbmQgc2VsZjpFV3VzZWQoKSB0aGVuDQogIHNlbGY6Q2FzdFFSKHRhcmdldCkNCiAgZW5kDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpjb21ib0VRV1IoKQ0KICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgIGlmIG5vdCBzZWxmLkNvbmZpZy5jb21iby50dXJudy53MyB0aGVuDQogIGlmIChzZWxmLnRzdy50YXJnZXQgfj0gbmlsICl0aGVuDQogIHNlbGY6Q2FzdEVRKHRhcmdldCkNCiAgZW5kDQogIGlmKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgKSBhbmQgc2VsZjpFUXVzZWQoKSB0aGVuDQogIHNlbGY6Q2FzdFdSKHRhcmdldCkNCiAgZW5kDQogIGVuZA0KICAgaWYgIHNlbGYuQ29uZmlnLmNvbWJvLnR1cm53LnczIHRoZW4NCiAgaWYgKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgKXRoZW4NCiAgc2VsZjpDYXN0RVEodGFyZ2V0KQ0KICBlbmQNCiAgaWYoc2VsZi50c3cudGFyZ2V0IH49IG5pbCApIGFuZCBzZWxmOkVRdXNlZCgpIHRoZW4NCiAgc2VsZjpDYXN0V1JCKHRhcmdldCkNCiAgZW5kDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpjb21ib1FFV1IoKQ0KICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgIGlmIG5vdCBzZWxmLkNvbmZpZy5jb21iby50dXJudy53MSB0aGVuDQogIGlmIChzZWxmLnRzdy50YXJnZXQgfj0gbmlsICl0aGVuDQogIHNlbGY6Q2FzdFFFKHRhcmdldCkNCiAgZW5kDQogIGlmKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgKSBhbmQgc2VsZjpRRXVzZWQoKSB0aGVuDQogIHNlbGY6Q2FzdFdSKHRhcmdldCkNCiAgZW5kDQogIGVuZA0KICAgaWYgc2VsZi5Db25maWcuY29tYm8udHVybncudzEgdGhlbg0KICBpZiAoc2VsZi50c3cudGFyZ2V0IH49IG5pbCApdGhlbg0KICBzZWxmOkNhc3RRRSh0YXJnZXQpDQogIGVuZA0KICBpZihzZWxmLnRzdy50YXJnZXQgfj0gbmlsICkgYW5kIHNlbGY6UUV1c2VkKCkgdGhlbg0KICBzZWxmOkNhc3RXUkIodGFyZ2V0KQ0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOkNhc3RRKHVuaXQpDQogICAgc2VsZi5RU3BlbGw6Q2FzdCh1bml0KQ0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpDYXN0UUUodW5pdCkNCiAgICAgICAgc2VsZi50c3E6dXBkYXRlKCkNCiAgICAgICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi50c3EudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVEgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgIGFuZCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFEodGFyZ2V0KQ0KICAgICBlbmQNCiAgICAgICAgIHNlbGYudHNlOnVwZGF0ZSgpDQogICAgICAgICAgaWYoc2VsZi50c2UudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZUUgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEUodGFyZ2V0KQ0KICAgICAgICAgIGVuZA0KICAgICAgICAgIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOkNhc3RFVyh1bml0KQ0KICAgICAgICBzZWxmLnRzZTp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi50c2UudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZUUgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgIGFuZCBzZWxmLkVTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEUodGFyZ2V0KQ0KICAgICBlbmQNCiAgICAgICAgIHNlbGYudHN3OnVwZGF0ZSgpDQogICAgICAgICAgaWYoc2VsZi50c3cudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVcgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgYW5kIG5vdCBzZWxmOndVc2VkKCkgYW5kIHNlbGYuV1NwZWxsOklzUmVhZHkoKSkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFcodGFyZ2V0KQ0KICAgICAgICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpDYXN0RVdCKHVuaXQpDQogICAgICAgIHNlbGYudHNlOnVwZGF0ZSgpDQogICAgICBpZihzZWxmLnRzZS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlRSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICAgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0RSh0YXJnZXQpDQogICAgIGVuZA0KICAgICAgICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgICAgICAgICBpZihzZWxmLnRzdy50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlVyBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgIGFuZCBzZWxmLldTcGVsbDpJc1JlYWR5KCkpIHRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RXKHRhcmdldCkNCiAgICAgICAgICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6cmFuZG9tY29tYm8oKQ0KICAgICAgICBzZWxmLnRzcTp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi50c3EudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVEgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgIGFuZCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFEodGFyZ2V0KSAgICAgDQogICAgICAgICAgZW5kDQogICAgICAgICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgICAgIGlmKHNlbGYudHN3LnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VXIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgICBhbmQgc2VsZi5XU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RXKHRhcmdldCkgICAgICANCiAgICAgICAgICBlbmQNCiAgICAgICAgICBzZWxmLnRzZTp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi50c2UudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZUUgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgIGFuZCBzZWxmLkVTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEUodGFyZ2V0KSAgICANCiAgICAgICAgICBlbmQNCiAgICAgICAgICAgc2VsZi50c3I6dXBkYXRlKCkNCiAgICAgIGlmKHNlbGYudHNyLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VSIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgICBhbmQgc2VsZi5RU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RSKHRhcmdldCkNCiAgICAgICAgICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6Q2FzdFFSKHVuaXQpDQogICAgICAgIHNlbGYudHNxOnVwZGF0ZSgpDQogICAgICAgICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi50c3EudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVEgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgIGFuZCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFEodGFyZ2V0KQ0KICAgICBlbmQNCiAgICAgICAgIHNlbGYudHNyOnVwZGF0ZSgpDQogICAgICAgICAgaWYoc2VsZi50c3IudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVIgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgYW5kIHNlbGYuUlNwZWxsOklzUmVhZHkoKSkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFIodGFyZ2V0KQ0KICAgICAgICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpDYXN0V1IodW5pdCkNCiAgICAgICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgICAgIGlmKHNlbGYudHN3LnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VXIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgICBhbmQgc2VsZi5XU3BlbGw6SXNSZWFkeSgpYW5kIG5vdCBzZWxmOndVc2VkKCkpdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFcodGFyZ2V0KQ0KICAgICBlbmQNCiAgICAgICAgIHNlbGYudHNyOnVwZGF0ZSgpDQogICAgICAgICAgaWYoc2VsZi50c3IudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVIgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgYW5kIHNlbGYuUlNwZWxsOklzUmVhZHkoKSkgYW5kIG5vdCBzZWxmOnJVc2VkKCkgIHRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RSKHRhcmdldCkNCiAgICAgICAgICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6Q2FzdFdSQih1bml0KQ0KICAgICAgICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi50c3cudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVcgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgIGFuZCBzZWxmLldTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFcodGFyZ2V0KQ0KICAgICBlbmQNCiAgICAgICAgIHNlbGYudHNyOnVwZGF0ZSgpDQogICAgICAgICAgaWYoc2VsZi50c3IudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVIgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgYW5kIHNlbGYuUlNwZWxsOklzUmVhZHkoKSkgYW5kIG5vdCBzZWxmOnJVc2VkKCkgIHRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RSKHRhcmdldCkNCiAgICAgICAgICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6Q2FzdFFXSCgpDQogICAgICAgIHNlbGYudHNxOnVwZGF0ZSgpDQogICAgICBpZihzZWxmLnRzcS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuaGFyYXNzLnVzZVEgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmhhcmFzc2tleSAgYW5kIHNlbGYuUVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0USh0YXJnZXQpDQogICAgIGVuZA0KICAgICAgICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi50c3cudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmhhcmFzcy51c2VXIGFuZCAgc2VsZi5Db25maWcuS2V5cy5oYXJhc3NrZXkgIGFuZCBzZWxmLldTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICAgc2VsZjpDYXN0Vyh0YXJnZXQpDQogICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpDYXN0UVdLKHVuaXQpDQogICAgICAgIHNlbGYudHNxOnVwZGF0ZSgpDQogICAgICBpZihzZWxmLnRzcS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZVFXIGFuZCAgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzIGFuZCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFEodGFyZ2V0KQ0KICAgICBlbmQNCiAgICAgICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgICAgIGlmKHNlbGYudHN3LnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlUVcgYW5kICBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgYW5kIHNlbGYuV1NwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0Vyh0YXJnZXQpDQogICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpDYXN0RVEodW5pdCkNCiAgICAgICAgc2VsZi50c2U6dXBkYXRlKCkNCiAgICAgICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgICAgIGlmKHNlbGYudHNlLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VFIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgICBhbmQgc2VsZi5FU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RFKHRhcmdldCkNCiAgICAgZW5kDQogICAgICAgICBzZWxmLnRzcTp1cGRhdGUoKQ0KICAgICAgICAgIGlmKHNlbGYudHNxLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VRIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgIGFuZCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkpIHRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RRKHRhcmdldCkNCiAgICAgICAgICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6Q2FzdFcodW5pdCkNCiAgICBzZWxmLldTcGVsbDpDYXN0KHVuaXQpDQogIGVuZA0KICANCiAgZnVuY3Rpb24gTGVibGFuYzpDYXN0RSh1bml0KQ0KICAgc2VsZi5FU3BlbGw6Q2FzdCh1bml0KQ0KICAgIA0KICBlbmQNCiAgDQogIGZ1bmN0aW9uIExlYmxhbmM6Q2FzdFIodW5pdCkNCiAgICBzZWxmLlJTcGVsbDpDYXN0KHVuaXQpDQogIGVuZA0KICANCiAgZnVuY3Rpb24gTGVibGFuYzpDYXN0SSh1bml0KQ0KICAgIHNlbGYuSWduaXRlOkNhc3QodW5pdCkNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6a2lsbHN0ZWFsKCkNCiAgZm9yIF8sIHVuaXQgaW4gcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8NCiAgICAgIGxvY2FsIGhlYWx0aCA9IHVuaXQuaGVhbHRoDQogICAgICBsb2NhbCBkbWdFID0gZ2V0RG1nKCJFIiwgdW5pdCwgbXlIZXJvKSArICgobXlIZXJvLmFwKSowLjUpICsgKGdldERtZygiRSIsIHVuaXQsIG15SGVybykgKyAoKG15SGVyby5hcCkqMC41KSkNCiAgICAgICAgaWYoc2VsZi50c2UudGFyZ2V0IH49IG5pbCBhbmQgIHNlbGYuRVNwZWxsOklzUmVhZHkoKSBhbmQgbm90IHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICBhbmQgaGVhbHRoPGRtZ0UgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VFICAgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0RSh1bml0KSAgDQogICAgICAgIGVuZA0KICAgICAgICBsb2NhbCBkbWdRID0gZ2V0RG1nKCJRIiwgdW5pdCwgbXlIZXJvKSArICgobXlIZXJvLmFwKSowLjQwKQ0KICAgICAgICBpZihzZWxmLnRzcS50YXJnZXQgfj0gbmlsIGFuZCAgc2VsZi5RU3BlbGw6SXNSZWFkeSgpIGFuZCBub3Qgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgIGFuZCBoZWFsdGg8ZG1nUSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZVEgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFEodW5pdCkgIA0KICAgICAgICBlbmQNCiAgICAgICAgIGxvY2FsIGRtZ1FXID0gZ2V0RG1nKCJRIiwgdW5pdCwgbXlIZXJvKSArICgobXlIZXJvLmFwKSowLjQwKSsoZ2V0RG1nKCJXIiwgdW5pdCwgbXlIZXJvKSArICgobXlIZXJvLmFwKSowLjYwKSsoZ2V0RG1nKCJRIiwgdW5pdCwgbXlIZXJvKSArICgobXlIZXJvLmFwKSowLjQwKSkpDQogICAgICAgIGlmKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgYW5kICBoZWFsdGg8ZG1nUSBhbmQgbm90IHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZVFXIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RRV0sodW5pdCkgIA0KICAgICAgICBlbmQNCiAgICAgICAgICAgICAgbG9jYWwgZG1nVyA9IGdldERtZygiVyIsIHVuaXQsIG15SGVybykgKyAoKG15SGVyby5hcCkqMC42MCkNCiAgICAgICAgaWYoc2VsZi50c3cudGFyZ2V0IH49IG5pbCBhbmQgIHNlbGYuV1NwZWxsOklzUmVhZHkoKSBhbmQgbm90IHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICBhbmQgaGVhbHRoPGRtZ1EgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VXIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RXKHVuaXQpICANCiAgICAgICAgZW5kDQogICAgICAgICBsb2NhbCBkbWdJID0oNTArICgobXlIZXJvLmxldmVsKSoyMCkpDQogICAgICAgIGlmKGhlYWx0aDxkbWdJIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlSSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzIGFuZCBHZXREaXN0YW5jZSh1bml0KTw2MDApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEkodW5pdCkNCiAgICAgICAgZW5kDQogICAgICAgIGxvY2FsIGRtZ1IgPWdldERtZygiUiIsdW5pdCxteUhlcm8pKygobXlIZXJvLmFwKSowLjYwKSANCiAgICAgICAgaWYoc2VsZi50c3IudGFyZ2V0IH49IG5pbCBhbmQgIHNlbGYuUlNwZWxsOklzUmVhZHkoKSBhbmQgbm90IHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICBhbmQgaGVhbHRoPGRtZ1IgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VSIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgYW5kIEdldERpc3RhbmNlKHVuaXQpPDYwMCl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0Uih1bml0KQ0KICAgICAgICBlbmQNCiAgICAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOmhhcmFzcygpDQogICAgc2VsZi50c3E6dXBkYXRlKCkNCiAgICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgICBpZiBzZWxmLkNvbmZpZy5LZXlzLmhhcmFzc2tleSAgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuaGFyYXNzLk1hbmEgLzEwMCApICB0aGVuDQogICAgc2VsZjpDYXN0UVdIKCkNCiAgICAgIGVuZCAgIA0KICAgZW5kDQogICBmdW5jdGlvbiBMZWJsYW5jOkxhbmVDbGVhcigpDQogIGxvY2FsIGNsZWFydGFyZ2V0ID0gc2VsZi5jbGVhcnRhcmdldA0KICBzZWxmLmVuZW15TWluaW9uczp1cGRhdGUoKQ0KICAgc2VsZi5vdGhlck1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIHNlbGYuanVuZ2xlTWluaW9uczp1cGRhdGUoKQ0KICAgICAgZm9yIGksIG1pbmlvbiBpbiBpcGFpcnMoc2VsZi5lbmVteU1pbmlvbnMub2JqZWN0cykgZG8NCiAgICAgICAgaWYgVmFsaWRUYXJnZXQobWluaW9uLCA2MDApIGFuZCAoY2xlYXJ0YXJnZXQgPT0gbmlsIG9yIG5vdCBWYWxpZFRhcmdldChjbGVhcnRhcmdldCkpIHRoZW4NCiAgICAgICAgICBjbGVhcnRhcmdldCA9IG1pbmlvbg0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgZm9yIGksIG1pbmlvbiBpbiBwYWlycyhzZWxmLmVuZW15TWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgICBpZiBWYWxpZFRhcmdldChtaW5pb24pIGFuZCBtaW5pb24gfj0gbmlsIHRoZW4NCiAgICAgICAgICBpZiBzZWxmLkNvbmZpZy5LZXlzLmxhbmVjbGVhcmtleSAgYW5kIHNlbGYuQ29uZmlnLmxhbmVjbGVhci51c2VRIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmxhbmVjbGVhci5NYW5hIC8xMDAgKSBhbmQgR2V0RGlzdGFuY2UobWluaW9uKSA8PSBzZWxmLlFTcGVsbC5SYW5nZSB0aGVuIA0KICAgICAgICAgICAgIHNlbGY6Q2FzdFEoY2xlYXJ0YXJnZXQpDQogICAgICAgICAgZW5kDQogICAgICAgICAgaWYgc2VsZi5Db25maWcuS2V5cy5sYW5lY2xlYXJrZXkgIGFuZCBzZWxmLkNvbmZpZy5sYW5lY2xlYXIudXNlVyBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5sYW5lY2xlYXIuTWFuYSAvMTAwICkgYW5kIEdldERpc3RhbmNlKG1pbmlvbikgPD0gc2VsZi5XU3BlbGwuUmFuZ2UgdGhlbiANCiAgICAgICAgICAgIGxvY2FsIEJlc3RQb3MsIEJlc3RIaXQgPSBHZXRCZXN0Q2lyY3VsYXJGYXJtUG9zaXRpb24oc2VsZi5XU3BlbGwuUmFuZ2UsIHNlbGYuV1NwZWxsLldpZHRoLCBzZWxmLmVuZW15TWluaW9ucy5vYmplY3RzKQ0KICAgICAgICAgICAgaWYgQmVzdFBvcyB+PSBuaWwgdGhlbg0KICAgICAgICAgICAgICBDYXN0U3BlbGwoX1csIEJlc3RQb3MueCwgQmVzdFBvcy56KQ0KICAgICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgICAgICAgaWYgc2VsZi5Db25maWcuS2V5cy5sYW5lY2xlYXJrZXkgIGFuZCBzZWxmLkNvbmZpZy5sYW5lY2xlYXIudXNlUiBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5sYW5lY2xlYXIuTWFuYSAvMTAwICkgYW5kIEdldERpc3RhbmNlKG1pbmlvbikgPD0gc2VsZi5XU3BlbGwuUmFuZ2UgdGhlbiANCiAgICAgICAgICAgIGxvY2FsIEJlc3RQb3MsIEJlc3RIaXQgPSBHZXRCZXN0Q2lyY3VsYXJGYXJtUG9zaXRpb24oc2VsZi5XU3BlbGwuUmFuZ2UsIHNlbGYuV1NwZWxsLldpZHRoLCBzZWxmLmVuZW15TWluaW9ucy5vYmplY3RzKQ0KICAgICAgICAgICAgaWYgQmVzdFBvcyB+PSBuaWwgdGhlbg0KICAgICAgICAgICAgICBDYXN0U3BlbGwoX1IsIEJlc3RQb3MueCwgQmVzdFBvcy56KQ0KICAgICAgICAgIGVuZA0KICAgICAgICBlbmQgICAgICAgIA0KICAgICAgZW5kDQogICAgZW5kDQogIGVuZA0KICANCiAgZnVuY3Rpb24gTGVibGFuYzpKdW5nbGVDbGVhcigpDQogIGxvY2FsIGNsZWFydGFyZ2V0ID0gbmlsDQogICAgICBzZWxmLmVuZW15TWluaW9uczp1cGRhdGUoKQ0KICAgICAgc2VsZi5vdGhlck1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIHNlbGYuanVuZ2xlTWluaW9uczp1cGRhdGUoKQ0KICAgICAgZm9yIGksIG1pbmlvbiBpbiBpcGFpcnMoc2VsZi5lbmVteU1pbmlvbnMub2JqZWN0cykgZG8NCiAgICAgICAgaWYgVmFsaWRUYXJnZXQobWluaW9uLCA2MDApIGFuZCAoY2xlYXJ0YXJnZXQgPT0gbmlsIG9yIG5vdCBWYWxpZFRhcmdldChjbGVhcnRhcmdldCkpIHRoZW4NCiAgICAgICAgICBjbGVhcnRhcmdldCA9IG1pbmlvbg0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgZm9yIGksIGp1bmdsZW1pbmlvbiBpbiBpcGFpcnMoc2VsZi5qdW5nbGVNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICAgIGlmIFZhbGlkVGFyZ2V0KGp1bmdsZW1pbmlvbiwgNjAwKSBhbmQgKGNsZWFydGFyZ2V0ID09IG5pbCBvciBub3QgVmFsaWRUYXJnZXQoY2xlYXJ0YXJnZXQpKSB0aGVuDQogICAgICAgICAgY2xlYXJ0YXJnZXQgPSBqdW5nbGVtaW5pb24NCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGZvciBpLCBvdGhlcm1pbmlvbiBpbiBpcGFpcnMoc2VsZi5vdGhlck1pbmlvbnMub2JqZWN0cykgZG8NCiAgICAgICAgaWYgVmFsaWRUYXJnZXQob3RoZXJtaW5pb24sIDYwMCkgYW5kIChjbGVhcnRhcmdldCA9PSBuaWwgb3Igbm90IFZhbGlkVGFyZ2V0KGNsZWFydGFyZ2V0KSkgdGhlbg0KICAgICAgICAgIGNsZWFydGFyZ2V0ID0gb3RoZXJtaW5pb24NCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGlmIGNsZWFydGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGlmKHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcuanVuZ2xlY2xlYXIudXNlUSBhbmQgc2VsZi5Db25maWcuS2V5cy5qdW5nbGVjbGVhcmtleSApIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyLk1hbmEgLzEwMCApIHRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RRKGNsZWFydGFyZ2V0KQ0KICAgICAgICBlbmQNCiAgICAgICAgaWYgY2xlYXJ0YXJnZXQgfj0gbmlsIHRoZW4NCiAgICAgICAgaWYoc2VsZi5XU3BlbGw6SXNSZWFkeSgpIGFuZCBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhci51c2VXIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmp1bmdsZWNsZWFya2V5ICkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuanVuZ2xlY2xlYXIuTWFuYSAvMTAwICkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFcoY2xlYXJ0YXJnZXQpDQogICAgICAgIGVuZA0KICAgICAgICBpZiBjbGVhcnRhcmdldCB+PSBuaWwgdGhlbg0KICAgICAgICBpZihzZWxmLkVTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyLnVzZUUgYW5kIHNlbGYuQ29uZmlnLktleXMuanVuZ2xlY2xlYXJrZXkgKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0RShjbGVhcnRhcmdldCkNCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICBlbmQNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOndVc2VkKCkgDQogICAgbG9jYWwgbGVibGFuY1cgPSBteUhlcm86R2V0U3BlbGxEYXRhKF9XKQ0KICAgIGlmIGxlYmxhbmNXLm5hbWUgPT0gImxlYmxhbmNzbGlkZXJldHVybiIgdGhlbiANCiAgICAgIHJldHVybiB0cnVlIA0KICAgIGVsc2UgDQogICAgICByZXR1cm4gZmFsc2UNCiAgICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6clVzZWQoKSANCiAgICBsb2NhbCBsZWJsYW5jUiA9IG15SGVybzpHZXRTcGVsbERhdGEoX1IpDQogICAgaWYgbGVibGFuY1IubmFtZSA9PSAiTGVibGFuY1NsaWRlTSIgdGhlbiANCiAgICAgIHJldHVybiBmYWxzZQ0KICAgIGVsc2UgDQogICAgICByZXR1cm4gdHJ1ZQ0KICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpRRXVzZWQoKSANCiAgICBsb2NhbCBsZWJsYW5jUSA9IHNlbGYuUVNwZWxsOklzUmVhZHkoKQ0KICAgIGxvY2FsIGxlYmxhbmNFID0gc2VsZi5FU3BlbGw6SXNSZWFkeSgpDQogICAgaWYgKGxlYmxhbmNRIGFuZCBsZWJsYW5jRSkgdGhlbiANCiAgICAgIHJldHVybiBmYWxzZSANCiAgICBlbHNlIA0KICAgICAgcmV0dXJuIHRydWUNCiAgICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6RVF1c2VkKCkgDQogICAgbG9jYWwgbGVibGFuY1cgPSBzZWxmLkVTcGVsbDpJc1JlYWR5KCkNCiAgICBsb2NhbCBsZWJsYW5jRSA9IHNlbGYuUVNwZWxsOklzUmVhZHkoKQ0KICAgIGlmIChsZWJsYW5jVyBhbmQgbGVibGFuY0UpIHRoZW4gDQogICAgICByZXR1cm4gZmFsc2UgDQogICAgZWxzZSANCiAgICAgIHJldHVybiB0cnVlDQogICAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOkVXdXNlZCgpIA0KICAgIGxvY2FsIGxlYmxhbmNXID0gc2VsZi5FU3BlbGw6SXNSZWFkeSgpDQogICAgbG9jYWwgbGVibGFuY0UgPSBzZWxmLldTcGVsbDpJc1JlYWR5KCkNCiAgICBpZiAobGVibGFuY1cgYW5kIGxlYmxhbmNFKSB0aGVuIA0KICAgICAgcmV0dXJuIGZhbHNlIA0KICAgIGVsc2UgDQogICAgICByZXR1cm4gdHJ1ZQ0KICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpRUnVzZWQoKSANCiAgICBsb2NhbCBsZWJsYW5jVyA9IHNlbGYuUVNwZWxsOklzUmVhZHkoKQ0KICAgIGxvY2FsIGxlYmxhbmNFID0gc2VsZi5SU3BlbGw6SXNSZWFkeSgpDQogICAgaWYgKGxlYmxhbmNXIGFuZCBsZWJsYW5jRSkgdGhlbiANCiAgICAgIHJldHVybiBmYWxzZSANCiAgICBlbHNlIA0KICAgICAgcmV0dXJuIHRydWUNCiAgICBlbmQNCiAgZW5kDQogIGxvY2FsIHNwZWxsTGV2ZWwgPSAwDQogIGZ1bmN0aW9uIExlYmxhbmM6YXV0b2xldmVsKCkNCmlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gMSBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTEgPSAgIHsgMSwyLDMsMSwxLDQsMSwyLDEsMiw0LDIsMiwzLDMsNCwzLDN9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTEpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSAyIGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlMiA9ICAgeyAxLDIsMywxLDEsNCwxLDMsMSwzLDQsMywzLDIsMiw0LDIsMn0NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlMikNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDMgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2UzID0gIHsgMiwzLDEsMiwyLDQsMiwxLDIsMSw0LDEsMSwzLDMsNCwzLDN9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTMpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSA0IGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlNCA9ICB7IDIsMywxLDIsMiw0LDIsMywyLDMsNCwzLDMsMSwxLDQsMSwxfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2U0KQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gNSBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTUgPSAgeyAzLDEsMiwzLDMsNCwzLDIsMywyLDQsMiwyLDEsMSw0LDEsMX0NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlNSkNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDYgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2U2ID0gIHsgMywxLDIsMywzLDQsMywxLDMsMSw0LDEsMSwyLDIsNCwyLDJ9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTYpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDcgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2U2ID0gIHsgMiwxLDMsMiwxLDQsMiwyLDEsMyw0LDIsMSwxLDMsNCwzLDN9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTYpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6YXV0b3pob255YSgpDQogICAgaWYgc2VsZi5Db25maWcuaXRlbS5lbmFibGVhdXRvemhvbnlhIHRoZW4NCiAgICAgZm9yIF8gPSBJVEVNXzEsIElURU1fNyBkbw0KICAgICAgaWYgbXlIZXJvLmhlYWx0aCA8PSAobXlIZXJvLm1heEhlYWx0aCAqIHNlbGYuQ29uZmlnLml0ZW0uYXV0b3pob255YSAvIDEwMCkgYW5kICggbXlIZXJvOkNhblVzZVNwZWxsKF8pID09IDAgYW5kIG15SGVybzpHZXRTcGVsbERhdGEoXykubmFtZSA9PSAiWmhvbnlhc0hvdXJnbGFzcyIgKXRoZW4gQ2FzdFNwZWxsKF8pDQogICAgZW5kDQogICAgZW5kDQogICAgZW5kDQogICAgZW5kDQogICAgZnVuY3Rpb24gTGVibGFuYzplc2NhcGVmb3JnYXAoKQ0KICBpZiBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICBhbmQgc2VsZi5Db25maWcuY29tYm8uZ2FwY2xvc2UgYW5kIG5vdCBzZWxmOndVc2VkKCkgdGhlbg0KICBDYXN0U3BlbGwoX1csbW91c2VQb3MueCxtb3VzZVBvcy56KQ0KICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6ZXNjYXBlKCkNCiAgaWYgc2VsZi5Db25maWcuS2V5cy5lc2NhcGVrZXkgIGFuZCBzZWxmLkNvbmZpZy5lc2NhcGUudXNlVyBhbmQgbm90IHNlbGY6d1VzZWQoKSB0aGVuDQogIENhc3RTcGVsbChfVyxtb3VzZVBvcy54LG1vdXNlUG9zLnopDQogIGVuZA0KICBpZiBzZWxmLkNvbmZpZy5LZXlzLmVzY2FwZWtleSAgdGhlbiANCiAgc2VsZjp3YWxrKCkNCiAgZW5kDQogIGlmIHNlbGYuQ29uZmlnLktleXMuZXNjYXBla2V5ICBhbmQgc2VsZi5Db25maWcuZXNjYXBlLnVzZVIgYW5kIG5vdCAgc2VsZjpyVXNlZCgpIHRoZW4NCiAgQ2FzdFNwZWxsKF9SLG1vdXNlUG9zLngsbW91c2VQb3MueikNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOndhbGsoKQ0KICAgIG15SGVybzpNb3ZlVG8obW91c2VQb3MueCxtb3VzZVBvcy56KQ0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpnYXBjbG9zZSgpDQogIGlmIHRhcmdldCBhbmQgR2V0RGlzdGFuY2UodGFyZ2V0LG15SGVybyk+ODAwIHRoZW4gDQogIHNlbGY6ZXNjYXBlZm9yZ2FwKCkNCiAgICAgIGVuZCANCiAgDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOlRBUkdFVENTKCkNCiAgICAgIGxvY2FsIFRhcmdldCA9IG5pbA0KICAgICAgaWYgc2VsZi5zZWxlY3RlZFRhciB0aGVuIFRhcmdldCA9IHNlbGYuc2VsZWN0ZWRUYXINCiAgICAgIGVsc2UgVGFyZ2V0ID0gc2VsZi50c3cudGFyZ2V0DQogICAgICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6V25kTXNnKE1zZywgS2V5KQ0KICBpZiBzZWxmLkNvbmZpZy5LZXlzLmNvbWJvbW9kZSB0aGVuDQogIHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID0gc2VsZi5Db25maWcuY29tYm8ubG9naWMgKzENCiAgaWYgc2VsZi5Db25maWcuY29tYm8ubG9naWMgPiA1IHRoZW4gc2VsZi5Db25maWcuY29tYm8ubG9naWMgPSAxIGVuZA0KICBlbmQNCiAgaWYgc2VsZi5Db25maWcudGFyZ2V0c2VsLnRzIHRoZW4gICAgICANCiAgICAgICAgICBpZiBNc2cgPT0gV01fTEJVVFRPTkRPV04gdGhlbg0KICAgICAgICAgICAgICBsb2NhbCBtaW5EID0gMTANCiAgICAgICAgICAgICAgbG9jYWwgc3RhcmdldCA9IG5pbA0KICAgICAgICAgICAgICBmb3IgaSwgZW5lbXkgaW4gaXBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvDQogICAgICAgICAgICAgICAgICBpZiBWYWxpZFRhcmdldChlbmVteSkgdGhlbg0KICAgICAgICAgICAgICAgICAgICAgIGlmIEdldERpc3RhbmNlKGVuZW15LCBtb3VzZVBvcykgPD0gbWluRCBvciBzdGFyZ2V0ID09IG5pbCB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgICAgIG1pbkQgPSBHZXREaXN0YW5jZShlbmVteSwgbW91c2VQb3MpDQogICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJnZXQgPSBlbmVteQ0KICAgICAgICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgIGVuZCAgICAgDQogICAgICAgICAgICAgIGlmIHN0YXJnZXQgYW5kIG1pbkQgPCA1MDAgdGhlbg0KICAgICAgICAgICAgICAgICAgaWYgc2VsZi5zZWxlY3RlZFRhciBhbmQgc3RhcmdldC5jaGFyTmFtZSA9PSBzZWxmLnNlbGVjdGVkVGFyLmNoYXJOYW1lIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNlbGVjdGVkVGFyID0gbmlsDQogICAgICAgICAgICAgICAgICAgICAgcHJpbnQoIjxmb250IGNvbG9yPVwiI0NCRjZGRlwiPlRhcmdldCA8Yj5pcyBubyBsb2dlciBzZWxlY3RlZC48L2I+OiAiLi5zdGFyZ2V0LmNoYXJOYW1lLi4iPC9mb250PiIpDQogICAgICAgICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgICAgICAgc2VsZi5zZWxlY3RlZFRhciA9IHN0YXJnZXQgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICBwcmludCgiPGZvbnQgY29sb3I9XCIjQ0JGNkZGXCI+TmV3IHRhcmdldCA8Yj5zZWxlY3RlZC48L2I+OiAiLi5zdGFyZ2V0LmNoYXJOYW1lLi4iPC9mb250PiIpDQogICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGVuZA0KICAtLSBBbGwgY2xhc3NpYyBuZWNlc3NlcmllcyBzdGFydA0KICAtLSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1MZUJsYW5jIEVuZGluZy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgLS0gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tTGVCbGFuYyBFbmRpbmctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogIC0tIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLUxlQmxhbmMgRW5kaW5nLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAtLSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1MZUJsYW5jIEVuZGluZy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgY2xhc3MgIkFrYWxpIg0KICBmdW5jdGlvbiBBa2FsaTpfX2luaXQoKQ0Kc2VsZi50cz0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgNzAwLCBEQU1BR0VfUEhZU0lDQUwsIGZhbHNlLCB0cnVlKQ0Kc2VsZi50c3E9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDYwMCwgREFNQUdFX1BIWVNJQ0FMLCBmYWxzZSwgdHJ1ZSkNCnNlbGYudHN3PSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCA3MDAsIERBTUFHRV9QSFlTSUNBTCwgZmFsc2UsIHRydWUpDQpzZWxmLnRzZT0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgMzI1LCBEQU1BR0VfUEhZU0lDQUwsIGZhbHNlLCB0cnVlKQ0Kc2VsZi50c3I9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDcwMCwgREFNQUdFX1BIWVNJQ0FMLCBmYWxzZSwgdHJ1ZSkNCnNlbGYudHNnPSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCA5MjUsIERBTUFHRV9NQUdJQywgZmFsc2UsIHRydWUpDQogICBzZWxmLlFTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9RLCBEYW1hZ2VOYW1lID0gIlEiLCBSYW5nZSA9IDYwMCwgQ29sbGlzaW9uID0gZmFsc2UsIEFvZSA9IGZhbHNlLCBUeXBlID0gU1BFTExfVFlQRS5UQVJHRVRURUR9KQ0KICAgc2VsZi5XU3BlbGwgPSBfU3BlbGwoe1Nsb3QgPSBfVywgRGFtYWdlTmFtZSA9ICJXIiwgUmFuZ2UgPSA3MDAsIENvbGxpc2lvbiA9IGZhbHNlLCBBb2UgPSB0cnVlLCBUeXBlID0gU1BFTExfVFlQRS5TRUxGfSkNCiAgIHNlbGYuRVNwZWxsID0gX1NwZWxsKHtTbG90ID0gX0UsIERhbWFnZU5hbWUgPSAiRSIsIFJhbmdlID0gMzI1LCBDb2xsaXNpb24gPSBmYWxzZSwgQW9lID0gdHJ1ZSwgVHlwZSA9IFNQRUxMX1RZUEUuU0VMRn0pDQogICBzZWxmLlJTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9SLCBEYW1hZ2VOYW1lID0gIlIiLCBSYW5nZSA9NzAwLCAgQ29sbGlzaW9uID0gZmFsc2UsIEFvZSA9IGZhbHNlLCBUeXBlID0gU1BFTExfVFlQRS5UQVJHRVRURUR9KQ0KICAgc2VsZi5JZ25pdGUgPSBfU3BlbGwoe1Nsb3QgPSBGaW5kU3VtbW9uZXJTbG90KCJzdW1tb25lcmRvdCIpLCBEYW1hZ2VOYW1lID0gIklHTklURSIsIFJhbmdlID0gNjAwLCBUeXBlID0gU1BFTExfVFlQRS5UQVJHRVRURUR9KQ0KLS18PiBNaW5pb24gTWFuYWdlcnMNCiAgICBzZWxmLmVuZW15TWluaW9ucyAgID0gbWluaW9uTWFuYWdlcihNSU5JT05fRU5FTVksICAgNjUwLCBteUhlcm8sIE1JTklPTl9TT1JUX01BWEhFQUxUSF9ERUMpDQogICAgc2VsZi5hbGx5TWluaW9ucyAgICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX0FMTFksICAgNjUwLCBteUhlcm8sIE1JTklPTl9TT1JUX01BWEhFQUxUSF9ERUMpDQogICAgc2VsZi5qdW5nbGVNaW5pb25zICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX0pVTkdMRSwgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgIHNlbGYub3RoZXJNaW5pb25zICAgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9PVEhFUiwgICA2NTAsIG15SGVybywgTUlOSU9OX1NPUlRfTUFYSEVBTFRIX0RFQykNCiAgICBzZWxmOkxvYWRNZW51KCkNCiAgICBMYXN0X0xldmVsU3BlbGwgPSAwDQogICAgICBzZWxmOmZpbmRvcmJ3YWxrZXIoKQ0KICAgICAgICAgaWYgVklQX1VTRVIgdGhlbiAgc2VsZjpza2luaGFjaygpIGVuZA0KICAgICAgQWRkVGlja0NhbGxiYWNrKGZ1bmN0aW9uKCkgc2VsZjpUaWNrKCkgZW5kKQ0KICBBZGREcmF3Q2FsbGJhY2soZnVuY3Rpb24oKSBzZWxmOkRyYXcoKSBlbmQpDQogIEFkZE1zZ0NhbGxiYWNrKGZ1bmN0aW9uKG1zZyxLZXkpIHNlbGY6V25kTXNnKG1zZyxLZXkpIGVuZCkNCiAgLS1BZGRBbmltYXRpb25DYWxsYmFjayhmdW5jdGlvbih1bml0LCBhbmltYXRpb24pIHNlbGY6QW5pbWF0aW9uKHVuaXQsIGFuaW1hdGlvbikgZW5kKQ0KICAtLUFkZFByb2Nlc3NTcGVsbENhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIHNwZWxsKSBzZWxmOlByb2Nlc3NTcGVsbCh1bml0LCBzcGVsbCkgZW5kKQ0KICAtLUFkZEFwcGx5QnVmZkNhbGxiYWNrKGZ1bmN0aW9uKHNvdXJjZSwgdW5pdCwgYnVmZikgc2VsZjpPbkFwcGx5QnVmZihzb3VyY2UsIHVuaXQsIGJ1ZmYpIGVuZCkNCiAgLS1BZGRVcGRhdGVCdWZmQ2FsbGJhY2soZnVuY3Rpb24odW5pdCwgYnVmZiwgc3RhY2tzKSBzZWxmOlVwZGF0ZUJ1ZmYodW5pdCwgYnVmZiwgc3RhY2tzKSBlbmQpDQogIC0tQWRkUmVtb3ZlQnVmZkNhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIGJ1ZmYpIHNlbGY6T25SZW1vdmVCdWZmKHVuaXQsIGJ1ZmYpIGVuZCkgDQogIGVuZA0KICBmdW5jdGlvbiBBa2FsaTpUaWNrKCkNCiAgc2VsZjphdXRvemhvbnlhKCkNCiAgc2VsZjpBdXRvc3RlYWx0aCgpDQogIHNlbGY6YXV0b3EoKQ0KICAgICAgICBzZWxmOmNoZWNrdHMoKQ0KICAgICAgICBpZiBWSVBfVVNFUiB0aGVuIHNlbGY6YXV0b2xldmVsKCkgZW5kDQogaWYoc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSBhbmQgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5SbG9naWMubG9naWMgPT0gMSApdGhlbg0KICAgIHNlbGY6Y29tYm8oKQ0KICBlbmQNCiAgIGlmKHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgYW5kIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljLmxvZ2ljID09IDIgKXRoZW4NCiAgICBzZWxmOmNvbWJvMigpDQogIGVuZA0KICAgICAgaWYoc2VsZi5Db25maWcuS2V5cy5qdW5nbGVjbGVhcmtleSApdGhlbg0KICAgc2VsZjpKdW5nbGVDbGVhcigpDQogIGVuZA0KICAgIGlmKHNlbGYuQ29uZmlnLktleXMubGFuZWNsZWFya2V5ICl0aGVuDQogICAgc2VsZjpMYW5lQ2xlYXIoKQ0KICBlbmQNCiAgaWYoc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzICkgdGhlbg0KICAgIHNlbGY6a2lsbHN0ZWFsKCkNCiAgZW5kDQogIGlmKHNlbGYuQ29uZmlnLktleXMuaGFyYXNza2V5ICApIHRoZW4NCiAgICBzZWxmOmhhcmFzcygpDQogIGVuZA0KICAgICAgaWYoc2VsZi5Db25maWcuS2V5cy5lc2NhcGVrZXkgKXRoZW4NCiAgICAgIHNlbGY6ZXNjYXBlKCkNCiAgICBlbmQNCiAgZW5kDQogICAgZnVuY3Rpb24gQWthbGk6d2FsaygpDQogICAgbXlIZXJvOk1vdmVUbyhtb3VzZVBvcy54LG1vdXNlUG9zLnopDQogIGVuZA0KICBmdW5jdGlvbiBBa2FsaTplc2NhcGUoKQ0KICAgaWYgc2VsZi5Db25maWcuS2V5cy5lc2NhcGVrZXkgIGFuZCBzZWxmLkNvbmZpZy5lc2NhcGUudXNlVyB0aGVuDQogIENhc3RTcGVsbChfVyxtb3VzZVBvcy54LG1vdXNlUG9zLnopDQogIGVuZA0KICBpZiBzZWxmLkNvbmZpZy5LZXlzLmVzY2FwZWtleSAgdGhlbiANCiAgc2VsZjp3YWxrKCkNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBBa2FsaTpEcmF3KCkNCiAgICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LnFkcmF3IGFuZCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkgdGhlbg0KICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCA2MDAsIDEscmVkKQ0KICBlbmQNCg0KICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LndkcmF3IGFuZCBzZWxmLldTcGVsbDpJc1JlYWR5KCkgdGhlbg0KICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCA3MDAsIDEsIHJlZCkNCiAgZW5kDQoNCiAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5lZHJhdyBhbmQgc2VsZi5FU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgMzI1LCAxLCByZWQpDQogIGVuZA0KICANCiAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5yZHJhdyBhbmQgc2VsZi5SU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgNzAwLDEsIHJlZCkNCiAgZW5kDQogIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcuYWFkcmF3IHRoZW4NCiAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgNTUwLDEsIEFSR0IoMjU1LCAyNTUsMCwwKSkNCiAgZW5kDQogICAgICAgICAgaWYgc2VsZi5Db25maWcub3RoZXIudGFyZ2V0IGFuZCBzZWxmLnNlbGVjdGVkVGFyIH49IG5pbCB0aGVuDQogICAgICAgICBEcmF3Q2lyY2xlM0Qoc2VsZi5zZWxlY3RlZFRhci54LCBzZWxmLnNlbGVjdGVkVGFyLnksIHNlbGYuc2VsZWN0ZWRUYXIueiwgODAsNiwgQVJHQigyNTUsIDI1NSwwLDApKQ0KZW5kDQogIGlmIHNlbGYuQ29uZmlnLm90aGVyLnRhcmdldGNhbCBhbmQgbm90IG15SGVyby5kZWFkIHRoZW4NCiAgICAgIGlmIHRhcmdldCBhbmQgdGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGxvY2FsIGRyYXdwb3M9V29ybGRUb1NjcmVlbihEM0RYVkVDVE9SMyh0YXJnZXQueCwgdGFyZ2V0LnksIHRhcmdldC56KSkNCiAgICAgICAgbG9jYWwgY29tYm9UZXh0LGNvbG9yID0gc2VsZjpHZXREcmF3cyh0YXJnZXQpDQogICAgICAgIGlmIGNvbWJvVGV4dCB0aGVuDQogICAgICAgICAgRHJhd1RleHQoY29tYm9UZXh0LDE1LGRyYXdwb3MueC0yMCxkcmF3cG9zLnktMjAsY29sb3IpDQogICAgICAgIGVuZCANCiAgICAgIGVuZCANCiAgICAgIGVuZA0KICAgICAgZW5kDQogDQpmdW5jdGlvbiBBa2FsaTpidWZmKHVuaXQpDQogcmV0dXJuIFRhcmdldEhhdmVCdWZmKCdBa2FsaU1vdGEnLCB1bml0KQ0KZW5kDQoNCiAgZnVuY3Rpb24gQWthbGk6c2tpbmhhY2soKQ0KaWYgbm90IHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgdGhlbiBTZW5kU2tpblBhY2tldChteUhlcm8uY2hhck5hbWUsIHNraW5zUEJbMV0sIG15SGVyby5uZXR3b3JrSUQpOyBlbHNlDQppZiBzZWxmLkNvbmZpZy52aXAuc2tpbi5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgIHRoZW4NClNlbmRTa2luUGFja2V0KG15SGVyby5jaGFyTmFtZSwgc2tpbnNQQltzZWxmLkNvbmZpZy52aXAuc2tpblsnc2VsZWN0ZWQnIC4uIG15SGVyby5jaGFyTmFtZSAuLiAnU2tpbiddXSwgbXlIZXJvLm5ldHdvcmtJRCk7DQplbmQNCmVuZA0KZW5kDQoNCiBmdW5jdGlvbiBBa2FsaTphdXRvbGV2ZWwoKQ0KaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSAxIGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlMSA9ICAgeyAxLDIsMywxLDEsNCwxLDIsMSwyLDQsMiwyLDMsMyw0LDMsM30NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlMSkNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDIgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2UyID0gICB7IDEsMiwzLDEsMSw0LDEsMywxLDMsNCwzLDMsMiwyLDQsMiwyfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2UyKQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gMyBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTMgPSAgeyAyLDMsMSwyLDIsNCwyLDEsMiwxLDQsMSwxLDMsMyw0LDMsM30NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlMykNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDQgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2U0ID0gIHsgMiwzLDEsMiwyLDQsMiwzLDIsMyw0LDMsMywxLDEsNCwxLDF9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTQpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSA1IGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlNSA9ICB7IDMsMSwyLDMsMyw0LDMsMiwzLDIsNCwyLDIsMSwxLDQsMSwxfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2U1KQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gNiBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTYgPSAgeyAzLDEsMiwzLDMsNCwzLDEsMywxLDQsMSwxLDIsMiw0LDIsMn0NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlNikNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICAgIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gNyBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTYgPSAgeyAxLDMsMiwxLDEsNCwxLDMsMSwzLDQsMywzLDIsMiw0LDIsMn0NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlNikNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gQWthbGk6YXV0b3pob255YSgpDQogIGlmIHNlbGYuQ29uZmlnLml0ZW0uZW5hYmxlYXV0b3pob255YSB0aGVuDQogICBmb3IgXyA9IElURU1fMSwgSVRFTV83IGRvDQogICAgaWYgbXlIZXJvLmhlYWx0aCA8PSAobXlIZXJvLm1heEhlYWx0aCAqIHNlbGYuQ29uZmlnLml0ZW0uYXV0b3pob255YSAvIDEwMCkgYW5kICggbXlIZXJvOkNhblVzZVNwZWxsKF8pID09IDAgYW5kIG15SGVybzpHZXRTcGVsbERhdGEoXykubmFtZSA9PSAiWmhvbnlhc0hvdXJnbGFzcyIgKXRoZW4gQ2FzdFNwZWxsKF8pDQogIGVuZA0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBBa2FsaTpjaGVja3RzKCkNCiAgICAgICBzZWxmLnRzOnVwZGF0ZSgpDQogICAgICAgc2VsZi50c2U6dXBkYXRlKCkNCiAgICAgICBzZWxmLnRzcTp1cGRhdGUoKQ0KICAgICAgIHNlbGYudHNyOnVwZGF0ZSgpDQogICAgICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgICAgICBzZWxmLnRzZzp1cGRhdGUoKQ0KaWYgbm90IHNlbGYudHNnLnRhcmdldH49bmlsIG9yIG5vdCBzZWxmLkNvbmZpZy50YXJnZXRzZWwudHMgdGhlbg0KdGFyZ2V0ID0gc2VsZi50cy50YXJnZXQNCmVsc2VpZiBzZWxmLnRzZy50YXJnZXR+PW5pbCBvciBzZWxmLnNlbGVjdGVkVGFyIHRoZW4NCnRhcmdldCA9IHNlbGYuc2VsZWN0ZWRUYXINCmVuZA0KZW5kDQogIGZ1bmN0aW9uIEFrYWxpOmNvbWJvKCkNCiAgbG9jYWwgYWJ1ZmYgPSBzZWxmOmJ1ZmYodGFyZ2V0KQ0KICBpZihzZWxmLnRzcS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgIGFuZCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICBzZWxmOkNhc3RRKHRhcmdldCkNCiAgIGVuZA0KICAgIGlmKHNlbGYudHNyLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VSIGFuZCBhYnVmZiBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgIGFuZCBub3Qgc2VsZi5RU3BlbGw6SXNSZWFkeSgpIGFuZCBzZWxmLlJTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICBzZWxmOkNhc3RSKHRhcmdldCkNCiAgIGVuZA0KICAgIGlmKHNlbGYudHNlLnRhcmdldH49bmlsICBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlRSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgIGFuZCBzZWxmLkVTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICBzZWxmOkNhc3RFKHRhcmdldCkNCiAgIGVuZA0KICAgICAgIGlmKHNlbGYuQ29uZmlnLmNvbWJvLnVzZUkgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLmNvbWJva2V5ICl0aGVuDQogICAgZm9yIF8sIHVuaXQgaW4gcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8NCiAgICAgIGxvY2FsIGRtZ0kgPSg1MCsgKChteUhlcm8ubGV2ZWwpKjIwKSkNCiAgICAgIGxvY2FsIGhlYWx0aD11bml0LmhlYWx0aA0KICAgICAgaWYoaGVhbHRoPGRtZ0kgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZUkgYW5kIEdldERpc3RhbmNlKHVuaXQpPDYwMCl0aGVuDQogICAgICAgIHNlbGY6Q2FzdEkodW5pdCkNCiAgICBlbmQNCiAgICBlbmQNCiAgZW5kDQogIGVuZA0KICAgIGZ1bmN0aW9uIEFrYWxpOmNvbWJvMigpDQogIGlmKHNlbGYudHNxLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VRIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgYW5kIHNlbGYuUVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgIHNlbGY6Q2FzdFEodGFyZ2V0KQ0KICAgZW5kDQogICAgaWYoc2VsZi50c3IudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVIgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICBhbmQgbm90IHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5SU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0Uih0YXJnZXQpDQogICBlbmQNCiAgICBpZihzZWxmLnRzZS50YXJnZXR+PW5pbCAgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZUUgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICBhbmQgc2VsZi5FU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0RSh0YXJnZXQpDQogICBlbmQNCiAgICAgICBpZihzZWxmLkNvbmZpZy5jb21iby51c2VJIGFuZCBzZWxmLkNvbmZpZy5jb21iby5jb21ib2tleSApdGhlbg0KICAgIGZvciBfLCB1bml0IGluIHBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvDQogICAgICBsb2NhbCBkbWdJID0oNTArICgobXlIZXJvLmxldmVsKSoyMCkpDQogICAgICBsb2NhbCBoZWFsdGg9dW5pdC5oZWFsdGgNCiAgICAgIGlmKGhlYWx0aDxkbWdJIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VJIGFuZCBHZXREaXN0YW5jZSh1bml0KTw2MDApdGhlbg0KICAgICAgICBzZWxmOkNhc3RJKHVuaXQpDQogICAgZW5kDQogICAgZW5kDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gQWthbGk6aGFyYXNzKCkNCiAgaWYoc2VsZi50c3EudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmhhcmFzcy51c2VRIGFuZCAgc2VsZi5Db25maWcuS2V5cy5oYXJhc3NrZXkgIGFuZCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICBzZWxmOkNhc3RRKHRhcmdldCkNCiAgIGVuZA0KICAgIGlmKHNlbGYudHNlLnRhcmdldH49bmlsICBhbmQgc2VsZi5Db25maWcuaGFyYXNzLnVzZUUgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmhhcmFzc2tleSAgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgIHNlbGY6Q2FzdEUodGFyZ2V0KQ0KICAgZW5kDQogIGVuZA0KICAgIGZ1bmN0aW9uIEFrYWxpOkp1bmdsZUNsZWFyKCkNCiAgIGxvY2FsIGNsZWFydGFyZ2V0ID0gbmlsDQogICAgICBzZWxmLmVuZW15TWluaW9uczp1cGRhdGUoKQ0KICAgICAgc2VsZi5vdGhlck1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIHNlbGYuanVuZ2xlTWluaW9uczp1cGRhdGUoKQ0KICAgICAgZm9yIGksIG1pbmlvbiBpbiBpcGFpcnMoc2VsZi5lbmVteU1pbmlvbnMub2JqZWN0cykgZG8NCiAgICAgICAgaWYgVmFsaWRUYXJnZXQobWluaW9uLCA2MDApIGFuZCAoY2xlYXJ0YXJnZXQgPT0gbmlsIG9yIG5vdCBWYWxpZFRhcmdldChjbGVhcnRhcmdldCkpIHRoZW4NCiAgICAgICAgICBjbGVhcnRhcmdldCA9IG1pbmlvbg0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgZm9yIGksIGp1bmdsZW1pbmlvbiBpbiBpcGFpcnMoc2VsZi5qdW5nbGVNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICAgIGlmIFZhbGlkVGFyZ2V0KGp1bmdsZW1pbmlvbiwgNjAwKSBhbmQgKGNsZWFydGFyZ2V0ID09IG5pbCBvciBub3QgVmFsaWRUYXJnZXQoY2xlYXJ0YXJnZXQpKSB0aGVuDQogICAgICAgICAgY2xlYXJ0YXJnZXQgPSBqdW5nbGVtaW5pb24NCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGZvciBpLCBvdGhlcm1pbmlvbiBpbiBpcGFpcnMoc2VsZi5vdGhlck1pbmlvbnMub2JqZWN0cykgZG8NCiAgICAgICAgaWYgVmFsaWRUYXJnZXQob3RoZXJtaW5pb24sIDYwMCkgYW5kIChjbGVhcnRhcmdldCA9PSBuaWwgb3Igbm90IFZhbGlkVGFyZ2V0KGNsZWFydGFyZ2V0KSkgdGhlbg0KICAgICAgICAgIGNsZWFydGFyZ2V0ID0gb3RoZXJtaW5pb24NCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGlmIGNsZWFydGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGlmKHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci51c2VRIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmp1bmdsZWNsZWFya2V5ICkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0UShjbGVhcnRhcmdldCkNCiAgICAgICAgZW5kDQogICAgICAgIGlmIGNsZWFydGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGlmKHNlbGYuUlNwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci51c2VSIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmp1bmdsZWNsZWFya2V5ICkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0UihjbGVhcnRhcmdldCkNCiAgICAgICAgZW5kDQogICAgICAgIGlmIGNsZWFydGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGlmKHNlbGYuRVNwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci51c2VFIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmp1bmdsZWNsZWFya2V5ICkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0RShjbGVhcnRhcmdldCkNCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICBlbmQNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBBa2FsaTpMYW5lQ2xlYXIoKQ0KICAgbG9jYWwgY2xlYXJ0YXJnZXQgPSBuaWwNCiAgICAgIHNlbGYuZW5lbXlNaW5pb25zOnVwZGF0ZSgpDQogICAgICBzZWxmLm90aGVyTWluaW9uczp1cGRhdGUoKQ0KICAgICAgc2VsZi5qdW5nbGVNaW5pb25zOnVwZGF0ZSgpDQogICAgICBmb3IgaSwgbWluaW9uIGluIGlwYWlycyhzZWxmLmVuZW15TWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgICBpZiBWYWxpZFRhcmdldChtaW5pb24sIDYwMCkgYW5kIChjbGVhcnRhcmdldCA9PSBuaWwgb3Igbm90IFZhbGlkVGFyZ2V0KGNsZWFydGFyZ2V0KSkgdGhlbg0KICAgICAgICAgIGNsZWFydGFyZ2V0ID0gbWluaW9uDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBmb3IgaSwganVuZ2xlbWluaW9uIGluIGlwYWlycyhzZWxmLmp1bmdsZU1pbmlvbnMub2JqZWN0cykgZG8NCiAgICAgICAgaWYgVmFsaWRUYXJnZXQoanVuZ2xlbWluaW9uLCA2MDApIGFuZCAoY2xlYXJ0YXJnZXQgPT0gbmlsIG9yIG5vdCBWYWxpZFRhcmdldChjbGVhcnRhcmdldCkpIHRoZW4NCiAgICAgICAgICBjbGVhcnRhcmdldCA9IGp1bmdsZW1pbmlvbg0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgZm9yIGksIG90aGVybWluaW9uIGluIGlwYWlycyhzZWxmLm90aGVyTWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgICBpZiBWYWxpZFRhcmdldChvdGhlcm1pbmlvbiwgNjAwKSBhbmQgKGNsZWFydGFyZ2V0ID09IG5pbCBvciBub3QgVmFsaWRUYXJnZXQoY2xlYXJ0YXJnZXQpKSB0aGVuDQogICAgICAgICAgY2xlYXJ0YXJnZXQgPSBvdGhlcm1pbmlvbg0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgaWYgY2xlYXJ0YXJnZXQgfj0gbmlsIHRoZW4NCiAgICAgICAgaWYoc2VsZi5RU3BlbGw6SXNSZWFkeSgpIGFuZCBzZWxmLkNvbmZpZy5mYXJtLmxhbmVjbGVhci51c2VRIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmp1bmdsZWNsZWFya2V5ICkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0UShjbGVhcnRhcmdldCkNCiAgICAgICAgZW5kDQogICAgICAgIGlmIGNsZWFydGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGlmKHNlbGYuUlNwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcuZmFybS5sYW5lY2xlYXIudXNlUiBhbmQgc2VsZi5Db25maWcuS2V5cy5qdW5nbGVjbGVhcmtleSApIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXIuTWFuYSAvMTAwICkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFIoY2xlYXJ0YXJnZXQpDQogICAgICAgIGVuZA0KICAgICAgICBpZiBjbGVhcnRhcmdldCB+PSBuaWwgdGhlbg0KICAgICAgICBpZihzZWxmLkVTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYuQ29uZmlnLmZhcm0ubGFuZWNsZWFyLnVzZUUgYW5kIHNlbGYuQ29uZmlnLktleXMuanVuZ2xlY2xlYXJrZXkgKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyLk1hbmEgLzEwMCApIHRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RFKGNsZWFydGFyZ2V0KQ0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgIGVuZA0KICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIEFrYWxpOkNhc3RRKHVuaXQpDQogIHNlbGYuUVNwZWxsOkNhc3QodW5pdCkNCmVuZA0KDQpmdW5jdGlvbiBBa2FsaTpDYXN0Vyh1bml0KQ0KICBzZWxmLldTcGVsbDpDYXN0KHVuaXQpDQplbmQNCg0KZnVuY3Rpb24gQWthbGk6Q2FzdEUodW5pdCkNCiAgc2VsZi5FU3BlbGw6Q2FzdCh1bml0KQ0KZW5kDQoNCmZ1bmN0aW9uIEFrYWxpOkNhc3RSKHVuaXQpDQogIHNlbGYuUlNwZWxsOkNhc3QodW5pdCkNCmVuZA0KZnVuY3Rpb24gQWthbGk6Q2FzdEkodW5pdCkNCiAgc2VsZi5JZ25pdGU6Q2FzdCh1bml0KQ0KZW5kDQogIGZ1bmN0aW9uIEFrYWxpOmF1dG9xKCkNCiAgICAgICAgIGlmKHNlbGYudHNxLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmF1dG9xIGFuZCAgc2VsZi5RU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0USh0YXJnZXQpDQogICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIEFrYWxpOkdldERyYXdzKHRhcmdldCkNCmxvY2FsIFFkbWc9Z2V0RG1nKCJRIix0YXJnZXQsbXlIZXJvKQ0KbG9jYWwgUWRtZzI9KG15SGVyby5hcCowLjUpDQpsb2NhbCBFZG1nPWdldERtZygiRSIsdGFyZ2V0LG15SGVybykNCmxvY2FsIFJkbWc9Z2V0RG1nKCJSIix0YXJnZXQsbXlIZXJvKQ0KbG9jYWwgSWRtZz0oNTArICgobXlIZXJvLmxldmVsKSoyMCkpDQogIA0KICBpZiBRZG1nID4gdGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRJywgUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIFFkbWcrSWRtZz50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBJZ25pdGUnLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgRWRtZz50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ0UnLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgRWRtZytJZG1nPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnRSArIElnbml0ZScsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogICAgICBlbHNlaWYgUmRtZz50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1InLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgUmRtZytJZG1nPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUiArIElnbml0ZScsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBRZG1nK0VkbWc+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgRScsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgICAgIGVsc2VpZiBRZG1nK1JkbWc+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgUicsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIFFkbWcrRWRtZytJZG1nPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIEUgKyBJZ25pdGUnLFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogICAgICBlbHNlaWYgUWRtZytSZG1nK0lkbWc+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgUiArIElnbml0ZScsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIFFkbWcrRWRtZytSZG1nK0lkbWc+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgUiArIEUgKyBJZ25pdGUnLFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBRZG1nK1JkbWcrRWRtZyA+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgUiArIEUnLFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBRZG1nK1FkbWcyID4gdGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgUTInLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgUWRtZytJZG1nK1FkbWcyPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIFEyICsgSWduaXRlJywgUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIEVkbWc+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdFJywgUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIEVkbWcrSWRtZz50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ0UgKyBJZ25pdGUnLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICAgICAgZWxzZWlmIFJkbWc+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdSJywgUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIFJkbWcrSWRtZz50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1IgKyBJZ25pdGUnLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgUWRtZytFZG1nK1FkbWcyPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIFEyICsgRScsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgICAgIGVsc2VpZiBRZG1nK1JkbWcrUWRtZzI+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgUTIgKyBSJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgUWRtZytFZG1nK0lkbWcrUWRtZzI+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgUTIgKyBFICsgSWduaXRlJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICAgICAgZWxzZWlmIFFkbWcrUmRtZytJZG1nK1FkbWcyPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIFEyICsgUiArIElnbml0ZScsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIFFkbWcrRWRtZytSZG1nK0lkbWcrUWRtZzI+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgUTIgKyBSICsgRSArIElnbml0ZScsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIFFkbWcrUmRtZytFZG1nK1FkbWcyID50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBRMiArIFIgKyBFJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICAgICAgZWxzZWlmIChRZG1nK0VkbWcrUmRtZytJZG1nK1FkbWcyKSsoUWRtZytFZG1nK1JkbWcrSWRtZytRZG1nMikgPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnS2lsbCBXaXRoIDIgQ29tYm8nLFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2UgDQogICAgcmV0dXJuICJDYW50IEtpbGwgeWV0IiwgUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZW5kIA0KZW5kDQogIGZ1bmN0aW9uIEFrYWxpOmtpbGxzdGVhbCgpDQpmb3IgXywgdW5pdCBpbiBwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbw0KICAgIGxvY2FsIGhlYWx0aCA9IHVuaXQuaGVhbHRoDQogICAgbG9jYWwgZG1nRSA9IGdldERtZygiRSIsIHVuaXQsIG15SGVybykNCiAgICAgIGlmKHNlbGYudHNlLnRhcmdldCB+PSBuaWwgYW5kICBzZWxmLkVTcGVsbDpJc1JlYWR5KCkgYW5kIGhlYWx0aDxkbWdFIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlRSAgIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MpdGhlbg0KICAgICAgICBzZWxmOkNhc3RFKHVuaXQpICANCiAgICAgIGVuZA0KICAgICAgbG9jYWwgZG1nUSA9IGdldERtZygiUSIsIHVuaXQsIG15SGVybykgDQogICAgICBpZihzZWxmLnRzcS50YXJnZXQgfj0gbmlsIGFuZCAgc2VsZi5RU3BlbGw6SXNSZWFkeSgpIGFuZCBoZWFsdGg8ZG1nUSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZVEgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyApdGhlbg0KICAgICAgICBzZWxmOkNhc3RRKHVuaXQpICANCiAgICAgIGVuZA0KICAgICAgIGxvY2FsIGRtZ0kgPSg1MCsgKChteUhlcm8ubGV2ZWwpKjIwKSkNCiAgICAgIGlmKGhlYWx0aDxkbWdJIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlSSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzIGFuZCBHZXREaXN0YW5jZSh1bml0KTw2MDApdGhlbg0KICAgICAgICBzZWxmOkNhc3RJKHVuaXQpDQogICAgICBlbmQNCiAgICAgIGxvY2FsIGRtZ1IgPWdldERtZygiUiIsdW5pdCxteUhlcm8pDQogICAgICBpZihzZWxmLnRzci50YXJnZXQgfj0gbmlsIGFuZCAgc2VsZi5SU3BlbGw6SXNSZWFkeSgpIGFuZCBoZWFsdGg8ZG1nUiBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZVIgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyBhbmQgR2V0RGlzdGFuY2UodW5pdCk8NTUwKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0Uih1bml0KQ0KICAgICAgZW5kDQogICBlbmQNCmVuZA0KZnVuY3Rpb24gQWthbGk6aXRlbXMoKQ0KICBpZiBzZWxmLkNvbmZpZy5pdGVtLnVzZWJnIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5IHRoZW4NCiAgIGZvciBfID0gSVRFTV8xLCBJVEVNXzcgZG8NCiAgICBpZiAoIG15SGVybzpDYW5Vc2VTcGVsbChfKSA9PSAwIGFuZCBteUhlcm86R2V0U3BlbGxEYXRhKF8pLm5hbWUgPT0gIkJpbGdld2F0ZXJDdXRsYXNzIiApdGhlbiBDYXN0U3BlbGwoXykNCiAgZW5kDQogIGVuZA0KICBlbmQNCiAgaWYgc2VsZi5Db25maWcuaXRlbS51c2VoZyBhbmQgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSB0aGVuDQogICBmb3IgXyA9IElURU1fMSwgSVRFTV83IGRvDQogICAgaWYgKCBteUhlcm86Q2FuVXNlU3BlbGwoXykgPT0gMCBhbmQgbXlIZXJvOkdldFNwZWxsRGF0YShfKS5uYW1lID09ICJIZXh0ZWNoR3VuYmxhZGUiICl0aGVuIENhc3RTcGVsbChfKQ0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBlbmQNCiBmdW5jdGlvbiBBa2FsaTpBdXRvc3RlYWx0aCgpDQogICAgaWYgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5XbG9naWMudXNlVyBhbmQgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5XbG9naWMudXNlV2VuIHRoZW4NCiAgICAgICAgaWYgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5XbG9naWMudXNlV2UgPT0gMSB0aGVuDQogICAgICAgICAgICBpZiBDb3VudEVuZW15SGVyb0luUmFuZ2UoOTAwKSA+PSAyIHRoZW4NCiAgICAgICAgICAgICAgICBDYXN0U3BlbGwoX1csIG15SGVyby54LCBteUhlcm8ueikNCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbHNlaWYgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5XbG9naWMudXNlV2UgPT0gMiB0aGVuDQogICAgICAgICAgICBpZiBDb3VudEVuZW15SGVyb0luUmFuZ2UoOTAwKSA+PSAzIHRoZW4NCiAgICAgICAgICAgICAgICBDYXN0U3BlbGwoX1csIG15SGVyby54LCBteUhlcm8ueikNCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbHNlaWYgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5XbG9naWMudXNlV2UgPT0gMyB0aGVuDQogICAgICAgICAgICBpZiBDb3VudEVuZW15SGVyb0luUmFuZ2UoOTAwKSA+PSA0IHRoZW4NCiAgICAgICAgICAgICAgICBDYXN0U3BlbGwoX1csIG15SGVyby54LCBteUhlcm8ueikNCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbHNlaWYgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5XbG9naWMudXNlV2UgPT0gNCB0aGVuDQogICAgICAgICAgICBpZiBDb3VudEVuZW15SGVyb0luUmFuZ2UoOTAwKSA+PSA1IHRoZW4NCiAgICAgICAgICAgICAgICBDYXN0U3BlbGwoX1csIG15SGVyby54LCBteUhlcm8ueikNCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgICBlbmQNCiAgICBpZiBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLldsb2dpYy51c2VXaHAgYW5kIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuV2xvZ2ljLnVzZVcgdGhlbg0KICAgICAgICBpZiBteUhlcm8uaGVhbHRoIDw9IChteUhlcm8ubWF4SGVhbHRoICogc2VsZi5Db25maWcuc2tpbGxsb2dpYy5XbG9naWMuaHAgLyAxMDApIHRoZW4gDQogICAgICAgICAgICBDYXN0U3BlbGwoX1csIG15SGVyby54LCBteUhlcm8ueikNCiAgICAgICAgZW5kDQogICAgZW5kDQplbmQNCg0KICBmdW5jdGlvbiBBa2FsaTpMb2FkTWVudSgpDQogICAgICBzZWxmLkNvbmZpZz1zY3JpcHRDb25maWcoIiIuLlNjcmlwdG5hbWUuLiIiLCJtZW51IikNCg0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiQ29tYm8gU2V0dGluZ3MiLCAiY29tYm8iKQ0KICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZVEiLCAiVXNlIFEgaW4gQ29tYm8iLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlRSIsICJVc2UgRSBpbiBjb21ibyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VSIiwgIlVzZSBSIGluIGNvbWJvIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZUkiLCAiVXNlIElnbml0ZSBpZiB0YXJnZXQga2lsbGFibGUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDEwLCAxMCwgMTAwLCAwKQ0KICAgICANCiAgICAgIA0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiSGFyYXNzIFNldHRpbmdzIiwgImhhcmFzcyIpDQogICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6YWRkUGFyYW0oInVzZVEiLCAiSGFyYXNzIFdpdGggUSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczphZGRQYXJhbSgidXNlRSIsICJIYXJhc3MgV2l0aCBFIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgc2VsZi5Db25maWcuaGFyYXNzOmFkZFBhcmFtKCJNYW5hIiwiTWFuYSBNYW5hZ2VyICUiLFNDUklQVF9QQVJBTV9TTElDRSwgMTAsIDEwLCAxMDAsIDApDQogICAgICANCiAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIlNraWxsIExvZ2ljcyIsICJza2lsbGxvZ2ljIikNCiAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWM6YWRkU3ViTWVudSgiVyBTa2lsbCBMb2dpYyIsICJXbG9naWMiKSANCiAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuV2xvZ2ljOmFkZFBhcmFtKCJ1c2VXIiwgIlVzZSBTdGVhbHRoIChXKSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuV2xvZ2ljOmFkZFBhcmFtKCJ1c2VXaHAiLCAiVXNlIFN0ZWFsdGggaWYgaGVhbHQgJSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgZmFsc2UpDQogICAgICBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLldsb2dpYzphZGRQYXJhbSgiaHAiLCJIZWFsdGggTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDMwLCAxMCwgMTAwLCAwKQ0KICAgICAgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5XbG9naWM6YWRkUGFyYW0oInVzZVdlbiIsICJVc2UgU3RlYWx0aCBpZiBlbmVteSA+IiwgU0NSSVBUX1BBUkFNX09OT0ZGLCBmYWxzZSkNCiAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuV2xvZ2ljOmFkZFBhcmFtKCJ1c2VXZSIsICJVc2UgU3RlYWx0aCBpZiBlbmVteSA+IiwgU0NSSVBUX1BBUkFNX0xJU1QsIDEsIHsiMiBlbmVteSIsICIzIGVuZW15IiAsICI0IGVuZW15IiwiNSBlbmVteSIgfSkNCiAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWM6YWRkU3ViTWVudSgiUiBTa2lsbCBMb2dpYyIsICJSbG9naWMiKSANCiAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljOmFkZFBhcmFtKCJsb2dpYyIsICJSIFNraWxsIExvZ2ljIiwgU0NSSVBUX1BBUkFNX0xJU1QsIDEsIHsiVXNlIFIgaWYgUSBpcyBvbiB0YXJnZXQiLCAiUnVzaCBTa2lsbHMiIH0pDQogICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiRmFybSBTZXR0aW5ncyIsICJmYXJtIikNCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnLmZhcm06YWRkU3ViTWVudSgiTGFuZUNsZWFyIFNldHRpbmdzIiwibGFuZWNsZWFyIikNCiAgICAgICAgc2VsZi5Db25maWcuZmFybS5sYW5lY2xlYXI6YWRkUGFyYW0oInVzZVEiLCJVc2UgUSBvbiBMYW5lY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5mYXJtLmxhbmVjbGVhcjphZGRQYXJhbSgidXNlRSIsIlVzZSBFIG9uIExhbmVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmZhcm0ubGFuZWNsZWFyOmFkZFBhcmFtKCJ1c2VSIiwiVXNlIFIgb24gTGFuZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLmZhcm0ubGFuZWNsZWFyOmFkZFBhcmFtKCJNYW5hIiwiTWFuYSBNYW5hZ2VyICUiLFNDUklQVF9QQVJBTV9TTElDRSwgMzAsIDEwLCAxMDAsIDApDQogICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZy5mYXJtOmFkZFN1Yk1lbnUoIkp1bmdsZUNsZWFyIFNldHRpbmdzIiwianVuZ2xlY2xlYXIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyOmFkZFBhcmFtKCJ1c2VRIiwiVXNlIFEgb24gSnVuZ2xlY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyOmFkZFBhcmFtKCJ1c2VFIiwiVXNlIEUgb24gSnVuZ2xlY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyOmFkZFBhcmFtKCJ1c2VSIiwiVXNlIFIgb24gSnVuZ2xlY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhcjphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDMwLCAxMCwgMTAwLCAwKQ0KICAgICAgDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJLaWxsU3RlYWwgU2V0dGluZ3MiLCAia2lsbHN0ZWFsIikNCiAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgia3MiLCJLaWxsc3RlYWwgT24vT2ZmIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgidXNlUSIsICJTdGVhbCBXaXRoIFEiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZUUiLCAiU3RlYWwgV2l0aCBFIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJ1c2VSIiwgIlN0ZWFsIFdpdGggUiIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgidXNlSSIsICJTdGVhbCBXaXRoIElnbml0ZSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIA0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiRXNjYXBlIFNldHRpbmdzIiwiZXNjYXBlIikNCiAgICAgIHNlbGYuQ29uZmlnLmVzY2FwZTphZGRQYXJhbSgidXNlVyIsIlVzZSBXIFdoaWxlIEVzY2FwZSIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIA0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiSXRlbSBTZXR0aW5ncyIsICJpdGVtIikNCiAgICAgIHNlbGYuQ29uZmlnLml0ZW06YWRkUGFyYW0oImVuYWJsZWF1dG96aG9ueWEiLCAiQXV0byBaaG9ueWEiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIGZhbHNlKQ0KICAgICAgc2VsZi5Db25maWcuaXRlbTphZGRQYXJhbSgiYXV0b3pob255YSIsICJaaG9ueWEgaWYgSGVhbHRoIHVuZGVyIC0+ICUiLCBTQ1JJUFRfUEFSQU1fU0xJQ0UsIDEwLCAwLCAxMDAsIDApDQogICAgICBzZWxmLkNvbmZpZy5pdGVtOmFkZFBhcmFtKCJ1c2VoZyIsICJVc2UgSGV4dGVjaCBHdW5ibGFkZSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLml0ZW06YWRkUGFyYW0oInVzZWJnIiwgIlVzZSBCaWxnZXdhdGVyIEN1dGxhc3MiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICANCiAgICAgIGlmIFZJUF9VU0VSIHRoZW4NCiAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIlZJUCBTZXR0aW5ncyIsICJ2aXAiKQ0KICAgICAgc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJwYWNrZXQiLCJVc2UgUGFja2V0IENhc3RpbmciLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzEiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm8yIiwgIlRvIHVzZSB2aXAgc2V0dGluZ3MsIFBhY2tldCBDYXN0aW5nIHNob3VsZCBiZSBvcGVuLiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcudmlwOmFkZFN1Yk1lbnUoIkF1dG8gTGV2ZWwgU2V0dGluZ3MiLCAibGV2ZWwiKQ0KICAgICAgc2VsZi5Db25maWcudmlwLmxldmVsOmFkZFBhcmFtKCJrZXkiLCJVc2UgQXV0byBMZXZlbCIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgc2VsZi5Db25maWcudmlwLmxldmVsOmFkZFBhcmFtKCJsb2dpYyIsICJTZWxlY3QgU2tpbGwgT3JkZXIiLCBTQ1JJUFRfUEFSQU1fTElTVCwgMiwgeyJGb2N1cyBRPlc+RSIsICJGb2N1cyBRPkU+VyIsIkZvY3VzIFc+UT5FIiwiRm9jdXMgVz5FPlEiLCJGb2N1cyBFPlc+USIsICJGb2N1cyBFPlE+VyIsIlNtYXJ0IiAgfSkNCiAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRTdWJNZW51KCJTa2luIEhhY2sgU2V0dGluZ3MiLCAic2tpbiIpDQogICAgICBzZWxmLkNvbmZpZy52aXAuc2tpbjphZGRQYXJhbSgia2V5IiwiVXNlIFNraW4gSGFjayIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgc2VsZi5Db25maWcudmlwLnNraW46YWRkUGFyYW0oJ3NlbGVjdGVkJyAuLiBteUhlcm8uY2hhck5hbWUgLi4gJ1NraW4nLCAiU2VsZWN0IFNraW4iLCBTQ1JJUFRfUEFSQU1fTElTVCwgMSwgeyJPcmlnaW5hbCIsICIgTnVyc2UgQWthbGkgIiwiQWxsLXN0YXIgQWthbGkiLCIgQmxvb2QgTW9vbiBBa2FsaSIsIkhlYWRodW50ZXIgQWthbGkiLCJTdGluZ2VyIEFrYWxpIiB9KQ0KICAgICAgc2VsZi5Db25maWcudmlwLnNraW46YWRkUGFyYW0oImluZm80IiwgIlRvIHVzZSBza2luIGhhY2ssIFlvdSBuZWVkIHRvIDJ4IEY5IGFmdGVyIHlvdSBzZWxlY3QgdGhlIHNraW4geW91IGRlc2lyZS4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLnZpcC5za2luOmFkZFBhcmFtKCJpbmZvNSIsICJNYWtlIHN1cmUgdGhhdCB1c2luZyBwYWNrZXQgY2FzdGluZyBpcyBPTi4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIC0tc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvNSIsICJTa2luIEhhY2sgdGVtcG9yYXJ5IGRpc2FibGVkIHVudGlsIG5leHQgdXBkYXRlLiAuIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAtLVtbc2VsZi5Db25maWcudmlwOmFkZFN1Yk1lbnUoIkFudGktQUZLIFNldHRpbmdzIiwgImFudGlhZmsiKQ0KICAgICAgc2VsZi5Db25maWcudmlwLmFudGlhZms6YWRkUGFyYW0oImFudGlhZmsiLCJVc2UgQW50aSBBZmsiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkgXV0NCiAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzMiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm80IiwgIlRvIHVzZSB2aXAgc2V0dGluZ3MsIFlvdSBuZWVkIHRvIGJlIGEgVklQIHVzZXIgb24gQk9MIGNvbW11bml0eS4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgZW5kDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJEcmF3IFNldHRpbmdzIiwib3RoZXIiKQ0KICAgICAgLS1zZWxmLkNvbmZpZy5vdGhlcjphZGRTdWJNZW51KCJTaG93IERhbWFnZSBPbiBIcCBCYXIiLCAiSFBCQVIiKQ0KICAgICAgLS1zZWxmLkNvbmZpZy5vdGhlci5IUEJBUjphZGRQYXJhbSgia2V5IiwiT04vT0ZGIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLm90aGVyOmFkZFN1Yk1lbnUoIlNraWxsIERyYXdpbmcgU2V0dGluZ3MiLCAiZHJhdyIpDQogICAgICBzZWxmLkNvbmZpZy5vdGhlci5kcmF3OmFkZFBhcmFtKCJxZHJhdyIsIlEgU2tpbGwgRHJhd2luZ3MiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgid2RyYXciLCJXIFNraWxsIERyYXdpbmdzIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oImVkcmF3IiwiRSBTa2lsbCBEcmF3aW5ncyIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5vdGhlci5kcmF3OmFkZFBhcmFtKCJyZHJhdyIsIlIgU2tpbGwgRHJhd2luZ3MiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgiYWFkcmF3IiwiQXV0byBBdHRhY2sgUmFuZ2UiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgIHNlbGYuQ29uZmlnLm90aGVyOmFkZFN1Yk1lbnUoIkRyYXcgUGVybWFib3giLCAicGVybWEiKQ0KICAgICAgc2VsZi5Db25maWcub3RoZXIucGVybWE6YWRkUGFyYW0oInBlcm1hIiwiRHJhdyBQZXJtYWJveCAoIE5lZWRzIDJ4IEY5ICkiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgc2VsZi5Db25maWcub3RoZXI6YWRkUGFyYW0oInRhcmdldCIsIkRyYXcgY2lyY2xlIGZvciB0YXJnZXQgc2VsZWN0ZWQiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgc2VsZi5Db25maWcub3RoZXI6YWRkUGFyYW0oInRhcmdldGNhbCIsIlRhcmdldCBjYWxjdWxhdGlvbiIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICANCiAgICAgIA0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiVGFyZ2V0c2VsZWN0b3JzIiwidGFyZ2V0c2VsIikNCiAgICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRQYXJhbSgiaW5mb0syIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFBhcmFtKCJpbmZvSyIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRQYXJhbSgidHMiLCJMZWZ0IENsaWNrIEZvciBUYXJnZXQgU2VsZWN0aW9uIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICBzZWxmLnRzLm5hbWUgID0gIkFrYWxpIg0KICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRUUyhzZWxmLnRzKQ0KICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJLZXlzIFNldHRpbmdzIiwgIktleXMiKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LMyIsICI8LS0tLS0tLS0tLS0tLS0tLS0tQ29tYm8gS2V5IFNldHRpbmdzLS0tLS0tLS0tLS0tLS0tLS0tPiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImNvbWJva2V5IiwgIkNvbWJvIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCAzMikNCiAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJpbmZvSzQiLCAiPC0tLS0tLS0tLS0tLS0tLS0tLUhhcmFzcyBLZXkgU2V0dGluZ3MtLS0tLS0tLS0tLS0tLS0tLS0+IiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaGFyYXNza2V5IiwgIlNtYXJ0IEhhcmFzcyBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIkMiKSkNCiAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJhdXRvcSIsICJBdXRvIEhhcmFzcyBRIiwgU0NSSVBUX1BBUkFNX09OS0VZVE9HR0xFLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIlQiKSkNCiAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJpbmZvSzUiLCAiPC0tLS0tLS0tLS0tLS0tLS0tLUNsZWFyIEtleSBTZXR0aW5ncy0tLS0tLS0tLS0tLS0tLS0tLS0tPiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImxhbmVjbGVhcmtleSIsICJMYW5lQ2xlYXIgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJWIikpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgianVuZ2xlY2xlYXJrZXkiLCAiSnVuZ2xlQ2xlYXIgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJWIikpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0s2IiwgIjwtLS0tLS0tLS0tLS0tLS0tLS1PdGhlciBLZXkgU2V0dGluZ3MtLS0tLS0tLS0tLS0tLS0tLS0tLT4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJlc2NhcGVrZXkiLCAiRXNjYXBlIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiWSIpKQ0KICAgIC0tc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgibGFzdGhpdGtleSIsICJMYXN0aGl0IEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiWCIpKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LMiIsICJNYWtlIFN1cmUgVGhhdCBZb3VyIE9yYndhbGtlciBLZXlzIGFyZSBTYW1lIEFzIEhlcmUiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJPcndXYWxrZXJLZXkgU2V0dGluZ3MiLCAiS2V5czIiKQ0KICAgIA0KICAgIE9yYndhbGtNYW5hZ2VyOkxvYWRDb21tb25LZXlzKHNlbGYuQ29uZmlnLktleXMyKQ0KICAgIA0KICAgICANCiAgICAgaWYgc2VsZi5Db25maWcub3RoZXIucGVybWEucGVybWEgdGhlbg0KICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBzZWxmLkNvbmZpZzpwZXJtYVNob3coImluZm9ib3giKSBlbmQsIDEpDQogICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHNlbGYuQ29uZmlnLktleXM6cGVybWFTaG93KCJjb21ib2tleSIpIGVuZCwgMS4yKQ0KICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgc2VsZi5Db25maWcuS2V5czpwZXJtYVNob3coImhhcmFzc2tleSIpIGVuZCwgMS4yKQ0KICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgc2VsZi5Db25maWcuS2V5czpwZXJtYVNob3coImF1dG9xIikgZW5kLCAxLjIpDQplbmQNCiAgZW5kDQpmdW5jdGlvbiBBa2FsaTpXbmRNc2coTXNnLCBLZXkpDQppZiBzZWxmLkNvbmZpZy50YXJnZXRzZWwudHMgdGhlbiAgICAgIA0KICAgICAgICBpZiBNc2cgPT0gV01fTEJVVFRPTkRPV04gdGhlbg0KICAgICAgICAgICAgbG9jYWwgbWluRCA9IDEwDQogICAgICAgICAgICBsb2NhbCBzdGFyZ2V0ID0gbmlsDQogICAgICAgICAgICBmb3IgaSwgZW5lbXkgaW4gaXBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvDQogICAgICAgICAgICAgICAgaWYgVmFsaWRUYXJnZXQoZW5lbXkpIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgaWYgR2V0RGlzdGFuY2UoZW5lbXksIG1vdXNlUG9zKSA8PSBtaW5EIG9yIHN0YXJnZXQgPT0gbmlsIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICAgIG1pbkQgPSBHZXREaXN0YW5jZShlbmVteSwgbW91c2VQb3MpDQogICAgICAgICAgICAgICAgICAgICAgICBzdGFyZ2V0ID0gZW5lbXkNCiAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICBlbmQgICAgIA0KICAgICAgICAgICAgaWYgc3RhcmdldCBhbmQgbWluRCA8IDUwMCB0aGVuDQogICAgICAgICAgICAgICAgaWYgc2VsZi5zZWxlY3RlZFRhciBhbmQgc3RhcmdldC5jaGFyTmFtZSA9PSBzZWxmLnNlbGVjdGVkVGFyLmNoYXJOYW1lIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgc2VsZi5zZWxlY3RlZFRhciA9IG5pbA0KICAgICAgICAgICAgICAgICAgICBwcmludCgiPGZvbnQgY29sb3I9XCIjQ0JGNkZGXCI+VGFyZ2V0IDxiPmlzIG5vIGxvZ2VyIHNlbGVjdGVkLjwvYj46ICIuLnN0YXJnZXQuY2hhck5hbWUuLiI8L2ZvbnQ+IikNCiAgICAgICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWRUYXIgPSBzdGFyZ2V0ICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIHByaW50KCI8Zm9udCBjb2xvcj1cIiNDQkY2RkZcIj5OZXcgdGFyZ2V0IDxiPnNlbGVjdGVkLjwvYj46ICIuLnN0YXJnZXQuY2hhck5hbWUuLiI8L2ZvbnQ+IikNCiAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgICBlbmQNCiAgICBlbmQNCiAgLS0gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tTGlzYW5kcmEgc3RhcnRpbmctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogIC0tIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLUxpc2FuZHJhIHN0YXJ0aW5nLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAtLSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1MaXNhbmRyYSBzdGFydGluZy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgLS0gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tTGlzYW5kcmEgc3RhcnRpbmctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogIGNsYXNzICJMaXNzYW5kcmEiDQogIGZ1bmN0aW9uIExpc3NhbmRyYTpfX2luaXQoKQ0KICAgc2VsZi50cz0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgNTUwLCBEQU1BR0VfUEhZU0lDQUwsIGZhbHNlLCB0cnVlKQ0KICBzZWxmLnRzcT0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgNzI1LCBEQU1BR0VfUEhZU0lDQUwsIGZhbHNlLCB0cnVlKQ0KICBzZWxmLnRzdz0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgNDUwLCBEQU1BR0VfTUFHSUMsIGZhbHNlLCB0cnVlKQ0KICBzZWxmLnRzZT0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgMTA1MCwgREFNQUdFX01BR0lDLCBmYWxzZSwgdHJ1ZSkNCiAgc2VsZi50c3I9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDU1MCwgREFNQUdFX01BR0lDLCBmYWxzZSwgdHJ1ZSkgDQogICAgIHNlbGYuUVNwZWxsID0gX1NwZWxsKHtTbG90ID0gX1EsIERhbWFnZU5hbWUgPSAiUSIsIFJhbmdlID0gNzI1LCBXaWR0aCA9IDIwLCBEZWxheSA9IDAuMjUsIFNwZWVkID0gbWF0aC5odWdlLCBDb2xsaXNpb24gPSBmYWxzZSwgQW9lID0gZmFsc2UsIFR5cGUgPSBTUEVMTF9UWVBFLkxJTkVBUn0pDQogICAgIHNlbGYuV1NwZWxsID0gX1NwZWxsKHtTbG90ID0gX1csIERhbWFnZU5hbWUgPSAiVyIsIFJhbmdlID0gNDUwLCBXaWR0aCA9IDAsIERlbGF5ID0gMC41LCBTcGVlZCA9IG1hdGguaHVnZSwgQ29sbGlzaW9uID0gZmFsc2UsIEFvZSA9IHRydWUsIFR5cGUgPSBTUEVMTF9UWVBFLlNFTEZ9KQ0KICAgICBzZWxmLkVTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9FLCBEYW1hZ2VOYW1lID0gIkUiLCBSYW5nZSA9IDEwNTAsIFdpZHRoID0gMTEwLCBEZWxheSA9IC4yNSwgU3BlZWQgPSBtYXRoLmh1Z2UsIENvbGxpc2lvbiA9IGZhbHNlLCBBb2UgPSBmYWxzZSwgVHlwZSA9IFNQRUxMX1RZUEUuTElORUFSfSkNCiAgICAgc2VsZi5SU3BlbGwgPSBfU3BlbGwoe1Nsb3QgPSBfUiwgRGFtYWdlTmFtZSA9ICJSIiwgUmFuZ2UgPTU1MCwgV2lkdGggPSAwLCBEZWxheSA9IDAuMjUsIFNwZWVkID0gbWF0aC5odWdlLCBDb2xsaXNpb24gPSBmYWxzZSwgQW9lID0gdHJ1ZSwgVHlwZSA9IFNQRUxMX1RZUEUuVEFSR0VUVEVEfSkNCiAgICAgc2VsZi5SU1NwZWxsID0gX1NwZWxsKHtTbG90ID0gX1IsIERhbWFnZU5hbWUgPSAiUiIsIFJhbmdlID01NTAsIFdpZHRoID0gMCwgRGVsYXkgPSAwLjI1LCBTcGVlZCA9IG1hdGguaHVnZSwgQ29sbGlzaW9uID0gZmFsc2UsIEFvZSA9IHRydWUsIFR5cGUgPSBTUEVMTF9UWVBFLlRBUkdFVFRFRH0pDQogICAgIHNlbGYuSWduaXRlID0gX1NwZWxsKHtTbG90ID0gRmluZFN1bW1vbmVyU2xvdCgic3VtbW9uZXJkb3QiKSwgRGFtYWdlTmFtZSA9ICJJR05JVEUiLCBSYW5nZSA9IDYwMCwgVHlwZSA9IFNQRUxMX1RZUEUuVEFSR0VUVEVEfSkNCiAgLS18PiBNaW5pb24gTWFuYWdlcnMNCiAgICAgIHNlbGYuZW5lbXlNaW5pb25zICAgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9FTkVNWSwgICA2NTAsIG15SGVybywgTUlOSU9OX1NPUlRfTUFYSEVBTFRIX0RFQykNCiAgICAgIHNlbGYuYWxseU1pbmlvbnMgICAgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9BTExZLCAgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgICAgc2VsZi5qdW5nbGVNaW5pb25zICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX0pVTkdMRSwgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgICAgc2VsZi5vdGhlck1pbmlvbnMgICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX09USEVSLCAgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgICAgICAgIHNlbGY6TG9hZE1lbnUoKQ0KICAgICAgICAgICAgTGFzdF9MZXZlbFNwZWxsID0gMA0KICAgICAgICAgICAgc2VsZjpmaW5kb3Jid2Fsa2VyKCkNCiAgICAgICAgICAgICAgICAgICBpZiBWSVBfVVNFUiB0aGVuICAgc2VsZjpza2luaGFjaygpIGVuZA0KICAgICAgICBBZGRUaWNrQ2FsbGJhY2soZnVuY3Rpb24oKSBzZWxmOlRpY2soKSBlbmQpDQogICAgQWRkRHJhd0NhbGxiYWNrKGZ1bmN0aW9uKCkgc2VsZjpEcmF3KCkgZW5kKQ0KICAgIC0tQWRkTXNnQ2FsbGJhY2soZnVuY3Rpb24obXNnLEtleSkgc2VsZjpXbmRNc2cobXNnLEtleSkgZW5kKQ0KICAgIC0tQWRkQW5pbWF0aW9uQ2FsbGJhY2soZnVuY3Rpb24odW5pdCwgYW5pbWF0aW9uKSBzZWxmOkFuaW1hdGlvbih1bml0LCBhbmltYXRpb24pIGVuZCkNCiAgICAtLUFkZFByb2Nlc3NTcGVsbENhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIHNwZWxsKSBzZWxmOlByb2Nlc3NTcGVsbCh1bml0LCBzcGVsbCkgZW5kKQ0KICAgIC0tQWRkQXBwbHlCdWZmQ2FsbGJhY2soZnVuY3Rpb24oc291cmNlLCB1bml0LCBidWZmKSBzZWxmOk9uQXBwbHlCdWZmKHNvdXJjZSwgdW5pdCwgYnVmZikgZW5kKQ0KICAgIC0tQWRkVXBkYXRlQnVmZkNhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIGJ1ZmYsIHN0YWNrcykgc2VsZjpVcGRhdGVCdWZmKHVuaXQsIGJ1ZmYsIHN0YWNrcykgZW5kKQ0KICAgIC0tQWRkUmVtb3ZlQnVmZkNhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIGJ1ZmYpIHNlbGY6T25SZW1vdmVCdWZmKHVuaXQsIGJ1ZmYpIGVuZCkgDQogICAgICBlbmQNCiAgICAgIGZ1bmN0aW9uIExpc3NhbmRyYTpUaWNrKCkNCiAgICAgICBzZWxmOmF1dG96aG9ueWEoKQ0KICAgICAgIHNlbGY6ZW5nYWdld2l0aHIoKQ0KICAgICAgICAgaWYgVklQX1VTRVIgdGhlbiBzZWxmOmF1dG9sZXZlbCgpIGVuZA0KICAgICAgIHNlbGY6YXV0b1IoKQ0KICAgICAgIHNlbGY6YXV0b3EoKQ0KICAgaWYoc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSApdGhlbg0KICAgICAgc2VsZjpjb21ibygpDQogICAgZW5kDQogICAgICAgIGlmKHNlbGYuQ29uZmlnLktleXMuanVuZ2xlY2xlYXJrZXkgKXRoZW4NCiAgICAgc2VsZjpKdW5nbGVDbGVhcigpDQogICAgZW5kDQogICAgICBpZihzZWxmLkNvbmZpZy5LZXlzLmxhbmVjbGVhcmtleSApdGhlbg0KICAgICAgc2VsZjpMYW5lQ2xlYXIoKQ0KICAgIGVuZA0KICAgICBpZihzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ciApdGhlbg0KICAgICAgc2VsZjplbmdhZ2V3aXRocigpDQogICAgZW5kDQogICAgICBpZihzZWxmLkNvbmZpZy5LZXlzLmVzY2FwZWtleSl0aGVuDQogICAgICBzZWxmOmVzY2FwZSgpDQogICAgZW5kDQogICAgaWYoc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzICkgdGhlbg0KICAgICAgc2VsZjpraWxsc3RlYWwoKQ0KICAgIGVuZA0KICAgIGlmKHNlbGYuQ29uZmlnLktleXMuaGFyYXNza2V5IG9yIHNlbGYuQ29uZmlnLktleXMuaGFyYXNzdG9nbGVrZXkgICkgdGhlbg0KICAgICAgc2VsZjpoYXJhc3MoKQ0KICAgIGVuZA0KICAgICAgZW5kDQogICAgICBmdW5jdGlvbiBMaXNzYW5kcmE6TG9hZE1lbnUoKQ0KICAgICAgICBzZWxmLkNvbmZpZz1zY3JpcHRDb25maWcoIiIuLlNjcmlwdG5hbWUuLiIiLCJtZW51IikNCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkNvbWJvIFNldHRpbmdzIiwgImNvbWJvIikNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZVEiLCAiVXNlIFEgaW4gQ29tYm8iLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VXIiwgIlVzZSBXIGluIENvbWJvIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlRSIsICJVc2UgRSBpbiBjb21ibyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZVIiLCAiVXNlIFIgaW4gY29tYm8iLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VJIiwgIlVzZSBJZ25pdGUgaWYgdGFyZ2V0IGtpbGxhYmxlIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDEwLCAxMCwgMTAwLCAwKQ0KICANCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkhhcmFzcyBTZXR0aW5ncyIsICJoYXJhc3MiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6YWRkUGFyYW0oInVzZVEiLCAiSGFyYXNzIFdpdGggUSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuaGFyYXNzOmFkZFBhcmFtKCJ1c2VXIiwgIkhhcmFzcyBXaXRoIFciLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczphZGRQYXJhbSgidXNlRSIsICJIYXJhc3MgV2l0aCBFIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCBmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcuaGFyYXNzOmFkZFBhcmFtKCJhdXRvcSIsICJBdXRvIEhhcmFzcyB3aXRoIFEiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIGZhbHNlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6YWRkUGFyYW0oIk1hbmEiLCJNYW5hIE1hbmFnZXIgJSIsU0NSSVBUX1BBUkFNX1NMSUNFLCAzMCwgMTAsIDEwMCwgMCkNCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIlNraWxsIExvZ2ljcyIsICJza2lsbGxvZ2ljIikNCiAgICAgICAgc2VsZi5Db25maWcuc2tpbGxsb2dpYzphZGRTdWJNZW51KCJFIFNraWxsIExvZ2ljIiwgIkVsb2dpYyIpDQogICAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuRWxvZ2ljOmFkZFBhcmFtKCJjb21ibyIsICJFIExvZ2ljIGZvciBjb21ibyBtb2RlIiwgU0NSSVBUX1BBUkFNX0xJU1QsIDIsIHsiRW5nYWdlIHdpdGggc2Vjb25kIEUiLCAiRG8gbm90IHVzZSBTZWNvbmQgRSAoIFJlY29tZW5kZWQpIiB9KQ0KICAgICAgICBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLkVsb2dpYzphZGRQYXJhbSgiaGFyYXNzIiwgIkUgTG9naWMgZm9yIEhhcmFzcyBtb2RlIiwgU0NSSVBUX1BBUkFNX0xJU1QsIDEsIHsiRG8gbm90IHVzZSBTZWNvbmQgRSAoIFJlY29tZW5kZWQpIiwgIkVuZ2FnZSB3aXRoIHNlY29uZCBFIiB9KQ0KICAgICAgICBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLkVsb2dpYzphZGRQYXJhbSgiYmxhbmsiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuRWxvZ2ljOmFkZFBhcmFtKCJpbmZvRSIsICJFbmdhZ2Ugd2l0aCBzZWNvbmQgRSBvcHRpb24gaXMgc3RpbGwgb24gQmV0YS4uIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWM6YWRkU3ViTWVudSgiUiBTa2lsbCBMb2dpYyIsICJSbG9naWMiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLlJsb2dpYzphZGRQYXJhbSgiUmxvZ2ljIiwgIlIgTG9naWMgZm9yIGNvbWJvIG1vZGUiLCBTQ1JJUFRfUEFSQU1fTElTVCwgMSwgeyJTbWFydCIsICJzYXZlIGZvciB5b3Vyc2VsZiIsICJVc2UgZm9yIGVuZW15IiB9KQ0KICAgICAgICBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLlJsb2dpYzphZGRQYXJhbSgiZW5hYmxlYXV0b1IiLCAiQXV0byBSIGZvciB5b3Vyc2VsZiIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5SbG9naWM6YWRkUGFyYW0oImF1dG9SIiwgIkF1dG9SIGlmIEhlYWx0aCB1bmRlciAtPiAlIiwgU0NSSVBUX1BBUkFNX1NMSUNFLCAxMCwgMCwgMTAwLCAwKQ0KICAgICAgICBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLlJsb2dpYzphZGRQYXJhbSgiaW5mb1IyIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLlJsb2dpYzphZGRQYXJhbSgiaW5mb1IiLCAiRm9yIHVzaW5nIFNtYXJ0IFIgbG9naWMsIEF1dG9SIHNob3VsZCBiZSBvcGVuLi4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgc2VsZi5Db25maWcuc2tpbGxsb2dpYzphZGRTdWJNZW51KCJXIFNraWxsIExvZ2ljIiwgIldsb2dpYyIpIA0KICAgICAgICBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLldsb2dpYzphZGRQYXJhbSgidXNlVyIsICJVc2UgVyBmb3IgQW50aSBHYXBDbG9zZSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuV2xvZ2ljOmFkZFBhcmFtKCJpbmZvdzIiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuV2xvZ2ljOmFkZFBhcmFtKCJpbmZvVzMiLCAiVGhpcyBGdW5jdGlvbiBpcyBvbiBiZXRhLi4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgDQogICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJFc2NhcGUgU2V0dGluZ3MiLCJlc2NhcGUiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5lc2NhcGU6YWRkUGFyYW0oInVzZUUiLCJVc2UgRSBXaGlsZSBFc2NhcGUiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5lc2NhcGU6YWRkUGFyYW0oInVzZVciLCJVc2UgVyBXaGlsZSBFc2NhcGUiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiRmFybSBTZXR0aW5ncyIsICJmYXJtIikNCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnLmZhcm06YWRkU3ViTWVudSgiTGFuZUNsZWFyIFNldHRpbmdzIiwibGFuZWNsZWFyIikNCiAgICAgICAgc2VsZi5Db25maWcuZmFybS5sYW5lY2xlYXI6YWRkUGFyYW0oInVzZVEiLCJVc2UgUSBvbiBMYW5lY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5mYXJtLmxhbmVjbGVhcjphZGRQYXJhbSgidXNlVyIsIlVzZSBXIG9uIExhbmVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgICAtLXNlbGYuQ29uZmlnLmZhcm0ubGFuZWNsZWFyOmFkZFBhcmFtKCJ1c2VFIiwiVXNlIEUgb24gTGFuZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuZmFybS5sYW5lY2xlYXI6YWRkUGFyYW0oIk1hbmEiLCJNYW5hIE1hbmFnZXIgJSIsU0NSSVBUX1BBUkFNX1NMSUNFLCAzMCwgMTAsIDEwMCwgMCkNCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnLmZhcm06YWRkU3ViTWVudSgiSnVuZ2xlQ2xlYXIgU2V0dGluZ3MiLCJqdW5nbGVjbGVhciIpDQogICAgICAgIHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXI6YWRkUGFyYW0oInVzZVEiLCJVc2UgUSBvbiBqdW5nbGVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXI6YWRkUGFyYW0oInVzZVciLCJVc2UgVyBvbiBqdW5nbGVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXI6YWRkUGFyYW0oInVzZUUiLCJVc2UgRSBvbiBqdW5nbGVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXI6YWRkUGFyYW0oIk1hbmEiLCJNYW5hIE1hbmFnZXIgJSIsU0NSSVBUX1BBUkFNX1NMSUNFLCAzMCwgMTAsIDEwMCwgMCkNCiAgICAgICAgDQogICAgICAgIC0tc2VsZi5Db25maWcuZmFybTphZGRTdWJNZW51KCJMYXN0aGl0IFNldHRpbmdzIiwibGFzdGhpdCIpDQogICAgICAgIC0tc2VsZi5Db25maWcuZmFybS5sYXN0aGl0OmFkZFBhcmFtKCJ1c2VRIiwiVXNlIFEgb24gTGFzdGhpdCIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIC0tc2VsZi5Db25maWcuZmFybS5sYXN0aGl0OmFkZFBhcmFtKCJ1c2VXIiwiVXNlIFcgb24gTGFzdGhpdCIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIC0tc2VsZi5Db25maWcuZmFybS5sYXN0aGl0OmFkZFBhcmFtKCJ1c2VFIiwiVXNlIEUgb24gTGFzdGhpdCIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIC0tc2VsZi5Db25maWcuZmFybS5sYXN0aGl0OmFkZFBhcmFtKCJNYW5hIiwiTWFuYSBNYW5hZ2VyICUiLFNDUklQVF9QQVJBTV9TTElDRSwgMzAsIDEwLCAxMDAsIDApDQogICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiS2lsbFN0ZWFsIFNldHRpbmdzIiwgImtpbGxzdGVhbCIpDQogICAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgia3MiLCJLaWxsc3RlYWwgT24vT2ZmIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJ1c2VRIiwgIlN0ZWFsIFdpdGggUSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJ1c2VFIiwgIlN0ZWFsIFdpdGggRSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJ1c2VSIiwgIlN0ZWFsIFdpdGggUiIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJ1c2VJIiwgIlN0ZWFsIFdpdGggSWduaXRlIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiSXRlbSBTZXR0aW5ncyIsICJpdGVtIikNCiAgICAgICAgc2VsZi5Db25maWcuaXRlbTphZGRQYXJhbSgiZW5hYmxlYXV0b3pob255YSIsICJBdXRvIFpob255YSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLml0ZW06YWRkUGFyYW0oImF1dG96aG9ueWEiLCAiWmhvbnlhIGlmIEhlYWx0aCB1bmRlciAtPiAlIiwgU0NSSVBUX1BBUkFNX1NMSUNFLCAxMCwgMCwgMTAwLCAwKQ0KICAgICAgICANCiAgICAgICAgICAgICAgaWYgVklQX1VTRVIgdGhlbg0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJWSVAgU2V0dGluZ3MiLCAidmlwIikNCiAgICAgICAgc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJwYWNrZXQiLCJVc2UgUGFja2V0IENhc3RpbmciLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvMSIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvMiIsICJUbyB1c2UgdmlwIHNldHRpbmdzLCBQYWNrZXQgQ2FzdGluZyBzaG91bGQgYmUgb3Blbi4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgc2VsZi5Db25maWcudmlwOmFkZFN1Yk1lbnUoIkF1dG8gTGV2ZWwgU2V0dGluZ3MiLCAibGV2ZWwiKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXAubGV2ZWw6YWRkUGFyYW0oImtleSIsIlVzZSBBdXRvIExldmVsIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcC5sZXZlbDphZGRQYXJhbSgibG9naWMiLCAiU2VsZWN0IFNraWxsIE9yZGVyIiwgU0NSSVBUX1BBUkFNX0xJU1QsIDcsIHsiRm9jdXMgUT5XPkUiLCAiRm9jdXMgUT5FPlciLCJGb2N1cyBXPlE+RSIsIkZvY3VzIFc+RT5RIiwiRm9jdXMgRT5XPlEiLCAiRm9jdXMgRT5RPlciICwgIlNtYXJ0IiAgfSkNCiAgICAgICAgc2VsZi5Db25maWcudmlwOmFkZFN1Yk1lbnUoIlNraW4gSGFjayBTZXR0aW5ncyIsICJza2luIikNCiAgICAgICAgc2VsZi5Db25maWcudmlwLnNraW46YWRkUGFyYW0oImtleSIsIlVzZSBTa2luIEhhY2siLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcudmlwLnNraW46YWRkUGFyYW0oJ3NlbGVjdGVkJyAuLiBteUhlcm8uY2hhck5hbWUgLi4gJ1NraW4nLCAiU2VsZWN0IFNraW4iLCBTQ1JJUFRfUEFSQU1fTElTVCwgMSwgeyJPcmlnaW5hbCIsICJCbG9vZHN0b25lIExpc3NhbmRyYSAiLCJCbGFkZSBRdWVlbiBMaXNzYW5kcmEifSkNCiAgICAgICAgc2VsZi5Db25maWcudmlwLnNraW46YWRkUGFyYW0oImluZm80IiwgIlRvIHVzZSBza2luIGhhY2ssIFlvdSBuZWVkIHRvIDJ4IEY5IGFmdGVyIHlvdSBzZWxlY3QgdGhlIHNraW4geW91IGRlc2lyZS4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgc2VsZi5Db25maWcudmlwLnNraW46YWRkUGFyYW0oImluZm81IiwgIk1ha2Ugc3VyZSB0aGF0IHVzaW5nIHBhY2tldCBjYXN0aW5nIGlzIE9OLiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICAtLXNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzUiLCAiU2tpbiBIYWNrIHRlbXBvcmFyeSBkaXNhYmxlZCB1bnRpbCBuZXh0IHVwZGF0ZS4gLiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICAtLVtbc2VsZi5Db25maWcudmlwOmFkZFN1Yk1lbnUoIkFudGktQUZLIFNldHRpbmdzIiwgImFudGlhZmsiKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXAuYW50aWFmazphZGRQYXJhbSgiYW50aWFmayIsIlVzZSBBbnRpIEFmayIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKSBdXQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm8zIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm80IiwgIlRvIHVzZSB2aXAgc2V0dGluZ3MsIFlvdSBuZWVkIHRvIGJlIGEgVklQIHVzZXIgb24gQk9MIGNvbW11bml0eS4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBlbmQNCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiRHJhdyBTZXR0aW5ncyIsIm90aGVyIikNCiAgICAgICAgLS1zZWxmLkNvbmZpZy5vdGhlcjphZGRTdWJNZW51KCJTaG93IERhbWFnZSBPbiBIcCBCYXIiLCAiSFBCQVIiKQ0KICAgICAgICAtLXNlbGYuQ29uZmlnLm90aGVyLkhQQkFSOmFkZFBhcmFtKCJrZXkiLCJPTi9PRkYiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5vdGhlcjphZGRTdWJNZW51KCJTa2lsbCBEcmF3aW5nIFNldHRpbmdzIiwgImRyYXciKQ0KICAgICAgICBzZWxmLkNvbmZpZy5vdGhlci5kcmF3OmFkZFBhcmFtKCJxZHJhdyIsIlEgU2tpbGwgRHJhd2luZ3MiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5vdGhlci5kcmF3OmFkZFBhcmFtKCJ3ZHJhdyIsIlcgU2tpbGwgRHJhd2luZ3MiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5vdGhlci5kcmF3OmFkZFBhcmFtKCJlZHJhdyIsIkUgU2tpbGwgRHJhd2luZ3MiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5vdGhlci5kcmF3OmFkZFBhcmFtKCJyZHJhdyIsIlIgU2tpbGwgRHJhd2luZ3MiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5vdGhlci5kcmF3OmFkZFBhcmFtKCJhYWRyYXciLCJBdXRvIEF0dGFjayBSYW5nZSIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICANCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIlRhcmdldHNlbGVjdG9ycyIsInRhcmdldHNlbCIpDQogICAgICBzZWxmLnRzLm5hbWUgID0gIkxpc3NhbmRyYSBHZW5lcmFsIg0KICAgICAgc2VsZi50c3EubmFtZSA9ICJMaXNzYW5kcmEgUSBTa2lsbCINCiAgICAgIHNlbGYudHN3Lm5hbWUgPSAiTGlzc2FuZHJhIFcgU2tpbGwiDQogICAgICBzZWxmLnRzZS5uYW1lID0gIkxpc3NhbmRyYSBFIFNraWxsIg0KICAgICAgc2VsZi50c3IubmFtZSA9ICJMaXNzYW5kcmEgUiBTa2lsbCINCiAgICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRUUyhzZWxmLnRzKQ0KICAgICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFRTKHNlbGYudHNxKQ0KICAgICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFRTKHNlbGYudHN3KQ0KICAgICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFRTKHNlbGYudHNlKQ0KICAgICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFRTKHNlbGYudHNyKSANCiAgICAgIA0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiS2V5cyBTZXR0aW5ncyIsICJLZXlzIikNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LMyIsICI8LS0tLS0tLS0tLS0tLS0tLS0tQ29tYm8gS2V5IFNldHRpbmdzLS0tLS0tLS0tLS0tLS0tLS0tPiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiY29tYm9rZXkiLCAiQ29tYm8gS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIDMyKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiY29tYm9rZXlyIiwgIlN0YXJ0IEVuZ2FnZSBXaXRoIFlvdXIgVWx0aSAiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIlUiKSkNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LNCIsICI8LS0tLS0tLS0tLS0tLS0tLS0tSGFyYXNzIEtleSBTZXR0aW5ncy0tLS0tLS0tLS0tLS0tLS0tLT4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImhhcmFzc2tleSIsICJTbWFydCBIYXJhc3MgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJDIikpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJoYXJhc3N0b2dsZWtleSIsICJIYXJhc3MgVG9nbGUgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZVE9HR0xFLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIlQiKSkNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LNSIsICI8LS0tLS0tLS0tLS0tLS0tLS0tQ2xlYXIgS2V5IFNldHRpbmdzLS0tLS0tLS0tLS0tLS0tLS0tLS0+IiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJsYW5lY2xlYXJrZXkiLCAiTGFuZUNsZWFyIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiViIpKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgianVuZ2xlY2xlYXJrZXkiLCAiSnVuZ2xlQ2xlYXIgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJaIikpDQogICAgICAtLXNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImxhc3RoaXRrZXkiLCAiTGFzdGhpdCBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIlgiKSkNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LNiIsICI8LS0tLS0tLS0tLS0tLS0tLS0tT3RoZXIgS2V5IFNldHRpbmdzLS0tLS0tLS0tLS0tLS0tLS0tLS0+IiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJlc2NhcGVrZXkiLCAiRXNjYXBlIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiWSIpKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0siLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJpbmZvSzIiLCAiTWFrZSBTdXJlIFRoYXQgWW91ciBPcmJ3YWxrZXIgS2V5cyBhcmUgU2FtZSBBcyBIZXJlIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICANCiAgICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJPcmJ3YWxrZXIgS2V5IFNldHRpbmdzIiwgIktleXMyIikNCiAgICAgIE9yYndhbGtNYW5hZ2VyOkxvYWRDb21tb25LZXlzKHNlbGYuQ29uZmlnLktleXMyKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czI6YWRkUGFyYW0oImluZm9LNCIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLktleXMyOmFkZFBhcmFtKCJpbmZvSzIyIiwgIk1ha2UgU3VyZSBUaGF0IFlvdXIgU2NyaXB0IEtleXMgYXJlIFNhbWUgQXMgSGVyZSIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIA0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvMyIsICJfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3giLCAiICAgICAgICAgICAgICAgIi4uU2NyaXB0bmFtZS4uIiIsIFNDUklQVF9QQVJBTV9JTkZPLCAiIikgDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3gyIiwgIiAgICAgICAgICAgICAgICAgU2NyaXB0IFZlcnNpb246ICAiLi5WZXJzaW9uLi4gIiAgICAgICAgICIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94NiIsICIgICAgICAgICAgICBTY3JpcHQgd2FzIG1hZGUgYnkgICIuLkF1dGhvci4uICIgICAgICAgICAiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDUiLCAiICAgICAgIExlYXVnZSBPZiBMZWdlbmRzIFZlcnNpb246ICAiLi5MVmVyc2lvbi4uICIgICAgICAgICAiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICANCiAgICAgICBzZWxmLkNvbmZpZzpwZXJtYVNob3coImluZm9ib3giKQ0KICAgICAgIHNlbGYuQ29uZmlnLktleXM6cGVybWFTaG93KCJjb21ib2tleSIpDQogICAgICAgc2VsZi5Db25maWcuS2V5czpwZXJtYVNob3coImhhcmFzc3RvZ2xla2V5IikNCiAgICAgICBzZWxmLkNvbmZpZy5LZXlzOnBlcm1hU2hvdygiaGFyYXNza2V5IikNCiAgICANCiAgDQogIGVuZA0KICBmdW5jdGlvbiBMaXNzYW5kcmE6c2tpbmhhY2soKQ0KICBpZiBub3Qgc2VsZi5Db25maWcudmlwLnBhY2tldCB0aGVuIFNlbmRTa2luUGFja2V0KG15SGVyby5jaGFyTmFtZSwgc2tpbnNQQlsxXSwgbXlIZXJvLm5ldHdvcmtJRCk7IGVsc2UNCiAgaWYgc2VsZi5Db25maWcudmlwLnNraW4ua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAucGFja2V0ICB0aGVuDQogIFNlbmRTa2luUGFja2V0KG15SGVyby5jaGFyTmFtZSwgc2tpbnNQQltzZWxmLkNvbmZpZy52aXAuc2tpblsnc2VsZWN0ZWQnIC4uIG15SGVyby5jaGFyTmFtZSAuLiAnU2tpbiddXSwgbXlIZXJvLm5ldHdvcmtJRCk7DQogIGVuZA0KICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExpc3NhbmRyYTphdXRvbGV2ZWwoKQ0KaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSAxIGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlMSA9ICAgeyAxLDIsMywxLDEsNCwxLDIsMSwyLDQsMiwyLDMsMyw0LDMsM30NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlMSkNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDIgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2UyID0gICB7IDEsMiwzLDEsMSw0LDEsMywxLDMsNCwzLDMsMiwyLDQsMiwyfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2UyKQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gMyBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTMgPSAgeyAyLDMsMSwyLDIsNCwyLDEsMiwxLDQsMSwxLDMsMyw0LDMsM30NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlMykNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDQgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2U0ID0gIHsgMiwzLDEsMiwyLDQsMiwzLDIsMyw0LDMsMywxLDEsNCwxLDF9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTQpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSA1IGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlNSA9ICB7IDMsMSwyLDMsMyw0LDMsMiwzLDIsNCwyLDIsMSwxLDQsMSwxfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2U1KQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gNiBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTYgPSAgeyAzLDEsMiwzLDMsNCwzLDEsMywxLDQsMSwxLDIsMiw0LDIsMn0NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlNikNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICAgIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gNyBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTYgPSAgeyAxLDMsMiwxLDEsNCwxLDIsMSwyLDQsMiwyLDMsMyw0LDMsM30NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlNikNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGlzc2FuZHJhOmF1dG96aG9ueWEoKQ0KICAgIGlmIHNlbGYuQ29uZmlnLml0ZW0uZW5hYmxlYXV0b3pob255YSB0aGVuDQogICAgIGZvciBfID0gSVRFTV8xLCBJVEVNXzcgZG8NCiAgICAgIGlmIG15SGVyby5oZWFsdGggPD0gKG15SGVyby5tYXhIZWFsdGggKiBzZWxmLkNvbmZpZy5pdGVtLmF1dG96aG9ueWEgLyAxMDApIGFuZCAoIG15SGVybzpDYW5Vc2VTcGVsbChfKSA9PSAwIGFuZCBteUhlcm86R2V0U3BlbGxEYXRhKF8pLm5hbWUgPT0gIlpob255YXNIb3VyZ2xhc3MiICl0aGVuIENhc3RTcGVsbChfKQ0KICAgIGVuZA0KICAgIGVuZA0KICAgIGVuZA0KICAgIGVuZA0KICANCiAgZnVuY3Rpb24gTGlzc2FuZHJhOmF1dG9SKCkNCiAgICBpZiAoIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljLmVuYWJsZWF1dG9SIGFuZCAoc2VsZi5Db25maWcuc2tpbGxsb2dpYy5SbG9naWMuUmxvZ2ljID09IDIgb3Igc2VsZi5Db25maWcuc2tpbGxsb2dpYy5SbG9naWMuUmxvZ2ljID09IDEpKSB0aGVuDQogICAgICBpZiBteUhlcm8uaGVhbHRoIDw9IChteUhlcm8ubWF4SGVhbHRoICogc2VsZi5Db25maWcuc2tpbGxsb2dpYy5SbG9naWMuYXV0b1IgLyAxMDApIHRoZW4gc2VsZjpDYXN0UlMobXlIZXJvKQ0KICAgICAgZW5kDQogICAgZW5kDQogICAgZW5kDQogIA0KICBmdW5jdGlvbiBMaXNzYW5kcmE6ZW5nYWdld2l0aHIoKQ0KICAgc2VsZi50c3E6dXBkYXRlKCkNCiAgIGlmIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXlyIHRoZW4NCiAgIHNlbGY6d2FsaygpDQogICBlbmQNCiAgICAgIGlmKHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKWFuZCBzZWxmLnRzcS50YXJnZXR+PW5pbCAgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVEgYW5kIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXlyICApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFEoc2VsZi50c3EudGFyZ2V0KQ0KICAgICAgZW5kDQogICAgICBzZWxmLnRzZTp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi5FU3BlbGw6SXNSZWFkeSgpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmNvbWJvLk1hbmEgLzEwMCApYW5kIHNlbGYudHNlLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VFIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ciApdGhlbg0KICAgICAgICAgICAgICAgIGxvY2FsIFRpY2tlciA9IEdldFRpY2tDb3VudCgpDQogIGlmIChnbG9iYWxfdGlja3MgKyAyMDAwKSA8IFRpY2tlciB0aGVuDQogIGlmIChteUhlcm86Q2FuVXNlU3BlbGwoX0UpID09IFJFQURZICkgdGhlbg0KICAgICBDYXN0U3BlbGwoX0UsIHNlbGYudHNlLnRhcmdldC54LCBzZWxmLnRzZS50YXJnZXQueikNCiAgICAgZ2xvYmFsX3RpY2tzID0gVGlja2VyDQogICAgICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBDYXN0U3BlbGwoX0UpIGVuZCwgMS41KQ0KICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgICAgIGlmKHNlbGYuV1NwZWxsOklzUmVhZHkoKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKSBhbmQgc2VsZi50c3cudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVcgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ciAgKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RXKHNlbGYudHN3LnRhcmdldCkNCiAgICAgIGVuZA0KICAgICAgc2VsZi50c3I6dXBkYXRlKCkNCiAgICAgIGlmKHNlbGYuUlNwZWxsOklzUmVhZHkoKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKSBhbmQgc2VsZi50c3IudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVIgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ciApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFIoc2VsZi50c3IudGFyZ2V0KQ0KICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExpc3NhbmRyYTpEcmF3KCkNCiAgICAgIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcucWRyYXcgYW5kIHNlbGYuUVNwZWxsOklzUmVhZHkoKSB0aGVuDQogICAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgNzI1LCAxLHJlZCkNCiAgICBlbmQNCiAgDQogICAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy53ZHJhdyBhbmQgc2VsZi5XU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCAxMDUwLCAxLCByZWQpDQogICAgZW5kDQogIA0KICAgIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcuZWRyYXcgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSB0aGVuDQogICAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgNDIwLCAxLCByZWQpDQogICAgZW5kDQogICAgDQogICAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5yZHJhdyBhbmQgc2VsZi5SU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCA1MDAsMSwgcmVkKQ0KICAgIGVuZA0KICAgIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcuYWFkcmF3IHRoZW4NCiAgICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCA1NTAsMSwgQVJHQigyNTUsIDI1NSwwLDApKQ0KICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGlzc2FuZHJhOmFudGlnYXB3KCkNCiAgICAgIGlmKHNlbGYuV1NwZWxsOklzUmVhZHkoKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKWFuZCBzZWxmLnRzdy50YXJnZXR+PW5pbCAgYW5kIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuV2xvZ2ljLnVzZVcgICl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0VyhzZWxmLnRzdy50YXJnZXQpDQogICAgICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExpc3NhbmRyYTpjb21ibygpDQogICAgICAgIHNlbGYudHNxOnVwZGF0ZSgpDQogICAgICBpZihzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwIClhbmQgc2VsZi50c3EudGFyZ2V0fj1uaWwgIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VRIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFEoc2VsZi50c3EudGFyZ2V0KQ0KICAgICAgZW5kDQogICAgICBzZWxmLnRzZTp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi5Db25maWcuc2tpbGxsb2dpYy5FbG9naWMuY29tYm8gPT0gMSBhbmQgIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwIClhbmQgc2VsZi5Db25maWcuY29tYm8udXNlRSBhbmQgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgKXRoZW4NCiAgICAgIGxvY2FsIFRpY2tlciA9IEdldFRpY2tDb3VudCgpDQogIGlmIChnbG9iYWxfdGlja3MgKyAyMDAwKSA8IFRpY2tlciB0aGVuDQogIGlmIChteUhlcm86Q2FuVXNlU3BlbGwoX0UpID09IFJFQURZIGFuZCBzZWxmLnRzZS50YXJnZXR+PW5pbCkgdGhlbg0KICAgICBDYXN0U3BlbGwoX0UsIHNlbGYudHNlLnRhcmdldC54LCBzZWxmLnRzZS50YXJnZXQueikNCiAgICAgZ2xvYmFsX3RpY2tzID0gVGlja2VyDQogICAgICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBDYXN0U3BlbGwoX0UpIGVuZCwgMS41KQ0KICAgICAgICAgIGVuZA0KICAgICAgICAgIGVuZA0KICAgICAgICAgIGVuZA0KICAgICAgICAgaWYoc2VsZi5Db25maWcuc2tpbGxsb2dpYy5FbG9naWMuY29tYm8gPT0gMiBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKSBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlRSBhbmQgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgKXRoZW4NCiAgICAgICAgIGxvY2FsIFRpY2tlciA9IEdldFRpY2tDb3VudCgpDQogIGlmIChnbG9iYWxfdGlja3MgKyAyMDAwKSA8IFRpY2tlciB0aGVuDQogIGlmIChteUhlcm86Q2FuVXNlU3BlbGwoX0UpID09IFJFQURZIGFuZCBzZWxmLnRzZS50YXJnZXR+PW5pbCkgdGhlbg0KICAgICBDYXN0U3BlbGwoX0UsIHNlbGYudHNlLnRhcmdldC54LCBzZWxmLnRzZS50YXJnZXQueikNCiAgICAgZ2xvYmFsX3RpY2tzID0gVGlja2VyDQogICAgICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBDYXN0U3BlbGwoX0UpIGVuZCwgMikNCiAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIHNlbGYudHN3OnVwZGF0ZSgpDQogICAgICBpZihzZWxmLldTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwICkgYW5kIHNlbGYudHN3LnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VXIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgICl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0VyhzZWxmLnRzdy50YXJnZXQpDQogICAgICBlbmQNCiAgICAgIGlmKHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljLlJsb2dpYyA9PSAzIG9yIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljLlJsb2dpYyA9PSAxIGFuZCBzZWxmLlJTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwICkgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVIgYW5kIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICl0aGVuDQogICAgICBmb3IgXywgdW5pdCBpbiBwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbw0KICAgICAgICBsb2NhbCBkbWdSID1nZXREbWcoIlIiLHVuaXQsbXlIZXJvKSsgKChteUhlcm8uYXApKjAuNzApIA0KICAgICAgICBsb2NhbCBoZWFsdGg9dW5pdC5oZWFsdGgNCiAgICAgICAgaWYoaGVhbHRoPGRtZ1IgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVIgYW5kIEdldERpc3RhbmNlKHVuaXQpPDU1MCl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0Uih1bml0KQ0KICAgICAgZWxzZWlmIChzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLlJsb2dpYy5SbG9naWMgPT0gMiBhbmQgIG15SGVyby5oZWFsdGggPD0gKG15SGVyby5tYXhIZWFsdGggKiBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLlJsb2dpYy5hdXRvUiAvIDEwMCkpIHRoZW4gDQogICAgICAgc2VsZjpDYXN0UlMobXlIZXJvKQ0KICAgICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIA0KICAgICAgaWYoc2VsZi5Db25maWcuY29tYm8udXNlSSBhbmQgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgKXRoZW4NCiAgICAgIGZvciBfLCB1bml0IGluIHBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvDQogICAgICAgIGxvY2FsIGRtZ0kgPSg1MCsgKChteUhlcm8ubGV2ZWwpKjIwKSkNCiAgICAgICAgbG9jYWwgaGVhbHRoPXVuaXQuaGVhbHRoDQogICAgICAgIGlmKGhlYWx0aDxkbWdJIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VJIGFuZCBHZXREaXN0YW5jZSh1bml0KTw2MDApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEkodW5pdCkNCiAgICAgIGVuZA0KICAgICAgZW5kDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGlzc2FuZHJhOkNhc3RRKHVuaXQpDQogICAgc2VsZi5RU3BlbGw6Q2FzdCh1bml0KQ0KICBlbmQNCiAgDQogIGZ1bmN0aW9uIExpc3NhbmRyYTpDYXN0Vyh1bml0KQ0KICAgIHNlbGYuV1NwZWxsOkNhc3QodW5pdCkNCiAgZW5kDQogIA0KICBmdW5jdGlvbiBMaXNzYW5kcmE6Q2FzdEUodW5pdCkNCiAgICBzZWxmLkVTcGVsbDpDYXN0KHVuaXQpDQogIGVuZA0KICANCiAgZnVuY3Rpb24gTGlzc2FuZHJhOkNhc3RSKHVuaXQpDQogICAgc2VsZi5SU3BlbGw6Q2FzdCh1bml0KQ0KICBlbmQNCiAgZnVuY3Rpb24gTGlzc2FuZHJhOkNhc3RSUyh1bml0KQ0KICAgQ2FzdFNwZWxsKF9SICwgbXlIZXJvKQ0KICBlbmQNCiAgDQogIGZ1bmN0aW9uIExpc3NhbmRyYTpDYXN0SSh1bml0KQ0KICAgIHNlbGYuSWduaXRlOkNhc3QodW5pdCkNCiAgZW5kDQogIGZ1bmN0aW9uIExpc3NhbmRyYTpraWxsc3RlYWwoKQ0KICBmb3IgXywgdW5pdCBpbiBwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbw0KICAgICAgbG9jYWwgaGVhbHRoID0gdW5pdC5oZWFsdGgNCiAgICAgIGxvY2FsIGRtZ0UgPSBnZXREbWcoIkUiLCB1bml0LCBteUhlcm8pICsgKChteUhlcm8uYXApKjAuNikgDQogICAgICAgIGlmKHNlbGYudHNlLnRhcmdldCB+PSBuaWwgYW5kICBzZWxmLkVTcGVsbDpJc1JlYWR5KCkgYW5kIGhlYWx0aDxkbWdFIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlRSAgIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MpdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEUodW5pdCkgIA0KICAgICAgICBlbmQNCiAgICAgICAgbG9jYWwgZG1nUSA9IGdldERtZygiUSIsIHVuaXQsIG15SGVybykgKyAoKG15SGVyby5hcCkqMC42NSkNCiAgICAgICAgaWYoc2VsZi50c3EudGFyZ2V0IH49IG5pbCBhbmQgIHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgaGVhbHRoPGRtZ1EgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VRIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RRKHVuaXQpICANCiAgICAgICAgZW5kDQogICAgICAgIGxvY2FsIGRtZ1cgPSBnZXREbWcoIlciLCB1bml0LCBteUhlcm8pICsgKChteUhlcm8uYXApKjAuNDApDQogICAgICAgIGlmKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgYW5kICBzZWxmLldTcGVsbDpJc1JlYWR5KCkgYW5kIGhlYWx0aDxkbWdRIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlVyBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzICl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0Vyh1bml0KSAgDQogICAgICAgIGVuZA0KICAgICAgICAgbG9jYWwgZG1nSSA9KDUwKyAoKG15SGVyby5sZXZlbCkqMjApKQ0KICAgICAgICBpZihoZWFsdGg8ZG1nSSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZUkgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyBhbmQgR2V0RGlzdGFuY2UodW5pdCk8NjAwKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RJKHVuaXQpDQogICAgICAgIGVuZA0KICAgICAgICBsb2NhbCBkbWdSID1nZXREbWcoIlIiLHVuaXQsbXlIZXJvKSsoKG15SGVyby5hcCkqMC43MCkgDQogICAgICAgIGlmKHNlbGYudHNyLnRhcmdldCB+PSBuaWwgYW5kICBzZWxmLlJTcGVsbDpJc1JlYWR5KCkgYW5kIGhlYWx0aDxkbWdSIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlUiBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzIGFuZCBHZXREaXN0YW5jZSh1bml0KTw1NTApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFIodW5pdCkNCiAgICAgICAgZW5kDQogICAgIGVuZA0KICBlbmQNCiAgDQogIGZ1bmN0aW9uIExpc3NhbmRyYTplc2NhcGUoKQ0KICBsb2NhbCBUaWNrZXIgPSBHZXRUaWNrQ291bnQoKQ0KICBpZiAoZ2xvYmFsX3RpY2tzICsgMjAwMCkgPCBUaWNrZXIgdGhlbg0KICBpZiBzZWxmLkNvbmZpZy5LZXlzLmVzY2FwZWtleSBhbmQgc2VsZi5Db25maWcuZXNjYXBlLnVzZUUgIHRoZW4NCiAgaWYgKG15SGVybzpDYW5Vc2VTcGVsbChfRSkgPT0gUkVBRFkgKSB0aGVuDQogICAgIENhc3RTcGVsbChfRSxtb3VzZVBvcy54LG1vdXNlUG9zLnopDQogICAgIGdsb2JhbF90aWNrcyA9IFRpY2tlcg0KICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgQ2FzdFNwZWxsKF9FKSBlbmQsIDEuNSkNCiAgZW5kDQogIGVuZA0KICBlbmQNCiAgaWYgc2VsZi5Db25maWcuS2V5cy5lc2NhcGVrZXkgdGhlbiANCiAgc2VsZjp3YWxrKCkNCiAgZW5kDQogIGlmIHNlbGYuQ29uZmlnLktleXMuZXNjYXBla2V5IGFuZCBzZWxmLkNvbmZpZy5lc2NhcGUudXNlVyBhbmQgc2VsZi50c3cudGFyZ2V0fj1uaWwgdGhlbg0KICBDYXN0U3BlbGwoX1csdHN3LnRhcmdldCkNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMaXNzYW5kcmE6d2FsaygpDQogICAgbXlIZXJvOk1vdmVUbyhtb3VzZVBvcy54LG1vdXNlUG9zLnopDQogIGVuZA0KICBmdW5jdGlvbiBMaXNzYW5kcmE6aGFyYXNzKCkNCiAgICBzZWxmLnRzOnVwZGF0ZSgpDQogICAgc2VsZi50c3E6dXBkYXRlKCkNCiAgICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgICAgIHNlbGYudHNlOnVwZGF0ZSgpDQogICAgaWYgc2VsZi5Db25maWcuS2V5cy5oYXJhc3NrZXkgb3Igc2VsZi5Db25maWcuS2V5cy5oYXJhc3N0b2dsZWtleSB0aGVuDQogICAgICAgIGlmKHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5oYXJhc3MuTWFuYSAvMTAwICkgYW5kIHNlbGYudHNxLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5oYXJhc3MudXNlUSApIHRoZW4gICAgICAgIA0KICAgICAgICAgIHNlbGY6Q2FzdFEoc2VsZi50c3EudGFyZ2V0KQ0KICAgICAgICBlbmQgICANCiAgICAgICAgZW5kDQogICAgaWYgc2VsZi5Db25maWcuS2V5cy5oYXJhc3NrZXkgb3Igc2VsZi5Db25maWcuS2V5cy5oYXJhc3N0b2dsZWtleSB0aGVuDQogICAgICAgIGlmKHNlbGYuV1NwZWxsOklzUmVhZHkoKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5oYXJhc3MuTWFuYSAvMTAwICkgYW5kIHNlbGYudHN3LnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5oYXJhc3MudXNlVyApIHRoZW4gICAgICAgIA0KICAgICAgICAgIHNlbGY6Q2FzdFcoc2VsZi50c3cudGFyZ2V0KQ0KICAgICAgICBlbmQgIA0KICAgICAgICBlbmQgDQogICAgICAgICAgaWYgc2VsZi5Db25maWcuS2V5cy5oYXJhc3NrZXkgb3Igc2VsZi5Db25maWcuS2V5cy5oYXJhc3N0b2dsZWtleSAgdGhlbg0KICAgICAgICBpZihzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLkVsb2dpYy5oYXJhc3MgPT0gMSAgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuaGFyYXNzLk1hbmEgLzEwMCApICBhbmQgc2VsZi5Db25maWcuaGFyYXNzLnVzZUUgKSB0aGVuICAgICAgICANCiAgICAgICAgIGxvY2FsIFRpY2tlciA9IEdldFRpY2tDb3VudCgpDQogIGlmIChnbG9iYWxfdGlja3MgKyAyMDAwKSA8IFRpY2tlciB0aGVuDQogIGlmIChteUhlcm86Q2FuVXNlU3BlbGwoX0UpID09IFJFQURZIGFuZCBzZWxmLnRzZS50YXJnZXR+PW5pbCkgdGhlbg0KICAgICBDYXN0U3BlbGwoX0UsIHNlbGYudHNlLnRhcmdldC54LCBzZWxmLnRzZS50YXJnZXQueikNCiAgICAgZ2xvYmFsX3RpY2tzID0gVGlja2VyDQogICAgICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBDYXN0U3BlbGwoX0UpIGVuZCwgMikNCiAgICAgICAgICBlbmQNCiAgICAgICAgICBlbmQNCiAgICAgICAgICBlbmQNCiAgICAgICAgICBlbmQNCiAgICAgICAgICAgaWYgc2VsZi5Db25maWcuS2V5cy5oYXJhc3NrZXkgb3Igc2VsZi5Db25maWcuS2V5cy5oYXJhc3N0b2dsZWtleSAgdGhlbg0KICAgICAgICAgICAgICAgaWYoc2VsZi5Db25maWcuc2tpbGxsb2dpYy5FbG9naWMuaGFyYXNzID09IDIgYW5kICAgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5oYXJhc3MuTWFuYSAvMTAwICkgIGFuZCBzZWxmLkNvbmZpZy5oYXJhc3MudXNlRSApIHRoZW4gICAgICAgIA0KICAgICAgICAgbG9jYWwgVGlja2VyID0gR2V0VGlja0NvdW50KCkNCiAgaWYgKGdsb2JhbF90aWNrcyArIDIwMDApIDwgVGlja2VyIHRoZW4NCiAgaWYgKG15SGVybzpDYW5Vc2VTcGVsbChfRSkgPT0gUkVBRFkgYW5kIHNlbGYudHNlLnRhcmdldH49bmlsKSB0aGVuDQogICAgIENhc3RTcGVsbChfRSwgc2VsZi50c2UudGFyZ2V0LngsIHNlbGYudHNlLnRhcmdldC56KQ0KICAgICBnbG9iYWxfdGlja3MgPSBUaWNrZXINCiAgICAgICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIENhc3RTcGVsbChfRSkgZW5kLCAxLjUpDQogICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGVuZA0KICBmdW5jdGlvbiBMaXNzYW5kcmE6TGFuZUNsZWFyKCkNCiAgIGxvY2FsIGNsZWFydGFyZ2V0ID0gbmlsDQogIHNlbGYuZW5lbXlNaW5pb25zOnVwZGF0ZSgpDQogICBzZWxmLm90aGVyTWluaW9uczp1cGRhdGUoKQ0KICAgICAgc2VsZi5qdW5nbGVNaW5pb25zOnVwZGF0ZSgpDQogICAgICBmb3IgaSwgbWluaW9uIGluIGlwYWlycyhzZWxmLmVuZW15TWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgICBpZiBWYWxpZFRhcmdldChtaW5pb24sIDYwMCkgYW5kIChjbGVhcnRhcmdldCA9PSBuaWwgb3Igbm90IFZhbGlkVGFyZ2V0KGNsZWFydGFyZ2V0KSkgdGhlbg0KICAgICAgICAgIGNsZWFydGFyZ2V0ID0gbWluaW9uDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBmb3IgaSwgbWluaW9uIGluIHBhaXJzKHNlbGYuZW5lbXlNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICAgIGlmIFZhbGlkVGFyZ2V0KG1pbmlvbikgYW5kIG1pbmlvbiB+PSBuaWwgdGhlbg0KICAgICAgICAgIGlmIHNlbGYuQ29uZmlnLktleXMubGFuZWNsZWFya2V5ICBhbmQgc2VsZi5Db25maWcuZmFybS5sYW5lY2xlYXIudXNlUSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5mYXJtLmxhbmVjbGVhci5NYW5hIC8xMDAgKSBhbmQgR2V0RGlzdGFuY2UobWluaW9uKSA8PSBzZWxmLlFTcGVsbC5SYW5nZSB0aGVuIA0KICAgICAgICAgbG9jYWwgQmVzdFBvcywgQmVzdEhpdCA9IEdldEJlc3RMaW5lRmFybVBvc2l0aW9uKHNlbGYuUVNwZWxsLlJhbmdlLCBzZWxmLlFTcGVsbC5XaWR0aCwgc2VsZi5lbmVteU1pbmlvbnMub2JqZWN0cyApDQogICAgICAgIGlmIEJlc3RQb3MgIGFuZCBCZXN0SGl0ID4gMCB0aGVuDQogICAgICAgICBDYXN0U3BlbGwoX1EsIEJlc3RQb3MueCwgQmVzdFBvcy56KQ0KICAgICAgICAgIGVuZA0KICAgICAgICBpZiBjbGVhcnRhcmdldCB+PSBuaWwgdGhlbg0KICAgICAgICBpZihzZWxmLldTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYuQ29uZmlnLmZhcm0ubGFuZWNsZWFyLnVzZVcgYW5kIHNlbGYuQ29uZmlnLktleXMubGFuZWNsZWFya2V5ICkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuZmFybS5sYW5lY2xlYXIuTWFuYSAvMTAwICkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFcoY2xlYXJ0YXJnZXQpDQogICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgICAgICAgZW5kDQogICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExpc3NhbmRyYTphdXRvcSgpDQogIA0KICAgICAgICBpZihzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuaGFyYXNzLk1hbmEgLzEwMCApIGFuZCBzZWxmLnRzcS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuaGFyYXNzLmF1dG9xICkgdGhlbiAgICAgICAgDQogICAgICAgICAgc2VsZjpDYXN0UShzZWxmLnRzcS50YXJnZXQpDQogICAgICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExpc3NhbmRyYTpKdW5nbGVDbGVhcigpDQogIGxvY2FsIGNsZWFydGFyZ2V0ID0gbmlsDQogICAgICBzZWxmLmVuZW15TWluaW9uczp1cGRhdGUoKQ0KICAgICAgc2VsZi5vdGhlck1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIHNlbGYuanVuZ2xlTWluaW9uczp1cGRhdGUoKQ0KICAgICAgZm9yIGksIG1pbmlvbiBpbiBpcGFpcnMoc2VsZi5lbmVteU1pbmlvbnMub2JqZWN0cykgZG8NCiAgICAgICAgaWYgVmFsaWRUYXJnZXQobWluaW9uLCA2MDApIGFuZCAoY2xlYXJ0YXJnZXQgPT0gbmlsIG9yIG5vdCBWYWxpZFRhcmdldChjbGVhcnRhcmdldCkpIHRoZW4NCiAgICAgICAgICBjbGVhcnRhcmdldCA9IG1pbmlvbg0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgZm9yIGksIGp1bmdsZW1pbmlvbiBpbiBpcGFpcnMoc2VsZi5qdW5nbGVNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICAgIGlmIFZhbGlkVGFyZ2V0KGp1bmdsZW1pbmlvbiwgNjAwKSBhbmQgKGNsZWFydGFyZ2V0ID09IG5pbCBvciBub3QgVmFsaWRUYXJnZXQoY2xlYXJ0YXJnZXQpKSB0aGVuDQogICAgICAgICAgY2xlYXJ0YXJnZXQgPSBqdW5nbGVtaW5pb24NCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGZvciBpLCBvdGhlcm1pbmlvbiBpbiBpcGFpcnMoc2VsZi5vdGhlck1pbmlvbnMub2JqZWN0cykgZG8NCiAgICAgICAgaWYgVmFsaWRUYXJnZXQob3RoZXJtaW5pb24sIDYwMCkgYW5kIChjbGVhcnRhcmdldCA9PSBuaWwgb3Igbm90IFZhbGlkVGFyZ2V0KGNsZWFydGFyZ2V0KSkgdGhlbg0KICAgICAgICAgIGNsZWFydGFyZ2V0ID0gb3RoZXJtaW5pb24NCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGlmIGNsZWFydGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGlmKHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci51c2VRIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmp1bmdsZWNsZWFya2V5ICkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0UShjbGVhcnRhcmdldCkNCiAgICAgICAgZW5kDQogICAgICAgIGlmIGNsZWFydGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGlmKHNlbGYuV1NwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci51c2VXIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmp1bmdsZWNsZWFya2V5ICkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0VyhjbGVhcnRhcmdldCkNCiAgICAgICAgZW5kDQogICAgICAgIGlmIGNsZWFydGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGlmKHNlbGYuRVNwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci51c2VFIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmp1bmdsZWNsZWFya2V5ICkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0RShjbGVhcnRhcmdldCkNCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICBlbmQNCiAgZW5kDQogIGVuZA0KICAtLSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1MaXNhbmRyYSBlbmRpbmctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogIC0tIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLUxpc2FuZHJhIGVuZGluZy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgLS0gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tTGlzYW5kcmEgZW5kaW5nLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAtLSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1MaXNhbmRyYSBlbmRpbmctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogIA0KICAtLSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1WaWt0b3IgU3RhcnQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogIC0tIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVZpa3RvciBTdGFydC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgLS0gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tVmlrdG9yIFN0YXJ0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAtLSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1WaWt0b3IgU3RhcnQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogIGNsYXNzICJWaWt0b3IiDQogIHJlcXVpcmUgJ0hQcmVkaWN0aW9uJw0KICBmdW5jdGlvbiBWaWt0b3I6X19pbml0KCkNCiAgIHNlbGYudHM9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDUyNSwgREFNQUdFX1BIWVNJQ0FMLCBmYWxzZSwgdHJ1ZSkNCiAgICBzZWxmLnRzcT0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgNjAwLCBEQU1BR0VfUEhZU0lDQUwsIGZhbHNlLCB0cnVlKQ0KICAgIHNlbGYudHN3PSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCA3MDAsIERBTUFHRV9NQUdJQywgZmFsc2UsIHRydWUpDQogICAgc2VsZi50c2U9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDEyMDAsIERBTUFHRV9NQUdJQywgZmFsc2UsIHRydWUpDQogICAgc2VsZi50c3I9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDcwMCwgREFNQUdFX01BR0lDLCBmYWxzZSwgdHJ1ZSkgDQogICAgIHNlbGYuUVNwZWxsID0gX1NwZWxsKHtTbG90ID0gX1EsIERhbWFnZU5hbWUgPSAiUSIsIFJhbmdlID0gbWF0aC5odWdlLCBXaWR0aCA9IDEsIERlbGF5ID0gMCwgU3BlZWQgPSBtYXRoLmh1Z2UsIENvbGxpc2lvbiA9IHRydWUsIEFvZSA9IGZhbHNlLCBUeXBlID0gU1BFTExfVFlQRS5UQVJHRVRURUR9KQ0KICAgICBzZWxmLldTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9XLCBEYW1hZ2VOYW1lID0gIlciLCBSYW5nZSA9IG1hdGguaHVnZSwgV2lkdGggPSAxMjUsIERlbGF5ID0gMC41LCBTcGVlZCA9IDc1MCwgQ29sbGlzaW9uID0gZmFsc2UsIEFvZSA9IHRydWUsIFR5cGUgPSBTUEVMTF9UWVBFLkNJUkNVTEFSfSkNCiAgICAgc2VsZi5FU3BlbGwgPSBfU3BlbGwoe1Nsb3QgPSBfRSwgRGFtYWdlTmFtZSA9ICJFIiwgUmFuZ2UgPSAxMjAwLCBXaWR0aCA9IDkwLCBEZWxheSA9IDAsIFNwZWVkID0gbWF0aC5odWdlLCBDb2xsaXNpb24gPSB0cnVlLCBBb2UgPSBmYWxzZSwgVHlwZSA9IFNQRUxMX1RZUEUuTElORUFSfSkNCiAgICAgc2VsZi5SU3BlbGwgPSBfU3BlbGwoe1Nsb3QgPSBfUiwgRGFtYWdlTmFtZSA9ICJSIiwgUmFuZ2UgPTcwMCwgV2lkdGggPSAwLCBEZWxheSA9IDAuMjUsIFNwZWVkID0gMTAwMCwgQ29sbGlzaW9uID0gZmFsc2UsIEFvZSA9IHRydWUsIFR5cGUgPSBTUEVMTF9UWVBFLkNJUkNVTEFSfSkNCiAgICAgc2VsZi5JZ25pdGUgPSBfU3BlbGwoe1Nsb3QgPSBGaW5kU3VtbW9uZXJTbG90KCJzdW1tb25lcmRvdCIpLCBEYW1hZ2VOYW1lID0gIklHTklURSIsIFJhbmdlID0gNjAwLCBUeXBlID0gU1BFTExfVFlQRS5UQVJHRVRURUR9KQ0KICAgICBzZWxmLkhQcmVkID0gSFByZWRpY3Rpb24oKQ0KICAgICBzZWxmLkUgPSB7UmFuZ2UxID0gNTUwLCBSYW5nZTIgPSA3MDAsIHdpZHRoID0gMTgwLCByZWFkeX0NCiAgICAgc2VsZi5FUmFuZ2UgPSBzZWxmLkUuUmFuZ2UxK3NlbGYuRS5SYW5nZTINCiAgLS18PiBNaW5pb24gTWFuYWdlcnMNCiAgICAgIHNlbGYuZW5lbXlNaW5pb25zICAgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9FTkVNWSwgICA2NTAsIG15SGVybywgTUlOSU9OX1NPUlRfTUFYSEVBTFRIX0RFQykNCiAgICAgIHNlbGYuYWxseU1pbmlvbnMgICAgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9BTExZLCAgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgICAgc2VsZi5qdW5nbGVNaW5pb25zICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX0pVTkdMRSwgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgICAgc2VsZi5vdGhlck1pbmlvbnMgICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX09USEVSLCAgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgICAgICAgICAgICBzZWxmOkxvYWRNZW51KCkNCiAgICAgICAgICAgICAgc2VsZjpmaW5kb3Jid2Fsa2VyKCkNCiAgICAgICAgICAgICAgICBMYXN0X0xldmVsU3BlbGwgPSAwDQogICAgICAgICAgaWYgVklQX1VTRVIgdGhlbiBzZWxmOnNraW5oYWNrKCkgZW5kDQogICAgICAgIEFkZFRpY2tDYWxsYmFjayhmdW5jdGlvbigpIHNlbGY6VGljaygpIGVuZCkNCiAgICBBZGREcmF3Q2FsbGJhY2soZnVuY3Rpb24oKSBzZWxmOkRyYXcoKSBlbmQpDQogICAgLS1BZGRNc2dDYWxsYmFjayhmdW5jdGlvbihtc2csS2V5KSBzZWxmOlduZE1zZyhtc2csS2V5KSBlbmQpDQogICAgLS1BZGRBbmltYXRpb25DYWxsYmFjayhmdW5jdGlvbih1bml0LCBhbmltYXRpb24pIHNlbGY6QW5pbWF0aW9uKHVuaXQsIGFuaW1hdGlvbikgZW5kKQ0KICAgIC0tQWRkUHJvY2Vzc1NwZWxsQ2FsbGJhY2soZnVuY3Rpb24odW5pdCwgc3BlbGwpIHNlbGY6UHJvY2Vzc1NwZWxsKHVuaXQsIHNwZWxsKSBlbmQpDQogICAgLS1BZGRBcHBseUJ1ZmZDYWxsYmFjayhmdW5jdGlvbihzb3VyY2UsIHVuaXQsIGJ1ZmYpIHNlbGY6T25BcHBseUJ1ZmYoc291cmNlLCB1bml0LCBidWZmKSBlbmQpDQogICAgLS1BZGRVcGRhdGVCdWZmQ2FsbGJhY2soZnVuY3Rpb24odW5pdCwgYnVmZiwgc3RhY2tzKSBzZWxmOlVwZGF0ZUJ1ZmYodW5pdCwgYnVmZiwgc3RhY2tzKSBlbmQpDQogICAgLS1BZGRSZW1vdmVCdWZmQ2FsbGJhY2soZnVuY3Rpb24odW5pdCwgYnVmZikgc2VsZjpPblJlbW92ZUJ1ZmYodW5pdCwgYnVmZikgZW5kKSANCiAgICAgIGVuZA0KICAtLSBoYW5kbGVzIHNjcmlwdCBsb2dpYywgYSBwdXJlIGhpZ2ggc3BlZWQgbG9vcA0KICBmdW5jdGlvbiBWaWt0b3I6VGljaygpDQogICAgICAgc2VsZjphdXRvemhvbnlhKCkNCiAgICAgICAgICAgaWYgVklQX1VTRVIgdGhlbiBzZWxmOmF1dG9sZXZlbCgpIGVuZA0KICAgaWYoc2VsZi5Db25maWcuY29tYm8uY29tYm9rZXkgKXRoZW4NCiAgICAgIHNlbGY6Y29tYm8oKQ0KICAgIGVuZA0KICAgIGlmKHNlbGYuQ29uZmlnLmxhbmVjbGVhci5sYW5lY2xlYXJrZXkpdGhlbg0KICAgICAgc2VsZjpMYW5lQ2xlYXIoKQ0KICAgIGVuZA0KICAgICAgaWYoc2VsZi5Db25maWcuanVuZ2xlY2xlYXIuanVuZ2xlY2xlYXJrZXkpdGhlbg0KICAgICAgc2VsZjpKdW5nbGVDbGVhcigpDQogICAgZW5kDQogICAgaWYoc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzICkgdGhlbg0KICAgICAgc2VsZjpraWxsc3RlYWwoKQ0KICAgIGVuZA0KICAgIGlmKHNlbGYuQ29uZmlnLmhhcmFzcy5oYXJhc3NrZXkgb3Igc2VsZi5Db25maWcuaGFyYXNzLmhhcmFzc3RvZ2xlICkgdGhlbg0KICAgICAgc2VsZjpoYXJhc3MoKQ0KICAgIGVuZA0KICAgICAgZW5kDQogIGZ1bmN0aW9uIFZpa3RvcjpMb2FkTWVudSgpDQogICAgICAgIHNlbGYuQ29uZmlnPXNjcmlwdENvbmZpZygiIi4uU2NyaXB0bmFtZS4uIiIsIm1lbnUiKQ0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJIaXRjaGFuY2UiLCAiaGl0IikNCiAgICAgICAgc2VsZi5Db25maWcuaGl0OmFkZFBhcmFtKCJFIiwgIkUgSGl0Q2hhbmNlIChEZWZhdWx0IHZhbHVlID0gMS42KSIsIFNDUklQVF9QQVJBTV9TTElDRSwgMS42LCAxLCAzLCAyKQ0KICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJDb21ibyBTZXR0aW5ncyIsICJjb21ibyIpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJjb21ib2tleSIsICJDb21ibyBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgMzIpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VRIiwgIlVzZSBRIGluIENvbWJvIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlVyIsICJVc2UgVyBpbiBDb21ibyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZUUiLCAiVXNlIEUgaW4gY29tYm8iLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VSIiwgIlVzZSBSIGluIGNvbWJvIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlSSIsICJVc2UgSWduaXRlIGlmIHRhcmdldCBraWxsYWJsZSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oImxvZ2ljIiwgIlVsdGkgTG9naWMiLCBTQ1JJUFRfUEFSQU1fTElTVCwgMSwgeyJVc2UgVWx0aSBJZiBUYXJnZXQgSXMgS2lsbGFibGUiLH0pIC0tKCJVc2UgVWx0aSBEaXJlY3RseSIgfSkNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oIk1hbmEiLCJNYW5hIE1hbmFnZXIgJSIsU0NSSVBUX1BBUkFNX1NMSUNFLCAxMCwgMTAsIDEwMCwgMCkNCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkhhcmFzcyBTZXR0aW5ncyIsICJoYXJhc3MiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6YWRkUGFyYW0oImhhcmFzc2tleSIsICJTbWFydCBIYXJhc3MgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJDIikpDQogICAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczphZGRQYXJhbSgiaGFyYXNzdG9nbGUiLCAiU21hcnQgQXV0byBIYXJhc3MiLCAgIFNDUklQVF9QQVJBTV9PTktFWVRPR0dMRSwgZmFsc2UsIHN0cmluZy5ieXRlKCJUIikpDQogICAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczphZGRQYXJhbSgidXNlUSIsICJIYXJhc3MgV2l0aCBRIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6YWRkUGFyYW0oInVzZUUiLCAiSGFyYXNzIFdpdGggRSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuaGFyYXNzOmFkZFBhcmFtKCJFIiwgIkUgSGl0Q2hhbmNlIChEZWZhdWx0IHZhbHVlID0gMikiLCBTQ1JJUFRfUEFSQU1fU0xJQ0UsIDIsIDEsIDMsIDIpDQogICAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDMwLCAxMCwgMTAwLCAwKQ0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiTGFuZUNsZWFyIFNldHRpbmdzIiwibGFuZWNsZWFyIikNCiAgICAgICAgc2VsZi5Db25maWcubGFuZWNsZWFyOmFkZFBhcmFtKCJsYW5lY2xlYXJrZXkiLCAiTGFuZSBDbGVhciBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIlYiKSkNCiAgICAgICAgc2VsZi5Db25maWcubGFuZWNsZWFyOmFkZFBhcmFtKCJ1c2VRIiwiVXNlIFEgb24gTGFuZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcubGFuZWNsZWFyOmFkZFBhcmFtKCJ1c2VFIiwiVXNlIEUgb24gTGFuZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcubGFuZWNsZWFyOmFkZFBhcmFtKCJNYW5hIiwiTWFuYSBNYW5hZ2VyICUiLFNDUklQVF9QQVJBTV9TTElDRSwgMzAsIDEwLCAxMDAsIDApDQogICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJKdW5nbGVDbGVhciBTZXR0aW5ncyIsImp1bmdsZWNsZWFyIikNCiAgICAgICAgc2VsZi5Db25maWcuanVuZ2xlY2xlYXI6YWRkUGFyYW0oImp1bmdsZWNsZWFya2V5IiwgIkp1bmdsZUNsZWFyIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiViIpKQ0KICAgICAgICBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhcjphZGRQYXJhbSgidXNlUSIsIlVzZSBRIG9uIGp1bmdsZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuanVuZ2xlY2xlYXI6YWRkUGFyYW0oInVzZUUiLCJVc2UgRSBvbiBqdW5nbGVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyOmFkZFBhcmFtKCJNYW5hIiwiTWFuYSBNYW5hZ2VyICUiLFNDUklQVF9QQVJBTV9TTElDRSwgMzAsIDEwLCAxMDAsIDApDQogICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiS2lsbFN0ZWFsIFNldHRpbmdzIiwgImtpbGxzdGVhbCIpDQogICAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgia3MiLCJLaWxsc3RlYWwgT24vT2ZmIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJ1c2VRIiwgIlN0ZWFsIFdpdGggUSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJ1c2VFIiwgIlN0ZWFsIFdpdGggRSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJ1c2VSIiwgIlN0ZWFsIFdpdGggUiIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJ1c2VJIiwgIlN0ZWFsIFdpdGggSWduaXRlIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiSXRlbSBTZXR0aW5ncyIsICJpdGVtIikNCiAgICAgICAgc2VsZi5Db25maWcuaXRlbTphZGRQYXJhbSgiZW5hYmxlYXV0b3pob255YSIsICJBdXRvIFpob255YSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLml0ZW06YWRkUGFyYW0oImF1dG96aG9ueWEiLCAiWmhvbnlhIGlmIEhlYWx0aCB1bmRlciAtPiAlIiwgU0NSSVBUX1BBUkFNX1NMSUNFLCAxMCwgMCwgMTAwLCAwKQ0KICAgICAgICANCiAgICAgICAgICAgICAgaWYgVklQX1VTRVIgdGhlbg0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJWSVAgU2V0dGluZ3MiLCAidmlwIikNCiAgICAgICAgc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJwYWNrZXQiLCJVc2UgUGFja2V0IENhc3RpbmciLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvMSIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvMiIsICJUbyB1c2UgdmlwIHNldHRpbmdzLCBQYWNrZXQgQ2FzdGluZyBzaG91bGQgYmUgb3Blbi4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgc2VsZi5Db25maWcudmlwOmFkZFN1Yk1lbnUoIkF1dG8gTGV2ZWwgU2V0dGluZ3MiLCAibGV2ZWwiKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXAubGV2ZWw6YWRkUGFyYW0oImtleSIsIlVzZSBBdXRvIExldmVsIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcC5sZXZlbDphZGRQYXJhbSgibG9naWMiLCAiU2VsZWN0IFNraWxsIE9yZGVyIiwgU0NSSVBUX1BBUkFNX0xJU1QsIDcsIHsiRm9jdXMgUT5XPkUiLCAiRm9jdXMgUT5FPlciLCJGb2N1cyBXPlE+RSIsIkZvY3VzIFc+RT5RIiwiRm9jdXMgRT5XPlEiLCAiRm9jdXMgRT5RPlciLCAiU21hcnQiICB9KQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXA6YWRkU3ViTWVudSgiU2tpbiBIYWNrIFNldHRpbmdzIiwgInNraW4iKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXAuc2tpbjphZGRQYXJhbSgia2V5IiwiVXNlIFNraW4gSGFjayIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXAuc2tpbjphZGRQYXJhbSgnc2VsZWN0ZWQnIC4uIG15SGVyby5jaGFyTmFtZSAuLiAnU2tpbicsICJTZWxlY3QgU2tpbiIsIFNDUklQVF9QQVJBTV9MSVNULCAxLCB7Ik9yaWdpbmFsIiwgIkZ1bGwgTWFjaGluZSBWaWt0b3IgIiwiUHJvdG90eXBlIFZpa3RvciAiLCJDcmVhdG9yIFZpa3RvciAiIH0pDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcC5za2luOmFkZFBhcmFtKCJpbmZvNCIsICJUbyB1c2Ugc2tpbiBoYWNrLCBZb3UgbmVlZCB0byAyeCBGOSBhZnRlciB5b3Ugc2VsZWN0IHRoZSBza2luIHlvdSBkZXNpcmUuIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcC5za2luOmFkZFBhcmFtKCJpbmZvNSIsICJNYWtlIHN1cmUgdGhhdCB1c2luZyBwYWNrZXQgY2FzdGluZyBpcyBPTi4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgLS1zZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm81IiwgIlNraW4gSGFjayB0ZW1wb3JhcnkgZGlzYWJsZWQgdW50aWwgbmV4dCB1cGRhdGUuIC4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgLS1bW3NlbGYuQ29uZmlnLnZpcDphZGRTdWJNZW51KCJBbnRpLUFGSyBTZXR0aW5ncyIsICJhbnRpYWZrIikNCiAgICAgICAgc2VsZi5Db25maWcudmlwLmFudGlhZms6YWRkUGFyYW0oImFudGlhZmsiLCJVc2UgQW50aSBBZmsiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkgXV0NCiAgICAgICAgc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvMyIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvNCIsICJUbyB1c2UgdmlwIHNldHRpbmdzLCBZb3UgbmVlZCB0byBiZSBhIFZJUCB1c2VyIG9uIEJPTCBjb21tdW5pdHkuIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgZW5kDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkRyYXcgU2V0dGluZ3MiLCJvdGhlciIpDQogICAgICAgIC0tc2VsZi5Db25maWcub3RoZXI6YWRkU3ViTWVudSgiU2hvdyBEYW1hZ2UgT24gSHAgQmFyIiwgIkhQQkFSIikNCiAgICAgICAgLS1zZWxmLkNvbmZpZy5vdGhlci5IUEJBUjphZGRQYXJhbSgia2V5IiwiT04vT0ZGIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXI6YWRkU3ViTWVudSgiU2tpbGwgRHJhd2luZyBTZXR0aW5ncyIsICJkcmF3IikNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgicWRyYXciLCJRIFNraWxsIERyYXdpbmdzIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgid2RyYXciLCJXIFNraWxsIERyYXdpbmdzIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgiZWRyYXciLCJFIFNraWxsIERyYXdpbmdzIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgicmRyYXciLCJSIFNraWxsIERyYXdpbmdzIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgiYWFkcmF3IiwiQXV0byBBdHRhY2sgUmFuZ2UiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIlRhcmdldHNlbGVjdG9ycyIsInRhcmdldHNlbCIpDQogICAgIHNlbGYudHMubmFtZSAgPSAiVmlrdG9yIg0KICAgICAgc2VsZi50c3EubmFtZSA9ICJWaWt0b3JRIg0KICAgICAgc2VsZi50c3cubmFtZSA9ICJWaWt0b3JXIg0KICAgICAgc2VsZi50c2UubmFtZSA9ICJWaWt0b3JFIg0KICAgICAgc2VsZi50c3IubmFtZSA9ICJWaWt0b3JSIg0KICAgICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFRTKHNlbGYudHMpDQogICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkVFMoc2VsZi50c3EpDQogICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkVFMoc2VsZi50c3cpDQogICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkVFMoc2VsZi50c2UpDQogICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkVFMoc2VsZi50c3IpIA0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiS2V5cyBTZXR0aW5ncyIsICJLZXlzIikNCiAgICAgIE9yYndhbGtNYW5hZ2VyOkxvYWRDb21tb25LZXlzKHNlbGYuQ29uZmlnLktleXMpDQogICAgICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvMyIsICJfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3giLCAiICAgICAgICAgICAgICAgIi4uU2NyaXB0bmFtZS4uIiIsIFNDUklQVF9QQVJBTV9JTkZPLCAiIikgDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3gyIiwgIiAgICAgICAgICAgICAgICAgU2NyaXB0IFZlcnNpb246ICAiLi5WZXJzaW9uLi4gIiAgICAgICAgICIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94NiIsICIgICAgICAgICAgICBTY3JpcHQgd2FzIG1hZGUgYnkgICIuLkF1dGhvci4uICIgICAgICAgICAiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDUiLCAiICAgICAgIExlYXVnZSBPZiBMZWdlbmRzIFZlcnNpb246ICAiLi5MVmVyc2lvbi4uICIgICAgICAgICAiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICANCiAgICAgICBzZWxmLkNvbmZpZzpwZXJtYVNob3coImluZm9ib3giKQ0KICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOnBlcm1hU2hvdygiY29tYm9rZXkiKQ0KICAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczpwZXJtYVNob3coImhhcmFzc3RvZ2xlIikNCiAgICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6cGVybWFTaG93KCJoYXJhc3NrZXkiKQ0KICAgIA0KICBlbmQNCiAgZnVuY3Rpb24gVmlrdG9yOkRyYXcoKQ0KICAgICAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5xZHJhdyBhbmQgc2VsZi5RU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCA2MDAsIDEscmVkKQ0KICAgIGVuZA0KICANCiAgICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LndkcmF3IGFuZCBzZWxmLldTcGVsbDpJc1JlYWR5KCkgdGhlbg0KICAgICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDcwMCwgMSwgcmVkKQ0KICAgIGVuZA0KICANCiAgICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LmVkcmF3IGFuZCBzZWxmLkVTcGVsbDpJc1JlYWR5KCkgdGhlbg0KICAgICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDEyMDAsIDEsIHJlZCkNCiAgICBlbmQNCiAgICANCiAgICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LnJkcmF3IGFuZCBzZWxmLlJTcGVsbDpJc1JlYWR5KCkgdGhlbg0KICAgICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDcwMCwxLCByZWQpDQogICAgZW5kDQogICAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5hYWRyYXcgdGhlbg0KICAgICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDUyNSwxLCBBUkdCKDI1NSwgMjU1LDAsMCkpDQogICAgZW5kDQogIGVuZA0KICANCiAgZnVuY3Rpb24gVmlrdG9yOnNraW5oYWNrKCkNCiAgaWYgbm90IHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgdGhlbiBTZW5kU2tpblBhY2tldChteUhlcm8uY2hhck5hbWUsIHNraW5zUEJbMV0sIG15SGVyby5uZXR3b3JrSUQpOyBlbHNlDQogIGlmIHNlbGYuQ29uZmlnLnZpcC5za2luLmtleSBhbmQgc2VsZi5Db25maWcudmlwLnBhY2tldCAgdGhlbg0KICBTZW5kU2tpblBhY2tldChteUhlcm8uY2hhck5hbWUsIHNraW5zUEJbc2VsZi5Db25maWcudmlwLnNraW5bJ3NlbGVjdGVkJyAuLiBteUhlcm8uY2hhck5hbWUgLi4gJ1NraW4nXV0sIG15SGVyby5uZXR3b3JrSUQpOw0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBWaWt0b3I6YXV0b2xldmVsKCkNCmlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gMSBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTEgPSAgIHsgMSwyLDMsMSwxLDQsMSwyLDEsMiw0LDIsMiwzLDMsNCwzLDN9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTEpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSAyIGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlMiA9ICAgeyAxLDIsMywxLDEsNCwxLDMsMSwzLDQsMywzLDIsMiw0LDIsMn0NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlMikNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDMgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2UzID0gIHsgMiwzLDEsMiwyLDQsMiwxLDIsMSw0LDEsMSwzLDMsNCwzLDN9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTMpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSA0IGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlNCA9ICB7IDIsMywxLDIsMiw0LDIsMywyLDMsNCwzLDMsMSwxLDQsMSwxfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2U0KQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gNSBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTUgPSAgeyAzLDEsMiwzLDMsNCwzLDIsMywyLDQsMiwyLDEsMSw0LDEsMX0NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlNSkNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDYgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2U2ID0gIHsgMywxLDIsMywzLDQsMywxLDMsMSw0LDEsMSwyLDIsNCwyLDJ9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTYpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDcgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2U2ID0gIHsgMSwzLDMsMiwzLDQsMywxLDMsMSw0LDEsMiwxLDIsNCwyLDJ9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTYpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIFZpa3RvcjphdXRvemhvbnlhKCkNCiAgICBpZiBzZWxmLkNvbmZpZy5pdGVtLmVuYWJsZWF1dG96aG9ueWEgdGhlbg0KICAgICBmb3IgXyA9IElURU1fMSwgSVRFTV83IGRvDQogICAgICBpZiBteUhlcm8uaGVhbHRoIDw9IChteUhlcm8ubWF4SGVhbHRoICogc2VsZi5Db25maWcuaXRlbS5hdXRvemhvbnlhIC8gMTAwKSBhbmQgKCBteUhlcm86Q2FuVXNlU3BlbGwoXykgPT0gMCBhbmQgbXlIZXJvOkdldFNwZWxsRGF0YShfKS5uYW1lID09ICJaaG9ueWFzSG91cmdsYXNzIiApdGhlbiBDYXN0U3BlbGwoXykNCiAgICBlbmQNCiAgICBlbmQNCiAgICBlbmQNCiAgICBlbmQNCiAgICBmdW5jdGlvbiBWaWt0b3I6b25seXIoKQ0KICAgIGlmIChzZWxmLlJTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwICkgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVIgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLmNvbWJva2V5IGFuZCBHZXREaXN0YW5jZShzZWxmLnRzci50YXJnZXQpPDcwMCApdGhlbg0KICAgICAgc2VsZjpDYXN0UihzZWxmLnRzci50YXJnZXQpDQogICAgICBlbmQNCiAgICBlbmQNCiAgZnVuY3Rpb24gVmlrdG9yOmNvbWJvKCkNCiAgICAgICAgc2VsZi50c3E6dXBkYXRlKCkNCiAgICAgIGlmKHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKWFuZCBzZWxmLnRzcS50YXJnZXR+PW5pbCAgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVEgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLmNvbWJva2V5ICApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFEoc2VsZi50c3EudGFyZ2V0KQ0KICAgICAgZW5kDQogICAgICBzZWxmLnRzZTp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi5FU3BlbGw6SXNSZWFkeSgpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmNvbWJvLk1hbmEgLzEwMCApYW5kIHNlbGYudHNlLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VFIGFuZCBzZWxmLkNvbmZpZy5jb21iby5jb21ib2tleSAgKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RFKHNlbGYudHNlLnRhcmdldCkNCiAgICAgIGVuZA0KICAgICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgICAgIGlmKHNlbGYuV1NwZWxsOklzUmVhZHkoKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKSBhbmQgc2VsZi50c3cudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVcgYW5kICBzZWxmLkNvbmZpZy5jb21iby5jb21ib2tleSAgKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RXKHNlbGYudHN3LnRhcmdldCkNCiAgICAgIGVuZA0KICAgICAgaWYoIHNlbGYuUlNwZWxsOklzUmVhZHkoKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKSBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUiBhbmQgc2VsZi5Db25maWcuY29tYm8uY29tYm9rZXkgKXRoZW4NCiAgICAgIGZvciBfLCB1bml0IGluIHBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvDQogICAgICAgIGxvY2FsIGRtZ1IgPWdldERtZygiUiIsdW5pdCxteUhlcm8pKyAoKG15SGVyby5hcCkqMC41NSkgDQogICAgICAgIGxvY2FsIGhlYWx0aD11bml0LmhlYWx0aA0KICAgICAgICBpZihoZWFsdGg8ZG1nUiBhbmQgc2VsZi5Db25maWcuY29tYm8ubG9naWMgPT0gMSBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUiBhbmQgR2V0RGlzdGFuY2UodW5pdCk8NzAwKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RSKHVuaXQpDQogICAgICAgZW5kDQogICAgICAgZW5kDQogICAgICAgaWYgKHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID09IDIgYW5kIHNlbGYudHNyLnRhcmdldH49bmlsKSB0aGVuDQogICAgICAgc2VsZjpvbmx5cigpDQogICAgICBlbmQNCiAgICANCiAgICAgIGlmKHNlbGYuQ29uZmlnLmNvbWJvLnVzZUkgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLmNvbWJva2V5ICl0aGVuDQogICAgICBmb3IgXywgdW5pdCBpbiBwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbw0KICAgICAgICBsb2NhbCBkbWdJID0oNTArICgobXlIZXJvLmxldmVsKSoyMCkpDQogICAgICAgIGxvY2FsIGhlYWx0aD11bml0LmhlYWx0aA0KICAgICAgICBpZihoZWFsdGg8ZG1nSSBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlSSBhbmQgR2V0RGlzdGFuY2UodW5pdCk8NjAwKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RJKHVuaXQpDQogICAgICBlbmQNCiAgICAgIGVuZA0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBWaWt0b3I6Q2FzdFEodW5pdCkNCiAgICBzZWxmLlFTcGVsbDpDYXN0KHVuaXQpDQogIGVuZA0KICANCiAgZnVuY3Rpb24gVmlrdG9yOkNhc3RXKHVuaXQpDQogICAgc2VsZi5XU3BlbGw6Q2FzdCh1bml0KQ0KICBlbmQNCiAgDQogIGZ1bmN0aW9uIFZpa3RvcjpDYXN0RSh1bml0KQ0KICAgDQogICAgaWYgdW5pdC5kZWFkIG9yIHVuaXQuaGVhbHRoID09IDAgdGhlbg0KICAgICAgcmV0dXJuDQogICAgZW5kDQogICAgDQogICAgaWYgR2V0RGlzdGFuY2UodW5pdCwgbXlIZXJvKSA+IHNlbGYuRS5SYW5nZTEtNSB0aGVuDQogICAgIEVTdGFydFBvcyA9IENpcmNsZUludGVyc2VjdGlvbihteUhlcm8sIHVuaXQsIG15SGVybywgc2VsZi5FLlJhbmdlMS01KQ0KICAgIGVsc2UNCiAgICAgRVN0YXJ0UG9zID0gVmVjdG9yKHVuaXQueCwgdW5pdC55LCB1bml0LnopDQogICAgZW5kDQogICAgDQogICAgIEVQb3MsIEVIaXRDaGFuY2UgPSBzZWxmLkhQcmVkOkdldFByZWRpY3Qoc2VsZi5IUHJlZC5QcmVzZXRzWydWaWt0b3InXVsiRSJdLCB1bml0LCBFU3RhcnRQb3MpDQogICAgDQogICAgaWYgbW9kZSA9PSAiQ29tYm8iIGFuZCBFSGl0Q2hhbmNlID49IHNlbGYuQ29uZmlnLmhpdC5FIG9yIG1vZGUgPT0gIkhhcmFzcyIgYW5kIEVIaXRDaGFuY2UgPj0gc2VsZi5Db25maWcuaGFyYXNzLkUgb3IgIG1vZGUgPT0gbmlsIGFuZCBFSGl0Q2hhbmNlID4gMSB0aGVuDQogICAgICBDYXN0U3BlbGwzKF9FLCBEM0RYVkVDVE9SMyhFU3RhcnRQb3MueCwgMCwgRVN0YXJ0UG9zLnopLCBEM0RYVkVDVE9SMyhFUG9zLngsIDAsIEVQb3MueikpDQogICAgZW5kDQogICAgDQogIGVuZA0KICANCiAgZnVuY3Rpb24gVmlrdG9yOkNhc3RSKHVuaXQpDQogICAgc2VsZi5SU3BlbGw6Q2FzdCh1bml0KQ0KICBlbmQNCiAgZnVuY3Rpb24gVmlrdG9yOkNhc3RJKHVuaXQpDQogICAgc2VsZi5JZ25pdGU6Q2FzdCh1bml0KQ0KICBlbmQNCiAgZnVuY3Rpb24gVmlrdG9yOmtpbGxzdGVhbCgpDQogIGZvciBfLCB1bml0IGluIHBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvDQogICAgICBsb2NhbCBoZWFsdGggPSB1bml0LmhlYWx0aA0KICAgICAgbG9jYWwgZG1nRSA9IGdldERtZygiRSIsIHVuaXQsIG15SGVybykgKyAoKG15SGVyby5hcCkqMC43KSArICgoZ2V0RG1nKCJFIiwgdW5pdCwgbXlIZXJvKSArICgobXlIZXJvLmFwKSowLjcpKSowLjQpDQogICAgICAgIGlmKHNlbGYudHNlLnRhcmdldCB+PSBuaWwgYW5kICBzZWxmLkVTcGVsbDpJc1JlYWR5KCkgYW5kIGhlYWx0aDxkbWdFIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlRSBhbmQgR2V0RGlzdGFuY2UodW5pdCk8NzAwICAgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0RSh1bml0KSAgDQogICAgICAgIGVuZA0KICAgICAgICBsb2NhbCBkbWdRID0gZ2V0RG1nKCJRIiwgdW5pdCwgbXlIZXJvKSArICgobXlIZXJvLmFwKSowLjMwKQ0KICAgICAgICBpZihzZWxmLnRzcS50YXJnZXQgfj0gbmlsIGFuZCAgc2VsZi5RU3BlbGw6SXNSZWFkeSgpIGFuZCBoZWFsdGg8ZG1nUSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZVEgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFEodW5pdCkgIA0KICAgICAgICBlbmQNCiAgICAgICAgIGxvY2FsIGRtZ0kgPSg1MCsgKChteUhlcm8ubGV2ZWwpKjIwKSkNCiAgICAgICAgaWYoaGVhbHRoPGRtZ0kgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VJIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgYW5kIEdldERpc3RhbmNlKHVuaXQpPDYwMCl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0SSh1bml0KQ0KICAgICAgICBlbmQNCiAgICAgICAgbG9jYWwgZG1nUiA9Z2V0RG1nKCJSIix1bml0LG15SGVybykrKChteUhlcm8uYXApKjAuNTUpIA0KICAgICAgICBpZihzZWxmLnRzci50YXJnZXQgfj0gbmlsIGFuZCAgc2VsZi5SU3BlbGw6SXNSZWFkeSgpIGFuZCBoZWFsdGg8ZG1nUiBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZVIgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyBhbmQgR2V0RGlzdGFuY2UodW5pdCk8NzAwKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RSKHVuaXQpDQogICAgICAgIGVuZA0KICAgICBlbmQNCiAgZW5kDQogIA0KICBmdW5jdGlvbiBWaWt0b3I6aGFyYXNzKCkNCiAgICBzZWxmLnRzOnVwZGF0ZSgpDQogICAgc2VsZi50c3E6dXBkYXRlKCkNCiAgICBpZiBzZWxmLkNvbmZpZy5oYXJhc3MuaGFyYXNza2V5IG9yIHNlbGYuQ29uZmlnLmhhcmFzcy5oYXJhc3N0b2dsZSAgdGhlbg0KICAgICAgICBpZihzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuaGFyYXNzLk1hbmEgLzEwMCApIGFuZCBzZWxmLnRzcS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuaGFyYXNzLnVzZVEgKSB0aGVuICAgICAgICANCiAgICAgICAgICBzZWxmOkNhc3RRKHNlbGYudHNxLnRhcmdldCkNCiAgICAgICAgZW5kICAgDQogICAgICAgIHNlbGYudHNlOnVwZGF0ZSgpDQogICAgICAgICBpZihzZWxmLkVTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuaGFyYXNzLk1hbmEgLzEwMCApIGFuZCBzZWxmLnRzZS50YXJnZXQgfj0gbmlsIGFuZCBzZWxmLkNvbmZpZy5oYXJhc3MudXNlRSAgYW5kIFZhbGlkVGFyZ2V0KHNlbGYudHNlLnRhcmdldCwgc2VsZi5FUmFuZ2UpKSB0aGVuDQogICAgICAgIHNlbGY6Q2FzdEUoc2VsZi50c2UudGFyZ2V0KQ0KICAgIGVuZA0KICANCiAgICAgICAgZW5kDQogICAgICBlbmQgICANCiAgIA0KICBmdW5jdGlvbiBWaWt0b3I6TGFuZUNsZWFyKCkNCiAgIGxvY2FsIGNsZWFydGFyZ2V0ID0gbmlsDQogICAgICBzZWxmLmVuZW15TWluaW9uczp1cGRhdGUoKQ0KICAgICAgc2VsZi5vdGhlck1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIHNlbGYuanVuZ2xlTWluaW9uczp1cGRhdGUoKQ0KICAgICAgZm9yIGksIG1pbmlvbiBpbiBpcGFpcnMoc2VsZi5lbmVteU1pbmlvbnMub2JqZWN0cykgZG8NCiAgICAgICAgaWYgVmFsaWRUYXJnZXQobWluaW9uLCA2MDApIGFuZCAoY2xlYXJ0YXJnZXQgPT0gbmlsIG9yIG5vdCBWYWxpZFRhcmdldChjbGVhcnRhcmdldCkpIHRoZW4NCiAgICAgICAgICBjbGVhcnRhcmdldCA9IG1pbmlvbg0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgZm9yIGksIGp1bmdsZW1pbmlvbiBpbiBpcGFpcnMoc2VsZi5qdW5nbGVNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICAgIGlmIFZhbGlkVGFyZ2V0KGp1bmdsZW1pbmlvbiwgNjAwKSBhbmQgKGNsZWFydGFyZ2V0ID09IG5pbCBvciBub3QgVmFsaWRUYXJnZXQoY2xlYXJ0YXJnZXQpKSB0aGVuDQogICAgICAgICAgY2xlYXJ0YXJnZXQgPSBqdW5nbGVtaW5pb24NCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGZvciBpLCBvdGhlcm1pbmlvbiBpbiBpcGFpcnMoc2VsZi5vdGhlck1pbmlvbnMub2JqZWN0cykgZG8NCiAgICAgICAgaWYgVmFsaWRUYXJnZXQob3RoZXJtaW5pb24sIDYwMCkgYW5kIChjbGVhcnRhcmdldCA9PSBuaWwgb3Igbm90IFZhbGlkVGFyZ2V0KGNsZWFydGFyZ2V0KSkgdGhlbg0KICAgICAgICAgIGNsZWFydGFyZ2V0ID0gb3RoZXJtaW5pb24NCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGlmIGNsZWFydGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGlmKHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcubGFuZWNsZWFyLnVzZVEgYW5kIHNlbGYuQ29uZmlnLmxhbmVjbGVhci5sYW5lY2xlYXJrZXkpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmxhbmVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0UShjbGVhcnRhcmdldCkNCiAgICAgICAgZW5kDQogICAgICAgaWYgY2xlYXJ0YXJnZXQgfj0gbmlsIHRoZW4NCiAgICAgICAgaWYoc2VsZi5FU3BlbGw6SXNSZWFkeSgpIGFuZCBzZWxmLkNvbmZpZy5sYW5lY2xlYXIudXNlRSBhbmQgc2VsZi5Db25maWcubGFuZWNsZWFyLmxhbmVjbGVhcmtleSkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcubGFuZWNsZWFyLk1hbmEgLzEwMCApIHRoZW4NCiAgICAgICAgbG9jYWwgQmVzdFBvcywgQmVzdEhpdCA9IEdldEJlc3RMaW5lRmFybVBvc2l0aW9uKHNlbGYuRVNwZWxsLlJhbmdlLCBzZWxmLkVTcGVsbC5XaWR0aCwgc2VsZi5lbmVteU1pbmlvbnMub2JqZWN0cyApDQogICAgICAgIGlmIEJlc3RQb3Mgfj0gbmlsIGFuZCBCZXN0SGl0ID49IDEgdGhlbg0KICAgICAgICAgQ2FzdFNwZWxsKF9FLCBCZXN0UG9zLngsIEJlc3RQb3MueikNCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICBlbmQNCiAgICBlbmQNCiAgICBlbmQNCiAgICBmdW5jdGlvbiBWaWt0b3I6SnVuZ2xlQ2xlYXIoKQ0KICAgbG9jYWwgY2xlYXJ0YXJnZXQgPSBuaWwNCiAgICAgIHNlbGYuZW5lbXlNaW5pb25zOnVwZGF0ZSgpDQogICAgICBzZWxmLm90aGVyTWluaW9uczp1cGRhdGUoKQ0KICAgICAgc2VsZi5qdW5nbGVNaW5pb25zOnVwZGF0ZSgpDQogICAgICBmb3IgaSwganVuZ2xlbWluaW9uIGluIGlwYWlycyhzZWxmLmp1bmdsZU1pbmlvbnMub2JqZWN0cykgZG8NCiAgICAgICAgaWYgVmFsaWRUYXJnZXQoanVuZ2xlbWluaW9uLCA2MDApIGFuZCAoY2xlYXJ0YXJnZXQgPT0gbmlsIG9yIG5vdCBWYWxpZFRhcmdldChjbGVhcnRhcmdldCkpIHRoZW4NCiAgICAgICAgICBjbGVhcnRhcmdldCA9IGp1bmdsZW1pbmlvbg0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgaWYgY2xlYXJ0YXJnZXQgfj0gbmlsIHRoZW4NCiAgICAgICAgaWYoc2VsZi5RU3BlbGw6SXNSZWFkeSgpIGFuZCBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhci51c2VRIGFuZCBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhci5qdW5nbGVjbGVhcmtleSkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuanVuZ2xlY2xlYXIuTWFuYSAvMTAwICkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFEoY2xlYXJ0YXJnZXQpDQogICAgICAgIGVuZA0KICAgICAgICBpZiBjbGVhcnRhcmdldCB+PSBuaWwgdGhlbg0KICAgICAgICBpZihzZWxmLkVTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyLnVzZUUgYW5kIHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyLmp1bmdsZWNsZWFya2V5KSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0RShjbGVhcnRhcmdldCkNCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICBlbmQNCiAgICBlbmQNCiAgZnVuY3Rpb24gaXRlbWZpeCgpDQogIA0KICAgIEl0ZW1OYW1lcyAgICAgICA9IHsNCiAgICAgIFszMzAzXSAgICAgICAgPSAiQXJjaEFuZ2Vsc0R1bW15U3BlbGwiLA0KICAgICAgWzMwMDddICAgICAgICA9ICJBcmNoQW5nZWxzRHVtbXlTcGVsbCIsDQogICAgICBbMzE0NF0gICAgICAgID0gIkJpbGdld2F0ZXJDdXRsYXNzIiwNCiAgICAgIFszMTg4XSAgICAgICAgPSAiSXRlbUJsYWNrZmlyZVRvcmNoIiwNCiAgICAgIFszMTUzXSAgICAgICAgPSAiSXRlbVN3b3JkT2ZGZWFzdEFuZEZhbWluZSIsDQogICAgICBbMzQwNV0gICAgICAgID0gIlRyaW5rZXRTd2VlcGVyTHZsMSIsDQogICAgICBbMzQxMV0gICAgICAgID0gIlRyaW5rZXRPcmJMdmwxIiwNCiAgICAgIFszMTY2XSAgICAgICAgPSAiVHJpbmtldFRvdGVtTHZsMSIsDQogICAgICBbMzQ1MF0gICAgICAgID0gIk9kaW5Ucmlua2V0UmV2aXZlIiwNCiAgICAgIFsyMDQxXSAgICAgICAgPSAiSXRlbUNyeXN0YWxGbGFzayIsDQogICAgICBbMjA1NF0gICAgICAgID0gIkl0ZW1LaW5nUG9yb1NuYWNrIiwNCiAgICAgIFsyMTM4XSAgICAgICAgPSAiRWxpeGlyT2ZJcm9uIiwNCiAgICAgIFsyMTM3XSAgICAgICAgPSAiRWxpeGlyT2ZSdWluIiwNCiAgICAgIFsyMTM5XSAgICAgICAgPSAiRWxpeGlyT2ZTb3JjZXJ5IiwNCiAgICAgIFsyMTQwXSAgICAgICAgPSAiRWxpeGlyT2ZXcmF0aCIsDQogICAgICBbMzE4NF0gICAgICAgID0gIk9kaW5FbnRyb3BpY0NsYXltb3JlIiwNCiAgICAgIFsyMDUwXSAgICAgICAgPSAiSXRlbU1pbmlXYXJkIiwNCiAgICAgIFszNDAxXSAgICAgICAgPSAiSGVhbHRoQm9tYiIsDQogICAgICBbMzM2M10gICAgICAgID0gIlRyaW5rZXRPcmJMdmwzIiwNCiAgICAgIFszMDkyXSAgICAgICAgPSAiSXRlbUdsYWNpYWxTcGlrZUNhc3QiLA0KICAgICAgWzM0NjBdICAgICAgICA9ICJBc2NXYXJwIiwNCiAgICAgIFszMzYxXSAgICAgICAgPSAiVHJpbmtldFRvdGVtTHZsMyIsDQogICAgICBbMzM2Ml0gICAgICAgID0gIlRyaW5rZXRUb3RlbUx2bDQiLA0KICAgICAgWzMxNTldICAgICAgICA9ICJIZXh0ZWNoU3dlZXBlciIsDQogICAgICBbMjA1MV0gICAgICAgID0gIkl0ZW1Ib3JuIiwNCiAgICAgIC0tWzIwMDNdICAgICAgPSAiUmVnZW5lcmF0aW9uUG90aW9uIiwNCiAgICAgIFszMTQ2XSAgICAgICAgPSAiSGV4dGVjaEd1bmJsYWRlIiwNCiAgICAgIFszMTg3XSAgICAgICAgPSAiSGV4dGVjaFN3ZWVwZXIiLA0KICAgICAgWzMxOTBdICAgICAgICA9ICJJcm9uU3R5bHVzIiwNCiAgICAgIFsyMDA0XSAgICAgICAgPSAiRmxhc2tPZkNyeXN0YWxXYXRlciIsDQogICAgICBbMzEzOV0gICAgICAgID0gIkl0ZW1NZXJjdXJpYWwiLA0KICAgICAgWzMyMjJdICAgICAgICA9ICJJdGVtTW9yZWxsb3NCYW5lIiwNCiAgICAgIFszMDQyXSAgICAgICAgPSAiTXVyYW1hbmEiLA0KICAgICAgWzMwNDNdICAgICAgICA9ICJNdXJhbWFuYSIsDQogICAgICBbMzE4MF0gICAgICAgID0gIk9keW5zVmVpbCIsDQogICAgICBbMzA1Nl0gICAgICAgID0gIkl0ZW1GYWl0aFNoYWtlciIsDQogICAgICBbMjA0N10gICAgICAgID0gIk9yYWNsZUV4dHJhY3RTaWdodCIsDQogICAgICBbMzM2NF0gICAgICAgID0gIlRyaW5rZXRTd2VlcGVyTHZsMyIsDQogICAgICBbMjA1Ml0gICAgICAgID0gIkl0ZW1Qb3JvU25hY2siLA0KICAgICAgWzMxNDBdICAgICAgICA9ICJRdWlja3NpbHZlclNhc2giLA0KICAgICAgWzMxNDNdICAgICAgICA9ICJSYW5kdWluc09tZW4iLA0KICAgICAgWzMwNzRdICAgICAgICA9ICJJdGVtVGlhbWF0Q2xlYXZlIiwNCiAgICAgIFszODAwXSAgICAgICAgPSAiSXRlbVJpZ2h0ZW91c0dsb3J5IiwNCiAgICAgIFsyMDQ1XSAgICAgICAgPSAiSXRlbUdob3N0V2FyZCIsDQogICAgICBbMzM0Ml0gICAgICAgID0gIlRyaW5rZXRPcmJMdmwxIiwNCiAgICAgIFszMDQwXSAgICAgICAgPSAiSXRlbVNlcmFwaHNFbWJyYWNlIiwNCiAgICAgIFszMDQ4XSAgICAgICAgPSAiSXRlbVNlcmFwaHNFbWJyYWNlIiwNCiAgICAgIFsyMDQ5XSAgICAgICAgPSAiSXRlbUdob3N0V2FyZCIsDQogICAgICBbMzM0NV0gICAgICAgID0gIk9kaW5Ucmlua2V0UmV2aXZlIiwNCiAgICAgIFsyMDQ0XSAgICAgICAgPSAiU2lnaHRXYXJkIiwNCiAgICAgIFszMzQxXSAgICAgICAgPSAiVHJpbmtldFN3ZWVwZXJMdmwxIiwNCiAgICAgIFszMDY5XSAgICAgICAgPSAic2h1cmVseWFzY3Jlc3QiLA0KICAgICAgWzM1OTldICAgICAgICA9ICJLYWxpc3RhUFNwZWxsQ2FzdCIsDQogICAgICBbMzE4NV0gICAgICAgID0gIkhleHRlY2hTd2VlcGVyIiwNCiAgICAgIFszMDc3XSAgICAgICAgPSAiSXRlbVRpYW1hdENsZWF2ZSIsDQogICAgICBbMjAwOV0gICAgICAgID0gIkl0ZW1NaW5pUmVnZW5Qb3Rpb24iLA0KICAgICAgWzIwMTBdICAgICAgICA9ICJJdGVtTWluaVJlZ2VuUG90aW9uIiwNCiAgICAgIFszMDIzXSAgICAgICAgPSAiSXRlbVdyYWl0aENvbGxhciIsDQogICAgICBbMzI5MF0gICAgICAgID0gIkl0ZW1XcmFpdGhDb2xsYXIiLA0KICAgICAgWzIwNDNdICAgICAgICA9ICJWaXNpb25XYXJkIiwNCiAgICAgIFszMzQwXSAgICAgICAgPSAiVHJpbmtldFRvdGVtTHZsMSIsDQogICAgICBbMzA5MF0gICAgICAgID0gIlpob255YXNIb3VyZ2xhc3MiLA0KICAgICAgWzMxNTRdICAgICAgICA9ICJ3cmlnZ2xlbGFudGVybiIsDQogICAgICBbMzE0Ml0gICAgICAgID0gIllvdW11c0JsYWRlIiwNCiAgICAgIFszMTU3XSAgICAgICAgPSAiWmhvbnlhc0hvdXJnbGFzcyIsDQogICAgICBbMzUxMl0gICAgICAgID0gIkl0ZW1Wb2lkR2F0ZSIsDQogICAgICBbMzEzMV0gICAgICAgID0gIkl0ZW1Tb1REIiwNCiAgICAgIFszMTM3XSAgICAgICAgPSAiSXRlbURlcnZpc2hCbGFkZSIsDQogICAgICBbMzM1Ml0gICAgICAgID0gIlJlbGljU3BvdHRlciIsDQogICAgICBbMzM1MF0gICAgICAgID0gIlRyaW5rZXRUb3RlbUx2bDIiLA0KICAgIH0NCiAgICANCiAgICBfRy5JVEVNXzEgICAgICAgPSAwNg0KICAgIF9HLklURU1fMiAgICAgICA9IDA3DQogICAgX0cuSVRFTV8zICAgICAgID0gMDgNCiAgICBfRy5JVEVNXzQgICAgICAgPSAwOQ0KICAgIF9HLklURU1fNSAgICAgICA9IDEwDQogICAgX0cuSVRFTV82ICAgICAgID0gMTENCiAgICBfRy5JVEVNXzcgICAgICAgPSAxMg0KICAgIA0KICAgIF9fX0dldEludmVudG9yeVNsb3RJdGVtID0gcmF3Z2V0KF9HLCAiR2V0SW52ZW50b3J5U2xvdEl0ZW0iKQ0KICAgIF9HLkdldEludmVudG9yeVNsb3RJdGVtID0gR2V0U2xvdEl0ZW0NCiAgICANCiAgICANCiAgZW5kDQogIF9HLkxldmVsU3BlbGwgPSBmdW5jdGlvbihpZCkNCiAgbG9jYWwgb2Zmc2V0cyA9IHsgDQogICAgW19RXSA9IDB4QjgsDQogICAgW19XXSA9IDB4QkEsDQogICAgW19FXSA9IDB4NzksDQogICAgW19SXSA9IDB4N0IsDQogIH0NCiAgbG9jYWwgcCA9IENMb0xQYWNrZXQoMHgwMDUwKQ0KICBwLnZUYWJsZSA9IDB4RjM4REFDDQogIHA6RW5jb2RlRihteUhlcm8ubmV0d29ya0lEKQ0KICBwOkVuY29kZTEob2Zmc2V0c1tpZF0pDQogIHA6RW5jb2RlMSgweDNDKQ0KICBmb3IgaSA9IDEsIDQgZG8gcDpFbmNvZGUxKDB4RjYpIGVuZA0KICBmb3IgaSA9IDEsIDQgZG8gcDpFbmNvZGUxKDB4NUUpIGVuZA0KICBmb3IgaSA9IDEsIDQgZG8gcDpFbmNvZGUxKDB4RTApIGVuZA0KICBwOkVuY29kZTEoMHg1QykNCiAgcDpFbmNvZGUxKDB4RUUpDQogIHA6RW5jb2RlMSgweDI1KQ0KICBwOkVuY29kZTEoMHgwMykNCiAgU2VuZFBhY2tldChwKQ0KZW5kDQogIGZ1bmN0aW9uIENpcmNsZUludGVyc2VjdGlvbih2MSwgdjIsIGMsIHJhZGl1cykNCiAgICBhc3NlcnQoVmVjdG9yVHlwZSh2MSkgYW5kIFZlY3RvclR5cGUodjIpIGFuZCBWZWN0b3JUeXBlKGMpIGFuZCB0eXBlKHJhZGl1cykgPT0gIm51bWJlciIsICJDaXJjbGVJbnRlcnNlY3Rpb246IHdyb25nIGFyZ3VtZW50IHR5cGVzICg8VmVjdG9yPiwgPFZlY3Rvcj4sIDxWZWN0b3I+LCBpbnRlZ2VyIGV4cGVjdGVkKSIpDQogICAgDQogICAgbG9jYWwgeDEsIHkxLCB4MiwgeTIsIHgzLCB5MyA9IHYxLngsIHYxLnogb3IgdjEueSwgdjIueCwgdjIueiBvciB2Mi55LCBjLngsIGMueiBvciBjLnkNCiAgICBsb2NhbCByID0gcmFkaXVzDQogICAgbG9jYWwgeHAsIHlwLCB4bSwgeW0gPSBuaWwsIG5pbCwgbmlsLCBuaWwNCiAgICBsb2NhbCBJc09uU2VnbWVudCA9IG5pbA0KICAgIA0KICAgIGlmIHgxID09IHgyIHRoZW4NCiAgICANCiAgICAgIGxvY2FsIEIgPSBtYXRoLnNxcnQocl4yLSh4MS14MyleMikNCiAgICAgIA0KICAgICAgeHAsIHlwLCB4bSwgeW0gPSB4MSwgeTMrQiwgeDEsIHkzLUINCiAgICBlbHNlDQogICAgDQogICAgICBsb2NhbCBtID0gKHkyLXkxKS8oeDIteDEpDQogICAgICBsb2NhbCBuID0geTEtbSp4MQ0KICAgICAgbG9jYWwgQSA9IHgzLW0qKG4teTMpDQogICAgICBsb2NhbCBCID0gbWF0aC5zcXJ0KEFeMi0oMSttXjIpKih4M14yLXJeMisobi15MyleMikpDQogICAgICANCiAgICAgIHhwLCB4bSA9IChBK0IpLygxK21eMiksIChBLUIpLygxK21eMikNCiAgICAgIHlwLCB5bSA9IG0qeHArbiwgbSp4bStuDQogICAgZW5kDQogICAgDQogICAgaWYgeDEgPD0geDIgdGhlbg0KICAgICAgSXNPblNlZ21lbnQgPSB4MSA8PSB4cCBhbmQgeHAgPD0geDINCiAgICBlbHNlDQogICAgICBJc09uU2VnbWVudCA9IHgyIDw9IHhwIGFuZCB4cCA8PSB4MSAgICAgICAgDQogICAgZW5kDQogICAgICBpZiBJc09uU2VnbWVudCB0aGVuDQogICAgICByZXR1cm4gVmVjdG9yKHhwLCAwLCB5cCkNCiAgICBlbHNlDQogICAgICByZXR1cm4gVmVjdG9yKHhtLCAwLCB5bSkNCiAgICBlbmQNCiAgICANCiAgZW5kDQogIGZ1bmN0aW9uIEdldEJlc3RMaW5lRmFybVBvc2l0aW9uKHJhbmdlLCB3aWR0aCwgb2JqZWN0cykNCiAgICAgIGxvY2FsIEJlc3RQb3MgDQogICAgICBsb2NhbCBCZXN0SGl0ID0gMA0KICAgICAgZm9yIGksIG9iamVjdCBpbiBpcGFpcnMob2JqZWN0cykgZG8NCiAgICAgICAgICBsb2NhbCBFbmRQb3MgPSBWZWN0b3IobXlIZXJvLnBvcykgKyByYW5nZSAqIChWZWN0b3Iob2JqZWN0KSAtIFZlY3RvcihteUhlcm8ucG9zKSk6bm9ybWFsaXplZCgpDQogICAgICAgICAgbG9jYWwgaGl0ID0gQ291bnRPYmplY3RzT25MaW5lU2VnbWVudChteUhlcm8ucG9zLCBFbmRQb3MsIHdpZHRoLCBvYmplY3RzKQ0KICAgICAgICAgIGlmIGhpdCA+IEJlc3RIaXQgdGhlbg0KICAgICAgICAgICAgICBCZXN0SGl0ID0gaGl0DQogICAgICAgICAgICAgIEJlc3RQb3MgPSBWZWN0b3Iob2JqZWN0KQ0KICAgICAgICAgICAgICBpZiBCZXN0SGl0ID09ICNvYmplY3RzIHRoZW4NCiAgICAgICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgIGVuZA0KICAgICAgZW5kDQogIA0KICAgICAgcmV0dXJuIEJlc3RQb3MsIEJlc3RIaXQNCiAgZW5kDQogIA0KICBmdW5jdGlvbiBDb3VudE9iamVjdHNPbkxpbmVTZWdtZW50KFN0YXJ0UG9zLCBFbmRQb3MsIHdpZHRoLCBvYmplY3RzKQ0KICAgICAgbG9jYWwgbiA9IDANCiAgICAgIGZvciBpLCBvYmplY3QgaW4gaXBhaXJzKG9iamVjdHMpIGRvDQogICAgICAgICAgbG9jYWwgcG9pbnRTZWdtZW50LCBwb2ludExpbmUsIGlzT25TZWdtZW50ID0gVmVjdG9yUG9pbnRQcm9qZWN0aW9uT25MaW5lU2VnbWVudChTdGFydFBvcywgRW5kUG9zLCBvYmplY3QpDQogICAgICAgICAgaWYgaXNPblNlZ21lbnQgYW5kIEdldERpc3RhbmNlU3FyKHBvaW50U2VnbWVudCwgb2JqZWN0KSA8IHdpZHRoICogd2lkdGggdGhlbg0KICAgICAgICAgICAgICBuID0gbiArIDENCiAgICAgICAgICBlbmQNCiAgICAgIGVuZA0KICANCiAgICAgIHJldHVybiBuDQogIGVuZA0KICBmdW5jdGlvbiBDb3VudE9iamVjdHNOZWFyUG9zKHBvcywgcmFuZ2UsIHJhZGl1cywgb2JqZWN0cykNCiAgICAgIGxvY2FsIG4gPSAwDQogICAgICBmb3IgaSwgb2JqZWN0IGluIGlwYWlycyhvYmplY3RzKSBkbw0KICAgICAgICAgIGlmIEdldERpc3RhbmNlU3FyKHBvcywgb2JqZWN0KSA8PSByYWRpdXMgKiByYWRpdXMgdGhlbg0KICAgICAgICAgICAgICBuID0gbiArIDENCiAgICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgcmV0dXJuIG4NCiAgZW5kDQogIGZ1bmN0aW9uIEdldEJlc3RDaXJjdWxhckZhcm1Qb3NpdGlvbihyYW5nZSwgcmFkaXVzLCBvYmplY3RzKQ0KICAgICAgbG9jYWwgQmVzdFBvcyANCiAgICAgIGxvY2FsIEJlc3RIaXQgPSAwDQogICAgICBmb3IgaSwgb2JqZWN0IGluIGlwYWlycyhvYmplY3RzKSBkbw0KICAgICAgICAgIGxvY2FsIGhpdCA9IENvdW50T2JqZWN0c05lYXJQb3Mob2JqZWN0LnBvcyBvciBvYmplY3QsIHJhbmdlLCByYWRpdXMsIG9iamVjdHMpDQogICAgICAgICAgaWYgaGl0ID4gQmVzdEhpdCB0aGVuDQogICAgICAgICAgICAgIEJlc3RIaXQgPSBoaXQNCiAgICAgICAgICAgICAgQmVzdFBvcyA9IFZlY3RvcihvYmplY3QpDQogICAgICAgICAgICAgIGlmIEJlc3RIaXQgPT0gI29iamVjdHMgdGhlbg0KICAgICAgICAgICAgICAgICBicmVhaw0KICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIHJldHVybiBCZXN0UG9zLCBCZXN0SGl0DQogIGVuZA0KICBmdW5jdGlvbiBSZXF1aXJlU2ltcGxlTGliKCkNCiAgICAgIGlmIEZpbGVFeGlzdChMSUJfUEFUSC4uIlNpbXBsZUxpYi5sdWEiKSBhbmQgbm90IEZpbGVFeGlzdChTQ1JJUFRfUEFUSC4uIlNpbXBsZUxpYi5sdWEiKSB0aGVuDQogICAgICAgICAgcmVxdWlyZSAiU2ltcGxlTGliIg0KICAgICAgICAgIGlmIF9HLlNpbXBsZUxpYlZlcnNpb24gPT0gbmlsIHRoZW4gDQogICAgICAgICAgICAgIHByaW50KCJZb3VyIFNpbXBsZUxpYiBmaWxlIGlzIHdyb25nLiIpDQogICAgICAgICAgICAgIHJldHVybiBmYWxzZQ0KICAgICAgICAgIGVuZA0KICAgICAgICAgIGlmIF9HLlNpbXBsZUxpYlZlcnNpb24gPCAxLjAyIHRoZW4NCiAgICAgICAgICAgICAgcHJpbnQoIllvdSBuZWVkIHRoZSBsYXN0ZXN0IHZlcnNpb24gb2YgU2ltcGxlTGliLiIpDQogICAgICAgICAgICAgIHJldHVybiBmYWxzZQ0KICAgICAgICAgIGVuZA0KICAgICAgICAgIHJldHVybiB0cnVlDQogICAgICBlbHNlaWYgRmlsZUV4aXN0KExJQl9QQVRILi4iU2ltcGxlTGliLmx1YSIpIGFuZCBGaWxlRXhpc3QoU0NSSVBUX1BBVEguLiJTaW1wbGVMaWIubHVhIikgdGhlbg0KICAgICAgICAgIHByaW50KCJTaW1wbGVMaWIubHVhIHNob3VsZCBub3QgYmUgaW4gQ3VzdG9tIFNjcmlwdCAoT25seSBvbiBDb21tb24gZm9sZGVyKSwgZGVsZXRlIGl0IGZyb20gdGhlcmUuLi4iKQ0KICAgICAgICAgIHJldHVybiBmYWxzZQ0KICAgICAgZWxzZQ0KICAgICAgICAgIGxvY2FsIGZ1bmN0aW9uIEJhc2U2NEVuY29kZTIoZGF0YSkNCiAgICAgICAgICAgICAgbG9jYWwgYj0nQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLycNCiAgICAgICAgICAgICAgcmV0dXJuICgoZGF0YTpnc3ViKCcuJywgZnVuY3Rpb24oeCkNCiAgICAgICAgICAgICAgICAgIGxvY2FsIHIsYj0nJyx4OmJ5dGUoKQ0KICAgICAgICAgICAgICAgICAgZm9yIGk9OCwxLC0xIGRvIHI9ci4uKGIlMl5pLWIlMl4oaS0xKT4wIGFuZCAnMScgb3IgJzAnKSBlbmQNCiAgICAgICAgICAgICAgICAgIHJldHVybiByOw0KICAgICAgICAgICAgICBlbmQpLi4nMDAwMCcpOmdzdWIoJyVkJWQlZD8lZD8lZD8lZD8nLCBmdW5jdGlvbih4KQ0KICAgICAgICAgICAgICAgICAgaWYgKCN4IDwgNikgdGhlbiByZXR1cm4gJycgZW5kDQogICAgICAgICAgICAgICAgICBsb2NhbCBjPTANCiAgICAgICAgICAgICAgICAgIGZvciBpPTEsNiBkbyBjPWMrKHg6c3ViKGksaSk9PScxJyBhbmQgMl4oNi1pKSBvciAwKSBlbmQNCiAgICAgICAgICAgICAgICAgIHJldHVybiBiOnN1YihjKzEsYysxKQ0KICAgICAgICAgICAgICBlbmQpLi4oeyAnJywgJz09JywgJz0nIH0pWyNkYXRhJTMrMV0pDQogICAgICAgICAgZW5kDQogICAgICAgICAgbG9jYWwgU2F2ZVBhdGggPSBMSUJfUEFUSC4uIlNpbXBsZUxpYi5sdWEiDQogICAgICAgICAgbG9jYWwgU2NyaXB0UGF0aCA9ICcvQm9ML1RDUFVwZGF0ZXIvR2V0U2NyaXB0NS5waHA/c2NyaXB0PScuLkJhc2U2NEVuY29kZTIoInJhdy5naXRodWJ1c2VyY29udGVudC5jb20vamFjaGljYW8vQm9ML21hc3Rlci9TaW1wbGVMaWIubHVhIikuLicmcmFuZD0nLi5tYXRoLnJhbmRvbSg5OTk5OTk5OSkNCiAgICAgICAgICBsb2NhbCBHb3RTY3JpcHQgPSBmYWxzZQ0KICAgICAgICAgIGxvY2FsIEx1YVNvY2tldCA9IG5pbA0KICAgICAgICAgIGxvY2FsIFNvY2tldCA9IG5pbA0KICAgICAgICAgIGxvY2FsIFNpemUgPSBuaWwNCiAgICAgICAgICBsb2NhbCBSZWN2U3RhcnRlZCA9IGZhbHNlDQogICAgICAgICAgbG9jYWwgUmVjZWl2ZSwgU3RhdHVzLCBTbmlwcGVkID0gbmlsLCBuaWwsIG5pbA0KICAgICAgICAgIGxvY2FsIFN0YXJ0ZWQgPSBmYWxzZQ0KICAgICAgICAgIGxvY2FsIEZpbGUgPSAiIg0KICAgICAgICAgIGxvY2FsIE5ld0ZpbGUgPSAiIg0KICAgICAgICAgIGlmIG5vdCBMdWFTb2NrZXQgdGhlbg0KICAgICAgICAgICAgICBMdWFTb2NrZXQgPSByZXF1aXJlKCJzb2NrZXQiKQ0KICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgU29ja2V0OmNsb3NlKCkNCiAgICAgICAgICAgICAgU29ja2V0ID0gbmlsDQogICAgICAgICAgICAgIFNpemUgPSBuaWwNCiAgICAgICAgICAgICAgUmVjdlN0YXJ0ZWQgPSBmYWxzZQ0KICAgICAgICAgIGVuZA0KICAgICAgICAgIFNvY2tldCA9IEx1YVNvY2tldC50Y3AoKQ0KICAgICAgICAgIGlmIG5vdCBTb2NrZXQgdGhlbg0KICAgICAgICAgICAgICBwcmludCgnU29ja2V0IEVycm9yJykNCiAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgIFNvY2tldDpzZXR0aW1lb3V0KDAsICdiJykNCiAgICAgICAgICAgICAgU29ja2V0OnNldHRpbWVvdXQoOTk5OTk5OTksICd0JykNCiAgICAgICAgICAgICAgU29ja2V0OmNvbm5lY3QoJ3N4LWJvbC5ldScsIDgwKQ0KICAgICAgICAgICAgICBTdGFydGVkID0gZmFsc2UNCiAgICAgICAgICAgICAgRmlsZSA9ICIiDQogICAgICAgICAgZW5kDQogICAgICAgICAgQWRkVGlja0NhbGxiYWNrKGZ1bmN0aW9uKCkNCiAgICAgICAgICAgICAgaWYgR290U2NyaXB0IHRoZW4gcmV0dXJuIGVuZA0KICAgICAgICAgICAgICBSZWNlaXZlLCBTdGF0dXMsIFNuaXBwZWQgPSBTb2NrZXQ6cmVjZWl2ZSgxMDI0KQ0KICAgICAgICAgICAgICBpZiBTdGF0dXMgPT0gJ3RpbWVvdXQnIGFuZCBub3QgU3RhcnRlZCB0aGVuDQogICAgICAgICAgICAgICAgICBTdGFydGVkID0gdHJ1ZQ0KICAgICAgICAgICAgICAgICAgcHJpbnQoIkRvd25sb2FkaW5nIGEgbGlicmFyeSBjYWxsZWQgU2ltcGxlTGliLiBQbGVhc2Ugd2FpdC4uLiIpDQogICAgICAgICAgICAgICAgICBTb2NrZXQ6c2VuZCgiR0VUICIuLlNjcmlwdFBhdGguLiIgSFRUUC8xLjFcclxuSG9zdDogc3gtYm9sLmV1XHJcblxyXG4iKQ0KICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgaWYgKFJlY2VpdmUgb3IgKCNTbmlwcGVkID4gMCkpIGFuZCBub3QgUmVjdlN0YXJ0ZWQgdGhlbg0KICAgICAgICAgICAgICAgICAgUmVjdlN0YXJ0ZWQgPSB0cnVlDQogICAgICAgICAgICAgIGVuZA0KICANCiAgICAgICAgICAgICAgRmlsZSA9IEZpbGUgLi4gKFJlY2VpdmUgb3IgU25pcHBlZCkNCiAgICAgICAgICAgICAgaWYgRmlsZTpmaW5kKCc8L3NpJy4uJ3plPicpIHRoZW4NCiAgICAgICAgICAgICAgICAgIGlmIG5vdCBTaXplIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICBTaXplID0gdG9udW1iZXIoRmlsZTpzdWIoRmlsZTpmaW5kKCc8c2knLi4nemU+JykgKyA2LCBGaWxlOmZpbmQoJzwvc2knLi4nemU+JykgLSAxKSkNCiAgICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICAgICAgaWYgRmlsZTpmaW5kKCc8c2NyJy4uJ2lwdD4nKSB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgbG9jYWwgXywgU2NyaXB0RmluZCA9IEZpbGU6ZmluZCgnPHNjcicuLidpcHQ+JykNCiAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBTY3JpcHRFbmQgPSBGaWxlOmZpbmQoJzwvc2NyJy4uJ2lwdD4nKQ0KICAgICAgICAgICAgICAgICAgICAgIGlmIFNjcmlwdEVuZCB0aGVuIFNjcmlwdEVuZCA9IFNjcmlwdEVuZCAtIDEgZW5kDQogICAgICAgICAgICAgICAgICAgICAgbG9jYWwgRG93bmxvYWRlZFNpemUgPSBGaWxlOnN1YihTY3JpcHRGaW5kICsgMSxTY3JpcHRFbmQgb3IgLTEpOmxlbigpDQogICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgIGlmIEZpbGU6ZmluZCgnPC9zY3InLi4naXB0PicpIHRoZW4NCiAgICAgICAgICAgICAgICAgIGxvY2FsIGEsYiA9IEZpbGU6ZmluZCgnXHJcblxyXG4nKQ0KICAgICAgICAgICAgICAgICAgRmlsZSA9IEZpbGU6c3ViKGEsLTEpDQogICAgICAgICAgICAgICAgICBOZXdGaWxlID0gJycNCiAgICAgICAgICAgICAgICAgIGZvciBsaW5lLGNvbnRlbnQgaW4gaXBhaXJzKEZpbGU6c3BsaXQoJ1xuJykpIGRvDQogICAgICAgICAgICAgICAgICAgICAgaWYgY29udGVudDpsZW4oKSA+IDUgdGhlbg0KICAgICAgICAgICAgICAgICAgICAgICAgICBOZXdGaWxlID0gTmV3RmlsZSAuLiBjb250ZW50DQogICAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICAgIGxvY2FsIEhlYWRlckVuZCwgQ29udGVudFN0YXJ0ID0gTmV3RmlsZTpmaW5kKCc8c2MnLi4ncmlwdD4nKQ0KICAgICAgICAgICAgICAgICAgbG9jYWwgQ29udGVudEVuZCwgXyA9IE5ld0ZpbGU6ZmluZCgnPC9zY3InLi4naXB0PicpDQogICAgICAgICAgICAgICAgICBpZiBub3QgQ29udGVudFN0YXJ0IG9yIG5vdCBDb250ZW50RW5kIHRoZW4NCiAgICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBuZXdmID0gTmV3RmlsZTpzdWIoQ29udGVudFN0YXJ0ICsgMSxDb250ZW50RW5kIC0gMSkNCiAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBuZXdmID0gbmV3Zjpnc3ViKCdccicsJycpDQogICAgICAgICAgICAgICAgICAgICAgaWYgbmV3ZjpsZW4oKSB+PSBTaXplIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuDQogICAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgICAgICAgbG9jYWwgbmV3ZiA9IEJhc2U2NERlY29kZShuZXdmKQ0KICAgICAgICAgICAgICAgICAgICAgIGlmIHR5cGUobG9hZChuZXdmKSkgfj0gJ2Z1bmN0aW9uJyB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBmID0gaW8ub3BlbihTYXZlUGF0aCwgIncrYiIpDQogICAgICAgICAgICAgICAgICAgICAgICAgIGY6d3JpdGUobmV3ZikNCiAgICAgICAgICAgICAgICAgICAgICAgICAgZjpjbG9zZSgpDQogICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCJSZXF1aXJlZCBsaWJyYXJ5IGRvd25sb2FkZWQuIFBsZWFzZSByZWxvYWQgd2l0aCAyeCBGOS4iKQ0KICAgICAgICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgICBHb3RTY3JpcHQgPSB0cnVlDQogICAgICAgICAgICAgIGVuZA0KICAgICAgICAgIGVuZCkNCiAgICAgICAgICByZXR1cm4gZmFsc2UNCiAgICAgIGVuZA0KICBlbmQNCiAgDQogIC0tIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1vcmIgd2FsayBzZXR0aW5ncyBzdGFydC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICANCiAgZnVuY3Rpb24gVmlrdG9yOmZpbmRvcmJ3YWxrZXIoKQ0KICAgaWYgX0cuUmVib3JuX0xvYWRlZCB0aGVuDQogICAgICBTQUM9dHJ1ZSBhbmQNCiAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj5TaWRhcyBBdXRvIENhcnJ5IGhhcyBiZWVuIGZvdW5kIikgZW5kLCAyKQ0KICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj5TaWRhcyBBdXRvIENhcnJ5IGludGVncmF0aW9uIGhhcyBiZWVuIGZpbmlzaGVkIHN1Y2Nlc2Z1bGx5IikgZW5kLCA4KQ0KICAgIGVsc2VpZiBub3QgX0cuUmVib3JuX0xvYWRlZCBhbmQgRmlsZUV4aXN0KExJQl9QQVRIIC4uICJTeE9yYldhbGsubHVhIikgdGhlbg0KICAgICAgU3hPcmI9dHJ1ZSBhbmQgDQogICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBwcmludCgiPGZvbnQgY29sb3I9XCIjRkYwMDAwXCI+PGI+ICIuLlNjcmlwdG5hbWUuLiIgLSA8L2I+PC9mb250Pjxmb250IGNvbG9yPVwiI0ZGRkZGRlwiPiBTeE9yYldhbGsgaGFzIGJlZW4gZm91bmQiKSBlbmQsIDIpDQogICAgICAgICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+IFN4T3JiV2FsayBpbnRlZ3JhdGlvbiBoYXMgYmVlbiBmaW5pc2hlZCBzdWNjZXNmdWxseSIpIGVuZCwgNCkNCiAgICAgIHJlcXVpcmUoIlN4T3JiV2FsayIpDQogICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJTeE9yYldhbGsiLCJvcmJXYWxrIikgZW5kLDUpDQogICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIF9HLlN4T3JiOkxvYWRUb01lbnUoc2VsZi5Db25maWcub3JiV2FsaykgZW5kLDUpDQogICAgZWxzZWlmIFNBQ349dHJ1ZSBhbmQgU3hPcmJ+PSB0cnVlIHRoZW4NCiAgICAgIHAoIj09PT09PT09PT09PT09PT09IikNCiAgICAgIHAoIj09PT09PT09PT09PT09PT09IikNCiAgICAgIHAoIlN4T3JiIG9yIFNBQzpSIGlzIHJlcXVpcmVkLiIpDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgZW5kDQogIGVuZA0KICAgIGZ1bmN0aW9uIEFrYWxpOmZpbmRvcmJ3YWxrZXIoKQ0KaWYgX0cuUmVib3JuX0xvYWRlZCB0aGVuDQogICAgICBTQUM9dHJ1ZSBhbmQNCiAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj5TaWRhcyBBdXRvIENhcnJ5IGhhcyBiZWVuIGZvdW5kIikgZW5kLCAyKQ0KICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj5TaWRhcyBBdXRvIENhcnJ5IGludGVncmF0aW9uIGhhcyBiZWVuIGZpbmlzaGVkIHN1Y2Nlc2Z1bGx5IikgZW5kLCA4KQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94MjIiLCAiQ3VycmVudCBPcmJ3YWxrZXI6ICAgICAgICAgICAgICAgICAgICAgIFNpZGFzIEF1dG8gQ2FycnkiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mbzMiLCAiX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXyIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94IiwgIiAgICAgICAgICAgICAgICIuLlNjcmlwdG5hbWUuLiIiLCBTQ1JJUFRfUEFSQU1fSU5GTywgIiIpIA0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94MiIsICIgICAgICAgICAgICAgICAgIFNjcmlwdCBWZXJzaW9uOiAgIi4uVmVyc2lvbi4uICIgICAgICAgICAiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDYiLCAiICAgICAgICAgICAgU2NyaXB0IHdhcyBtYWRlIGJ5ICAiLi5BdXRob3IuLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3g1IiwgIiAgICAgICBMZWF1Z2UgT2YgTGVnZW5kcyBWZXJzaW9uOiAgIi4uTFZlcnNpb24uLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpICAgDQogICAgZWxzZWlmIG5vdCBfRy5SZWJvcm5fTG9hZGVkIGFuZCBGaWxlRXhpc3QoTElCX1BBVEggLi4gIlN4T3JiV2Fsay5sdWEiKSB0aGVuDQogICAgICBTeE9yYj10cnVlIGFuZCANCiAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+IFN4T3JiV2FsayBoYXMgYmVlbiBmb3VuZCIpIGVuZCwgMikNCiAgICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj4gU3hPcmJXYWxrIGludGVncmF0aW9uIGhhcyBiZWVuIGZpbmlzaGVkIHN1Y2Nlc2Z1bGx5IikgZW5kLCA0KQ0KICAgICAgcmVxdWlyZSgiU3hPcmJXYWxrIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDIyIiwgIkN1cnJlbnQgT3Jid2Fsa2VyOiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3hPcmJXYWxrIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm8zIiwgIl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveCIsICIgICAgICAgICAgICAgICAiLi5TY3JpcHRuYW1lLi4iIiwgU0NSSVBUX1BBUkFNX0lORk8sICIiKSANCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDIiLCAiICAgICAgICAgICAgICAgICBTY3JpcHQgVmVyc2lvbjogICIuLlZlcnNpb24uLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3g2IiwgIiAgICAgICAgICAgIFNjcmlwdCB3YXMgbWFkZSBieSAgIi4uQXV0aG9yLi4gIiAgICAgICAgICIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94NSIsICIgICAgICAgTGVhdWdlIE9mIExlZ2VuZHMgVmVyc2lvbjogICIuLkxWZXJzaW9uLi4gIiAgICAgICAgICIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKSAgIA0KICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiU3hPcmJXYWxrIiwib3JiV2FsayIpIGVuZCw1KQ0KICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBfRy5TeE9yYjpMb2FkVG9NZW51KHNlbGYuQ29uZmlnLm9yYldhbGspIGVuZCw1KQ0KICAgIGVsc2VpZiBTQUN+PXRydWUgYW5kIFN4T3Jifj0gdHJ1ZSB0aGVuDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgICBwKCJTeE9yYiBvciBTQUM6UiBpcyByZXF1aXJlZC4iKQ0KICAgICAgcCgiPT09PT09PT09PT09PT09PT0iKQ0KICAgICAgcCgiPT09PT09PT09PT09PT09PT0iKQ0KICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGlzc2FuZHJhOmZpbmRvcmJ3YWxrZXIoKQ0KICAgaWYgX0cuUmVib3JuX0xvYWRlZCB0aGVuDQogICAgICBTQUM9dHJ1ZSBhbmQNCiAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj5TaWRhcyBBdXRvIENhcnJ5IGhhcyBiZWVuIGZvdW5kIikgZW5kLCAyKQ0KICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj5TaWRhcyBBdXRvIENhcnJ5IGludGVncmF0aW9uIGhhcyBiZWVuIGZpbmlzaGVkIHN1Y2Nlc2Z1bGx5IikgZW5kLCA4KQ0KICAgIGVsc2VpZiBub3QgX0cuUmVib3JuX0xvYWRlZCBhbmQgRmlsZUV4aXN0KExJQl9QQVRIIC4uICJTeE9yYldhbGsubHVhIikgdGhlbg0KICAgICAgU3hPcmI9dHJ1ZSBhbmQgDQogICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBwcmludCgiPGZvbnQgY29sb3I9XCIjRkYwMDAwXCI+PGI+ICIuLlNjcmlwdG5hbWUuLiIgLSA8L2I+PC9mb250Pjxmb250IGNvbG9yPVwiI0ZGRkZGRlwiPiBTeE9yYldhbGsgaGFzIGJlZW4gZm91bmQiKSBlbmQsIDIpDQogICAgICAgICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+IFN4T3JiV2FsayBpbnRlZ3JhdGlvbiBoYXMgYmVlbiBmaW5pc2hlZCBzdWNjZXNmdWxseSIpIGVuZCwgNCkNCiAgICAgIHJlcXVpcmUoIlN4T3JiV2FsayIpDQogICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJTeE9yYldhbGsiLCJvcmJXYWxrIikgZW5kLDUpDQogICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIF9HLlN4T3JiOkxvYWRUb01lbnUoc2VsZi5Db25maWcub3JiV2FsaykgZW5kLDUpDQogICAgZWxzZWlmIFNBQ349dHJ1ZSBhbmQgU3hPcmJ+PSB0cnVlIHRoZW4NCiAgICAgIHAoIj09PT09PT09PT09PT09PT09IikNCiAgICAgIHAoIj09PT09PT09PT09PT09PT09IikNCiAgICAgIHAoIlN4T3JiIG9yIFNBQzpSIGlzIHJlcXVpcmVkLiIpDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOmZpbmRvcmJ3YWxrZXIoKQ0KICAgaWYgX0cuUmVib3JuX0xvYWRlZCB0aGVuDQogICAgICBTQUM9dHJ1ZSBhbmQNCiAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj5TaWRhcyBBdXRvIENhcnJ5IGhhcyBiZWVuIGZvdW5kIikgZW5kLCAyKQ0KICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj5TaWRhcyBBdXRvIENhcnJ5IGludGVncmF0aW9uIGhhcyBiZWVuIGZpbmlzaGVkIHN1Y2Nlc2Z1bGx5IikgZW5kLCA4KQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94MjIiLCAiQ3VycmVudCBPcmJ3YWxrZXI6ICAgICAgICAgICAgICAgICAgICAgIFNpZGFzIEF1dG8gQ2FycnkiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mbzMiLCAiX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXyIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94IiwgIiAgICAgICAgICAgICAgICIuLlNjcmlwdG5hbWUuLiIiLCBTQ1JJUFRfUEFSQU1fSU5GTywgIiIpIA0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94MiIsICIgICAgICAgICAgICAgICAgIFNjcmlwdCBWZXJzaW9uOiAgIi4uVmVyc2lvbi4uICIgICAgICAgICAiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDYiLCAiICAgICAgICAgICAgU2NyaXB0IHdhcyBtYWRlIGJ5ICAiLi5BdXRob3IuLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3g1IiwgIiAgICAgICBMZWF1Z2UgT2YgTGVnZW5kcyBWZXJzaW9uOiAgIi4uTFZlcnNpb24uLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpICAgDQogICAgZWxzZWlmIG5vdCBfRy5SZWJvcm5fTG9hZGVkIGFuZCBGaWxlRXhpc3QoTElCX1BBVEggLi4gIlN4T3JiV2Fsay5sdWEiKSB0aGVuDQogICAgICBTeE9yYj10cnVlIGFuZCANCiAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+IFN4T3JiV2FsayBoYXMgYmVlbiBmb3VuZCIpIGVuZCwgMikNCiAgICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj4gU3hPcmJXYWxrIGludGVncmF0aW9uIGhhcyBiZWVuIGZpbmlzaGVkIHN1Y2Nlc2Z1bGx5IikgZW5kLCA0KQ0KICAgICAgcmVxdWlyZSgiU3hPcmJXYWxrIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDIyIiwgIkN1cnJlbnQgT3Jid2Fsa2VyOiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3hPcmJXYWxrIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm8zIiwgIl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveCIsICIgICAgICAgICAgICAgICAiLi5TY3JpcHRuYW1lLi4iIiwgU0NSSVBUX1BBUkFNX0lORk8sICIiKSANCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDIiLCAiICAgICAgICAgICAgICAgICBTY3JpcHQgVmVyc2lvbjogICIuLlZlcnNpb24uLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3g2IiwgIiAgICAgICAgICAgIFNjcmlwdCB3YXMgbWFkZSBieSAgIi4uQXV0aG9yLi4gIiAgICAgICAgICIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94NSIsICIgICAgICAgTGVhdWdlIE9mIExlZ2VuZHMgVmVyc2lvbjogICIuLkxWZXJzaW9uLi4gIiAgICAgICAgICIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKSAgIA0KICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiU3hPcmJXYWxrIiwib3JiV2FsayIpIGVuZCw1KQ0KICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBfRy5TeE9yYjpMb2FkVG9NZW51KHNlbGYuQ29uZmlnLm9yYldhbGspIGVuZCw1KQ0KICAgIGVsc2VpZiBTQUN+PXRydWUgYW5kIFN4T3Jifj0gdHJ1ZSB0aGVuDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgICBwKCJTeE9yYiBvciBTQUM6UiBpcyByZXF1aXJlZC4iKQ0KICAgICAgcCgiPT09PT09PT09PT09PT09PT0iKQ0KICAgICAgcCgiPT09PT09PT09PT09PT09PT0iKQ0KICAgIGVuZA0KICBlbmQNCiAgLS0gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLW9yYiB3YWxrIHNldHRpbmdzIHN0YXJ0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogICBmdW5jdGlvbiBEcmF3ZG1nbGliKCkNCiAgICBpZihGaWxlRXhpc3QoTElCX1BBVEguLiJEcmF3RGFtYWdlTGliLmx1YSIpKXRoZW4NCiAgICAgIGNoZWNrPTENCiAgICBlbHNlDQogICAgICBjaGVjaz0wDQogICAgZW5kIA0KICAgICBpZiBfUmVxdWlyZWQoKTpBZGQoe05hbWUgPSAiRHJhd0RhbWFnZUxpYiIsIFVybCA9ICJyYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2lubmVyb3V0L0JvdE9mTGVnZW5kcy9tYXN0ZXIvRHJhd0RhbWFnZUxpYi5sdWEifSk6Q2hlY2soKTpJc0Rvd25sb2FkaW5nKCkgdGhlbiByZXR1cm4gZW5kIA0KICBlbmQNCiAgZnVuY3Rpb24gQ2lyY2xlSW50ZXJzZWN0aW9uKHYxLCB2MiwgYywgcmFkaXVzKQ0KICAgIGFzc2VydChWZWN0b3JUeXBlKHYxKSBhbmQgVmVjdG9yVHlwZSh2MikgYW5kIFZlY3RvclR5cGUoYykgYW5kIHR5cGUocmFkaXVzKSA9PSAibnVtYmVyIiwgIkNpcmNsZUludGVyc2VjdGlvbjogd3JvbmcgYXJndW1lbnQgdHlwZXMgKDxWZWN0b3I+LCA8VmVjdG9yPiwgPFZlY3Rvcj4sIGludGVnZXIgZXhwZWN0ZWQpIikNCiAgICANCiAgICBsb2NhbCB4MSwgeTEsIHgyLCB5MiwgeDMsIHkzID0gdjEueCwgdjEueiBvciB2MS55LCB2Mi54LCB2Mi56IG9yIHYyLnksIGMueCwgYy56IG9yIGMueQ0KICAgIGxvY2FsIHIgPSByYWRpdXMNCiAgICBsb2NhbCB4cCwgeXAsIHhtLCB5bSA9IG5pbCwgbmlsLCBuaWwsIG5pbA0KICAgIGxvY2FsIElzT25TZWdtZW50ID0gbmlsDQogICAgDQogICAgaWYgeDEgPT0geDIgdGhlbg0KICAgIA0KICAgICAgbG9jYWwgQiA9IG1hdGguc3FydChyXjItKHgxLXgzKV4yKQ0KICAgICAgDQogICAgICB4cCwgeXAsIHhtLCB5bSA9IHgxLCB5MytCLCB4MSwgeTMtQg0KICAgIGVsc2UNCiAgICANCiAgICAgIGxvY2FsIG0gPSAoeTIteTEpLyh4Mi14MSkNCiAgICAgIGxvY2FsIG4gPSB5MS1tKngxDQogICAgICBsb2NhbCBBID0geDMtbSoobi15MykNCiAgICAgIGxvY2FsIEIgPSBtYXRoLnNxcnQoQV4yLSgxK21eMikqKHgzXjItcl4yKyhuLXkzKV4yKSkNCiAgICAgIA0KICAgICAgeHAsIHhtID0gKEErQikvKDErbV4yKSwgKEEtQikvKDErbV4yKQ0KICAgICAgeXAsIHltID0gbSp4cCtuLCBtKnhtK24NCiAgICBlbmQNCiAgICANCiAgICBpZiB4MSA8PSB4MiB0aGVuDQogICAgICBJc09uU2VnbWVudCA9IHgxIDw9IHhwIGFuZCB4cCA8PSB4Mg0KICAgIGVsc2UNCiAgICAgIElzT25TZWdtZW50ID0geDIgPD0geHAgYW5kIHhwIDw9IHgxICAgICAgICANCiAgICBlbmQNCiAgICAgIGlmIElzT25TZWdtZW50IHRoZW4NCiAgICAgIHJldHVybiBWZWN0b3IoeHAsIDAsIHlwKQ0KICAgIGVsc2UNCiAgICAgIHJldHVybiBWZWN0b3IoeG0sIDAsIHltKQ0KICAgIGVuZA0KICAgIA0KICBlbmQNCiAgDQogIC0taXNrZXlkb3duZml4IHN0YXJ0DQogIGxvY2FsIG9yaWdpbmFsS0QgPSBfRy5Jc0tleURvd247DQogIF9HLklzS2V5RG93biA9IGZ1bmN0aW9uKHRoZUtleSkNCiAgICBpZiAodHlwZSh0aGVLZXkpIH49ICdudW1iZXInKSB0aGVuDQogICAgICBsb2NhbCB0aGVOdW1iZXIgPSB0b251bWJlcih0aGVLZXkpOw0KICAgICAgaWYgKHRoZU51bWJlciB+PSBuaWwpIHRoZW4NCiAgICAgICAgcmV0dXJuIG9yaWdpbmFsS0QodGhlTnVtYmVyKTsNCiAgICAgIGVsc2UNCiAgICAgICAgcmV0dXJuIG9yaWdpbmFsS0QoR2V0S2V5KHRoZUtleSkpOw0KICAgICAgZW5kOw0KICAgIGVsc2UNCiAgICAgIHJldHVybiBvcmlnaW5hbEtEKHRoZUtleSk7DQogICAgZW5kOw0KICBlbmQ7DQogIC0taXNrZXlkb3duZml4IGVuZA0KICAtLSBBbGwgY2xhc3NpYyBuZWNlc3NlcmllcyBlbmQNCiAgLS1za2luaGFjaw0KICBmdW5jdGlvbiBTZW5kU2tpblBhY2tldChtT2JqZWN0LCBza2luUEIsIG5ldHdvcmtJRCkNCiAgaWYgKHN0cmluZy5maW5kKEdldEdhbWVWZXJzaW9uKCksICdSZWxlYXNlcy81LjIyJykgfj0gbmlsKSB0aGVuDQogICAgbG9jYWwgbVAgPSBDTG9MUGFja2V0KDB4MTBFKTsNCg0KICAgIG1QLnZUYWJsZSA9IDB4RkQxN0QwOw0KDQogICAgbVA6RW5jb2RlRihuZXR3b3JrSUQpOw0KICAgIA0KICAgIG1QOkVuY29kZTEoMHgwMCk7DQogICAgDQogICAgaWYgKHNraW5QQiA9PSBuaWwpIHRoZW4NCiAgICAgIG1QOkVuY29kZTQoMHhFNEU0RTRFNCk7DQogICAgZWxzZQ0KICAgICAgbVA6RW5jb2RlMShza2luUEIpOw0KICAgICAgZm9yIEkgPSAxLCAzIGRvDQogICAgICAgIG1QOkVuY29kZTEoc2tpbkgpOw0KICAgICAgZW5kOw0KICAgIGVuZDsNCg0KICAgIGZvciBJID0gMSwgc3RyaW5nLmxlbihtT2JqZWN0KSBkbw0KICAgICAgbVA6RW5jb2RlMShzdHJpbmcuYnl0ZShzdHJpbmcuc3ViKG1PYmplY3QsIEksIEkpKSk7DQogICAgZW5kOw0KDQogICAgZm9yIEkgPSAxLCAoMTYgLSBzdHJpbmcubGVuKG1PYmplY3QpKSBkbw0KICAgICAgbVA6RW5jb2RlMSgweDAwKTsNCiAgICBlbmQ7DQoNCiAgICBtUDpFbmNvZGU0KDB4MDAwMDAwMEUpOw0KICAgIG1QOkVuY29kZTQoMHgwMDAwMDAwRik7DQogICAgbVA6RW5jb2RlNCgweDAwMDAwMDAwKTsNCiAgICBtUDpFbmNvZGU0KDB4MDAwMDAwMDApOw0KICAgIG1QOkVuY29kZTIoMHgwMDAwKTsNCiAgICANCiAgICBtUDpIaWRlKCk7DQogICAgUmVjdlBhY2tldChtUCk7DQogIGVsc2VpZiAoc3RyaW5nLmZpbmQoR2V0R2FtZVZlcnNpb24oKSwgJ1JlbGVhc2VzLzUuMjEnKSB+PSBuaWwpIHRoZW4NCiAgICAgIGxvY2FsIG1QID0gQ0xvTFBhY2tldCgweDEyQSk7DQoNCiAgICAgIG1QLnZUYWJsZSA9IDB4RUEyOThDOw0KDQogICAgICBtUDpFbmNvZGVGKG5ldHdvcmtJRCk7DQogICAgICANCiAgICAgIG1QOkVuY29kZTQoMHgwMDAwMDAwMCk7DQogICAgICBtUDpFbmNvZGUyKDB4MDAwMCk7DQoNCiAgICAgIGZvciBJID0gMSwgc3RyaW5nLmxlbihtT2JqZWN0KSBkbw0KICAgICAgICBtUDpFbmNvZGUxKHN0cmluZy5ieXRlKHN0cmluZy5zdWIobU9iamVjdCwgSSwgSSkpKTsNCiAgICAgIGVuZDsNCg0KICAgICAgZm9yIEkgPSAxLCAoMTYgLSBzdHJpbmcubGVuKG1PYmplY3QpKSBkbw0KICAgICAgICBtUDpFbmNvZGUxKDB4MDApOw0KICAgICAgZW5kOw0KDQogICAgICBtUDpFbmNvZGU0KDB4MDAwMDAwMEUpOw0KICAgICAgbVA6RW5jb2RlNCgweDAwMDAwMDBGKTsNCiAgICAgIGlmIChza2luUEIgPT0gbmlsKSB0aGVuDQogICAgICAgIG1QOkVuY29kZTQoMHg0RTRFNEU0RSk7DQogICAgICBlbHNlDQogICAgICAgIG1QOkVuY29kZTEoc2tpblBCKTsNCiAgICAgICAgZm9yIEkgPSAxLCAzIGRvDQogICAgICAgICAgbVA6RW5jb2RlMShza2luSCk7DQogICAgICAgIGVuZDsNCiAgICAgIGVuZDsNCiAgICAgIG1QOkVuY29kZTQoMHgwMDAwMDAwMCk7DQogICAgICBtUDpFbmNvZGUxKDB4MDApOw0KDQogICAgICBtUDpIaWRlKCk7DQogICAgICBSZWN2UGFja2V0KG1QKTsNCiAgZW5kOw0KZW5kOw0KICBpZiAoc3RyaW5nLmZpbmQoR2V0R2FtZVZlcnNpb24oKSwgJ1JlbGVhc2VzLzUuMjInKSB+PSBuaWwpIHRoZW4NCiAgc2tpbnNQQiA9IHsNCiAgICBbMV0gPSAweENBLA0KICAgIFsyXSA9IDB4MjAsDQogICAgWzNdID0gMHgzQywNCiAgICBbNF0gPSAweDc1LA0KICAgIFs1XSA9IDB4N0IsDQogICAgWzZdID0gMHhCNCwNCiAgICBbN10gPSAweEM4LA0KICAgIFs4XSA9IDB4Q0UsDQogICAgWzldID0gMHhENCwNCiAgICBbMTBdID0gMHhENywNCiAgICBbMTFdID0gMHhERCwNCiAgICBbMTJdID0gMHhGOSwNCiAgfTsNCiAgc2tpbk9iamVjdFBvcyA9IDExOw0KICBza2luSGVhZGVyID0gMHgxMEU7DQogIGRpc3BlbGxIZWFkZXIgPSAweDgzOw0KICBza2luSCA9IDB4Q0E7DQogIHNraW5IUG9zID0gNzsNCmVsc2VpZiAoc3RyaW5nLmZpbmQoR2V0R2FtZVZlcnNpb24oKSwgJ1JlbGVhc2VzLzUuMjEnKSB+PSBuaWwpIHRoZW4NCiAgICBza2luc1BCID0gew0KICAgICAgWzFdID0gMHg1MiwNCiAgICAgIFsyXSA9IDB4M0UsDQogICAgICBbM10gPSAweDQyLA0KICAgICAgWzRdID0gMHg1RSwNCiAgICAgIFs1XSA9IDB4NjIsDQogICAgICBbNl0gPSAweEFFLA0KICAgICAgWzddID0gMHhCMiwNCiAgICAgIFs4XSA9IDB4QkUsDQogICAgICBbOV0gPSAweEMyLA0KICAgICAgWzEwXSA9IDB4Q0UsDQogICAgICBbMTFdID0gMHhEMiwNCiAgICAgIFsxMl0gPSAweERFLA0KICAgIH07DQogICAgc2tpbk9iamVjdFBvcyA9IDEyOw0KICAgIHNraW5IZWFkZXIgPSAweDEyQTsNCiAgICBkaXNwZWxsSGVhZGVyID0gMHg3OTsNCiAgICBza2luSCA9IDB4NTI7DQogICAgc2tpbkhQb3MgPSAzNjsNCmVuZDs=="), nil, "bt", _ENV))()
-- -----------------Easy Copy Line------------------------