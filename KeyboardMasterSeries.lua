
--[[
One Click to Challenger
Keyboard Master Series by Ensuluyn
Current Leauge Of Legends Version :5.21
Current Script Version :2.03
Last Update: 08.11.2015
--Credits to Nebelwolfi for mentoring <3
]]

assert(load(Base64Decode("DQoNCi0tIE9uZSBDbGljayB0byBDaGFsbGVuZ2VyDQotLSBLZXlib2FyZCBNYXN0ZXIgU2VyaWVzIGJ5IEVuc3VsdXluDQoNCi0tQ3JlZGl0cyB0byBOZWJlbHdvbGZpIGZvciBtZW50b3JpbmcgPDMNCg0KbG9jYWwgVmVyc2lvbiA9ICIyLjAzIiAgDQpsb2NhbCBMVmVyc2lvbiA9ICI1LjIxIg0KbG9jYWwgU2NyaXB0bmFtZSA9ICJLZXlib2FyZCBNYXN0ZXIgU2VyaWVzIg0KbG9jYWwgQXV0aG9yID0gIkVuc3VsdXluIg0KbG9jYWwgbGlzdCA9ICJMZWJsYW5jICwgTGlzc2FuZHJhICwgVmlrdG9yIg0KbG9jYWwgbGluayA9ICJHbyB0byBodHRwOi8vZm9ydW0uYm90b2ZsZWdlbmRzLmNvbS9mb3J1bS8yMC1jaGFtcGlvbi1zY3JpcHRzLyB0aGVuIHlvdSBjYW4gc2VlIG15IHRvcGljICIuLlNjcmlwdG5hbWUuLiIgb24gdGhlIGZpcnN0IG9yIHNlY29uZCBwYWdlLiINCmxvY2FsIGRhdGUgPSAiMDguMTEuMjAxNSINCmdsb2JhbF90aWNrcyA9IDANCi0tIHN0YXJ0aW5nIHNjcmlwdA0KLS1hdXRvIHVwZGF0ZQ0KbG9jYWwgdmVyc2lvbiA9IDIuMDMNCmxvY2FsIGF1dGhvciA9ICJFbnN1bHV5biINCmxvY2FsIFNDUklQVF9OQU1FID0gIktleWJvYXJkTWFzdGVyU2VyaWVzIg0KbG9jYWwgQVVUT1VQREFURSA9IHRydWUNCmxvY2FsIFVQREFURV9IT1NUID0gInJhdy5naXRodWIuY29tIg0KbG9jYWwgVVBEQVRFX1BBVEggPSAiL0xvbnNlbWFyaWEvc2NyaXB0cy9tYXN0ZXIvS2V5Ym9hcmRNYXN0ZXJTZXJpZXMubHVhIi4uIj9yYW5kPSIuLm1hdGgucmFuZG9tKDEsMTAwMDApDQpsb2NhbCBVUERBVEVfRklMRV9QQVRIID0gU0NSSVBUX1BBVEguLkdldEN1cnJlbnRFbnYoKS5GSUxFX05BTUUNCmxvY2FsIFVQREFURV9VUkwgPSAiaHR0cHM6Ly8iLi5VUERBVEVfSE9TVC4uVVBEQVRFX1BBVEgNCmZ1bmN0aW9uIFNheSh0ZXh0KQ0KICBwcmludCgiPGZvbnQgY29sb3I9XCIjRkYwMDAwXCI+PGI+S2V5Ym9hcmQgTWFzdGVyIFNlcmllczo8L2I+PC9mb250PiA8Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj4iIC4uIHRleHQgLi4gIjwvZm9udD4iKQ0KZW5kDQoNCmlmIEFVVE9VUERBVEUgdGhlbg0KICBsb2NhbCBTZXJ2ZXJEYXRhID0gR2V0V2ViUmVzdWx0KFVQREFURV9IT1NULCAiL0xvbnNlbWFyaWEvc2NyaXB0cy9tYXN0ZXIvdmVyc2lvbi9CdW5kbGUudmVyc2lvbiIpDQogIGlmIFNlcnZlckRhdGEgdGhlbg0KICAgIFNlcnZlclZlcnNpb24gPSB0eXBlKHRvbnVtYmVyKFNlcnZlckRhdGEpKSA9PSAibnVtYmVyIiBhbmQgdG9udW1iZXIoU2VydmVyRGF0YSkgb3IgbmlsDQogICAgaWYgU2VydmVyVmVyc2lvbiB0aGVuDQogICAgICBpZiB0b251bWJlcih2ZXJzaW9uKSA8IFNlcnZlclZlcnNpb24gdGhlbg0KICAgICAgICBTYXkoIk5ldyB2ZXJzaW9uIGF2YWlsYWJsZSAiLi5TZXJ2ZXJWZXJzaW9uKQ0KICAgICAgICBTYXkoIlVwZGF0aW5nLCBwbGVhc2UgZG9uJ3QgcHJlc3MgRjkiKQ0KICAgICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIERvd25sb2FkRmlsZShVUERBVEVfVVJMLCBVUERBVEVfRklMRV9QQVRILCBmdW5jdGlvbiAoKSBTYXkoIlN1Y2Nlc3NmdWxseSB1cGRhdGVkLiAoIi4udmVyc2lvbi4uIiA9PiAiLi5TZXJ2ZXJWZXJzaW9uLi4iKSwgcHJlc3MgRjkgdHdpY2UgdG8gbG9hZCB0aGUgdXBkYXRlZCB2ZXJzaW9uLiIpIGVuZCkgZW5kLCAzKQ0KICAgICAgZWxzZQ0KICAgICAgICBTYXkoIi1XZWxjb21lLCBZb3UgaGF2ZSBnb3QgdGhlIGxhdGVzdCB2ZXJzaW9uICh2Ii4uU2VydmVyVmVyc2lvbi4uIikgb2YgIi4uU2NyaXB0bmFtZS4uIiAsIHVwZGF0ZWQgYXQgKCIuLmRhdGUuLiIpIGJ5ICIgLi4gYXV0aG9yKQ0KICAgICAgZW5kDQogICAgZW5kDQogIGVsc2UgDQogICAgU2F5KCJFcnJvciBkb3dubG9hZGluZyB2ZXJzaW9uIGluZm8iKQ0KICBlbmQNCmVuZA0KZnVuY3Rpb24gT25Mb2FkKCkNCiAgICAgICAgaWYgbm90IFJlcXVpcmVTaW1wbGVMaWIoKSB0aGVuIHJldHVybiBlbmQNCiAgICAgICAgaXRlbWZpeCgpDQogICAgICAgICBpZiBfR1tteUhlcm8uY2hhck5hbWVdIHRoZW4NCiAgICAgICAgICAgICAgICBfR1tteUhlcm8uY2hhck5hbWVdKCkNCiAgICAgICAgZWxzZQ0KICAgICAgICAgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNDQkY2RkZcIj4gOlRoaXMgY2hhbXBpb24gaXMgbm90IHN1cHBvcnRlZC4gQ3VycmVudGx5IHN1cHBvcnRlZCBjaGFtcGlvbnMgYXJlOiAiLi5saXN0Li4iICIgKQ0KICAgICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjQ0JGNkZGXCI+RmVlbCBmcmVlIHRvIGNoZWNrIG15IGZvcnVtIHRvcGljIGFuZCBhc2sgYSBuZXcgY2hhbXBpb24gb3IgZ2l2ZSBmZWVkYmFjayIpIGVuZCwgMC41KQ0KICAgICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjQ0JGNkZGXCI+Ii4ubGluay4uIiIpIGVuZCwgMC41KQ0KICAgICAgICBlbmQNCmVuZA0KLS0gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tTGVCbGFuYyBTdGFydGluZy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCi0tIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLUxlQmxhbmMgU3RhcnRpbmctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQotLSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1MZUJsYW5jIFN0YXJ0aW5nLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KLS0gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tTGVCbGFuYyBTdGFydGluZy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCmNsYXNzICJMZWJsYW5jIg0KZnVuY3Rpb24gTGVibGFuYzpfX2luaXQoKQ0Kc2VsZi50cz0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgNTI1LCBEQU1BR0VfUEhZU0lDQUwsIGZhbHNlLCB0cnVlKQ0KICBzZWxmLnRzcT0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgNzAwLCBEQU1BR0VfUEhZU0lDQUwsIGZhbHNlLCB0cnVlKQ0KIHNlbGYudHN3PSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCA2MDAsIERBTUFHRV9NQUdJQywgZmFsc2UsIHRydWUpDQogIHNlbGYudHNlPSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCA5MjUsIERBTUFHRV9NQUdJQywgZmFsc2UsIHRydWUpDQogIHNlbGYudHNyPSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCA5MjUsIERBTUFHRV9NQUdJQywgZmFsc2UsIHRydWUpIA0KICBzZWxmLnRzZz0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgOTUwLCBEQU1BR0VfTUFHSUMsIGZhbHNlLCB0cnVlKSANCiAgIHNlbGYuUVNwZWxsID0gX1NwZWxsKHtTbG90ID0gX1EsIERhbWFnZU5hbWUgPSAiUSIsIFJhbmdlID0gNzAwLCBXaWR0aCA9IDEsIERlbGF5ID0gMCwgU3BlZWQgPSBtYXRoLmh1Z2UsIENvbGxpc2lvbiA9IGZhbHNlLCBBb2UgPSBmYWxzZSwgVHlwZSA9IFNQRUxMX1RZUEUuVEFSR0VUVEVEfSkNCiAgIHNlbGYuV1NwZWxsID0gX1NwZWxsKHtTbG90ID0gX1csIERhbWFnZU5hbWUgPSAiVyIsIFJhbmdlID0gNjAwLCBXaWR0aCA9IDEyNSwgRGVsYXkgPSAwLjUsIFNwZWVkID0gMTMwMCwgUmFkaXVzID0gMjUwICwgQ29sbGlzaW9uID0gZmFsc2UsIEFvZSA9IHRydWUsIFR5cGUgPSBTUEVMTF9UWVBFLlRBUkdFVFRFRH0pDQogICBzZWxmLkVTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9FLCBEYW1hZ2VOYW1lID0gIkUiLCBSYW5nZSA9IDkyNSwgV2lkdGggPSA1NSwgRGVsYXkgPSAwLjI1LCBTcGVlZCA9IDE2MDAsIENvbGxpc2lvbiA9IHRydWUsIEFvZSA9IGZhbHNlLCBUeXBlID0gU1BFTExfVFlQRS5MSU5FQVJ9KQ0KICAgc2VsZi5SU3BlbGwgPSBfU3BlbGwoe1Nsb3QgPSBfUiwgRGFtYWdlTmFtZSA9ICJSIiwgUmFuZ2UgPTYwMCwgV2lkdGggPSAxMjUsIERlbGF5ID0gMC41LCBTcGVlZCA9IDEzMDAsIENvbGxpc2lvbiA9IGZhbHNlLCBBb2UgPSB0cnVlLCBUeXBlID0gU1BFTExfVFlQRS5UQVJHRVRURUR9KQ0KICAgc2VsZi5JZ25pdGUgPSBfU3BlbGwoe1Nsb3QgPSBGaW5kU3VtbW9uZXJTbG90KCJzdW1tb25lcmRvdCIpLCBEYW1hZ2VOYW1lID0gIklHTklURSIsIFJhbmdlID0gNjAwLCBUeXBlID0gU1BFTExfVFlQRS5UQVJHRVRURUR9KQ0KICAgc2VsZi5sZWJsYW5jVywgc2VsZi5sZWJsYW5jSW1hZ2UsIHNlbGYuY2xvbmVJZCA9IG5pbCwgbmlsLCBuaWwNCi0tfD4gTWluaW9uIE1hbmFnZXJzDQogICAgc2VsZi5lbmVteU1pbmlvbnMgICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX0VORU1ZLCAgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgIHNlbGYuYWxseU1pbmlvbnMgICAgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9BTExZLCAgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgIHNlbGYuanVuZ2xlTWluaW9ucyAgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9KVU5HTEUsICA2NTAsIG15SGVybywgTUlOSU9OX1NPUlRfTUFYSEVBTFRIX0RFQykNCiAgICBzZWxmLm90aGVyTWluaW9ucyAgID0gbWluaW9uTWFuYWdlcihNSU5JT05fT1RIRVIsICAgNjUwLCBteUhlcm8sIE1JTklPTl9TT1JUX01BWEhFQUxUSF9ERUMpDQogICAgc2VsZjpMb2FkTWVudSgpDQogICAgICBzZWxmOmZpbmRvcmJ3YWxrZXIoKQ0KICAgICAgQ2xvY2sgPSBvcy5jbG9jaygpDQogICAgICAgICBpZiBWSVBfVVNFUiB0aGVuICBzZWxmOnNraW5oYWNrKCkgZW5kDQogICAgICBBZGRUaWNrQ2FsbGJhY2soZnVuY3Rpb24oKSBzZWxmOlRpY2soKSBlbmQpDQogIEFkZERyYXdDYWxsYmFjayhmdW5jdGlvbigpIHNlbGY6RHJhdygpIGVuZCkNCiAgQWRkTXNnQ2FsbGJhY2soZnVuY3Rpb24obXNnLEtleSkgc2VsZjpXbmRNc2cobXNnLEtleSkgZW5kKQ0KICAtLUFkZEFuaW1hdGlvbkNhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIGFuaW1hdGlvbikgc2VsZjpBbmltYXRpb24odW5pdCwgYW5pbWF0aW9uKSBlbmQpDQogIC0tQWRkUHJvY2Vzc1NwZWxsQ2FsbGJhY2soZnVuY3Rpb24odW5pdCwgc3BlbGwpIHNlbGY6UHJvY2Vzc1NwZWxsKHVuaXQsIHNwZWxsKSBlbmQpDQogIC0tQWRkQXBwbHlCdWZmQ2FsbGJhY2soZnVuY3Rpb24oc291cmNlLCB1bml0LCBidWZmKSBzZWxmOk9uQXBwbHlCdWZmKHNvdXJjZSwgdW5pdCwgYnVmZikgZW5kKQ0KICAtLUFkZFVwZGF0ZUJ1ZmZDYWxsYmFjayhmdW5jdGlvbih1bml0LCBidWZmLCBzdGFja3MpIHNlbGY6VXBkYXRlQnVmZih1bml0LCBidWZmLCBzdGFja3MpIGVuZCkNCiAgLS1BZGRSZW1vdmVCdWZmQ2FsbGJhY2soZnVuY3Rpb24odW5pdCwgYnVmZikgc2VsZjpPblJlbW92ZUJ1ZmYodW5pdCwgYnVmZikgZW5kKSANCiAgICBlbmQNCiAgICBmdW5jdGlvbiBMZWJsYW5jOkxvYWRNZW51KCkNCiAgICAgIHNlbGYuQ29uZmlnPXNjcmlwdENvbmZpZygiIi4uU2NyaXB0bmFtZS4uIiIsIm1lbnUiKQ0KDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJDb21ibyBTZXR0aW5ncyIsICJjb21ibyIpDQogICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlUSIsICJVc2UgUSBpbiBDb21ibyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VXIiwgIlVzZSBXIGluIENvbWJvIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZUUiLCAiVXNlIEUgaW4gY29tYm8iLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlUiIsICJVc2UgUiBpbiBjb21ibyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VJIiwgIlVzZSBJZ25pdGUgaWYgdGFyZ2V0IGtpbGxhYmxlIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgLS1zZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgiZ2FwY2xvc2UiLCAiVXNlIFcgYXMgYSBnYXBjbG9zZSAoIEJldGEgKSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgZmFsc2UpDQogICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgibG9naWMiLCAiQ29tYm8gbG9naWMiLCBTQ1JJUFRfUEFSQU1fTElTVCwgMSwgeyJRPkU+Vz5SIiwgIlE+Uj5FPlciLCAiRT5RPlc+UiIsICJFPlc+UT5SIiAsIlJhbmRvbSBTa2lsbCBPcmRlciJ9KQ0KICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkU3ViTWVudSgiVyBTa2lsbCB0dXJuIGJhY2sgc2V0dGluZ3MiLCAidHVybnciKQ0KICAgICAgc2VsZi5Db25maWcuY29tYm8udHVybnc6YWRkUGFyYW0oIncxIiwiVHVybiBiYWNrIHRvIFcgc3BvdCBvbiBRPkU+Vz5SIG1vZGUgIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICBzZWxmLkNvbmZpZy5jb21iby50dXJudzphZGRQYXJhbSgidzIiLCJUdXJuIGJhY2sgdG8gVyBzcG90IG9uIFE+Uj5FPlcgbW9kZSAiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgIHNlbGYuQ29uZmlnLmNvbWJvLnR1cm53OmFkZFBhcmFtKCJ3MyIsIlR1cm4gYmFjayB0byBXIHNwb3Qgb24gRT5RPlc+UiBtb2RlICIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgc2VsZi5Db25maWcuY29tYm8udHVybnc6YWRkUGFyYW0oInc0IiwiVHVybiBiYWNrIHRvIFcgc3BvdCBvbiBFPlc+UT5SIG1vZGUgIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICBzZWxmLkNvbmZpZy5jb21iby50dXJudzphZGRQYXJhbSgidzUiLCJUdXJuIGJhY2sgdG8gVyBzcG90IG9uIFJhbmRvbSBTa2lsbCBPcmRlciBtb2RlICIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oIk1hbmEiLCJNYW5hIE1hbmFnZXIgJSIsU0NSSVBUX1BBUkFNX1NMSUNFLCAxMCwgMTAsIDEwMCwgMCkNCiAgICAgIA0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiSGFyYXNzIFNldHRpbmdzIiwgImhhcmFzcyIpDQogICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6YWRkUGFyYW0oInVzZVEiLCAiSGFyYXNzIFdpdGggUSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczphZGRQYXJhbSgidXNlVyIsICJIYXJhc3MgV2l0aCBXIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgc2VsZi5Db25maWcuaGFyYXNzOmFkZFBhcmFtKCJNYW5hIiwiTWFuYSBNYW5hZ2VyICUiLFNDUklQVF9QQVJBTV9TTElDRSwgMTAsIDEwLCAxMDAsIDApDQogICAgICANCiAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkxhbmVDbGVhciBTZXR0aW5ncyIsImxhbmVjbGVhciIpDQogICAgICBzZWxmLkNvbmZpZy5sYW5lY2xlYXI6YWRkUGFyYW0oInVzZVEiLCJVc2UgUSBvbiBMYW5lY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgc2VsZi5Db25maWcubGFuZWNsZWFyOmFkZFBhcmFtKCJ1c2VXIiwiVXNlIFcgb24gTGFuZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmxhbmVjbGVhcjphZGRQYXJhbSgidXNlUiIsIlVzZSBSIG9uIExhbmVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgc2VsZi5Db25maWcubGFuZWNsZWFyOmFkZFBhcmFtKCJNYW5hIiwiTWFuYSBNYW5hZ2VyICUiLFNDUklQVF9QQVJBTV9TTElDRSwgMzAsIDEwLCAxMDAsIDApDQogICAgICANCiAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkp1bmdsZUNsZWFyIFNldHRpbmdzIiwianVuZ2xlY2xlYXIiKQ0KICAgICAgc2VsZi5Db25maWcuanVuZ2xlY2xlYXI6YWRkUGFyYW0oInVzZVEiLCJVc2UgUSBvbiBqdW5nbGVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhcjphZGRQYXJhbSgidXNlVyIsIlVzZSBXIG9uIExhbmVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhcjphZGRQYXJhbSgidXNlRSIsIlVzZSBFIG9uIGp1bmdsZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyOmFkZFBhcmFtKCJNYW5hIiwiTWFuYSBNYW5hZ2VyICUiLFNDUklQVF9QQVJBTV9TTElDRSwgMzAsIDEwLCAxMDAsIDApDQogICAgICANCiAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkVzY2FwZSBTZXR0aW5ncyIsImVzY2FwZSIpDQogICAgICBzZWxmLkNvbmZpZy5lc2NhcGU6YWRkUGFyYW0oInVzZVciLCJVc2UgVyBXaGlsZSBFc2NhcGUiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgc2VsZi5Db25maWcuZXNjYXBlOmFkZFBhcmFtKCJ1c2VSIiwiVXNlIFIgV2hpbGUgRXNjYXBlIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCg0KICAgICAgDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJLaWxsU3RlYWwgU2V0dGluZ3MiLCAia2lsbHN0ZWFsIikNCiAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgia3MiLCJLaWxsc3RlYWwgT24vT2ZmIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgidXNlUSIsICJTdGVhbCBXaXRoIFEiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZVciLCAiU3RlYWwgV2l0aCBXIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJ1c2VFIiwgIlN0ZWFsIFdpdGggRSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgidXNlUiIsICJTdGVhbCBXaXRoIFIiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZVFXIiwgIlN0ZWFsIFdpdGggUVciLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZUkiLCAiU3RlYWwgV2l0aCBJZ25pdGUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICANCiAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkl0ZW0gU2V0dGluZ3MiLCAiaXRlbSIpDQogICAgICBzZWxmLkNvbmZpZy5pdGVtOmFkZFBhcmFtKCJlbmFibGVhdXRvemhvbnlhIiwgIkF1dG8gWmhvbnlhIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCBmYWxzZSkNCiAgICAgIHNlbGYuQ29uZmlnLml0ZW06YWRkUGFyYW0oImF1dG96aG9ueWEiLCAiWmhvbnlhIGlmIEhlYWx0aCB1bmRlciAtPiAlIiwgU0NSSVBUX1BBUkFNX1NMSUNFLCAxMCwgMCwgMTAwLCAwKQ0KICAgICAgDQogICAgICBpZiBWSVBfVVNFUiB0aGVuDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJWSVAgU2V0dGluZ3MiLCAidmlwIikNCiAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgicGFja2V0IiwiVXNlIFBhY2tldCBDYXN0aW5nIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm8xIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvMiIsICJUbyB1c2UgdmlwIHNldHRpbmdzLCBQYWNrZXQgQ2FzdGluZyBzaG91bGQgYmUgb3Blbi4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRTdWJNZW51KCJBdXRvIExldmVsIFNldHRpbmdzIiwgImxldmVsIikNCiAgICAgIHNlbGYuQ29uZmlnLnZpcC5sZXZlbDphZGRQYXJhbSgia2V5IiwiVXNlIEF1dG8gTGV2ZWwiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgIHNlbGYuQ29uZmlnLnZpcC5sZXZlbDphZGRQYXJhbSgibG9naWMiLCAiU2VsZWN0IFNraWxsIE9yZGVyIiwgU0NSSVBUX1BBUkFNX0xJU1QsIDMsIHsiRm9jdXMgUT5XPkUiLCAiRm9jdXMgUT5FPlciLCJGb2N1cyBXPlE+RSIsIkZvY3VzIFc+RT5RIiwiRm9jdXMgRT5XPlEiLCAiRm9jdXMgRT5RPlciICB9KQ0KICAgICAgc2VsZi5Db25maWcudmlwOmFkZFN1Yk1lbnUoIlNraW4gSGFjayBTZXR0aW5ncyIsICJza2luIikNCiAgICAgIHNlbGYuQ29uZmlnLnZpcC5za2luOmFkZFBhcmFtKCJrZXkiLCJVc2UgU2tpbiBIYWNrIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICBzZWxmLkNvbmZpZy52aXAuc2tpbjphZGRQYXJhbSgnc2VsZWN0ZWQnIC4uIG15SGVyby5jaGFyTmFtZSAuLiAnU2tpbicsICJTZWxlY3QgU2tpbiIsIFNDUklQVF9QQVJBTV9MSVNULCAxLCB7Ik9yaWdpbmFsIiwgIldpY2tlZCBMZUJsYW5jICIsIlByZXN0aWdpb3VzIExlQmxhbmMiLCJNaXN0bGV0b2UgTGVCbGFuYyIsIlJhdmVuYm9ybiBMZWJsYW5jIiwgfSkNCiAgICAgIHNlbGYuQ29uZmlnLnZpcC5za2luOmFkZFBhcmFtKCJpbmZvNCIsICJUbyB1c2Ugc2tpbiBoYWNrLCBZb3UgbmVlZCB0byAyeCBGOSBhZnRlciB5b3Ugc2VsZWN0IHRoZSBza2luIHlvdSBkZXNpcmUuIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICBzZWxmLkNvbmZpZy52aXAuc2tpbjphZGRQYXJhbSgiaW5mbzUiLCAiTWFrZSBzdXJlIHRoYXQgdXNpbmcgcGFja2V0IGNhc3RpbmcgaXMgT04uIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAtLXNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzUiLCAiU2tpbiBIYWNrIHRlbXBvcmFyeSBkaXNhYmxlZCB1bnRpbCBuZXh0IHVwZGF0ZS4gLiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgLS1bW3NlbGYuQ29uZmlnLnZpcDphZGRTdWJNZW51KCJBbnRpLUFGSyBTZXR0aW5ncyIsICJhbnRpYWZrIikNCiAgICAgIHNlbGYuQ29uZmlnLnZpcC5hbnRpYWZrOmFkZFBhcmFtKCJhbnRpYWZrIiwiVXNlIEFudGkgQWZrIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpIF1dDQogICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm8zIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvNCIsICJUbyB1c2UgdmlwIHNldHRpbmdzLCBZb3UgbmVlZCB0byBiZSBhIFZJUCB1c2VyIG9uIEJPTCBjb21tdW5pdHkuIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgIGVuZA0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiRHJhdyBTZXR0aW5ncyIsIm90aGVyIikNCiAgICAgIC0tc2VsZi5Db25maWcub3RoZXI6YWRkU3ViTWVudSgiU2hvdyBEYW1hZ2UgT24gSHAgQmFyIiwgIkhQQkFSIikNCiAgICAgIC0tc2VsZi5Db25maWcub3RoZXIuSFBCQVI6YWRkUGFyYW0oImtleSIsIk9OL09GRiIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5vdGhlcjphZGRTdWJNZW51KCJTa2lsbCBEcmF3aW5nIFNldHRpbmdzIiwgImRyYXciKQ0KICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgicWRyYXciLCJRIFNraWxsIERyYXdpbmdzIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oIndkcmF3IiwiVyBTa2lsbCBEcmF3aW5ncyIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5vdGhlci5kcmF3OmFkZFBhcmFtKCJlZHJhdyIsIkUgU2tpbGwgRHJhd2luZ3MiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgicmRyYXciLCJSIFNraWxsIERyYXdpbmdzIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oImFhZHJhdyIsIkF1dG8gQXR0YWNrIFJhbmdlIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICBzZWxmLkNvbmZpZy5vdGhlcjphZGRQYXJhbSgiY29tYm9tb2RlIiwiRHJhdyBDb21ibyBNb2RlIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICBzZWxmLkNvbmZpZy5vdGhlcjphZGRTdWJNZW51KCJEcmF3IFBlcm1hYm94IiwgInBlcm1hIikNCiAgICAgIHNlbGYuQ29uZmlnLm90aGVyLnBlcm1hOmFkZFBhcmFtKCJwZXJtYSIsIkRyYXcgUGVybWFib3ggKCBOZWVkcyAyeCBGOSApIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIA0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiVGFyZ2V0c2VsZWN0b3JzIiwidGFyZ2V0c2VsIikNCiAgICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRQYXJhbSgiaW5mb0syIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFBhcmFtKCJpbmZvSyIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRQYXJhbSgidHMiLCJMZWZ0IENsaWNrIEZvciBUYXJnZXQgU2VsZWN0aW9uIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgc2VsZi50cy5uYW1lICA9ICJMZWJsYW5jIg0KICAgIHNlbGYudHNxLm5hbWUgPSAiTGVibGFuY1EiDQogICAgc2VsZi50c3cubmFtZSA9ICJMZWJsYW5jVyINCiAgICBzZWxmLnRzZS5uYW1lID0gIkxlYmxhbmNFIg0KICAgIHNlbGYudHNyLm5hbWUgPSAiTGVibGFuY1IiDQogICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFRTKHNlbGYudHMpDQogICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFRTKHNlbGYudHNxKQ0KICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRUUyhzZWxmLnRzdykNCiAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkVFMoc2VsZi50c2UpDQogICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFRTKHNlbGYudHNyKSANCiAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiS2V5cyBTZXR0aW5ncyIsICJLZXlzIikNCiAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJpbmZvSzMiLCAiPC0tLS0tLS0tLS0tLS0tLS0tLUNvbWJvIEtleSBTZXR0aW5ncy0tLS0tLS0tLS0tLS0tLS0tLT4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJjb21ib2tleSIsICJDb21ibyBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgMzIpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgib25seWUiLCAiT25seSB1c2UgRSBTa2lsbCAoT25seSBTdHVuKSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sZmFsc2UsIHN0cmluZy5ieXRlKCJPIikpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiY29tYm9tb2RlIiwgIiBTZWxlY3QgQ29tYm9tb2RlIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sZmFsc2UsIHN0cmluZy5ieXRlKCIyIikpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0s0IiwgIjwtLS0tLS0tLS0tLS0tLS0tLS1IYXJhc3MgS2V5IFNldHRpbmdzLS0tLS0tLS0tLS0tLS0tLS0tPiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImhhcmFzc2tleSIsICJTbWFydCBIYXJhc3MgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJDIikpDQogICAtLSBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJoYXJhc3N0b2dsZWtleSIsICJIYXJhc3MgVG9nbGUgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZVE9HR0xFLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIlQiKSkNCiAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJpbmZvSzUiLCAiPC0tLS0tLS0tLS0tLS0tLS0tLUNsZWFyIEtleSBTZXR0aW5ncy0tLS0tLS0tLS0tLS0tLS0tLS0tPiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImxhbmVjbGVhcmtleSIsICJMYW5lQ2xlYXIgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJWIikpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgianVuZ2xlY2xlYXJrZXkiLCAiSnVuZ2xlQ2xlYXIgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJaIikpDQogICAgLS1zZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJsYXN0aGl0a2V5IiwgIkxhc3RoaXQgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJYIikpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0s2IiwgIjwtLS0tLS0tLS0tLS0tLS0tLS1PdGhlciBLZXkgU2V0dGluZ3MtLS0tLS0tLS0tLS0tLS0tLS0tLT4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJlc2NhcGVrZXkiLCAiRXNjYXBlIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiWSIpKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LMiIsICJNYWtlIFN1cmUgVGhhdCBZb3VyIE9yYndhbGtlciBLZXlzIGFyZSBTYW1lIEFzIEhlcmUiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJPcndXYWxrZXJLZXkgU2V0dGluZ3MiLCAiS2V5czIiKQ0KICAgIA0KICAgIE9yYndhbGtNYW5hZ2VyOkxvYWRDb21tb25LZXlzKHNlbGYuQ29uZmlnLktleXMyKQ0KICAgIA0KICAgICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm8zIiwgIl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3giLCAiICAgICAgICAgICAgICAgIi4uU2NyaXB0bmFtZS4uIiIsIFNDUklQVF9QQVJBTV9JTkZPLCAiIikgDQogICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94MiIsICIgICAgICAgICAgICAgICAgIFNjcmlwdCBWZXJzaW9uOiAgIi4uVmVyc2lvbi4uICIgICAgICAgICAiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3g2IiwgIiAgICAgICAgICAgIFNjcmlwdCB3YXMgbWFkZSBieSAgIi4uQXV0aG9yLi4gIiAgICAgICAgICIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDUiLCAiICAgICAgIExlYXVnZSBPZiBMZWdlbmRzIFZlcnNpb246ICAiLi5MVmVyc2lvbi4uICIgICAgICAgICAiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgDQogICAgIGlmIHNlbGYuQ29uZmlnLm90aGVyLnBlcm1hLnBlcm1hIHRoZW4NCiAgICAgc2VsZi5Db25maWc6cGVybWFTaG93KCJpbmZvYm94IikNCiAgICBzZWxmLkNvbmZpZy5LZXlzOnBlcm1hU2hvdygiY29tYm9rZXkiKQ0KICAgIC0tc2VsZi5Db25maWcuS2V5czpwZXJtYVNob3coImhhcmFzc3RvZ2xla2V5IikNCiAgICAgc2VsZi5Db25maWcuS2V5czpwZXJtYVNob3coImhhcmFzc2tleSIpDQogIGVuZA0KZW5kDQotLWRyYXdpbmcgc2V0dGluZ3Mgc3RhcnQNCmZ1bmN0aW9uIExlYmxhbmM6Y29tYm9tb2RlKCkNCmxvY2FsIGRyYXdwb3MgPSBHZXRVbml0SFBCYXJQb3MobXlIZXJvKQ0KaWYgc2VsZi5Db25maWcuY29tYm8ubG9naWMgPT0gMSB0aGVuDQpEcmF3VGV4dCgiQ3VycmVudCBDb21ibyBNb2RlOiBRPkU+Vz5SIiwgMTIsIGRyYXdwb3MueC00MCwgZHJhd3Bvcy55KzE2LCAweGZmMDBmZmZmKSBlbmQNCmlmIHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID09IDIgdGhlbg0KRHJhd1RleHQoIkN1cnJlbnQgQ29tYm8gTW9kZTogUT5SPkU+VyIsIDEyLCBkcmF3cG9zLngtNDAsIGRyYXdwb3MueSsxNiwgMHhmZjAwZmZmZikgZW5kDQppZiBzZWxmLkNvbmZpZy5jb21iby5sb2dpYyA9PSAzIHRoZW4NCkRyYXdUZXh0KCJDdXJyZW50IENvbWJvIE1vZGU6IEU+UT5XPlIiLCAxMiwgZHJhd3Bvcy54LTQwLCBkcmF3cG9zLnkrMTYsIDB4ZmYwMGZmZmYpIGVuZA0KaWYgc2VsZi5Db25maWcuY29tYm8ubG9naWMgPT0gNCB0aGVuDQpEcmF3VGV4dCgiQ3VycmVudCBDb21ibyBNb2RlOiBFPlc+UT5SIiwgMTIsIGRyYXdwb3MueC00MCwgZHJhd3Bvcy55KzE2LCAweGZmMDBmZmZmKSBlbmQNCmlmIHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID09IDUgdGhlbg0KRHJhd1RleHQoIkN1cnJlbnQgQ29tYm8gTW9kZTogUmFuZG9tIFNraWxsIE9yZGVyIiwgMTIsIGRyYXdwb3MueC00MCwgZHJhd3Bvcy55KzE2LCAweGZmMDBmZmZmKSBlbmQNCmVuZA0KZnVuY3Rpb24gTGVibGFuYzpEcmF3KCkNCmlmIHNlbGYuQ29uZmlnLm90aGVyLmNvbWJvbW9kZSB0aGVuDQpsb2NhbCBkcmF3cG9zID0gR2V0VW5pdEhQQmFyUG9zKG15SGVybykNCnNlbGY6Y29tYm9tb2RlKCkNCmVuZA0KICAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5xZHJhdyBhbmQgc2VsZi5RU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgNjUwLCAxLHJlZCkNCiAgZW5kDQoNCiAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy53ZHJhdyBhbmQgc2VsZi5XU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgNjAwLCAxLCByZWQpDQogIGVuZA0KDQogIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcuZWRyYXcgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSB0aGVuDQogICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDkyNSwgMSwgcmVkKQ0KICBlbmQNCiAgDQogIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcucmRyYXcgYW5kIHNlbGYuUlNwZWxsOklzUmVhZHkoKSB0aGVuDQogICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDcwMCwxLCByZWQpDQogIGVuZA0KICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LmFhZHJhdyB0aGVuDQogICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDU1MCwxLCBBUkdCKDI1NSwgMjU1LDAsMCkpDQogIGVuZA0KZW5kDQotLWRyYXdpbmcgc2V0dGluZ3MgZW5kDQpmdW5jdGlvbiBMZWJsYW5jOlRpY2soKQ0KICAgICBzZWxmOmF1dG96aG9ueWEoKQ0KICAgICAgc2VsZjpjaGVja3RzKCkNCiAgICAgIGlmIFZJUF9VU0VSIHRoZW4gc2VsZjphdXRvbGV2ZWwoKSBlbmQNCg0KICAgICBzZWxmOmdhcGNsb3NlKCkNCiBpZihzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgKXRoZW4NCiAgICBzZWxmOmNvbWJvKCkNCiAgZW5kDQogICBpZihzZWxmLkNvbmZpZy5LZXlzLm9ubHllICAgKXRoZW4NCiAgICBzZWxmOm9ubHllKCkNCiAgZW5kDQogIGlmKHNlbGYuQ29uZmlnLktleXMubGFuZWNsZWFya2V5ICl0aGVuDQogICAgc2VsZjpMYW5lQ2xlYXIoKQ0KICBlbmQNCiAgaWYoc2VsZi5Db25maWcuS2V5cy5lc2NhcGVrZXkgKXRoZW4NCiAgICBzZWxmOmVzY2FwZSgpDQogIGVuZA0KICAgIGlmKHNlbGYuQ29uZmlnLktleXMuanVuZ2xlY2xlYXJrZXkgKXRoZW4NCiAgIHNlbGY6SnVuZ2xlQ2xlYXIoKQ0KICBlbmQNCiAgaWYoc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzICkgdGhlbg0KICAgIHNlbGY6a2lsbHN0ZWFsKCkNCiAgZW5kDQogIGlmKHNlbGYuQ29uZmlnLktleXMuaGFyYXNza2V5ICAgKSB0aGVuDQogICAgc2VsZjpoYXJhc3MoKQ0KICBlbmQNCiAgICBlbmQNCmZ1bmN0aW9uIExlYmxhbmM6Y2hlY2t0cygpDQppZiBub3Qgc2VsZi50c2cudGFyZ2V0fj1uaWwgb3Igbm90IHNlbGYuQ29uZmlnLnRhcmdldHNlbC50cyB0aGVuDQp0YXJnZXQgPSBzZWxmLnRzdy50YXJnZXQNCmVsc2VpZiBzZWxmLnRzZy50YXJnZXR+PW5pbCBvciBzZWxmLnNlbGVjdGVkVGFyIHRoZW4NCnRhcmdldCA9IHNlbGYuc2VsZWN0ZWRUYXINCmVuZA0KZW5kDQpsb2NhbCBza2luc1BCID0ge307DQpsb2NhbCBza2luT2JqZWN0UG9zID0gbmlsOw0KbG9jYWwgc2tpbkhlYWRlciA9IG5pbDsNCmxvY2FsIGRpc3BlbGxIZWFkZXIgPSBuaWw7DQpsb2NhbCBza2luSCA9IG5pbDsNCmxvY2FsIHNraW5IUG9zID0gbmlsOw0KZnVuY3Rpb24gTGVibGFuYzpza2luaGFjaygpDQppZiBub3Qgc2VsZi5Db25maWcudmlwLnBhY2tldCB0aGVuIFNlbmRTa2luUGFja2V0KG15SGVyby5jaGFyTmFtZSwgc2tpbnNQQlsxXSwgbXlIZXJvLm5ldHdvcmtJRCk7IGVsc2UNCmlmIHNlbGYuQ29uZmlnLnZpcC5za2luLmtleSBhbmQgc2VsZi5Db25maWcudmlwLnBhY2tldCAgdGhlbg0KU2VuZFNraW5QYWNrZXQobXlIZXJvLmNoYXJOYW1lLCBza2luc1BCW3NlbGYuQ29uZmlnLnZpcC5za2luWydzZWxlY3RlZCcgLi4gbXlIZXJvLmNoYXJOYW1lIC4uICdTa2luJ11dLCBteUhlcm8ubmV0d29ya0lEKTsNCmVuZA0KZW5kDQplbmQNCmZ1bmN0aW9uIExlYmxhbmM6b25seWUoKQ0KICAgICAgIHNlbGYudHNlOnVwZGF0ZSgpDQogICAgICAgIGlmKHNlbGYudHNlLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VFIGFuZCAgc2VsZi5Db25maWcuS2V5cy5vbmx5ZSAgIGFuZCBzZWxmLkVTcGVsbDpJc1JlYWR5KCkpIHRoZW4NCiAgICAgICAgc2VsZjpDYXN0RShzZWxmLnRzZS50YXJnZXQpDQplbmQNCmVuZA0KZnVuY3Rpb24gTGVibGFuYzphbnRpYWZrKCkNCmlmIG9zLmNsb2NrKCkgPCBDbG9jayBvciBub3Qgc2VsZi5Db25maWcudmlwLmFudGlhZmsgdGhlbiByZXR1cm4gZW5kDQogICAgQ2xvY2sgPSBvcy5jbG9jaygpICsgbWF0aC5yYW5kb20oNjAsMTIwKQ0KbXlIZXJvOk1vdmVUbyhteUhlcm8ueCwgbXlIZXJvLnopDQplbmQNCmZ1bmN0aW9uIExlYmxhbmM6Y29tYm8oKQ0KaWYgc2VsZi5Db25maWcuY29tYm8ubG9naWMgPT0gMSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKSB0aGVuDQpzZWxmOmNvbWJvUUVXUigpDQplbmQNCmlmIHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID09IDIgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwICkgdGhlbg0Kc2VsZjpjb21ib1FSRVcoKQ0KZW5kDQppZiBzZWxmLkNvbmZpZy5jb21iby5sb2dpYyA9PSAzIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmNvbWJvLk1hbmEgLzEwMCApIHRoZW4NCnNlbGY6Y29tYm9FUVdSKCkNCmVuZA0KaWYgc2VsZi5Db25maWcuY29tYm8ubG9naWMgPT0gNCBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKSB0aGVuDQpzZWxmOmNvbWJvRVdRUigpDQplbmQNCmlmIHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID09IDUgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwICkgdGhlbg0Kc2VsZjpyYW5kb21jb21ibygpDQplbmQNCiAgICBpZihzZWxmLkNvbmZpZy5jb21iby51c2VJIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgKXRoZW4NCiAgICBmb3IgXywgdW5pdCBpbiBwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbw0KICAgICAgbG9jYWwgZG1nSSA9KDUwKyAoKG15SGVyby5sZXZlbCkqMjApKQ0KICAgICAgbG9jYWwgaGVhbHRoPXVuaXQuaGVhbHRoDQogICAgICBpZihoZWFsdGg8ZG1nSSBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlSSBhbmQgR2V0RGlzdGFuY2UodW5pdCk8NjAwKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0SSh1bml0KQ0KICAgIGVuZA0KICAgIGVuZA0KZW5kDQplbmQNCmZ1bmN0aW9uIExlYmxhbmM6Y29tYm9RUkVXKCkNCiBzZWxmLnRzdzp1cGRhdGUoKQ0KIGlmIG5vdCBzZWxmLkNvbmZpZy5jb21iby50dXJudy53MiB0aGVuDQppZiAoc2VsZi50c3cudGFyZ2V0IH49IG5pbCApdGhlbg0Kc2VsZjpDYXN0UVIodGFyZ2V0KQ0KZW5kDQppZihzZWxmLnRzdy50YXJnZXQgfj0gbmlsICkgYW5kIHNlbGY6UVJ1c2VkKCkgdGhlbg0Kc2VsZjpDYXN0RVcodGFyZ2V0KQ0KZW5kDQplbmQNCiBpZiBzZWxmLkNvbmZpZy5jb21iby50dXJudy53MiB0aGVuDQppZiAoc2VsZi50c3cudGFyZ2V0IH49IG5pbCApdGhlbg0Kc2VsZjpDYXN0UVIodGFyZ2V0KQ0KZW5kDQppZihzZWxmLnRzdy50YXJnZXQgfj0gbmlsICkgYW5kIHNlbGY6UUV1c2VkKCkgdGhlbg0Kc2VsZjpDYXN0RVdCKHRhcmdldCkNCmVuZA0KZW5kDQplbmQNCmZ1bmN0aW9uIExlYmxhbmM6Y29tYm9FV1FSKCkNCiBzZWxmLnRzdzp1cGRhdGUoKQ0KIGlmIG5vdCBzZWxmLkNvbmZpZy5jb21iby50dXJudy53NCB0aGVuDQppZiAoc2VsZi50c3cudGFyZ2V0IH49IG5pbCApdGhlbg0Kc2VsZjpDYXN0RVcodGFyZ2V0KQ0KZW5kDQppZihzZWxmLnRzdy50YXJnZXQgfj0gbmlsICkgYW5kIHNlbGY6RVd1c2VkKCkgdGhlbg0Kc2VsZjpDYXN0UVIodGFyZ2V0KQ0KZW5kDQplbmQNCiBpZiAgc2VsZi5Db25maWcuY29tYm8udHVybncudzQgdGhlbg0KaWYgKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgKXRoZW4NCnNlbGY6Q2FzdEVXQih0YXJnZXQpDQplbmQNCmlmKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgKSBhbmQgc2VsZjpFV3VzZWQoKSB0aGVuDQpzZWxmOkNhc3RRUih0YXJnZXQpDQplbmQNCmVuZA0KZW5kDQpmdW5jdGlvbiBMZWJsYW5jOmNvbWJvRVFXUigpDQogc2VsZi50c3c6dXBkYXRlKCkNCiBpZiBub3Qgc2VsZi5Db25maWcuY29tYm8udHVybncudzMgdGhlbg0KaWYgKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgKXRoZW4NCnNlbGY6Q2FzdEVRKHRhcmdldCkNCmVuZA0KaWYoc2VsZi50c3cudGFyZ2V0IH49IG5pbCApIGFuZCBzZWxmOkVRdXNlZCgpIHRoZW4NCnNlbGY6Q2FzdFdSKHRhcmdldCkNCmVuZA0KZW5kDQogaWYgIHNlbGYuQ29uZmlnLmNvbWJvLnR1cm53LnczIHRoZW4NCmlmIChzZWxmLnRzdy50YXJnZXQgfj0gbmlsICl0aGVuDQpzZWxmOkNhc3RFUSh0YXJnZXQpDQplbmQNCmlmKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgKSBhbmQgc2VsZjpFUXVzZWQoKSB0aGVuDQpzZWxmOkNhc3RXUkIodGFyZ2V0KQ0KZW5kDQplbmQNCmVuZA0KZnVuY3Rpb24gTGVibGFuYzpjb21ib1FFV1IoKQ0KIHNlbGYudHN3OnVwZGF0ZSgpDQogaWYgbm90IHNlbGYuQ29uZmlnLmNvbWJvLnR1cm53LncxIHRoZW4NCmlmIChzZWxmLnRzdy50YXJnZXQgfj0gbmlsICl0aGVuDQpzZWxmOkNhc3RRRSh0YXJnZXQpDQplbmQNCmlmKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgKSBhbmQgc2VsZjpRRXVzZWQoKSB0aGVuDQpzZWxmOkNhc3RXUih0YXJnZXQpDQplbmQNCmVuZA0KIGlmIHNlbGYuQ29uZmlnLmNvbWJvLnR1cm53LncxIHRoZW4NCmlmIChzZWxmLnRzdy50YXJnZXQgfj0gbmlsICl0aGVuDQpzZWxmOkNhc3RRRSh0YXJnZXQpDQplbmQNCmlmKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgKSBhbmQgc2VsZjpRRXVzZWQoKSB0aGVuDQpzZWxmOkNhc3RXUkIodGFyZ2V0KQ0KZW5kDQplbmQNCmVuZA0KZnVuY3Rpb24gTGVibGFuYzpDYXN0USh1bml0KQ0KICBzZWxmLlFTcGVsbDpDYXN0KHVuaXQpDQplbmQNCmZ1bmN0aW9uIExlYmxhbmM6Q2FzdFFFKHVuaXQpDQogICAgICBzZWxmLnRzcTp1cGRhdGUoKQ0KICAgICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgIGlmKHNlbGYudHNxLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VRIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgICBhbmQgc2VsZi5RU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0USh0YXJnZXQpDQogICBlbmQNCiAgICAgICBzZWxmLnRzZTp1cGRhdGUoKQ0KICAgICAgICBpZihzZWxmLnRzZS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlRSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICBhbmQgc2VsZi5FU3BlbGw6SXNSZWFkeSgpKSB0aGVuDQogICAgICAgIHNlbGY6Q2FzdEUodGFyZ2V0KQ0KICAgICAgICBlbmQNCiAgICAgICAgZW5kDQpmdW5jdGlvbiBMZWJsYW5jOkNhc3RFVyh1bml0KQ0KICAgICAgc2VsZi50c2U6dXBkYXRlKCkNCiAgICBpZihzZWxmLnRzZS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlRSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICAgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgIHNlbGY6Q2FzdEUodGFyZ2V0KQ0KICAgZW5kDQogICAgICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgICAgICAgaWYoc2VsZi50c3cudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVcgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgYW5kIG5vdCBzZWxmOndVc2VkKCkgYW5kIHNlbGYuV1NwZWxsOklzUmVhZHkoKSkgdGhlbg0KICAgICAgICBzZWxmOkNhc3RXKHRhcmdldCkNCiAgICAgICAgZW5kDQplbmQNCmZ1bmN0aW9uIExlYmxhbmM6Q2FzdEVXQih1bml0KQ0KICAgICAgc2VsZi50c2U6dXBkYXRlKCkNCiAgICBpZihzZWxmLnRzZS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlRSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICAgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgIHNlbGY6Q2FzdEUodGFyZ2V0KQ0KICAgZW5kDQogICAgICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgICAgICAgaWYoc2VsZi50c3cudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVcgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICBhbmQgc2VsZi5XU3BlbGw6SXNSZWFkeSgpKSB0aGVuDQogICAgICAgIHNlbGY6Q2FzdFcodGFyZ2V0KQ0KICAgICAgICBlbmQNCmVuZA0KZnVuY3Rpb24gTGVibGFuYzpyYW5kb21jb21ibygpDQogICAgICBzZWxmLnRzcTp1cGRhdGUoKQ0KICAgIGlmKHNlbGYudHNxLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VRIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgICBhbmQgc2VsZi5RU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0USh0YXJnZXQpICAgICANCiAgICAgICAgZW5kDQogICAgICAgIHNlbGYudHN3OnVwZGF0ZSgpDQogICAgaWYoc2VsZi50c3cudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVcgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgIGFuZCBzZWxmLldTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICBzZWxmOkNhc3RXKHRhcmdldCkgICAgICANCiAgICAgICAgZW5kDQogICAgICAgIHNlbGYudHNlOnVwZGF0ZSgpDQogICAgaWYoc2VsZi50c2UudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZUUgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgIGFuZCBzZWxmLkVTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICBzZWxmOkNhc3RFKHRhcmdldCkgICAgDQogICAgICAgIGVuZA0KICAgICAgICAgc2VsZi50c3I6dXBkYXRlKCkNCiAgICBpZihzZWxmLnRzci50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUiBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICAgYW5kIHNlbGYuUVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgIHNlbGY6Q2FzdFIodGFyZ2V0KQ0KICAgICAgICBlbmQNCmVuZA0KZnVuY3Rpb24gTGVibGFuYzpDYXN0UVIodW5pdCkNCiAgICAgIHNlbGYudHNxOnVwZGF0ZSgpDQogICAgICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgICBpZihzZWxmLnRzcS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICAgYW5kIHNlbGYuUVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgIHNlbGY6Q2FzdFEodGFyZ2V0KQ0KICAgZW5kDQogICAgICAgc2VsZi50c3I6dXBkYXRlKCkNCiAgICAgICAgaWYoc2VsZi50c3IudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVIgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgYW5kIHNlbGYuUlNwZWxsOklzUmVhZHkoKSkgdGhlbg0KICAgICAgICBzZWxmOkNhc3RSKHRhcmdldCkNCiAgICAgICAgZW5kDQplbmQNCmZ1bmN0aW9uIExlYmxhbmM6Q2FzdFdSKHVuaXQpDQogICAgICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgIGlmKHNlbGYudHN3LnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VXIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgICBhbmQgc2VsZi5XU3BlbGw6SXNSZWFkeSgpYW5kIG5vdCBzZWxmOndVc2VkKCkpdGhlbg0KICAgICAgICBzZWxmOkNhc3RXKHRhcmdldCkNCiAgIGVuZA0KICAgICAgIHNlbGYudHNyOnVwZGF0ZSgpDQogICAgICAgIGlmKHNlbGYudHNyLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VSIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgIGFuZCBzZWxmLlJTcGVsbDpJc1JlYWR5KCkpIGFuZCBub3Qgc2VsZjpyVXNlZCgpICB0aGVuDQogICAgICAgIHNlbGY6Q2FzdFIodGFyZ2V0KQ0KICAgICAgICBlbmQNCmVuZA0KZnVuY3Rpb24gTGVibGFuYzpDYXN0V1JCKHVuaXQpDQogICAgICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgIGlmKHNlbGYudHN3LnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VXIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgICBhbmQgc2VsZi5XU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0Vyh0YXJnZXQpDQogICBlbmQNCiAgICAgICBzZWxmLnRzcjp1cGRhdGUoKQ0KICAgICAgICBpZihzZWxmLnRzci50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUiBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICBhbmQgc2VsZi5SU3BlbGw6SXNSZWFkeSgpKSBhbmQgbm90IHNlbGY6clVzZWQoKSAgdGhlbg0KICAgICAgICBzZWxmOkNhc3RSKHRhcmdldCkNCiAgICAgICAgZW5kDQplbmQNCmZ1bmN0aW9uIExlYmxhbmM6Q2FzdFFXSCgpDQogICAgICBzZWxmLnRzcTp1cGRhdGUoKQ0KICAgIGlmKHNlbGYudHNxLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5oYXJhc3MudXNlUSBhbmQgIHNlbGYuQ29uZmlnLktleXMuaGFyYXNza2V5ICBhbmQgc2VsZi5RU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0USh0YXJnZXQpDQogICBlbmQNCiAgICAgIHNlbGYudHN3OnVwZGF0ZSgpDQogICAgaWYoc2VsZi50c3cudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmhhcmFzcy51c2VXIGFuZCAgc2VsZi5Db25maWcuS2V5cy5oYXJhc3NrZXkgIGFuZCBzZWxmLldTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgIHNlbGY6Q2FzdFcodGFyZ2V0KQ0KICAgZW5kDQplbmQNCmZ1bmN0aW9uIExlYmxhbmM6Q2FzdFFXSyh1bml0KQ0KICAgICAgc2VsZi50c3E6dXBkYXRlKCkNCiAgICBpZihzZWxmLnRzcS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZVFXIGFuZCAgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzIGFuZCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICBzZWxmOkNhc3RRKHRhcmdldCkNCiAgIGVuZA0KICAgICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgICBpZihzZWxmLnRzdy50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZVFXIGFuZCAgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzIGFuZCBzZWxmLldTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICBzZWxmOkNhc3RXKHRhcmdldCkNCiAgIGVuZA0KZW5kDQpmdW5jdGlvbiBMZWJsYW5jOkNhc3RFUSh1bml0KQ0KICAgICAgc2VsZi50c2U6dXBkYXRlKCkNCiAgICAgIHNlbGYudHN3OnVwZGF0ZSgpDQogICAgaWYoc2VsZi50c2UudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZUUgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgIGFuZCBzZWxmLkVTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICBzZWxmOkNhc3RFKHRhcmdldCkNCiAgIGVuZA0KICAgICAgIHNlbGYudHNxOnVwZGF0ZSgpDQogICAgICAgIGlmKHNlbGYudHNxLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VRIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgIGFuZCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkpIHRoZW4NCiAgICAgICAgc2VsZjpDYXN0USh0YXJnZXQpDQogICAgICAgIGVuZA0KZW5kDQpmdW5jdGlvbiBMZWJsYW5jOkNhc3RXKHVuaXQpDQogIHNlbGYuV1NwZWxsOkNhc3QodW5pdCkNCmVuZA0KDQpmdW5jdGlvbiBMZWJsYW5jOkNhc3RFKHVuaXQpDQogc2VsZi5FU3BlbGw6Q2FzdCh1bml0KQ0KICANCmVuZA0KDQpmdW5jdGlvbiBMZWJsYW5jOkNhc3RSKHVuaXQpDQogIHNlbGYuUlNwZWxsOkNhc3QodW5pdCkNCmVuZA0KDQpmdW5jdGlvbiBMZWJsYW5jOkNhc3RJKHVuaXQpDQogIHNlbGYuSWduaXRlOkNhc3QodW5pdCkNCmVuZA0KZnVuY3Rpb24gTGVibGFuYzpraWxsc3RlYWwoKQ0KZm9yIF8sIHVuaXQgaW4gcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8NCiAgICBsb2NhbCBoZWFsdGggPSB1bml0LmhlYWx0aA0KICAgIGxvY2FsIGRtZ0UgPSBnZXREbWcoIkUiLCB1bml0LCBteUhlcm8pICsgKChteUhlcm8uYXApKjAuNSkgKyAoZ2V0RG1nKCJFIiwgdW5pdCwgbXlIZXJvKSArICgobXlIZXJvLmFwKSowLjUpKQ0KICAgICAgaWYoc2VsZi50c2UudGFyZ2V0IH49IG5pbCBhbmQgIHNlbGYuRVNwZWxsOklzUmVhZHkoKSBhbmQgbm90IHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICBhbmQgaGVhbHRoPGRtZ0UgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VFICAgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyl0aGVuDQogICAgICAgIHNlbGY6Q2FzdEUodW5pdCkgIA0KICAgICAgZW5kDQogICAgICBsb2NhbCBkbWdRID0gZ2V0RG1nKCJRIiwgdW5pdCwgbXlIZXJvKSArICgobXlIZXJvLmFwKSowLjQwKQ0KICAgICAgaWYoc2VsZi50c3EudGFyZ2V0IH49IG5pbCBhbmQgIHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgbm90IHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICBhbmQgaGVhbHRoPGRtZ1EgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VRIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0USh1bml0KSAgDQogICAgICBlbmQNCiAgICAgICBsb2NhbCBkbWdRVyA9IGdldERtZygiUSIsIHVuaXQsIG15SGVybykgKyAoKG15SGVyby5hcCkqMC40MCkrKGdldERtZygiVyIsIHVuaXQsIG15SGVybykgKyAoKG15SGVyby5hcCkqMC42MCkrKGdldERtZygiUSIsIHVuaXQsIG15SGVybykgKyAoKG15SGVyby5hcCkqMC40MCkpKQ0KICAgICAgaWYoc2VsZi50c3cudGFyZ2V0IH49IG5pbCBhbmQgIGhlYWx0aDxkbWdRIGFuZCBub3Qgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlUVcgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyApdGhlbg0KICAgICAgICBzZWxmOkNhc3RRV0sodW5pdCkgIA0KICAgICAgZW5kDQogICAgICAgICAgICBsb2NhbCBkbWdXID0gZ2V0RG1nKCJXIiwgdW5pdCwgbXlIZXJvKSArICgobXlIZXJvLmFwKSowLjYwKQ0KICAgICAgaWYoc2VsZi50c3cudGFyZ2V0IH49IG5pbCBhbmQgIHNlbGYuV1NwZWxsOklzUmVhZHkoKSBhbmQgbm90IHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICBhbmQgaGVhbHRoPGRtZ1EgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VXIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0Vyh1bml0KSAgDQogICAgICBlbmQNCiAgICAgICBsb2NhbCBkbWdJID0oNTArICgobXlIZXJvLmxldmVsKSoyMCkpDQogICAgICBpZihoZWFsdGg8ZG1nSSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZUkgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyBhbmQgR2V0RGlzdGFuY2UodW5pdCk8NjAwKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0SSh1bml0KQ0KICAgICAgZW5kDQogICAgICBsb2NhbCBkbWdSID1nZXREbWcoIlIiLHVuaXQsbXlIZXJvKSsoKG15SGVyby5hcCkqMC42MCkgDQogICAgICBpZihzZWxmLnRzci50YXJnZXQgfj0gbmlsIGFuZCAgc2VsZi5SU3BlbGw6SXNSZWFkeSgpIGFuZCBub3Qgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgIGFuZCBoZWFsdGg8ZG1nUiBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZVIgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyBhbmQgR2V0RGlzdGFuY2UodW5pdCk8NjAwKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0Uih1bml0KQ0KICAgICAgZW5kDQogICBlbmQNCmVuZA0KZnVuY3Rpb24gTGVibGFuYzpoYXJhc3MoKQ0KICBzZWxmLnRzcTp1cGRhdGUoKQ0KICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgaWYgc2VsZi5Db25maWcuS2V5cy5oYXJhc3NrZXkgIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmhhcmFzcy5NYW5hIC8xMDAgKSAgdGhlbg0KICBzZWxmOkNhc3RRV0goKQ0KICAgIGVuZCAgIA0KIGVuZA0KIGZ1bmN0aW9uIExlYmxhbmM6TGFuZUNsZWFyKCkNCmxvY2FsIGNsZWFydGFyZ2V0ID0gc2VsZi5jbGVhcnRhcmdldA0Kc2VsZi5lbmVteU1pbmlvbnM6dXBkYXRlKCkNCiBzZWxmLm90aGVyTWluaW9uczp1cGRhdGUoKQ0KICAgIHNlbGYuanVuZ2xlTWluaW9uczp1cGRhdGUoKQ0KICAgIGZvciBpLCBtaW5pb24gaW4gaXBhaXJzKHNlbGYuZW5lbXlNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICBpZiBWYWxpZFRhcmdldChtaW5pb24sIDYwMCkgYW5kIChjbGVhcnRhcmdldCA9PSBuaWwgb3Igbm90IFZhbGlkVGFyZ2V0KGNsZWFydGFyZ2V0KSkgdGhlbg0KICAgICAgICBjbGVhcnRhcmdldCA9IG1pbmlvbg0KICAgICAgZW5kDQogICAgZW5kDQogICAgZm9yIGksIG1pbmlvbiBpbiBwYWlycyhzZWxmLmVuZW15TWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgaWYgVmFsaWRUYXJnZXQobWluaW9uKSBhbmQgbWluaW9uIH49IG5pbCB0aGVuDQogICAgICAgIGlmIHNlbGYuQ29uZmlnLktleXMubGFuZWNsZWFya2V5ICBhbmQgc2VsZi5Db25maWcubGFuZWNsZWFyLnVzZVEgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcubGFuZWNsZWFyLk1hbmEgLzEwMCApIGFuZCBHZXREaXN0YW5jZShtaW5pb24pIDw9IHNlbGYuUVNwZWxsLlJhbmdlIHRoZW4gDQogICAgICAgICAgIHNlbGY6Q2FzdFEoY2xlYXJ0YXJnZXQpDQogICAgICAgIGVuZA0KICAgICAgICBpZiBzZWxmLkNvbmZpZy5LZXlzLmxhbmVjbGVhcmtleSAgYW5kIHNlbGYuQ29uZmlnLmxhbmVjbGVhci51c2VXIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmxhbmVjbGVhci5NYW5hIC8xMDAgKSBhbmQgR2V0RGlzdGFuY2UobWluaW9uKSA8PSBzZWxmLldTcGVsbC5SYW5nZSB0aGVuIA0KICAgICAgICAgIGxvY2FsIEJlc3RQb3MsIEJlc3RIaXQgPSBHZXRCZXN0Q2lyY3VsYXJGYXJtUG9zaXRpb24oc2VsZi5XU3BlbGwuUmFuZ2UsIHNlbGYuV1NwZWxsLldpZHRoLCBzZWxmLmVuZW15TWluaW9ucy5vYmplY3RzKQ0KICAgICAgICAgIGlmIEJlc3RQb3Mgfj0gbmlsIHRoZW4NCiAgICAgICAgICAgIENhc3RTcGVsbChfVywgQmVzdFBvcy54LCBCZXN0UG9zLnopDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBpZiBzZWxmLkNvbmZpZy5LZXlzLmxhbmVjbGVhcmtleSAgYW5kIHNlbGYuQ29uZmlnLmxhbmVjbGVhci51c2VSIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmxhbmVjbGVhci5NYW5hIC8xMDAgKSBhbmQgR2V0RGlzdGFuY2UobWluaW9uKSA8PSBzZWxmLldTcGVsbC5SYW5nZSB0aGVuIA0KICAgICAgICAgIGxvY2FsIEJlc3RQb3MsIEJlc3RIaXQgPSBHZXRCZXN0Q2lyY3VsYXJGYXJtUG9zaXRpb24oc2VsZi5XU3BlbGwuUmFuZ2UsIHNlbGYuV1NwZWxsLldpZHRoLCBzZWxmLmVuZW15TWluaW9ucy5vYmplY3RzKQ0KICAgICAgICAgIGlmIEJlc3RQb3Mgfj0gbmlsIHRoZW4NCiAgICAgICAgICAgIENhc3RTcGVsbChfUiwgQmVzdFBvcy54LCBCZXN0UG9zLnopDQogICAgICAgIGVuZA0KICAgICAgZW5kICAgICAgICANCiAgICBlbmQNCiAgZW5kDQplbmQNCg0KZnVuY3Rpb24gTGVibGFuYzpKdW5nbGVDbGVhcigpDQpsb2NhbCBjbGVhcnRhcmdldCA9IG5pbA0KICAgIHNlbGYuZW5lbXlNaW5pb25zOnVwZGF0ZSgpDQogICAgc2VsZi5vdGhlck1pbmlvbnM6dXBkYXRlKCkNCiAgICBzZWxmLmp1bmdsZU1pbmlvbnM6dXBkYXRlKCkNCiAgICBmb3IgaSwgbWluaW9uIGluIGlwYWlycyhzZWxmLmVuZW15TWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgaWYgVmFsaWRUYXJnZXQobWluaW9uLCA2MDApIGFuZCAoY2xlYXJ0YXJnZXQgPT0gbmlsIG9yIG5vdCBWYWxpZFRhcmdldChjbGVhcnRhcmdldCkpIHRoZW4NCiAgICAgICAgY2xlYXJ0YXJnZXQgPSBtaW5pb24NCiAgICAgIGVuZA0KICAgIGVuZA0KICAgIGZvciBpLCBqdW5nbGVtaW5pb24gaW4gaXBhaXJzKHNlbGYuanVuZ2xlTWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgaWYgVmFsaWRUYXJnZXQoanVuZ2xlbWluaW9uLCA2MDApIGFuZCAoY2xlYXJ0YXJnZXQgPT0gbmlsIG9yIG5vdCBWYWxpZFRhcmdldChjbGVhcnRhcmdldCkpIHRoZW4NCiAgICAgICAgY2xlYXJ0YXJnZXQgPSBqdW5nbGVtaW5pb24NCiAgICAgIGVuZA0KICAgIGVuZA0KICAgIGZvciBpLCBvdGhlcm1pbmlvbiBpbiBpcGFpcnMoc2VsZi5vdGhlck1pbmlvbnMub2JqZWN0cykgZG8NCiAgICAgIGlmIFZhbGlkVGFyZ2V0KG90aGVybWluaW9uLCA2MDApIGFuZCAoY2xlYXJ0YXJnZXQgPT0gbmlsIG9yIG5vdCBWYWxpZFRhcmdldChjbGVhcnRhcmdldCkpIHRoZW4NCiAgICAgICAgY2xlYXJ0YXJnZXQgPSBvdGhlcm1pbmlvbg0KICAgICAgZW5kDQogICAgZW5kDQogICAgaWYgY2xlYXJ0YXJnZXQgfj0gbmlsIHRoZW4NCiAgICAgIGlmKHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcuanVuZ2xlY2xlYXIudXNlUSBhbmQgc2VsZi5Db25maWcuS2V5cy5qdW5nbGVjbGVhcmtleSApIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyLk1hbmEgLzEwMCApIHRoZW4NCiAgICAgICAgc2VsZjpDYXN0UShjbGVhcnRhcmdldCkNCiAgICAgIGVuZA0KICAgICAgaWYgY2xlYXJ0YXJnZXQgfj0gbmlsIHRoZW4NCiAgICAgIGlmKHNlbGYuV1NwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcuanVuZ2xlY2xlYXIudXNlVyBhbmQgc2VsZi5Db25maWcuS2V5cy5qdW5nbGVjbGVhcmtleSApIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyLk1hbmEgLzEwMCApIHRoZW4NCiAgICAgICAgc2VsZjpDYXN0VyhjbGVhcnRhcmdldCkNCiAgICAgIGVuZA0KICAgICAgaWYgY2xlYXJ0YXJnZXQgfj0gbmlsIHRoZW4NCiAgICAgIGlmKHNlbGYuRVNwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcuanVuZ2xlY2xlYXIudXNlRSBhbmQgc2VsZi5Db25maWcuS2V5cy5qdW5nbGVjbGVhcmtleSApIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyLk1hbmEgLzEwMCApIHRoZW4NCiAgICAgICAgc2VsZjpDYXN0RShjbGVhcnRhcmdldCkNCiAgICAgIGVuZA0KICAgIGVuZA0KICBlbmQNCmVuZA0KZW5kDQpmdW5jdGlvbiBMZWJsYW5jOndVc2VkKCkgDQogIGxvY2FsIGxlYmxhbmNXID0gbXlIZXJvOkdldFNwZWxsRGF0YShfVykNCiAgaWYgbGVibGFuY1cubmFtZSA9PSAibGVibGFuY3NsaWRlcmV0dXJuIiB0aGVuIA0KICAgIHJldHVybiB0cnVlIA0KICBlbHNlIA0KICAgIHJldHVybiBmYWxzZQ0KICBlbmQNCmVuZA0KZnVuY3Rpb24gTGVibGFuYzpyVXNlZCgpIA0KICBsb2NhbCBsZWJsYW5jUiA9IG15SGVybzpHZXRTcGVsbERhdGEoX1IpDQogIGlmIGxlYmxhbmNSLm5hbWUgPT0gIkxlYmxhbmNTbGlkZU0iIHRoZW4gDQogICAgcmV0dXJuIGZhbHNlDQogIGVsc2UgDQogICAgcmV0dXJuIHRydWUNCiAgZW5kDQplbmQNCmZ1bmN0aW9uIExlYmxhbmM6UUV1c2VkKCkgDQogIGxvY2FsIGxlYmxhbmNRID0gc2VsZi5RU3BlbGw6SXNSZWFkeSgpDQogIGxvY2FsIGxlYmxhbmNFID0gc2VsZi5FU3BlbGw6SXNSZWFkeSgpDQogIGlmIChsZWJsYW5jUSBhbmQgbGVibGFuY0UpIHRoZW4gDQogICAgcmV0dXJuIGZhbHNlIA0KICBlbHNlIA0KICAgIHJldHVybiB0cnVlDQogIGVuZA0KZW5kDQpmdW5jdGlvbiBMZWJsYW5jOkVRdXNlZCgpIA0KICBsb2NhbCBsZWJsYW5jVyA9IHNlbGYuRVNwZWxsOklzUmVhZHkoKQ0KICBsb2NhbCBsZWJsYW5jRSA9IHNlbGYuUVNwZWxsOklzUmVhZHkoKQ0KICBpZiAobGVibGFuY1cgYW5kIGxlYmxhbmNFKSB0aGVuIA0KICAgIHJldHVybiBmYWxzZSANCiAgZWxzZSANCiAgICByZXR1cm4gdHJ1ZQ0KICBlbmQNCmVuZA0KZnVuY3Rpb24gTGVibGFuYzpFV3VzZWQoKSANCiAgbG9jYWwgbGVibGFuY1cgPSBzZWxmLkVTcGVsbDpJc1JlYWR5KCkNCiAgbG9jYWwgbGVibGFuY0UgPSBzZWxmLldTcGVsbDpJc1JlYWR5KCkNCiAgaWYgKGxlYmxhbmNXIGFuZCBsZWJsYW5jRSkgdGhlbiANCiAgICByZXR1cm4gZmFsc2UgDQogIGVsc2UgDQogICAgcmV0dXJuIHRydWUNCiAgZW5kDQplbmQNCmZ1bmN0aW9uIExlYmxhbmM6UVJ1c2VkKCkgDQogIGxvY2FsIGxlYmxhbmNXID0gc2VsZi5RU3BlbGw6SXNSZWFkeSgpDQogIGxvY2FsIGxlYmxhbmNFID0gc2VsZi5SU3BlbGw6SXNSZWFkeSgpDQogIGlmIChsZWJsYW5jVyBhbmQgbGVibGFuY0UpIHRoZW4gDQogICAgcmV0dXJuIGZhbHNlIA0KICBlbHNlIA0KICAgIHJldHVybiB0cnVlDQogIGVuZA0KZW5kDQpsb2NhbCBzcGVsbExldmVsID0gMA0KZnVuY3Rpb24gTGVibGFuYzphdXRvbGV2ZWwoKQ0KaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSAxICkgdGhlbg0KaWYgbXlIZXJvLmxldmVsID09IDEgdGhlbg0KIExldmVsU3BlbGwoX1cpIA0KIGVsc2VpZiBteUhlcm8ubGV2ZWwgPT0gMiB0aGVuDQogTGV2ZWxTcGVsbChfUSkgDQogZWxzZWlmIG15SGVyby5sZXZlbCA9PSAzIHRoZW4NCiBMZXZlbFNwZWxsKF9FKSANCiBlbHNlaWYgbXlIZXJvLmxldmVsID4gMyBhbmQgbXlIZXJvLmxldmVsID4gc3BlbGxMZXZlbCB0aGVuDQogICAgICAgIHNwZWxsTGV2ZWwgPSBzcGVsbExldmVsICsgMSAgICAgICAgDQogICAgICAgICBMZXZlbFNwZWxsKF9SKQ0KICAgICAgICAgICAgTGV2ZWxTcGVsbChfUSkNCiAgICAgICAgICAgIExldmVsU3BlbGwoX1cpDQogICAgICAgICAgICBMZXZlbFNwZWxsKF9FKQ0KICAgICAgICAgICAgZW5kDQogICAgZWxzZWlmICggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDIgKSB0aGVuDQogICAgaWYgbXlIZXJvLmxldmVsID09IDEgdGhlbg0KIExldmVsU3BlbGwoX1cpIA0KIGVsc2VpZiBteUhlcm8ubGV2ZWwgPT0gMiB0aGVuDQogTGV2ZWxTcGVsbChfUSkgDQogZWxzZWlmIG15SGVyby5sZXZlbCA9PSAzIHRoZW4NCiBMZXZlbFNwZWxsKF9FKSANCiBlbHNlaWYgbXlIZXJvLmxldmVsID4gMyBhbmQgbXlIZXJvLmxldmVsID4gc3BlbGxMZXZlbCB0aGVuDQogICAgICAgIHNwZWxsTGV2ZWwgPSBzcGVsbExldmVsICsgMSAgICAgICAgDQogICAgICAgICBMZXZlbFNwZWxsKF9SKQ0KICAgICAgICAgICAgTGV2ZWxTcGVsbChfUSkNCiAgICAgICAgICAgIExldmVsU3BlbGwoX0UpDQogICAgICAgICAgICBMZXZlbFNwZWxsKF9XKQ0KICAgICAgICAgICAgZW5kDQogICBlbHNlaWYgKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gMyApIHRoZW4NCiAgICBpZiBteUhlcm8ubGV2ZWwgPT0gMSB0aGVuDQogTGV2ZWxTcGVsbChfUSkgDQogZWxzZWlmIG15SGVyby5sZXZlbCA9PSAyIHRoZW4NCiBMZXZlbFNwZWxsKF9XKSANCiBlbHNlaWYgbXlIZXJvLmxldmVsID09IDMgdGhlbg0KIExldmVsU3BlbGwoX0UpIA0KIGVsc2VpZiBteUhlcm8ubGV2ZWwgPiAzIGFuZCBteUhlcm8ubGV2ZWwgPiBzcGVsbExldmVsIHRoZW4NCiAgICAgICAgc3BlbGxMZXZlbCA9IHNwZWxsTGV2ZWwgKyAxICAgICAgICANCiAgICAgICAgIExldmVsU3BlbGwoX1IpDQogICAgICAgICAgICBMZXZlbFNwZWxsKF9XKQ0KICAgICAgICAgICAgTGV2ZWxTcGVsbChfUSkNCiAgICAgICAgICAgIExldmVsU3BlbGwoX0UpDQogICAgICAgICAgICBlbmQNCiAgICAgICAgICAgIGVsc2VpZiAoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSA0ICkgdGhlbg0KICAgIGlmIG15SGVyby5sZXZlbCA9PSAxIHRoZW4NCiBMZXZlbFNwZWxsKF9RKSANCiBlbHNlaWYgbXlIZXJvLmxldmVsID09IDIgdGhlbg0KIExldmVsU3BlbGwoX1cpIA0KIGVsc2VpZiBteUhlcm8ubGV2ZWwgPT0gMyB0aGVuDQogTGV2ZWxTcGVsbChfRSkgDQogZWxzZWlmIG15SGVyby5sZXZlbCA+IDMgYW5kIG15SGVyby5sZXZlbCA+IHNwZWxsTGV2ZWwgdGhlbg0KICAgICAgICBzcGVsbExldmVsID0gc3BlbGxMZXZlbCArIDEgICAgICAgIA0KICAgICAgICAgTGV2ZWxTcGVsbChfUikNCiAgICAgICAgICAgIExldmVsU3BlbGwoX1cpDQogICAgICAgICAgICBMZXZlbFNwZWxsKF9FKQ0KICAgICAgICAgICAgTGV2ZWxTcGVsbChfUSkNCiAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgZWxzZWlmICggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDUgKSB0aGVuDQogICAgaWYgbXlIZXJvLmxldmVsID09IDEgdGhlbg0KIExldmVsU3BlbGwoX1cpIA0KIGVsc2VpZiBteUhlcm8ubGV2ZWwgPT0gMiB0aGVuDQogTGV2ZWxTcGVsbChfRSkgDQogZWxzZWlmIG15SGVyby5sZXZlbCA9PSAzIHRoZW4NCiBMZXZlbFNwZWxsKF9RKSANCiBlbHNlaWYgbXlIZXJvLmxldmVsID4gMyBhbmQgbXlIZXJvLmxldmVsID4gc3BlbGxMZXZlbCB0aGVuDQogICAgICAgIHNwZWxsTGV2ZWwgPSBzcGVsbExldmVsICsgMSAgICAgICAgDQogICAgICAgICBMZXZlbFNwZWxsKF9SKQ0KICAgICAgICAgICAgTGV2ZWxTcGVsbChfVykNCiAgICAgICAgICAgIExldmVsU3BlbGwoX1EpDQogICAgICAgICAgICBMZXZlbFNwZWxsKF9FKQ0KICAgICAgICAgICAgZW5kDQogICAgICAgICAgICBlbHNlaWYgKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gNiApIHRoZW4NCiAgICBpZiBteUhlcm8ubGV2ZWwgPT0gMSB0aGVuDQogTGV2ZWxTcGVsbChfUSkgDQogZWxzZWlmIG15SGVyby5sZXZlbCA9PSAyIHRoZW4NCiBMZXZlbFNwZWxsKF9FKSANCiBlbHNlaWYgbXlIZXJvLmxldmVsID09IDMgdGhlbg0KIExldmVsU3BlbGwoX1cpIA0KIGVsc2VpZiBteUhlcm8ubGV2ZWwgPiAzIGFuZCBteUhlcm8ubGV2ZWwgPiBzcGVsbExldmVsIHRoZW4NCiAgICAgICAgc3BlbGxMZXZlbCA9IHNwZWxsTGV2ZWwgKyAxICAgICAgICANCiAgICAgICAgIExldmVsU3BlbGwoX1IpDQogICAgICAgICAgICBMZXZlbFNwZWxsKF9FKQ0KICAgICAgICAgICAgTGV2ZWxTcGVsbChfUSkNCiAgICAgICAgICAgIExldmVsU3BlbGwoX1cpDQogICAgICAgICAgICBlbmQNCiAgICAgICAgICAgIGVuZA0KZW5kDQpmdW5jdGlvbiBMZWJsYW5jOmF1dG96aG9ueWEoKQ0KICBpZiBzZWxmLkNvbmZpZy5pdGVtLmVuYWJsZWF1dG96aG9ueWEgdGhlbg0KICAgZm9yIF8gPSBJVEVNXzEsIElURU1fNyBkbw0KICAgIGlmIG15SGVyby5oZWFsdGggPD0gKG15SGVyby5tYXhIZWFsdGggKiBzZWxmLkNvbmZpZy5pdGVtLmF1dG96aG9ueWEgLyAxMDApIGFuZCAoIG15SGVybzpDYW5Vc2VTcGVsbChfKSA9PSAwIGFuZCBteUhlcm86R2V0U3BlbGxEYXRhKF8pLm5hbWUgPT0gIlpob255YXNIb3VyZ2xhc3MiICl0aGVuIENhc3RTcGVsbChfKQ0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzplc2NhcGVmb3JnYXAoKQ0KaWYgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLmdhcGNsb3NlIGFuZCBub3Qgc2VsZjp3VXNlZCgpIHRoZW4NCkNhc3RTcGVsbChfVyxtb3VzZVBvcy54LG1vdXNlUG9zLnopDQplbmQNCmVuZA0KZnVuY3Rpb24gTGVibGFuYzplc2NhcGUoKQ0KaWYgc2VsZi5Db25maWcuS2V5cy5lc2NhcGVrZXkgIGFuZCBzZWxmLkNvbmZpZy5lc2NhcGUudXNlVyBhbmQgbm90IHNlbGY6d1VzZWQoKSB0aGVuDQpDYXN0U3BlbGwoX1csbW91c2VQb3MueCxtb3VzZVBvcy56KQ0KZW5kDQppZiBzZWxmLkNvbmZpZy5LZXlzLmVzY2FwZWtleSAgdGhlbiANCnNlbGY6d2FsaygpDQplbmQNCmlmIHNlbGYuQ29uZmlnLktleXMuZXNjYXBla2V5ICBhbmQgc2VsZi5Db25maWcuZXNjYXBlLnVzZVIgYW5kIG5vdCAgc2VsZjpyVXNlZCgpIHRoZW4NCkNhc3RTcGVsbChfUixtb3VzZVBvcy54LG1vdXNlUG9zLnopDQplbmQNCmVuZA0KZnVuY3Rpb24gTGVibGFuYzp3YWxrKCkNCiAgbXlIZXJvOk1vdmVUbyhtb3VzZVBvcy54LG1vdXNlUG9zLnopDQplbmQNCmZ1bmN0aW9uIExlYmxhbmM6Z2FwY2xvc2UoKQ0KaWYgdGFyZ2V0IGFuZCBHZXREaXN0YW5jZSh0YXJnZXQsbXlIZXJvKT44MDAgdGhlbiANCnNlbGY6ZXNjYXBlZm9yZ2FwKCkNCiAgICBlbmQgDQoNCmVuZA0KZnVuY3Rpb24gTGVibGFuYzpUQVJHRVRDUygpDQogICAgbG9jYWwgVGFyZ2V0ID0gbmlsDQogICAgaWYgc2VsZi5zZWxlY3RlZFRhciB0aGVuIFRhcmdldCA9IHNlbGYuc2VsZWN0ZWRUYXINCiAgICBlbHNlIFRhcmdldCA9IHNlbGYudHN3LnRhcmdldA0KICAgIGVuZA0KZW5kDQpmdW5jdGlvbiBMZWJsYW5jOlduZE1zZyhNc2csIEtleSkNCmlmIHNlbGYuQ29uZmlnLktleXMuY29tYm9tb2RlIHRoZW4NCnNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID0gc2VsZi5Db25maWcuY29tYm8ubG9naWMgKzENCmlmIHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID4gNSB0aGVuIHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID0gMSBlbmQNCmVuZA0KaWYgc2VsZi5Db25maWcudGFyZ2V0c2VsLnRzIHRoZW4gICAgICANCiAgICAgICAgaWYgTXNnID09IFdNX0xCVVRUT05ET1dOIHRoZW4NCiAgICAgICAgICAgIGxvY2FsIG1pbkQgPSAxMA0KICAgICAgICAgICAgbG9jYWwgc3RhcmdldCA9IG5pbA0KICAgICAgICAgICAgZm9yIGksIGVuZW15IGluIGlwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbw0KICAgICAgICAgICAgICAgIGlmIFZhbGlkVGFyZ2V0KGVuZW15KSB0aGVuDQogICAgICAgICAgICAgICAgICAgIGlmIEdldERpc3RhbmNlKGVuZW15LCBtb3VzZVBvcykgPD0gbWluRCBvciBzdGFyZ2V0ID09IG5pbCB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgICBtaW5EID0gR2V0RGlzdGFuY2UoZW5lbXksIG1vdXNlUG9zKQ0KICAgICAgICAgICAgICAgICAgICAgICAgc3RhcmdldCA9IGVuZW15DQogICAgICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgZW5kICAgICANCiAgICAgICAgICAgIGlmIHN0YXJnZXQgYW5kIG1pbkQgPCA1MDAgdGhlbg0KICAgICAgICAgICAgICAgIGlmIHNlbGYuc2VsZWN0ZWRUYXIgYW5kIHN0YXJnZXQuY2hhck5hbWUgPT0gc2VsZi5zZWxlY3RlZFRhci5jaGFyTmFtZSB0aGVuDQogICAgICAgICAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWRUYXIgPSBuaWwNCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoIjxmb250IGNvbG9yPVwiI0NCRjZGRlwiPlRhcmdldCA8Yj5pcyBubyBsb2dlciBzZWxlY3RlZC48L2I+OiAiLi5zdGFyZ2V0LmNoYXJOYW1lLi4iPC9mb250PiIpDQogICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgICAgICBzZWxmLnNlbGVjdGVkVGFyID0gc3RhcmdldCAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBwcmludCgiPGZvbnQgY29sb3I9XCIjQ0JGNkZGXCI+TmV3IHRhcmdldCA8Yj5zZWxlY3RlZC48L2I+OiAiLi5zdGFyZ2V0LmNoYXJOYW1lLi4iPC9mb250PiIpDQogICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICBlbmQNCiAgICAgICAgZW5kDQogICAgZW5kDQogICAgZW5kDQotLSBBbGwgY2xhc3NpYyBuZWNlc3NlcmllcyBzdGFydA0KLS0gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tTGVCbGFuYyBFbmRpbmctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQotLSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1MZUJsYW5jIEVuZGluZy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCi0tIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLUxlQmxhbmMgRW5kaW5nLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KLS0gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tTGVCbGFuYyBFbmRpbmctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoNCi0tIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLUxpc2FuZHJhIHN0YXJ0aW5nLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KLS0gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tTGlzYW5kcmEgc3RhcnRpbmctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQotLSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1MaXNhbmRyYSBzdGFydGluZy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCi0tIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLUxpc2FuZHJhIHN0YXJ0aW5nLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KY2xhc3MgIkxpc3NhbmRyYSINCmZ1bmN0aW9uIExpc3NhbmRyYTpfX2luaXQoKQ0KIHNlbGYudHM9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDU1MCwgREFNQUdFX1BIWVNJQ0FMLCBmYWxzZSwgdHJ1ZSkNCnNlbGYudHNxPSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCA3MjUsIERBTUFHRV9QSFlTSUNBTCwgZmFsc2UsIHRydWUpDQpzZWxmLnRzdz0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgNDUwLCBEQU1BR0VfTUFHSUMsIGZhbHNlLCB0cnVlKQ0Kc2VsZi50c2U9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDEwNTAsIERBTUFHRV9NQUdJQywgZmFsc2UsIHRydWUpDQpzZWxmLnRzcj0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgNTUwLCBEQU1BR0VfTUFHSUMsIGZhbHNlLCB0cnVlKSANCiAgIHNlbGYuUVNwZWxsID0gX1NwZWxsKHtTbG90ID0gX1EsIERhbWFnZU5hbWUgPSAiUSIsIFJhbmdlID0gNzI1LCBXaWR0aCA9IDIwLCBEZWxheSA9IDAuMjUsIFNwZWVkID0gbWF0aC5odWdlLCBDb2xsaXNpb24gPSBmYWxzZSwgQW9lID0gZmFsc2UsIFR5cGUgPSBTUEVMTF9UWVBFLkxJTkVBUn0pDQogICBzZWxmLldTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9XLCBEYW1hZ2VOYW1lID0gIlciLCBSYW5nZSA9IDQ1MCwgV2lkdGggPSAwLCBEZWxheSA9IDAuNSwgU3BlZWQgPSBtYXRoLmh1Z2UsIENvbGxpc2lvbiA9IGZhbHNlLCBBb2UgPSB0cnVlLCBUeXBlID0gU1BFTExfVFlQRS5TRUxGfSkNCiAgIHNlbGYuRVNwZWxsID0gX1NwZWxsKHtTbG90ID0gX0UsIERhbWFnZU5hbWUgPSAiRSIsIFJhbmdlID0gMTA1MCwgV2lkdGggPSAxMTAsIERlbGF5ID0gLjI1LCBTcGVlZCA9IG1hdGguaHVnZSwgQ29sbGlzaW9uID0gZmFsc2UsIEFvZSA9IGZhbHNlLCBUeXBlID0gU1BFTExfVFlQRS5MSU5FQVJ9KQ0KICAgc2VsZi5SU3BlbGwgPSBfU3BlbGwoe1Nsb3QgPSBfUiwgRGFtYWdlTmFtZSA9ICJSIiwgUmFuZ2UgPTU1MCwgV2lkdGggPSAwLCBEZWxheSA9IDAuMjUsIFNwZWVkID0gbWF0aC5odWdlLCBDb2xsaXNpb24gPSBmYWxzZSwgQW9lID0gdHJ1ZSwgVHlwZSA9IFNQRUxMX1RZUEUuVEFSR0VUVEVEfSkNCiAgIHNlbGYuUlNTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9SLCBEYW1hZ2VOYW1lID0gIlIiLCBSYW5nZSA9NTUwLCBXaWR0aCA9IDAsIERlbGF5ID0gMC4yNSwgU3BlZWQgPSBtYXRoLmh1Z2UsIENvbGxpc2lvbiA9IGZhbHNlLCBBb2UgPSB0cnVlLCBUeXBlID0gU1BFTExfVFlQRS5UQVJHRVRURUR9KQ0KICAgc2VsZi5JZ25pdGUgPSBfU3BlbGwoe1Nsb3QgPSBGaW5kU3VtbW9uZXJTbG90KCJzdW1tb25lcmRvdCIpLCBEYW1hZ2VOYW1lID0gIklHTklURSIsIFJhbmdlID0gNjAwLCBUeXBlID0gU1BFTExfVFlQRS5UQVJHRVRURUR9KQ0KLS18PiBNaW5pb24gTWFuYWdlcnMNCiAgICBzZWxmLmVuZW15TWluaW9ucyAgID0gbWluaW9uTWFuYWdlcihNSU5JT05fRU5FTVksICAgNjUwLCBteUhlcm8sIE1JTklPTl9TT1JUX01BWEhFQUxUSF9ERUMpDQogICAgc2VsZi5hbGx5TWluaW9ucyAgICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX0FMTFksICAgNjUwLCBteUhlcm8sIE1JTklPTl9TT1JUX01BWEhFQUxUSF9ERUMpDQogICAgc2VsZi5qdW5nbGVNaW5pb25zICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX0pVTkdMRSwgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgIHNlbGYub3RoZXJNaW5pb25zICAgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9PVEhFUiwgICA2NTAsIG15SGVybywgTUlOSU9OX1NPUlRfTUFYSEVBTFRIX0RFQykNCiAgICAgICAgc2VsZjpMb2FkTWVudSgpDQogICAgICAgICAgc2VsZjpmaW5kb3Jid2Fsa2VyKCkNCiAgICAgICAgICAgICAgICAgaWYgVklQX1VTRVIgdGhlbiAgIHNlbGY6c2tpbmhhY2soKSBlbmQNCiAgICAgIEFkZFRpY2tDYWxsYmFjayhmdW5jdGlvbigpIHNlbGY6VGljaygpIGVuZCkNCiAgQWRkRHJhd0NhbGxiYWNrKGZ1bmN0aW9uKCkgc2VsZjpEcmF3KCkgZW5kKQ0KICAtLUFkZE1zZ0NhbGxiYWNrKGZ1bmN0aW9uKG1zZyxLZXkpIHNlbGY6V25kTXNnKG1zZyxLZXkpIGVuZCkNCiAgLS1BZGRBbmltYXRpb25DYWxsYmFjayhmdW5jdGlvbih1bml0LCBhbmltYXRpb24pIHNlbGY6QW5pbWF0aW9uKHVuaXQsIGFuaW1hdGlvbikgZW5kKQ0KICAtLUFkZFByb2Nlc3NTcGVsbENhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIHNwZWxsKSBzZWxmOlByb2Nlc3NTcGVsbCh1bml0LCBzcGVsbCkgZW5kKQ0KICAtLUFkZEFwcGx5QnVmZkNhbGxiYWNrKGZ1bmN0aW9uKHNvdXJjZSwgdW5pdCwgYnVmZikgc2VsZjpPbkFwcGx5QnVmZihzb3VyY2UsIHVuaXQsIGJ1ZmYpIGVuZCkNCiAgLS1BZGRVcGRhdGVCdWZmQ2FsbGJhY2soZnVuY3Rpb24odW5pdCwgYnVmZiwgc3RhY2tzKSBzZWxmOlVwZGF0ZUJ1ZmYodW5pdCwgYnVmZiwgc3RhY2tzKSBlbmQpDQogIC0tQWRkUmVtb3ZlQnVmZkNhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIGJ1ZmYpIHNlbGY6T25SZW1vdmVCdWZmKHVuaXQsIGJ1ZmYpIGVuZCkgDQogICAgZW5kDQogICAgZnVuY3Rpb24gTGlzc2FuZHJhOlRpY2soKQ0KICAgICBzZWxmOmF1dG96aG9ueWEoKQ0KICAgICBzZWxmOmVuZ2FnZXdpdGhyKCkNCiAgICAgICAgICBpZiBWSVBfVVNFUiB0aGVuIHNlbGY6YXV0b2xldmVsKCkgZW5kDQogICAgIHNlbGY6YXV0b1IoKQ0KICAgICBzZWxmOmF1dG9xKCkNCiBpZihzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICl0aGVuDQogICAgc2VsZjpjb21ibygpDQogIGVuZA0KICAgICAgaWYoc2VsZi5Db25maWcuS2V5cy5qdW5nbGVjbGVhcmtleSApdGhlbg0KICAgc2VsZjpKdW5nbGVDbGVhcigpDQogIGVuZA0KICAgIGlmKHNlbGYuQ29uZmlnLktleXMubGFuZWNsZWFya2V5ICl0aGVuDQogICAgc2VsZjpMYW5lQ2xlYXIoKQ0KICBlbmQNCiAgIGlmKHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXlyICl0aGVuDQogICAgc2VsZjplbmdhZ2V3aXRocigpDQogIGVuZA0KICAgIGlmKHNlbGYuQ29uZmlnLktleXMuZXNjYXBla2V5KXRoZW4NCiAgICBzZWxmOmVzY2FwZSgpDQogIGVuZA0KICBpZihzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgKSB0aGVuDQogICAgc2VsZjpraWxsc3RlYWwoKQ0KICBlbmQNCiAgaWYoc2VsZi5Db25maWcuS2V5cy5oYXJhc3NrZXkgb3Igc2VsZi5Db25maWcuS2V5cy5oYXJhc3N0b2dsZWtleSAgKSB0aGVuDQogICAgc2VsZjpoYXJhc3MoKQ0KICBlbmQNCiAgICBlbmQNCiAgICBmdW5jdGlvbiBMaXNzYW5kcmE6TG9hZE1lbnUoKQ0KICAgICAgc2VsZi5Db25maWc9c2NyaXB0Q29uZmlnKCIiLi5TY3JpcHRuYW1lLi4iIiwibWVudSIpDQogICAgICANCiAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkNvbWJvIFNldHRpbmdzIiwgImNvbWJvIikNCiAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VRIiwgIlVzZSBRIGluIENvbWJvIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZVciLCAiVXNlIFcgaW4gQ29tYm8iLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlRSIsICJVc2UgRSBpbiBjb21ibyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VSIiwgIlVzZSBSIGluIGNvbWJvIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZUkiLCAiVXNlIElnbml0ZSBpZiB0YXJnZXQga2lsbGFibGUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDEwLCAxMCwgMTAwLCAwKQ0KDQogICAgICANCiAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkhhcmFzcyBTZXR0aW5ncyIsICJoYXJhc3MiKQ0KICAgICAgc2VsZi5Db25maWcuaGFyYXNzOmFkZFBhcmFtKCJ1c2VRIiwgIkhhcmFzcyBXaXRoIFEiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6YWRkUGFyYW0oInVzZVciLCAiSGFyYXNzIFdpdGggVyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczphZGRQYXJhbSgidXNlRSIsICJIYXJhc3MgV2l0aCBFIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCBmYWxzZSkNCiAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczphZGRQYXJhbSgiYXV0b3EiLCAiQXV0byBIYXJhc3Mgd2l0aCBRIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCBmYWxzZSkNCiAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDMwLCAxMCwgMTAwLCAwKQ0KICAgICAgDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJTa2lsbCBMb2dpY3MiLCAic2tpbGxsb2dpYyIpDQogICAgICBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljOmFkZFN1Yk1lbnUoIkUgU2tpbGwgTG9naWMiLCAiRWxvZ2ljIikNCiAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuRWxvZ2ljOmFkZFBhcmFtKCJjb21ibyIsICJFIExvZ2ljIGZvciBjb21ibyBtb2RlIiwgU0NSSVBUX1BBUkFNX0xJU1QsIDIsIHsiRW5nYWdlIHdpdGggc2Vjb25kIEUiLCAiRG8gbm90IHVzZSBTZWNvbmQgRSAoIFJlY29tZW5kZWQpIiB9KQ0KICAgICAgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5FbG9naWM6YWRkUGFyYW0oImhhcmFzcyIsICJFIExvZ2ljIGZvciBIYXJhc3MgbW9kZSIsIFNDUklQVF9QQVJBTV9MSVNULCAxLCB7IkRvIG5vdCB1c2UgU2Vjb25kIEUgKCBSZWNvbWVuZGVkKSIsICJFbmdhZ2Ugd2l0aCBzZWNvbmQgRSIgfSkNCiAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuRWxvZ2ljOmFkZFBhcmFtKCJibGFuayIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuRWxvZ2ljOmFkZFBhcmFtKCJpbmZvRSIsICJFbmdhZ2Ugd2l0aCBzZWNvbmQgRSBvcHRpb24gaXMgc3RpbGwgb24gQmV0YS4uIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljOmFkZFN1Yk1lbnUoIlIgU2tpbGwgTG9naWMiLCAiUmxvZ2ljIikNCiAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljOmFkZFBhcmFtKCJSbG9naWMiLCAiUiBMb2dpYyBmb3IgY29tYm8gbW9kZSIsIFNDUklQVF9QQVJBTV9MSVNULCAxLCB7IlNtYXJ0IiwgInNhdmUgZm9yIHlvdXJzZWxmIiwgIlVzZSBmb3IgZW5lbXkiIH0pDQogICAgICBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLlJsb2dpYzphZGRQYXJhbSgiZW5hYmxlYXV0b1IiLCAiQXV0byBSIGZvciB5b3Vyc2VsZiIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljOmFkZFBhcmFtKCJhdXRvUiIsICJBdXRvUiBpZiBIZWFsdGggdW5kZXIgLT4gJSIsIFNDUklQVF9QQVJBTV9TTElDRSwgMTAsIDAsIDEwMCwgMCkNCiAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljOmFkZFBhcmFtKCJpbmZvUjIiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLlJsb2dpYzphZGRQYXJhbSgiaW5mb1IiLCAiRm9yIHVzaW5nIFNtYXJ0IFIgbG9naWMsIEF1dG9SIHNob3VsZCBiZSBvcGVuLi4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWM6YWRkU3ViTWVudSgiVyBTa2lsbCBMb2dpYyIsICJXbG9naWMiKSANCiAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuV2xvZ2ljOmFkZFBhcmFtKCJ1c2VXIiwgIlVzZSBXIGZvciBBbnRpIEdhcENsb3NlIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCBmYWxzZSkNCiAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuV2xvZ2ljOmFkZFBhcmFtKCJpbmZvdzIiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLldsb2dpYzphZGRQYXJhbSgiaW5mb1czIiwgIlRoaXMgRnVuY3Rpb24gaXMgb24gYmV0YS4uIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICANCiAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJFc2NhcGUgU2V0dGluZ3MiLCJlc2NhcGUiKQ0KICAgICAgc2VsZi5Db25maWcuZXNjYXBlOmFkZFBhcmFtKCJ1c2VFIiwiVXNlIEUgV2hpbGUgRXNjYXBlIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmVzY2FwZTphZGRQYXJhbSgidXNlVyIsIlVzZSBXIFdoaWxlIEVzY2FwZSIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICANCiAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkZhcm0gU2V0dGluZ3MiLCAiZmFybSIpDQogICAgICANCiAgICAgIHNlbGYuQ29uZmlnLmZhcm06YWRkU3ViTWVudSgiTGFuZUNsZWFyIFNldHRpbmdzIiwibGFuZWNsZWFyIikNCiAgICAgIHNlbGYuQ29uZmlnLmZhcm0ubGFuZWNsZWFyOmFkZFBhcmFtKCJ1c2VRIiwiVXNlIFEgb24gTGFuZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmZhcm0ubGFuZWNsZWFyOmFkZFBhcmFtKCJ1c2VXIiwiVXNlIFcgb24gTGFuZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICAtLXNlbGYuQ29uZmlnLmZhcm0ubGFuZWNsZWFyOmFkZFBhcmFtKCJ1c2VFIiwiVXNlIEUgb24gTGFuZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmZhcm0ubGFuZWNsZWFyOmFkZFBhcmFtKCJNYW5hIiwiTWFuYSBNYW5hZ2VyICUiLFNDUklQVF9QQVJBTV9TTElDRSwgMzAsIDEwLCAxMDAsIDApDQogICAgICANCiAgICAgIHNlbGYuQ29uZmlnLmZhcm06YWRkU3ViTWVudSgiSnVuZ2xlQ2xlYXIgU2V0dGluZ3MiLCJqdW5nbGVjbGVhciIpDQogICAgICBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyOmFkZFBhcmFtKCJ1c2VRIiwiVXNlIFEgb24ganVuZ2xlY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhcjphZGRQYXJhbSgidXNlVyIsIlVzZSBXIG9uIGp1bmdsZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXI6YWRkUGFyYW0oInVzZUUiLCJVc2UgRSBvbiBqdW5nbGVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyOmFkZFBhcmFtKCJNYW5hIiwiTWFuYSBNYW5hZ2VyICUiLFNDUklQVF9QQVJBTV9TTElDRSwgMzAsIDEwLCAxMDAsIDApDQogICAgICANCiAgICAgIC0tc2VsZi5Db25maWcuZmFybTphZGRTdWJNZW51KCJMYXN0aGl0IFNldHRpbmdzIiwibGFzdGhpdCIpDQogICAgICAtLXNlbGYuQ29uZmlnLmZhcm0ubGFzdGhpdDphZGRQYXJhbSgidXNlUSIsIlVzZSBRIG9uIExhc3RoaXQiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgLS1zZWxmLkNvbmZpZy5mYXJtLmxhc3RoaXQ6YWRkUGFyYW0oInVzZVciLCJVc2UgVyBvbiBMYXN0aGl0IixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIC0tc2VsZi5Db25maWcuZmFybS5sYXN0aGl0OmFkZFBhcmFtKCJ1c2VFIiwiVXNlIEUgb24gTGFzdGhpdCIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAtLXNlbGYuQ29uZmlnLmZhcm0ubGFzdGhpdDphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDMwLCAxMCwgMTAwLCAwKQ0KICAgICAgIA0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiS2lsbFN0ZWFsIFNldHRpbmdzIiwgImtpbGxzdGVhbCIpDQogICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oImtzIiwiS2lsbHN0ZWFsIE9uL09mZiIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZVEiLCAiU3RlYWwgV2l0aCBRIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJ1c2VFIiwgIlN0ZWFsIFdpdGggRSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgidXNlUiIsICJTdGVhbCBXaXRoIFIiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZUkiLCAiU3RlYWwgV2l0aCBJZ25pdGUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICANCiAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkl0ZW0gU2V0dGluZ3MiLCAiaXRlbSIpDQogICAgICBzZWxmLkNvbmZpZy5pdGVtOmFkZFBhcmFtKCJlbmFibGVhdXRvemhvbnlhIiwgIkF1dG8gWmhvbnlhIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCBmYWxzZSkNCiAgICAgIHNlbGYuQ29uZmlnLml0ZW06YWRkUGFyYW0oImF1dG96aG9ueWEiLCAiWmhvbnlhIGlmIEhlYWx0aCB1bmRlciAtPiAlIiwgU0NSSVBUX1BBUkFNX1NMSUNFLCAxMCwgMCwgMTAwLCAwKQ0KICAgICAgDQogICAgICAgICAgICBpZiBWSVBfVVNFUiB0aGVuDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJWSVAgU2V0dGluZ3MiLCAidmlwIikNCiAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgicGFja2V0IiwiVXNlIFBhY2tldCBDYXN0aW5nIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm8xIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvMiIsICJUbyB1c2UgdmlwIHNldHRpbmdzLCBQYWNrZXQgQ2FzdGluZyBzaG91bGQgYmUgb3Blbi4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRTdWJNZW51KCJBdXRvIExldmVsIFNldHRpbmdzIiwgImxldmVsIikNCiAgICAgIHNlbGYuQ29uZmlnLnZpcC5sZXZlbDphZGRQYXJhbSgia2V5IiwiVXNlIEF1dG8gTGV2ZWwiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgIHNlbGYuQ29uZmlnLnZpcC5sZXZlbDphZGRQYXJhbSgibG9naWMiLCAiU2VsZWN0IFNraWxsIE9yZGVyIiwgU0NSSVBUX1BBUkFNX0xJU1QsIDEsIHsiRm9jdXMgUT5XPkUiLCAiRm9jdXMgUT5FPlciLCJGb2N1cyBXPlE+RSIsIkZvY3VzIFc+RT5RIiwiRm9jdXMgRT5XPlEiLCAiRm9jdXMgRT5RPlciICB9KQ0KICAgICAgc2VsZi5Db25maWcudmlwOmFkZFN1Yk1lbnUoIlNraW4gSGFjayBTZXR0aW5ncyIsICJza2luIikNCiAgICAgIHNlbGYuQ29uZmlnLnZpcC5za2luOmFkZFBhcmFtKCJrZXkiLCJVc2UgU2tpbiBIYWNrIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICBzZWxmLkNvbmZpZy52aXAuc2tpbjphZGRQYXJhbSgnc2VsZWN0ZWQnIC4uIG15SGVyby5jaGFyTmFtZSAuLiAnU2tpbicsICJTZWxlY3QgU2tpbiIsIFNDUklQVF9QQVJBTV9MSVNULCAxLCB7Ik9yaWdpbmFsIiwgIkJsb29kc3RvbmUgTGlzc2FuZHJhICIsIkJsYWRlIFF1ZWVuIExpc3NhbmRyYSJ9KQ0KICAgICAgc2VsZi5Db25maWcudmlwLnNraW46YWRkUGFyYW0oImluZm80IiwgIlRvIHVzZSBza2luIGhhY2ssIFlvdSBuZWVkIHRvIDJ4IEY5IGFmdGVyIHlvdSBzZWxlY3QgdGhlIHNraW4geW91IGRlc2lyZS4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLnZpcC5za2luOmFkZFBhcmFtKCJpbmZvNSIsICJNYWtlIHN1cmUgdGhhdCB1c2luZyBwYWNrZXQgY2FzdGluZyBpcyBPTi4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIC0tc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvNSIsICJTa2luIEhhY2sgdGVtcG9yYXJ5IGRpc2FibGVkIHVudGlsIG5leHQgdXBkYXRlLiAuIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAtLVtbc2VsZi5Db25maWcudmlwOmFkZFN1Yk1lbnUoIkFudGktQUZLIFNldHRpbmdzIiwgImFudGlhZmsiKQ0KICAgICAgc2VsZi5Db25maWcudmlwLmFudGlhZms6YWRkUGFyYW0oImFudGlhZmsiLCJVc2UgQW50aSBBZmsiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkgXV0NCiAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzMiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm80IiwgIlRvIHVzZSB2aXAgc2V0dGluZ3MsIFlvdSBuZWVkIHRvIGJlIGEgVklQIHVzZXIgb24gQk9MIGNvbW11bml0eS4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgZW5kDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJEcmF3IFNldHRpbmdzIiwib3RoZXIiKQ0KICAgICAgLS1zZWxmLkNvbmZpZy5vdGhlcjphZGRTdWJNZW51KCJTaG93IERhbWFnZSBPbiBIcCBCYXIiLCAiSFBCQVIiKQ0KICAgICAgLS1zZWxmLkNvbmZpZy5vdGhlci5IUEJBUjphZGRQYXJhbSgia2V5IiwiT04vT0ZGIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLm90aGVyOmFkZFN1Yk1lbnUoIlNraWxsIERyYXdpbmcgU2V0dGluZ3MiLCAiZHJhdyIpDQogICAgICBzZWxmLkNvbmZpZy5vdGhlci5kcmF3OmFkZFBhcmFtKCJxZHJhdyIsIlEgU2tpbGwgRHJhd2luZ3MiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgid2RyYXciLCJXIFNraWxsIERyYXdpbmdzIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oImVkcmF3IiwiRSBTa2lsbCBEcmF3aW5ncyIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5vdGhlci5kcmF3OmFkZFBhcmFtKCJyZHJhdyIsIlIgU2tpbGwgRHJhd2luZ3MiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgiYWFkcmF3IiwiQXV0byBBdHRhY2sgUmFuZ2UiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCg0KICAgICAgDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJUYXJnZXRzZWxlY3RvcnMiLCJ0YXJnZXRzZWwiKQ0KICAgIHNlbGYudHMubmFtZSAgPSAiTGlzc2FuZHJhIEdlbmVyYWwiDQogICAgc2VsZi50c3EubmFtZSA9ICJMaXNzYW5kcmEgUSBTa2lsbCINCiAgICBzZWxmLnRzdy5uYW1lID0gIkxpc3NhbmRyYSBXIFNraWxsIg0KICAgIHNlbGYudHNlLm5hbWUgPSAiTGlzc2FuZHJhIEUgU2tpbGwiDQogICAgc2VsZi50c3IubmFtZSA9ICJMaXNzYW5kcmEgUiBTa2lsbCINCiAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkVFMoc2VsZi50cykNCiAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkVFMoc2VsZi50c3EpDQogICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFRTKHNlbGYudHN3KQ0KICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRUUyhzZWxmLnRzZSkNCiAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkVFMoc2VsZi50c3IpIA0KICAgIA0KICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIktleXMgU2V0dGluZ3MiLCAiS2V5cyIpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0szIiwgIjwtLS0tLS0tLS0tLS0tLS0tLS1Db21ibyBLZXkgU2V0dGluZ3MtLS0tLS0tLS0tLS0tLS0tLS0+IiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiY29tYm9rZXkiLCAiQ29tYm8gS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIDMyKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImNvbWJva2V5ciIsICJTdGFydCBFbmdhZ2UgV2l0aCBZb3VyIFVsdGkgIiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJVIikpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0s0IiwgIjwtLS0tLS0tLS0tLS0tLS0tLS1IYXJhc3MgS2V5IFNldHRpbmdzLS0tLS0tLS0tLS0tLS0tLS0tPiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImhhcmFzc2tleSIsICJTbWFydCBIYXJhc3MgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJDIikpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaGFyYXNzdG9nbGVrZXkiLCAiSGFyYXNzIFRvZ2xlIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWVRPR0dMRSwgZmFsc2UsIHN0cmluZy5ieXRlKCJUIikpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0s1IiwgIjwtLS0tLS0tLS0tLS0tLS0tLS1DbGVhciBLZXkgU2V0dGluZ3MtLS0tLS0tLS0tLS0tLS0tLS0tLT4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJsYW5lY2xlYXJrZXkiLCAiTGFuZUNsZWFyIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiViIpKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImp1bmdsZWNsZWFya2V5IiwgIkp1bmdsZUNsZWFyIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiWiIpKQ0KICAgIC0tc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgibGFzdGhpdGtleSIsICJMYXN0aGl0IEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiWCIpKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LNiIsICI8LS0tLS0tLS0tLS0tLS0tLS0tT3RoZXIgS2V5IFNldHRpbmdzLS0tLS0tLS0tLS0tLS0tLS0tLS0+IiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiZXNjYXBla2V5IiwgIkVzY2FwZSBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIlkiKSkNCiAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJpbmZvSyIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJpbmZvSzIiLCAiTWFrZSBTdXJlIFRoYXQgWW91ciBPcmJ3YWxrZXIgS2V5cyBhcmUgU2FtZSBBcyBIZXJlIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIk9yYndhbGtlciBLZXkgU2V0dGluZ3MiLCAiS2V5czIiKQ0KICAgIE9yYndhbGtNYW5hZ2VyOkxvYWRDb21tb25LZXlzKHNlbGYuQ29uZmlnLktleXMyKQ0KICAgIHNlbGYuQ29uZmlnLktleXMyOmFkZFBhcmFtKCJpbmZvSzQiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgc2VsZi5Db25maWcuS2V5czI6YWRkUGFyYW0oImluZm9LMjIiLCAiTWFrZSBTdXJlIFRoYXQgWW91ciBTY3JpcHQgS2V5cyBhcmUgU2FtZSBBcyBIZXJlIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIA0KICAgICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm8zIiwgIl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3giLCAiICAgICAgICAgICAgICAgIi4uU2NyaXB0bmFtZS4uIiIsIFNDUklQVF9QQVJBTV9JTkZPLCAiIikgDQogICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94MiIsICIgICAgICAgICAgICAgICAgIFNjcmlwdCBWZXJzaW9uOiAgIi4uVmVyc2lvbi4uICIgICAgICAgICAiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3g2IiwgIiAgICAgICAgICAgIFNjcmlwdCB3YXMgbWFkZSBieSAgIi4uQXV0aG9yLi4gIiAgICAgICAgICIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDUiLCAiICAgICAgIExlYXVnZSBPZiBMZWdlbmRzIFZlcnNpb246ICAiLi5MVmVyc2lvbi4uICIgICAgICAgICAiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgDQogICAgIHNlbGYuQ29uZmlnOnBlcm1hU2hvdygiaW5mb2JveCIpDQogICAgIHNlbGYuQ29uZmlnLktleXM6cGVybWFTaG93KCJjb21ib2tleSIpDQogICAgIHNlbGYuQ29uZmlnLktleXM6cGVybWFTaG93KCJoYXJhc3N0b2dsZWtleSIpDQogICAgIHNlbGYuQ29uZmlnLktleXM6cGVybWFTaG93KCJoYXJhc3NrZXkiKQ0KICANCg0KZW5kDQpmdW5jdGlvbiBMaXNzYW5kcmE6c2tpbmhhY2soKQ0KaWYgbm90IHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgdGhlbiBTZW5kU2tpblBhY2tldChteUhlcm8uY2hhck5hbWUsIHNraW5zUEJbMV0sIG15SGVyby5uZXR3b3JrSUQpOyBlbHNlDQppZiBzZWxmLkNvbmZpZy52aXAuc2tpbi5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgIHRoZW4NClNlbmRTa2luUGFja2V0KG15SGVyby5jaGFyTmFtZSwgc2tpbnNQQltzZWxmLkNvbmZpZy52aXAuc2tpblsnc2VsZWN0ZWQnIC4uIG15SGVyby5jaGFyTmFtZSAuLiAnU2tpbiddXSwgbXlIZXJvLm5ldHdvcmtJRCk7DQplbmQNCmVuZA0KZW5kDQpmdW5jdGlvbiBMaXNzYW5kcmE6YXV0b2xldmVsKCkNCmlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gMSApIHRoZW4NCmlmIG15SGVyby5sZXZlbCA9PSAxIHRoZW4NCiBMZXZlbFNwZWxsKF9XKSANCiBlbHNlaWYgbXlIZXJvLmxldmVsID09IDIgdGhlbg0KIExldmVsU3BlbGwoX1EpIA0KIGVsc2VpZiBteUhlcm8ubGV2ZWwgPT0gMyB0aGVuDQogTGV2ZWxTcGVsbChfRSkgDQogZWxzZWlmIG15SGVyby5sZXZlbCA+IDMgYW5kIG15SGVyby5sZXZlbCA+IHNwZWxsTGV2ZWwgdGhlbg0KICAgICAgICBzcGVsbExldmVsID0gc3BlbGxMZXZlbCArIDEgICAgICAgIA0KICAgICAgICAgTGV2ZWxTcGVsbChfUikNCiAgICAgICAgICAgIExldmVsU3BlbGwoX1EpDQogICAgICAgICAgICBMZXZlbFNwZWxsKF9XKQ0KICAgICAgICAgICAgTGV2ZWxTcGVsbChfRSkNCiAgICAgICAgICAgIGVuZA0KICAgIGVsc2VpZiAoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSAyICkgdGhlbg0KICAgIGlmIG15SGVyby5sZXZlbCA9PSAxIHRoZW4NCiBMZXZlbFNwZWxsKF9XKSANCiBlbHNlaWYgbXlIZXJvLmxldmVsID09IDIgdGhlbg0KIExldmVsU3BlbGwoX1EpIA0KIGVsc2VpZiBteUhlcm8ubGV2ZWwgPT0gMyB0aGVuDQogTGV2ZWxTcGVsbChfRSkgDQogZWxzZWlmIG15SGVyby5sZXZlbCA+IDMgYW5kIG15SGVyby5sZXZlbCA+IHNwZWxsTGV2ZWwgdGhlbg0KICAgICAgICBzcGVsbExldmVsID0gc3BlbGxMZXZlbCArIDEgICAgICAgIA0KICAgICAgICAgTGV2ZWxTcGVsbChfUikNCiAgICAgICAgICAgIExldmVsU3BlbGwoX1EpDQogICAgICAgICAgICBMZXZlbFNwZWxsKF9FKQ0KICAgICAgICAgICAgTGV2ZWxTcGVsbChfVykNCiAgICAgICAgICAgIGVuZA0KICAgZWxzZWlmICggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDMgKSB0aGVuDQogICAgaWYgbXlIZXJvLmxldmVsID09IDEgdGhlbg0KIExldmVsU3BlbGwoX1EpIA0KIGVsc2VpZiBteUhlcm8ubGV2ZWwgPT0gMiB0aGVuDQogTGV2ZWxTcGVsbChfVykgDQogZWxzZWlmIG15SGVyby5sZXZlbCA9PSAzIHRoZW4NCiBMZXZlbFNwZWxsKF9FKSANCiBlbHNlaWYgbXlIZXJvLmxldmVsID4gMyBhbmQgbXlIZXJvLmxldmVsID4gc3BlbGxMZXZlbCB0aGVuDQogICAgICAgIHNwZWxsTGV2ZWwgPSBzcGVsbExldmVsICsgMSAgICAgICAgDQogICAgICAgICBMZXZlbFNwZWxsKF9SKQ0KICAgICAgICAgICAgTGV2ZWxTcGVsbChfVykNCiAgICAgICAgICAgIExldmVsU3BlbGwoX1EpDQogICAgICAgICAgICBMZXZlbFNwZWxsKF9FKQ0KICAgICAgICAgICAgZW5kDQogICAgICAgICAgICBlbHNlaWYgKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gNCApIHRoZW4NCiAgICBpZiBteUhlcm8ubGV2ZWwgPT0gMSB0aGVuDQogTGV2ZWxTcGVsbChfUSkgDQogZWxzZWlmIG15SGVyby5sZXZlbCA9PSAyIHRoZW4NCiBMZXZlbFNwZWxsKF9XKSANCiBlbHNlaWYgbXlIZXJvLmxldmVsID09IDMgdGhlbg0KIExldmVsU3BlbGwoX0UpIA0KIGVsc2VpZiBteUhlcm8ubGV2ZWwgPiAzIGFuZCBteUhlcm8ubGV2ZWwgPiBzcGVsbExldmVsIHRoZW4NCiAgICAgICAgc3BlbGxMZXZlbCA9IHNwZWxsTGV2ZWwgKyAxICAgICAgICANCiAgICAgICAgIExldmVsU3BlbGwoX1IpDQogICAgICAgICAgICBMZXZlbFNwZWxsKF9XKQ0KICAgICAgICAgICAgTGV2ZWxTcGVsbChfRSkNCiAgICAgICAgICAgIExldmVsU3BlbGwoX1EpDQogICAgICAgICAgICBlbmQNCiAgICAgICAgICAgIGVsc2VpZiAoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSA1ICkgdGhlbg0KICAgIGlmIG15SGVyby5sZXZlbCA9PSAxIHRoZW4NCiBMZXZlbFNwZWxsKF9XKSANCiBlbHNlaWYgbXlIZXJvLmxldmVsID09IDIgdGhlbg0KIExldmVsU3BlbGwoX0UpIA0KIGVsc2VpZiBteUhlcm8ubGV2ZWwgPT0gMyB0aGVuDQogTGV2ZWxTcGVsbChfUSkgDQogZWxzZWlmIG15SGVyby5sZXZlbCA+IDMgYW5kIG15SGVyby5sZXZlbCA+IHNwZWxsTGV2ZWwgdGhlbg0KICAgICAgICBzcGVsbExldmVsID0gc3BlbGxMZXZlbCArIDEgICAgICAgIA0KICAgICAgICAgTGV2ZWxTcGVsbChfUikNCiAgICAgICAgICAgIExldmVsU3BlbGwoX1cpDQogICAgICAgICAgICBMZXZlbFNwZWxsKF9RKQ0KICAgICAgICAgICAgTGV2ZWxTcGVsbChfRSkNCiAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgZWxzZWlmICggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDYgKSB0aGVuDQogICAgaWYgbXlIZXJvLmxldmVsID09IDEgdGhlbg0KIExldmVsU3BlbGwoX1EpIA0KIGVsc2VpZiBteUhlcm8ubGV2ZWwgPT0gMiB0aGVuDQogTGV2ZWxTcGVsbChfRSkgDQogZWxzZWlmIG15SGVyby5sZXZlbCA9PSAzIHRoZW4NCiBMZXZlbFNwZWxsKF9XKSANCiBlbHNlaWYgbXlIZXJvLmxldmVsID4gMyBhbmQgbXlIZXJvLmxldmVsID4gc3BlbGxMZXZlbCB0aGVuDQogICAgICAgIHNwZWxsTGV2ZWwgPSBzcGVsbExldmVsICsgMSAgICAgICAgDQogICAgICAgICBMZXZlbFNwZWxsKF9SKQ0KICAgICAgICAgICAgTGV2ZWxTcGVsbChfRSkNCiAgICAgICAgICAgIExldmVsU3BlbGwoX1EpDQogICAgICAgICAgICBMZXZlbFNwZWxsKF9XKQ0KICAgICAgICAgICAgZW5kDQogICAgICAgICAgICBlbmQNCmVuZA0KZnVuY3Rpb24gTGlzc2FuZHJhOmF1dG96aG9ueWEoKQ0KICBpZiBzZWxmLkNvbmZpZy5pdGVtLmVuYWJsZWF1dG96aG9ueWEgdGhlbg0KICAgZm9yIF8gPSBJVEVNXzEsIElURU1fNyBkbw0KICAgIGlmIG15SGVyby5oZWFsdGggPD0gKG15SGVyby5tYXhIZWFsdGggKiBzZWxmLkNvbmZpZy5pdGVtLmF1dG96aG9ueWEgLyAxMDApIGFuZCAoIG15SGVybzpDYW5Vc2VTcGVsbChfKSA9PSAwIGFuZCBteUhlcm86R2V0U3BlbGxEYXRhKF8pLm5hbWUgPT0gIlpob255YXNIb3VyZ2xhc3MiICl0aGVuIENhc3RTcGVsbChfKQ0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBlbmQNCg0KZnVuY3Rpb24gTGlzc2FuZHJhOmF1dG9SKCkNCiAgaWYgKCBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLlJsb2dpYy5lbmFibGVhdXRvUiBhbmQgKHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljLlJsb2dpYyA9PSAyIG9yIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljLlJsb2dpYyA9PSAxKSkgdGhlbg0KICAgIGlmIG15SGVyby5oZWFsdGggPD0gKG15SGVyby5tYXhIZWFsdGggKiBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLlJsb2dpYy5hdXRvUiAvIDEwMCkgdGhlbiBzZWxmOkNhc3RSUyhteUhlcm8pDQogICAgZW5kDQogIGVuZA0KICBlbmQNCg0KZnVuY3Rpb24gTGlzc2FuZHJhOmVuZ2FnZXdpdGhyKCkNCiBzZWxmLnRzcTp1cGRhdGUoKQ0KIGlmIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXlyIHRoZW4NCiBzZWxmOndhbGsoKQ0KIGVuZA0KICAgIGlmKHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKWFuZCBzZWxmLnRzcS50YXJnZXR+PW5pbCAgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVEgYW5kIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXlyICApdGhlbg0KICAgICAgICBzZWxmOkNhc3RRKHNlbGYudHNxLnRhcmdldCkNCiAgICBlbmQNCiAgICBzZWxmLnRzZTp1cGRhdGUoKQ0KICAgIGlmKHNlbGYuRVNwZWxsOklzUmVhZHkoKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKWFuZCBzZWxmLnRzZS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlRSBhbmQgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleXIgKXRoZW4NCiAgICAgICAgICAgICAgbG9jYWwgVGlja2VyID0gR2V0VGlja0NvdW50KCkNCmlmIChnbG9iYWxfdGlja3MgKyAyMDAwKSA8IFRpY2tlciB0aGVuDQppZiAobXlIZXJvOkNhblVzZVNwZWxsKF9FKSA9PSBSRUFEWSApIHRoZW4NCiAgIENhc3RTcGVsbChfRSwgc2VsZi50c2UudGFyZ2V0LngsIHNlbGYudHNlLnRhcmdldC56KQ0KICAgZ2xvYmFsX3RpY2tzID0gVGlja2VyDQogICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgQ2FzdFNwZWxsKF9FKSBlbmQsIDEuNSkNCiAgICBlbmQNCiAgICBlbmQNCiAgICBlbmQNCiAgICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgIGlmKHNlbGYuV1NwZWxsOklzUmVhZHkoKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKSBhbmQgc2VsZi50c3cudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVcgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ciAgKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0VyhzZWxmLnRzdy50YXJnZXQpDQogICAgZW5kDQogICAgc2VsZi50c3I6dXBkYXRlKCkNCiAgICBpZihzZWxmLlJTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwICkgYW5kIHNlbGYudHNyLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VSIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleXIgKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0UihzZWxmLnRzci50YXJnZXQpDQplbmQNCmVuZA0KZnVuY3Rpb24gTGlzc2FuZHJhOkRyYXcoKQ0KICAgIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcucWRyYXcgYW5kIHNlbGYuUVNwZWxsOklzUmVhZHkoKSB0aGVuDQogICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDcyNSwgMSxyZWQpDQogIGVuZA0KDQogIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcud2RyYXcgYW5kIHNlbGYuV1NwZWxsOklzUmVhZHkoKSB0aGVuDQogICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDEwNTAsIDEsIHJlZCkNCiAgZW5kDQoNCiAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5lZHJhdyBhbmQgc2VsZi5FU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgNDIwLCAxLCByZWQpDQogIGVuZA0KICANCiAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5yZHJhdyBhbmQgc2VsZi5SU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgNTAwLDEsIHJlZCkNCiAgZW5kDQogIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcuYWFkcmF3IHRoZW4NCiAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgNTUwLDEsIEFSR0IoMjU1LCAyNTUsMCwwKSkNCiAgZW5kDQplbmQNCmZ1bmN0aW9uIExpc3NhbmRyYTphbnRpZ2FwdygpDQogICAgaWYoc2VsZi5XU3BlbGw6SXNSZWFkeSgpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmNvbWJvLk1hbmEgLzEwMCApYW5kIHNlbGYudHN3LnRhcmdldH49bmlsICBhbmQgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5XbG9naWMudXNlVyAgKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0VyhzZWxmLnRzdy50YXJnZXQpDQogICAgZW5kDQplbmQNCmZ1bmN0aW9uIExpc3NhbmRyYTpjb21ibygpDQogICAgICBzZWxmLnRzcTp1cGRhdGUoKQ0KICAgIGlmKHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKWFuZCBzZWxmLnRzcS50YXJnZXR+PW5pbCAgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVEgYW5kIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICl0aGVuDQogICAgICAgIHNlbGY6Q2FzdFEoc2VsZi50c3EudGFyZ2V0KQ0KICAgIGVuZA0KICAgIHNlbGYudHNlOnVwZGF0ZSgpDQogICAgaWYoc2VsZi5Db25maWcuc2tpbGxsb2dpYy5FbG9naWMuY29tYm8gPT0gMSBhbmQgIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwIClhbmQgc2VsZi5Db25maWcuY29tYm8udXNlRSBhbmQgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgKXRoZW4NCiAgICBsb2NhbCBUaWNrZXIgPSBHZXRUaWNrQ291bnQoKQ0KaWYgKGdsb2JhbF90aWNrcyArIDIwMDApIDwgVGlja2VyIHRoZW4NCmlmIChteUhlcm86Q2FuVXNlU3BlbGwoX0UpID09IFJFQURZIGFuZCBzZWxmLnRzZS50YXJnZXR+PW5pbCkgdGhlbg0KICAgQ2FzdFNwZWxsKF9FLCBzZWxmLnRzZS50YXJnZXQueCwgc2VsZi50c2UudGFyZ2V0LnopDQogICBnbG9iYWxfdGlja3MgPSBUaWNrZXINCiAgICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBDYXN0U3BlbGwoX0UpIGVuZCwgMS41KQ0KICAgICAgICBlbmQNCiAgICAgICAgZW5kDQogICAgICAgIGVuZA0KICAgICAgIGlmKHNlbGYuQ29uZmlnLnNraWxsbG9naWMuRWxvZ2ljLmNvbWJvID09IDIgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwICkgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZUUgYW5kIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICl0aGVuDQogICAgICAgbG9jYWwgVGlja2VyID0gR2V0VGlja0NvdW50KCkNCmlmIChnbG9iYWxfdGlja3MgKyAyMDAwKSA8IFRpY2tlciB0aGVuDQppZiAobXlIZXJvOkNhblVzZVNwZWxsKF9FKSA9PSBSRUFEWSBhbmQgc2VsZi50c2UudGFyZ2V0fj1uaWwpIHRoZW4NCiAgIENhc3RTcGVsbChfRSwgc2VsZi50c2UudGFyZ2V0LngsIHNlbGYudHNlLnRhcmdldC56KQ0KICAgZ2xvYmFsX3RpY2tzID0gVGlja2VyDQogICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgQ2FzdFNwZWxsKF9FKSBlbmQsIDIpDQogICAgZW5kDQogICAgZW5kDQogICAgZW5kDQogICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgICBpZihzZWxmLldTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwICkgYW5kIHNlbGYudHN3LnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VXIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgICl0aGVuDQogICAgICAgIHNlbGY6Q2FzdFcoc2VsZi50c3cudGFyZ2V0KQ0KICAgIGVuZA0KICAgIGlmKHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljLlJsb2dpYyA9PSAzIG9yIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljLlJsb2dpYyA9PSAxIGFuZCBzZWxmLlJTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwICkgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVIgYW5kIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICl0aGVuDQogICAgZm9yIF8sIHVuaXQgaW4gcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8NCiAgICAgIGxvY2FsIGRtZ1IgPWdldERtZygiUiIsdW5pdCxteUhlcm8pKyAoKG15SGVyby5hcCkqMC43MCkgDQogICAgICBsb2NhbCBoZWFsdGg9dW5pdC5oZWFsdGgNCiAgICAgIGlmKGhlYWx0aDxkbWdSIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VSIGFuZCBHZXREaXN0YW5jZSh1bml0KTw1NTApdGhlbg0KICAgICAgICBzZWxmOkNhc3RSKHVuaXQpDQogICAgZWxzZWlmIChzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLlJsb2dpYy5SbG9naWMgPT0gMiBhbmQgIG15SGVyby5oZWFsdGggPD0gKG15SGVyby5tYXhIZWFsdGggKiBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLlJsb2dpYy5hdXRvUiAvIDEwMCkpIHRoZW4gDQogICAgIHNlbGY6Q2FzdFJTKG15SGVybykNCiAgICAgICAgZW5kDQogICAgZW5kDQogICAgZW5kDQogICAgDQogICAgaWYoc2VsZi5Db25maWcuY29tYm8udXNlSSBhbmQgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgKXRoZW4NCiAgICBmb3IgXywgdW5pdCBpbiBwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbw0KICAgICAgbG9jYWwgZG1nSSA9KDUwKyAoKG15SGVyby5sZXZlbCkqMjApKQ0KICAgICAgbG9jYWwgaGVhbHRoPXVuaXQuaGVhbHRoDQogICAgICBpZihoZWFsdGg8ZG1nSSBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlSSBhbmQgR2V0RGlzdGFuY2UodW5pdCk8NjAwKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0SSh1bml0KQ0KICAgIGVuZA0KICAgIGVuZA0KZW5kDQplbmQNCmZ1bmN0aW9uIExpc3NhbmRyYTpDYXN0USh1bml0KQ0KICBzZWxmLlFTcGVsbDpDYXN0KHVuaXQpDQplbmQNCg0KZnVuY3Rpb24gTGlzc2FuZHJhOkNhc3RXKHVuaXQpDQogIHNlbGYuV1NwZWxsOkNhc3QodW5pdCkNCmVuZA0KDQpmdW5jdGlvbiBMaXNzYW5kcmE6Q2FzdEUodW5pdCkNCiAgc2VsZi5FU3BlbGw6Q2FzdCh1bml0KQ0KZW5kDQoNCmZ1bmN0aW9uIExpc3NhbmRyYTpDYXN0Uih1bml0KQ0KICBzZWxmLlJTcGVsbDpDYXN0KHVuaXQpDQplbmQNCmZ1bmN0aW9uIExpc3NhbmRyYTpDYXN0UlModW5pdCkNCiBDYXN0U3BlbGwoX1IgLCBteUhlcm8pDQplbmQNCg0KZnVuY3Rpb24gTGlzc2FuZHJhOkNhc3RJKHVuaXQpDQogIHNlbGYuSWduaXRlOkNhc3QodW5pdCkNCmVuZA0KZnVuY3Rpb24gTGlzc2FuZHJhOmtpbGxzdGVhbCgpDQpmb3IgXywgdW5pdCBpbiBwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbw0KICAgIGxvY2FsIGhlYWx0aCA9IHVuaXQuaGVhbHRoDQogICAgbG9jYWwgZG1nRSA9IGdldERtZygiRSIsIHVuaXQsIG15SGVybykgKyAoKG15SGVyby5hcCkqMC42KSANCiAgICAgIGlmKHNlbGYudHNlLnRhcmdldCB+PSBuaWwgYW5kICBzZWxmLkVTcGVsbDpJc1JlYWR5KCkgYW5kIGhlYWx0aDxkbWdFIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlRSAgIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MpdGhlbg0KICAgICAgICBzZWxmOkNhc3RFKHVuaXQpICANCiAgICAgIGVuZA0KICAgICAgbG9jYWwgZG1nUSA9IGdldERtZygiUSIsIHVuaXQsIG15SGVybykgKyAoKG15SGVyby5hcCkqMC42NSkNCiAgICAgIGlmKHNlbGYudHNxLnRhcmdldCB+PSBuaWwgYW5kICBzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIGhlYWx0aDxkbWdRIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlUSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzICl0aGVuDQogICAgICAgIHNlbGY6Q2FzdFEodW5pdCkgIA0KICAgICAgZW5kDQogICAgICBsb2NhbCBkbWdXID0gZ2V0RG1nKCJXIiwgdW5pdCwgbXlIZXJvKSArICgobXlIZXJvLmFwKSowLjQwKQ0KICAgICAgaWYoc2VsZi50c3cudGFyZ2V0IH49IG5pbCBhbmQgIHNlbGYuV1NwZWxsOklzUmVhZHkoKSBhbmQgaGVhbHRoPGRtZ1EgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VXIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0Vyh1bml0KSAgDQogICAgICBlbmQNCiAgICAgICBsb2NhbCBkbWdJID0oNTArICgobXlIZXJvLmxldmVsKSoyMCkpDQogICAgICBpZihoZWFsdGg8ZG1nSSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZUkgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyBhbmQgR2V0RGlzdGFuY2UodW5pdCk8NjAwKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0SSh1bml0KQ0KICAgICAgZW5kDQogICAgICBsb2NhbCBkbWdSID1nZXREbWcoIlIiLHVuaXQsbXlIZXJvKSsoKG15SGVyby5hcCkqMC43MCkgDQogICAgICBpZihzZWxmLnRzci50YXJnZXQgfj0gbmlsIGFuZCAgc2VsZi5SU3BlbGw6SXNSZWFkeSgpIGFuZCBoZWFsdGg8ZG1nUiBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZVIgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyBhbmQgR2V0RGlzdGFuY2UodW5pdCk8NTUwKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0Uih1bml0KQ0KICAgICAgZW5kDQogICBlbmQNCmVuZA0KDQpmdW5jdGlvbiBMaXNzYW5kcmE6ZXNjYXBlKCkNCmxvY2FsIFRpY2tlciA9IEdldFRpY2tDb3VudCgpDQppZiAoZ2xvYmFsX3RpY2tzICsgMjAwMCkgPCBUaWNrZXIgdGhlbg0KaWYgc2VsZi5Db25maWcuS2V5cy5lc2NhcGVrZXkgYW5kIHNlbGYuQ29uZmlnLmVzY2FwZS51c2VFICB0aGVuDQppZiAobXlIZXJvOkNhblVzZVNwZWxsKF9FKSA9PSBSRUFEWSApIHRoZW4NCiAgIENhc3RTcGVsbChfRSxtb3VzZVBvcy54LG1vdXNlUG9zLnopDQogICBnbG9iYWxfdGlja3MgPSBUaWNrZXINCiAgICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBDYXN0U3BlbGwoX0UpIGVuZCwgMS41KQ0KZW5kDQplbmQNCmVuZA0KaWYgc2VsZi5Db25maWcuS2V5cy5lc2NhcGVrZXkgdGhlbiANCnNlbGY6d2FsaygpDQplbmQNCmlmIHNlbGYuQ29uZmlnLktleXMuZXNjYXBla2V5IGFuZCBzZWxmLkNvbmZpZy5lc2NhcGUudXNlVyBhbmQgc2VsZi50c3cudGFyZ2V0fj1uaWwgdGhlbg0KQ2FzdFNwZWxsKF9XLHRzdy50YXJnZXQpDQplbmQNCmVuZA0KZnVuY3Rpb24gTGlzc2FuZHJhOndhbGsoKQ0KICBteUhlcm86TW92ZVRvKG1vdXNlUG9zLngsbW91c2VQb3MueikNCmVuZA0KZnVuY3Rpb24gTGlzc2FuZHJhOmhhcmFzcygpDQogIHNlbGYudHM6dXBkYXRlKCkNCiAgc2VsZi50c3E6dXBkYXRlKCkNCiAgIHNlbGYudHN3OnVwZGF0ZSgpDQogICAgc2VsZi50c2U6dXBkYXRlKCkNCiAgaWYgc2VsZi5Db25maWcuS2V5cy5oYXJhc3NrZXkgb3Igc2VsZi5Db25maWcuS2V5cy5oYXJhc3N0b2dsZWtleSB0aGVuDQogICAgICBpZihzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuaGFyYXNzLk1hbmEgLzEwMCApIGFuZCBzZWxmLnRzcS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuaGFyYXNzLnVzZVEgKSB0aGVuICAgICAgICANCiAgICAgICAgc2VsZjpDYXN0UShzZWxmLnRzcS50YXJnZXQpDQogICAgICBlbmQgICANCiAgICAgIGVuZA0KICBpZiBzZWxmLkNvbmZpZy5LZXlzLmhhcmFzc2tleSBvciBzZWxmLkNvbmZpZy5LZXlzLmhhcmFzc3RvZ2xla2V5IHRoZW4NCiAgICAgIGlmKHNlbGYuV1NwZWxsOklzUmVhZHkoKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5oYXJhc3MuTWFuYSAvMTAwICkgYW5kIHNlbGYudHN3LnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5oYXJhc3MudXNlVyApIHRoZW4gICAgICAgIA0KICAgICAgICBzZWxmOkNhc3RXKHNlbGYudHN3LnRhcmdldCkNCiAgICAgIGVuZCAgDQogICAgICBlbmQgDQogICAgICAgIGlmIHNlbGYuQ29uZmlnLktleXMuaGFyYXNza2V5IG9yIHNlbGYuQ29uZmlnLktleXMuaGFyYXNzdG9nbGVrZXkgIHRoZW4NCiAgICAgIGlmKHNlbGYuQ29uZmlnLnNraWxsbG9naWMuRWxvZ2ljLmhhcmFzcyA9PSAxICBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5oYXJhc3MuTWFuYSAvMTAwICkgIGFuZCBzZWxmLkNvbmZpZy5oYXJhc3MudXNlRSApIHRoZW4gICAgICAgIA0KICAgICAgIGxvY2FsIFRpY2tlciA9IEdldFRpY2tDb3VudCgpDQppZiAoZ2xvYmFsX3RpY2tzICsgMjAwMCkgPCBUaWNrZXIgdGhlbg0KaWYgKG15SGVybzpDYW5Vc2VTcGVsbChfRSkgPT0gUkVBRFkgYW5kIHNlbGYudHNlLnRhcmdldH49bmlsKSB0aGVuDQogICBDYXN0U3BlbGwoX0UsIHNlbGYudHNlLnRhcmdldC54LCBzZWxmLnRzZS50YXJnZXQueikNCiAgIGdsb2JhbF90aWNrcyA9IFRpY2tlcg0KICAgICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIENhc3RTcGVsbChfRSkgZW5kLCAyKQ0KICAgICAgICBlbmQNCiAgICAgICAgZW5kDQogICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgICAgICAgIGlmIHNlbGYuQ29uZmlnLktleXMuaGFyYXNza2V5IG9yIHNlbGYuQ29uZmlnLktleXMuaGFyYXNzdG9nbGVrZXkgIHRoZW4NCiAgICAgICAgICAgICBpZihzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLkVsb2dpYy5oYXJhc3MgPT0gMiBhbmQgICAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmhhcmFzcy5NYW5hIC8xMDAgKSAgYW5kIHNlbGYuQ29uZmlnLmhhcmFzcy51c2VFICkgdGhlbiAgICAgICAgDQogICAgICAgbG9jYWwgVGlja2VyID0gR2V0VGlja0NvdW50KCkNCmlmIChnbG9iYWxfdGlja3MgKyAyMDAwKSA8IFRpY2tlciB0aGVuDQppZiAobXlIZXJvOkNhblVzZVNwZWxsKF9FKSA9PSBSRUFEWSBhbmQgc2VsZi50c2UudGFyZ2V0fj1uaWwpIHRoZW4NCiAgIENhc3RTcGVsbChfRSwgc2VsZi50c2UudGFyZ2V0LngsIHNlbGYudHNlLnRhcmdldC56KQ0KICAgZ2xvYmFsX3RpY2tzID0gVGlja2VyDQogICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgQ2FzdFNwZWxsKF9FKSBlbmQsIDEuNSkNCiAgICBlbmQNCiAgICBlbmQNCiAgICBlbmQNCiAgICBlbmQNCiAgICBlbmQNCmZ1bmN0aW9uIExpc3NhbmRyYTpMYW5lQ2xlYXIoKQ0KIGxvY2FsIGNsZWFydGFyZ2V0ID0gbmlsDQpzZWxmLmVuZW15TWluaW9uczp1cGRhdGUoKQ0KIHNlbGYub3RoZXJNaW5pb25zOnVwZGF0ZSgpDQogICAgc2VsZi5qdW5nbGVNaW5pb25zOnVwZGF0ZSgpDQogICAgZm9yIGksIG1pbmlvbiBpbiBpcGFpcnMoc2VsZi5lbmVteU1pbmlvbnMub2JqZWN0cykgZG8NCiAgICAgIGlmIFZhbGlkVGFyZ2V0KG1pbmlvbiwgNjAwKSBhbmQgKGNsZWFydGFyZ2V0ID09IG5pbCBvciBub3QgVmFsaWRUYXJnZXQoY2xlYXJ0YXJnZXQpKSB0aGVuDQogICAgICAgIGNsZWFydGFyZ2V0ID0gbWluaW9uDQogICAgICBlbmQNCiAgICBlbmQNCiAgICBmb3IgaSwgbWluaW9uIGluIHBhaXJzKHNlbGYuZW5lbXlNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICBpZiBWYWxpZFRhcmdldChtaW5pb24pIGFuZCBtaW5pb24gfj0gbmlsIHRoZW4NCiAgICAgICAgaWYgc2VsZi5Db25maWcuS2V5cy5sYW5lY2xlYXJrZXkgIGFuZCBzZWxmLkNvbmZpZy5mYXJtLmxhbmVjbGVhci51c2VRIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmZhcm0ubGFuZWNsZWFyLk1hbmEgLzEwMCApIGFuZCBHZXREaXN0YW5jZShtaW5pb24pIDw9IHNlbGYuUVNwZWxsLlJhbmdlIHRoZW4gDQogICAgICAgbG9jYWwgQmVzdFBvcywgQmVzdEhpdCA9IEdldEJlc3RMaW5lRmFybVBvc2l0aW9uKHNlbGYuUVNwZWxsLlJhbmdlLCBzZWxmLlFTcGVsbC5XaWR0aCwgc2VsZi5lbmVteU1pbmlvbnMub2JqZWN0cyApDQogICAgICBpZiBCZXN0UG9zICBhbmQgQmVzdEhpdCA+IDAgdGhlbg0KICAgICAgIENhc3RTcGVsbChfUSwgQmVzdFBvcy54LCBCZXN0UG9zLnopDQogICAgICAgIGVuZA0KICAgICAgaWYgY2xlYXJ0YXJnZXQgfj0gbmlsIHRoZW4NCiAgICAgIGlmKHNlbGYuV1NwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcuZmFybS5sYW5lY2xlYXIudXNlVyBhbmQgc2VsZi5Db25maWcuS2V5cy5sYW5lY2xlYXJrZXkgKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5mYXJtLmxhbmVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgIHNlbGY6Q2FzdFcoY2xlYXJ0YXJnZXQpDQogICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGVuZA0KZW5kDQpmdW5jdGlvbiBMaXNzYW5kcmE6YXV0b3EoKQ0KDQogICAgICBpZihzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuaGFyYXNzLk1hbmEgLzEwMCApIGFuZCBzZWxmLnRzcS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuaGFyYXNzLmF1dG9xICkgdGhlbiAgICAgICAgDQogICAgICAgIHNlbGY6Q2FzdFEoc2VsZi50c3EudGFyZ2V0KQ0KICAgIGVuZA0KZW5kDQpmdW5jdGlvbiBMaXNzYW5kcmE6SnVuZ2xlQ2xlYXIoKQ0KbG9jYWwgY2xlYXJ0YXJnZXQgPSBuaWwNCiAgICBzZWxmLmVuZW15TWluaW9uczp1cGRhdGUoKQ0KICAgIHNlbGYub3RoZXJNaW5pb25zOnVwZGF0ZSgpDQogICAgc2VsZi5qdW5nbGVNaW5pb25zOnVwZGF0ZSgpDQogICAgZm9yIGksIG1pbmlvbiBpbiBpcGFpcnMoc2VsZi5lbmVteU1pbmlvbnMub2JqZWN0cykgZG8NCiAgICAgIGlmIFZhbGlkVGFyZ2V0KG1pbmlvbiwgNjAwKSBhbmQgKGNsZWFydGFyZ2V0ID09IG5pbCBvciBub3QgVmFsaWRUYXJnZXQoY2xlYXJ0YXJnZXQpKSB0aGVuDQogICAgICAgIGNsZWFydGFyZ2V0ID0gbWluaW9uDQogICAgICBlbmQNCiAgICBlbmQNCiAgICBmb3IgaSwganVuZ2xlbWluaW9uIGluIGlwYWlycyhzZWxmLmp1bmdsZU1pbmlvbnMub2JqZWN0cykgZG8NCiAgICAgIGlmIFZhbGlkVGFyZ2V0KGp1bmdsZW1pbmlvbiwgNjAwKSBhbmQgKGNsZWFydGFyZ2V0ID09IG5pbCBvciBub3QgVmFsaWRUYXJnZXQoY2xlYXJ0YXJnZXQpKSB0aGVuDQogICAgICAgIGNsZWFydGFyZ2V0ID0ganVuZ2xlbWluaW9uDQogICAgICBlbmQNCiAgICBlbmQNCiAgICBmb3IgaSwgb3RoZXJtaW5pb24gaW4gaXBhaXJzKHNlbGYub3RoZXJNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICBpZiBWYWxpZFRhcmdldChvdGhlcm1pbmlvbiwgNjAwKSBhbmQgKGNsZWFydGFyZ2V0ID09IG5pbCBvciBub3QgVmFsaWRUYXJnZXQoY2xlYXJ0YXJnZXQpKSB0aGVuDQogICAgICAgIGNsZWFydGFyZ2V0ID0gb3RoZXJtaW5pb24NCiAgICAgIGVuZA0KICAgIGVuZA0KICAgIGlmIGNsZWFydGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICBpZihzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXIudXNlUSBhbmQgc2VsZi5Db25maWcuS2V5cy5qdW5nbGVjbGVhcmtleSApIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXIuTWFuYSAvMTAwICkgdGhlbg0KICAgICAgICBzZWxmOkNhc3RRKGNsZWFydGFyZ2V0KQ0KICAgICAgZW5kDQogICAgICBpZiBjbGVhcnRhcmdldCB+PSBuaWwgdGhlbg0KICAgICAgaWYoc2VsZi5XU3BlbGw6SXNSZWFkeSgpIGFuZCBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyLnVzZVcgYW5kIHNlbGYuQ29uZmlnLktleXMuanVuZ2xlY2xlYXJrZXkgKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyLk1hbmEgLzEwMCApIHRoZW4NCiAgICAgICAgc2VsZjpDYXN0VyhjbGVhcnRhcmdldCkNCiAgICAgIGVuZA0KICAgICAgaWYgY2xlYXJ0YXJnZXQgfj0gbmlsIHRoZW4NCiAgICAgIGlmKHNlbGYuRVNwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci51c2VFIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmp1bmdsZWNsZWFya2V5ICkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgIHNlbGY6Q2FzdEUoY2xlYXJ0YXJnZXQpDQogICAgICBlbmQNCiAgICBlbmQNCiAgZW5kDQplbmQNCmVuZA0KLS0gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tTGlzYW5kcmEgZW5kaW5nLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KLS0gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tTGlzYW5kcmEgZW5kaW5nLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KLS0gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tTGlzYW5kcmEgZW5kaW5nLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KLS0gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tTGlzYW5kcmEgZW5kaW5nLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KDQotLSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1WaWt0b3IgU3RhcnQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQotLSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1WaWt0b3IgU3RhcnQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQotLSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1WaWt0b3IgU3RhcnQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQotLSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1WaWt0b3IgU3RhcnQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQpjbGFzcyAiVmlrdG9yIg0KcmVxdWlyZSAnSFByZWRpY3Rpb24nDQpmdW5jdGlvbiBWaWt0b3I6X19pbml0KCkNCiBzZWxmLnRzPSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCA1MjUsIERBTUFHRV9QSFlTSUNBTCwgZmFsc2UsIHRydWUpDQogIHNlbGYudHNxPSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCA2MDAsIERBTUFHRV9QSFlTSUNBTCwgZmFsc2UsIHRydWUpDQogIHNlbGYudHN3PSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCA3MDAsIERBTUFHRV9NQUdJQywgZmFsc2UsIHRydWUpDQogIHNlbGYudHNlPSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCAxMjAwLCBEQU1BR0VfTUFHSUMsIGZhbHNlLCB0cnVlKQ0KICBzZWxmLnRzcj0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgNzAwLCBEQU1BR0VfTUFHSUMsIGZhbHNlLCB0cnVlKSANCiAgIHNlbGYuUVNwZWxsID0gX1NwZWxsKHtTbG90ID0gX1EsIERhbWFnZU5hbWUgPSAiUSIsIFJhbmdlID0gbWF0aC5odWdlLCBXaWR0aCA9IDEsIERlbGF5ID0gMCwgU3BlZWQgPSBtYXRoLmh1Z2UsIENvbGxpc2lvbiA9IHRydWUsIEFvZSA9IGZhbHNlLCBUeXBlID0gU1BFTExfVFlQRS5UQVJHRVRURUR9KQ0KICAgc2VsZi5XU3BlbGwgPSBfU3BlbGwoe1Nsb3QgPSBfVywgRGFtYWdlTmFtZSA9ICJXIiwgUmFuZ2UgPSBtYXRoLmh1Z2UsIFdpZHRoID0gMTI1LCBEZWxheSA9IDAuNSwgU3BlZWQgPSA3NTAsIENvbGxpc2lvbiA9IGZhbHNlLCBBb2UgPSB0cnVlLCBUeXBlID0gU1BFTExfVFlQRS5DSVJDVUxBUn0pDQogICBzZWxmLkVTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9FLCBEYW1hZ2VOYW1lID0gIkUiLCBSYW5nZSA9IDEyMDAsIFdpZHRoID0gOTAsIERlbGF5ID0gMCwgU3BlZWQgPSBtYXRoLmh1Z2UsIENvbGxpc2lvbiA9IHRydWUsIEFvZSA9IGZhbHNlLCBUeXBlID0gU1BFTExfVFlQRS5MSU5FQVJ9KQ0KICAgc2VsZi5SU3BlbGwgPSBfU3BlbGwoe1Nsb3QgPSBfUiwgRGFtYWdlTmFtZSA9ICJSIiwgUmFuZ2UgPTcwMCwgV2lkdGggPSAwLCBEZWxheSA9IDAuMjUsIFNwZWVkID0gMTAwMCwgQ29sbGlzaW9uID0gZmFsc2UsIEFvZSA9IHRydWUsIFR5cGUgPSBTUEVMTF9UWVBFLkNJUkNVTEFSfSkNCiAgIHNlbGYuSWduaXRlID0gX1NwZWxsKHtTbG90ID0gRmluZFN1bW1vbmVyU2xvdCgic3VtbW9uZXJkb3QiKSwgRGFtYWdlTmFtZSA9ICJJR05JVEUiLCBSYW5nZSA9IDYwMCwgVHlwZSA9IFNQRUxMX1RZUEUuVEFSR0VUVEVEfSkNCiAgIHNlbGYuSFByZWQgPSBIUHJlZGljdGlvbigpDQogICBzZWxmLkUgPSB7UmFuZ2UxID0gNTUwLCBSYW5nZTIgPSA3MDAsIHdpZHRoID0gMTgwLCByZWFkeX0NCiAgIHNlbGYuRVJhbmdlID0gc2VsZi5FLlJhbmdlMStzZWxmLkUuUmFuZ2UyDQotLXw+IE1pbmlvbiBNYW5hZ2Vycw0KICAgIHNlbGYuZW5lbXlNaW5pb25zICAgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9FTkVNWSwgICA2NTAsIG15SGVybywgTUlOSU9OX1NPUlRfTUFYSEVBTFRIX0RFQykNCiAgICBzZWxmLmFsbHlNaW5pb25zICAgID0gbWluaW9uTWFuYWdlcihNSU5JT05fQUxMWSwgICA2NTAsIG15SGVybywgTUlOSU9OX1NPUlRfTUFYSEVBTFRIX0RFQykNCiAgICBzZWxmLmp1bmdsZU1pbmlvbnMgID0gbWluaW9uTWFuYWdlcihNSU5JT05fSlVOR0xFLCAgNjUwLCBteUhlcm8sIE1JTklPTl9TT1JUX01BWEhFQUxUSF9ERUMpDQogICAgc2VsZi5vdGhlck1pbmlvbnMgICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX09USEVSLCAgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgICAgICAgICAgc2VsZjpMb2FkTWVudSgpDQogICAgICAgICAgICBzZWxmOmZpbmRvcmJ3YWxrZXIoKQ0KICAgICAgICAgaWYgVklQX1VTRVIgdGhlbiBzZWxmOnNraW5oYWNrKCkgZW5kDQogICAgICBBZGRUaWNrQ2FsbGJhY2soZnVuY3Rpb24oKSBzZWxmOlRpY2soKSBlbmQpDQogIEFkZERyYXdDYWxsYmFjayhmdW5jdGlvbigpIHNlbGY6RHJhdygpIGVuZCkNCiAgLS1BZGRNc2dDYWxsYmFjayhmdW5jdGlvbihtc2csS2V5KSBzZWxmOlduZE1zZyhtc2csS2V5KSBlbmQpDQogIC0tQWRkQW5pbWF0aW9uQ2FsbGJhY2soZnVuY3Rpb24odW5pdCwgYW5pbWF0aW9uKSBzZWxmOkFuaW1hdGlvbih1bml0LCBhbmltYXRpb24pIGVuZCkNCiAgLS1BZGRQcm9jZXNzU3BlbGxDYWxsYmFjayhmdW5jdGlvbih1bml0LCBzcGVsbCkgc2VsZjpQcm9jZXNzU3BlbGwodW5pdCwgc3BlbGwpIGVuZCkNCiAgLS1BZGRBcHBseUJ1ZmZDYWxsYmFjayhmdW5jdGlvbihzb3VyY2UsIHVuaXQsIGJ1ZmYpIHNlbGY6T25BcHBseUJ1ZmYoc291cmNlLCB1bml0LCBidWZmKSBlbmQpDQogIC0tQWRkVXBkYXRlQnVmZkNhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIGJ1ZmYsIHN0YWNrcykgc2VsZjpVcGRhdGVCdWZmKHVuaXQsIGJ1ZmYsIHN0YWNrcykgZW5kKQ0KICAtLUFkZFJlbW92ZUJ1ZmZDYWxsYmFjayhmdW5jdGlvbih1bml0LCBidWZmKSBzZWxmOk9uUmVtb3ZlQnVmZih1bml0LCBidWZmKSBlbmQpIA0KICAgIGVuZA0KLS0gaGFuZGxlcyBzY3JpcHQgbG9naWMsIGEgcHVyZSBoaWdoIHNwZWVkIGxvb3ANCmZ1bmN0aW9uIFZpa3RvcjpUaWNrKCkNCiAgICAgc2VsZjphdXRvemhvbnlhKCkNCiAgICAgICAgICBpZiBWSVBfVVNFUiB0aGVuIHNlbGY6YXV0b2xldmVsKCkgZW5kDQogaWYoc2VsZi5Db25maWcuY29tYm8uY29tYm9rZXkgKXRoZW4NCiAgICBzZWxmOmNvbWJvKCkNCiAgZW5kDQogIGlmKHNlbGYuQ29uZmlnLmxhbmVjbGVhci5sYW5lY2xlYXJrZXkpdGhlbg0KICAgIHNlbGY6TGFuZUNsZWFyKCkNCiAgZW5kDQogICAgaWYoc2VsZi5Db25maWcuanVuZ2xlY2xlYXIuanVuZ2xlY2xlYXJrZXkpdGhlbg0KICAgIHNlbGY6SnVuZ2xlQ2xlYXIoKQ0KICBlbmQNCiAgaWYoc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzICkgdGhlbg0KICAgIHNlbGY6a2lsbHN0ZWFsKCkNCiAgZW5kDQogIGlmKHNlbGYuQ29uZmlnLmhhcmFzcy5oYXJhc3NrZXkgb3Igc2VsZi5Db25maWcuaGFyYXNzLmhhcmFzc3RvZ2xlICkgdGhlbg0KICAgIHNlbGY6aGFyYXNzKCkNCiAgZW5kDQogICAgZW5kDQpmdW5jdGlvbiBWaWt0b3I6TG9hZE1lbnUoKQ0KICAgICAgc2VsZi5Db25maWc9c2NyaXB0Q29uZmlnKCIiLi5TY3JpcHRuYW1lLi4iIiwibWVudSIpDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJIaXRjaGFuY2UiLCAiaGl0IikNCiAgICAgIHNlbGYuQ29uZmlnLmhpdDphZGRQYXJhbSgiRSIsICJFIEhpdENoYW5jZSAoRGVmYXVsdCB2YWx1ZSA9IDEuNikiLCBTQ1JJUFRfUEFSQU1fU0xJQ0UsIDEuNiwgMSwgMywgMikNCiAgICAgDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJDb21ibyBTZXR0aW5ncyIsICJjb21ibyIpDQogICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgiY29tYm9rZXkiLCAiQ29tYm8gS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIDMyKQ0KICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZVEiLCAiVXNlIFEgaW4gQ29tYm8iLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlVyIsICJVc2UgVyBpbiBDb21ibyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VFIiwgIlVzZSBFIGluIGNvbWJvIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZVIiLCAiVXNlIFIgaW4gY29tYm8iLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlSSIsICJVc2UgSWduaXRlIGlmIHRhcmdldCBraWxsYWJsZSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJsb2dpYyIsICJVbHRpIExvZ2ljIiwgU0NSSVBUX1BBUkFNX0xJU1QsIDEsIHsiVXNlIFVsdGkgSWYgVGFyZ2V0IElzIEtpbGxhYmxlIix9KSAtLSgiVXNlIFVsdGkgRGlyZWN0bHkiIH0pDQogICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDEwLCAxMCwgMTAwLCAwKQ0KICAgICAgDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJIYXJhc3MgU2V0dGluZ3MiLCAiaGFyYXNzIikNCiAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczphZGRQYXJhbSgiaGFyYXNza2V5IiwgIlNtYXJ0IEhhcmFzcyBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIkMiKSkNCiAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczphZGRQYXJhbSgiaGFyYXNzdG9nbGUiLCAiU21hcnQgQXV0byBIYXJhc3MiLCAgIFNDUklQVF9QQVJBTV9PTktFWVRPR0dMRSwgZmFsc2UsIHN0cmluZy5ieXRlKCJUIikpDQogICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6YWRkUGFyYW0oInVzZVEiLCAiSGFyYXNzIFdpdGggUSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczphZGRQYXJhbSgidXNlRSIsICJIYXJhc3MgV2l0aCBFIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgc2VsZi5Db25maWcuaGFyYXNzOmFkZFBhcmFtKCJFIiwgIkUgSGl0Q2hhbmNlIChEZWZhdWx0IHZhbHVlID0gMikiLCBTQ1JJUFRfUEFSQU1fU0xJQ0UsIDIsIDEsIDMsIDIpDQogICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6YWRkUGFyYW0oIk1hbmEiLCJNYW5hIE1hbmFnZXIgJSIsU0NSSVBUX1BBUkFNX1NMSUNFLCAzMCwgMTAsIDEwMCwgMCkNCiAgICAgIA0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiTGFuZUNsZWFyIFNldHRpbmdzIiwibGFuZWNsZWFyIikNCiAgICAgIHNlbGYuQ29uZmlnLmxhbmVjbGVhcjphZGRQYXJhbSgibGFuZWNsZWFya2V5IiwgIkxhbmUgQ2xlYXIgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJWIikpDQogICAgICBzZWxmLkNvbmZpZy5sYW5lY2xlYXI6YWRkUGFyYW0oInVzZVEiLCJVc2UgUSBvbiBMYW5lY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgc2VsZi5Db25maWcubGFuZWNsZWFyOmFkZFBhcmFtKCJ1c2VFIiwiVXNlIEUgb24gTGFuZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmxhbmVjbGVhcjphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDMwLCAxMCwgMTAwLCAwKQ0KICAgICAgDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJKdW5nbGVDbGVhciBTZXR0aW5ncyIsImp1bmdsZWNsZWFyIikNCiAgICAgIHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyOmFkZFBhcmFtKCJqdW5nbGVjbGVhcmtleSIsICJKdW5nbGVDbGVhciBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIlYiKSkNCiAgICAgIHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyOmFkZFBhcmFtKCJ1c2VRIiwiVXNlIFEgb24ganVuZ2xlY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgc2VsZi5Db25maWcuanVuZ2xlY2xlYXI6YWRkUGFyYW0oInVzZUUiLCJVc2UgRSBvbiBqdW5nbGVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhcjphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDMwLCAxMCwgMTAwLCAwKQ0KICAgICAgIA0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiS2lsbFN0ZWFsIFNldHRpbmdzIiwgImtpbGxzdGVhbCIpDQogICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oImtzIiwiS2lsbHN0ZWFsIE9uL09mZiIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZVEiLCAiU3RlYWwgV2l0aCBRIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJ1c2VFIiwgIlN0ZWFsIFdpdGggRSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgidXNlUiIsICJTdGVhbCBXaXRoIFIiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZUkiLCAiU3RlYWwgV2l0aCBJZ25pdGUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICANCiAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkl0ZW0gU2V0dGluZ3MiLCAiaXRlbSIpDQogICAgICBzZWxmLkNvbmZpZy5pdGVtOmFkZFBhcmFtKCJlbmFibGVhdXRvemhvbnlhIiwgIkF1dG8gWmhvbnlhIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCBmYWxzZSkNCiAgICAgIHNlbGYuQ29uZmlnLml0ZW06YWRkUGFyYW0oImF1dG96aG9ueWEiLCAiWmhvbnlhIGlmIEhlYWx0aCB1bmRlciAtPiAlIiwgU0NSSVBUX1BBUkFNX1NMSUNFLCAxMCwgMCwgMTAwLCAwKQ0KICAgICAgDQogICAgICAgICAgICBpZiBWSVBfVVNFUiB0aGVuDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJWSVAgU2V0dGluZ3MiLCAidmlwIikNCiAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgicGFja2V0IiwiVXNlIFBhY2tldCBDYXN0aW5nIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm8xIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvMiIsICJUbyB1c2UgdmlwIHNldHRpbmdzLCBQYWNrZXQgQ2FzdGluZyBzaG91bGQgYmUgb3Blbi4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRTdWJNZW51KCJBdXRvIExldmVsIFNldHRpbmdzIiwgImxldmVsIikNCiAgICAgIHNlbGYuQ29uZmlnLnZpcC5sZXZlbDphZGRQYXJhbSgia2V5IiwiVXNlIEF1dG8gTGV2ZWwiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgIHNlbGYuQ29uZmlnLnZpcC5sZXZlbDphZGRQYXJhbSgibG9naWMiLCAiU2VsZWN0IFNraWxsIE9yZGVyIiwgU0NSSVBUX1BBUkFNX0xJU1QsIDYsIHsiRm9jdXMgUT5XPkUiLCAiRm9jdXMgUT5FPlciLCJGb2N1cyBXPlE+RSIsIkZvY3VzIFc+RT5RIiwiRm9jdXMgRT5XPlEiLCAiRm9jdXMgRT5RPlciICB9KQ0KICAgICAgc2VsZi5Db25maWcudmlwOmFkZFN1Yk1lbnUoIlNraW4gSGFjayBTZXR0aW5ncyIsICJza2luIikNCiAgICAgIHNlbGYuQ29uZmlnLnZpcC5za2luOmFkZFBhcmFtKCJrZXkiLCJVc2UgU2tpbiBIYWNrIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICBzZWxmLkNvbmZpZy52aXAuc2tpbjphZGRQYXJhbSgnc2VsZWN0ZWQnIC4uIG15SGVyby5jaGFyTmFtZSAuLiAnU2tpbicsICJTZWxlY3QgU2tpbiIsIFNDUklQVF9QQVJBTV9MSVNULCAxLCB7Ik9yaWdpbmFsIiwgIkZ1bGwgTWFjaGluZSBWaWt0b3IgIiwiUHJvdG90eXBlIFZpa3RvciAiLCJDcmVhdG9yIFZpa3RvciAiIH0pDQogICAgICBzZWxmLkNvbmZpZy52aXAuc2tpbjphZGRQYXJhbSgiaW5mbzQiLCAiVG8gdXNlIHNraW4gaGFjaywgWW91IG5lZWQgdG8gMnggRjkgYWZ0ZXIgeW91IHNlbGVjdCB0aGUgc2tpbiB5b3UgZGVzaXJlLiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcudmlwLnNraW46YWRkUGFyYW0oImluZm81IiwgIk1ha2Ugc3VyZSB0aGF0IHVzaW5nIHBhY2tldCBjYXN0aW5nIGlzIE9OLiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgLS1zZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm81IiwgIlNraW4gSGFjayB0ZW1wb3JhcnkgZGlzYWJsZWQgdW50aWwgbmV4dCB1cGRhdGUuIC4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIC0tW1tzZWxmLkNvbmZpZy52aXA6YWRkU3ViTWVudSgiQW50aS1BRksgU2V0dGluZ3MiLCAiYW50aWFmayIpDQogICAgICBzZWxmLkNvbmZpZy52aXAuYW50aWFmazphZGRQYXJhbSgiYW50aWFmayIsIlVzZSBBbnRpIEFmayIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKSBdXQ0KICAgICAgc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvMyIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzQiLCAiVG8gdXNlIHZpcCBzZXR0aW5ncywgWW91IG5lZWQgdG8gYmUgYSBWSVAgdXNlciBvbiBCT0wgY29tbXVuaXR5LiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICBlbmQNCiAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkRyYXcgU2V0dGluZ3MiLCJvdGhlciIpDQogICAgICAtLXNlbGYuQ29uZmlnLm90aGVyOmFkZFN1Yk1lbnUoIlNob3cgRGFtYWdlIE9uIEhwIEJhciIsICJIUEJBUiIpDQogICAgICAtLXNlbGYuQ29uZmlnLm90aGVyLkhQQkFSOmFkZFBhcmFtKCJrZXkiLCJPTi9PRkYiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgc2VsZi5Db25maWcub3RoZXI6YWRkU3ViTWVudSgiU2tpbGwgRHJhd2luZyBTZXR0aW5ncyIsICJkcmF3IikNCiAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oInFkcmF3IiwiUSBTa2lsbCBEcmF3aW5ncyIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5vdGhlci5kcmF3OmFkZFBhcmFtKCJ3ZHJhdyIsIlcgU2tpbGwgRHJhd2luZ3MiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgiZWRyYXciLCJFIFNraWxsIERyYXdpbmdzIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oInJkcmF3IiwiUiBTa2lsbCBEcmF3aW5ncyIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5vdGhlci5kcmF3OmFkZFBhcmFtKCJhYWRyYXciLCJBdXRvIEF0dGFjayBSYW5nZSIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJUYXJnZXRzZWxlY3RvcnMiLCJ0YXJnZXRzZWwiKQ0KICAgc2VsZi50cy5uYW1lICA9ICJWaWt0b3IiDQogICAgc2VsZi50c3EubmFtZSA9ICJWaWt0b3JRIg0KICAgIHNlbGYudHN3Lm5hbWUgPSAiVmlrdG9yVyINCiAgICBzZWxmLnRzZS5uYW1lID0gIlZpa3RvckUiDQogICAgc2VsZi50c3IubmFtZSA9ICJWaWt0b3JSIg0KICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRUUyhzZWxmLnRzKQ0KICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRUUyhzZWxmLnRzcSkNCiAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkVFMoc2VsZi50c3cpDQogICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFRTKHNlbGYudHNlKQ0KICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRUUyhzZWxmLnRzcikgDQogICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiS2V5cyBTZXR0aW5ncyIsICJLZXlzIikNCiAgICBPcmJ3YWxrTWFuYWdlcjpMb2FkQ29tbW9uS2V5cyhzZWxmLkNvbmZpZy5LZXlzKQ0KICAgICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm8zIiwgIl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3giLCAiICAgICAgICAgICAgICAgIi4uU2NyaXB0bmFtZS4uIiIsIFNDUklQVF9QQVJBTV9JTkZPLCAiIikgDQogICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94MiIsICIgICAgICAgICAgICAgICAgIFNjcmlwdCBWZXJzaW9uOiAgIi4uVmVyc2lvbi4uICIgICAgICAgICAiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3g2IiwgIiAgICAgICAgICAgIFNjcmlwdCB3YXMgbWFkZSBieSAgIi4uQXV0aG9yLi4gIiAgICAgICAgICIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDUiLCAiICAgICAgIExlYXVnZSBPZiBMZWdlbmRzIFZlcnNpb246ICAiLi5MVmVyc2lvbi4uICIgICAgICAgICAiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgDQogICAgIHNlbGYuQ29uZmlnOnBlcm1hU2hvdygiaW5mb2JveCIpDQogICAgIHNlbGYuQ29uZmlnLmNvbWJvOnBlcm1hU2hvdygiY29tYm9rZXkiKQ0KICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6cGVybWFTaG93KCJoYXJhc3N0b2dsZSIpDQogICAgIHNlbGYuQ29uZmlnLmhhcmFzczpwZXJtYVNob3coImhhcmFzc2tleSIpDQogIA0KZW5kDQpmdW5jdGlvbiBWaWt0b3I6RHJhdygpDQogICAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5xZHJhdyBhbmQgc2VsZi5RU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgNjAwLCAxLHJlZCkNCiAgZW5kDQoNCiAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy53ZHJhdyBhbmQgc2VsZi5XU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgNzAwLCAxLCByZWQpDQogIGVuZA0KDQogIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcuZWRyYXcgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSB0aGVuDQogICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDEyMDAsIDEsIHJlZCkNCiAgZW5kDQogIA0KICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LnJkcmF3IGFuZCBzZWxmLlJTcGVsbDpJc1JlYWR5KCkgdGhlbg0KICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCA3MDAsMSwgcmVkKQ0KICBlbmQNCiAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5hYWRyYXcgdGhlbg0KICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCA1MjUsMSwgQVJHQigyNTUsIDI1NSwwLDApKQ0KICBlbmQNCmVuZA0KDQpmdW5jdGlvbiBWaWt0b3I6c2tpbmhhY2soKQ0KaWYgbm90IHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgdGhlbiBTZW5kU2tpblBhY2tldChteUhlcm8uY2hhck5hbWUsIHNraW5zUEJbMV0sIG15SGVyby5uZXR3b3JrSUQpOyBlbHNlDQppZiBzZWxmLkNvbmZpZy52aXAuc2tpbi5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgIHRoZW4NClNlbmRTa2luUGFja2V0KG15SGVyby5jaGFyTmFtZSwgc2tpbnNQQltzZWxmLkNvbmZpZy52aXAuc2tpblsnc2VsZWN0ZWQnIC4uIG15SGVyby5jaGFyTmFtZSAuLiAnU2tpbiddXSwgbXlIZXJvLm5ldHdvcmtJRCk7DQplbmQNCmVuZA0KZW5kDQpmdW5jdGlvbiBWaWt0b3I6YXV0b2xldmVsKCkNCmlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gMSApIHRoZW4NCmlmIG15SGVyby5sZXZlbCA9PSAxIHRoZW4NCiBMZXZlbFNwZWxsKF9XKSANCiBlbHNlaWYgbXlIZXJvLmxldmVsID09IDIgdGhlbg0KIExldmVsU3BlbGwoX1EpIA0KIGVsc2VpZiBteUhlcm8ubGV2ZWwgPT0gMyB0aGVuDQogTGV2ZWxTcGVsbChfRSkgDQogZWxzZWlmIG15SGVyby5sZXZlbCA+IDMgYW5kIG15SGVyby5sZXZlbCA+IHNwZWxsTGV2ZWwgdGhlbg0KICAgICAgICBzcGVsbExldmVsID0gc3BlbGxMZXZlbCArIDEgICAgICAgIA0KICAgICAgICAgTGV2ZWxTcGVsbChfUikNCiAgICAgICAgICAgIExldmVsU3BlbGwoX1EpDQogICAgICAgICAgICBMZXZlbFNwZWxsKF9XKQ0KICAgICAgICAgICAgTGV2ZWxTcGVsbChfRSkNCiAgICAgICAgICAgIGVuZA0KICAgIGVsc2VpZiAoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSAyICkgdGhlbg0KICAgIGlmIG15SGVyby5sZXZlbCA9PSAxIHRoZW4NCiBMZXZlbFNwZWxsKF9XKSANCiBlbHNlaWYgbXlIZXJvLmxldmVsID09IDIgdGhlbg0KIExldmVsU3BlbGwoX1EpIA0KIGVsc2VpZiBteUhlcm8ubGV2ZWwgPT0gMyB0aGVuDQogTGV2ZWxTcGVsbChfRSkgDQogZWxzZWlmIG15SGVyby5sZXZlbCA+IDMgYW5kIG15SGVyby5sZXZlbCA+IHNwZWxsTGV2ZWwgdGhlbg0KICAgICAgICBzcGVsbExldmVsID0gc3BlbGxMZXZlbCArIDEgICAgICAgIA0KICAgICAgICAgTGV2ZWxTcGVsbChfUikNCiAgICAgICAgICAgIExldmVsU3BlbGwoX1EpDQogICAgICAgICAgICBMZXZlbFNwZWxsKF9FKQ0KICAgICAgICAgICAgTGV2ZWxTcGVsbChfVykNCiAgICAgICAgICAgIGVuZA0KICAgZWxzZWlmICggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDMgKSB0aGVuDQogICAgaWYgbXlIZXJvLmxldmVsID09IDEgdGhlbg0KIExldmVsU3BlbGwoX1EpIA0KIGVsc2VpZiBteUhlcm8ubGV2ZWwgPT0gMiB0aGVuDQogTGV2ZWxTcGVsbChfVykgDQogZWxzZWlmIG15SGVyby5sZXZlbCA9PSAzIHRoZW4NCiBMZXZlbFNwZWxsKF9FKSANCiBlbHNlaWYgbXlIZXJvLmxldmVsID4gMyBhbmQgbXlIZXJvLmxldmVsID4gc3BlbGxMZXZlbCB0aGVuDQogICAgICAgIHNwZWxsTGV2ZWwgPSBzcGVsbExldmVsICsgMSAgICAgICAgDQogICAgICAgICBMZXZlbFNwZWxsKF9SKQ0KICAgICAgICAgICAgTGV2ZWxTcGVsbChfVykNCiAgICAgICAgICAgIExldmVsU3BlbGwoX1EpDQogICAgICAgICAgICBMZXZlbFNwZWxsKF9FKQ0KICAgICAgICAgICAgZW5kDQogICAgICAgICAgICBlbHNlaWYgKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gNCApIHRoZW4NCiAgICBpZiBteUhlcm8ubGV2ZWwgPT0gMSB0aGVuDQogTGV2ZWxTcGVsbChfUSkgDQogZWxzZWlmIG15SGVyby5sZXZlbCA9PSAyIHRoZW4NCiBMZXZlbFNwZWxsKF9XKSANCiBlbHNlaWYgbXlIZXJvLmxldmVsID09IDMgdGhlbg0KIExldmVsU3BlbGwoX0UpIA0KIGVsc2VpZiBteUhlcm8ubGV2ZWwgPiAzIGFuZCBteUhlcm8ubGV2ZWwgPiBzcGVsbExldmVsIHRoZW4NCiAgICAgICAgc3BlbGxMZXZlbCA9IHNwZWxsTGV2ZWwgKyAxICAgICAgICANCiAgICAgICAgIExldmVsU3BlbGwoX1IpDQogICAgICAgICAgICBMZXZlbFNwZWxsKF9XKQ0KICAgICAgICAgICAgTGV2ZWxTcGVsbChfRSkNCiAgICAgICAgICAgIExldmVsU3BlbGwoX1EpDQogICAgICAgICAgICBlbmQNCiAgICAgICAgICAgIGVsc2VpZiAoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSA1ICkgdGhlbg0KICAgIGlmIG15SGVyby5sZXZlbCA9PSAxIHRoZW4NCiBMZXZlbFNwZWxsKF9XKSANCiBlbHNlaWYgbXlIZXJvLmxldmVsID09IDIgdGhlbg0KIExldmVsU3BlbGwoX0UpIA0KIGVsc2VpZiBteUhlcm8ubGV2ZWwgPT0gMyB0aGVuDQogTGV2ZWxTcGVsbChfUSkgDQogZWxzZWlmIG15SGVyby5sZXZlbCA+IDMgYW5kIG15SGVyby5sZXZlbCA+IHNwZWxsTGV2ZWwgdGhlbg0KICAgICAgICBzcGVsbExldmVsID0gc3BlbGxMZXZlbCArIDEgICAgICAgIA0KICAgICAgICAgTGV2ZWxTcGVsbChfUikNCiAgICAgICAgICAgIExldmVsU3BlbGwoX1cpDQogICAgICAgICAgICBMZXZlbFNwZWxsKF9RKQ0KICAgICAgICAgICAgTGV2ZWxTcGVsbChfRSkNCiAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgZWxzZWlmICggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDYgKSB0aGVuDQogICAgaWYgbXlIZXJvLmxldmVsID09IDEgdGhlbg0KIExldmVsU3BlbGwoX1EpIA0KIGVsc2VpZiBteUhlcm8ubGV2ZWwgPT0gMiB0aGVuDQogTGV2ZWxTcGVsbChfRSkgDQogZWxzZWlmIG15SGVyby5sZXZlbCA9PSAzIHRoZW4NCiBMZXZlbFNwZWxsKF9XKSANCiBlbHNlaWYgbXlIZXJvLmxldmVsID4gMyBhbmQgbXlIZXJvLmxldmVsID4gc3BlbGxMZXZlbCB0aGVuDQogICAgICAgIHNwZWxsTGV2ZWwgPSBzcGVsbExldmVsICsgMSAgICAgICAgDQogICAgICAgICBMZXZlbFNwZWxsKF9SKQ0KICAgICAgICAgICAgTGV2ZWxTcGVsbChfRSkNCiAgICAgICAgICAgIExldmVsU3BlbGwoX1EpDQogICAgICAgICAgICBMZXZlbFNwZWxsKF9XKQ0KICAgICAgICAgICAgZW5kDQogICAgICAgICAgICBlbmQNCmVuZA0KZnVuY3Rpb24gVmlrdG9yOmF1dG96aG9ueWEoKQ0KICBpZiBzZWxmLkNvbmZpZy5pdGVtLmVuYWJsZWF1dG96aG9ueWEgdGhlbg0KICAgZm9yIF8gPSBJVEVNXzEsIElURU1fNyBkbw0KICAgIGlmIG15SGVyby5oZWFsdGggPD0gKG15SGVyby5tYXhIZWFsdGggKiBzZWxmLkNvbmZpZy5pdGVtLmF1dG96aG9ueWEgLyAxMDApIGFuZCAoIG15SGVybzpDYW5Vc2VTcGVsbChfKSA9PSAwIGFuZCBteUhlcm86R2V0U3BlbGxEYXRhKF8pLm5hbWUgPT0gIlpob255YXNIb3VyZ2xhc3MiICl0aGVuIENhc3RTcGVsbChfKQ0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gVmlrdG9yOm9ubHlyKCkNCiAgaWYgKHNlbGYuUlNwZWxsOklzUmVhZHkoKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKSBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUiBhbmQgc2VsZi5Db25maWcuY29tYm8uY29tYm9rZXkgYW5kIEdldERpc3RhbmNlKHNlbGYudHNyLnRhcmdldCk8NzAwICl0aGVuDQogICAgc2VsZjpDYXN0UihzZWxmLnRzci50YXJnZXQpDQogICAgZW5kDQogIGVuZA0KZnVuY3Rpb24gVmlrdG9yOmNvbWJvKCkNCiAgICAgIHNlbGYudHNxOnVwZGF0ZSgpDQogICAgaWYoc2VsZi5RU3BlbGw6SXNSZWFkeSgpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmNvbWJvLk1hbmEgLzEwMCApYW5kIHNlbGYudHNxLnRhcmdldH49bmlsICBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUSBhbmQgc2VsZi5Db25maWcuY29tYm8uY29tYm9rZXkgICl0aGVuDQogICAgICAgIHNlbGY6Q2FzdFEoc2VsZi50c3EudGFyZ2V0KQ0KICAgIGVuZA0KICAgIHNlbGYudHNlOnVwZGF0ZSgpDQogICAgaWYoc2VsZi5FU3BlbGw6SXNSZWFkeSgpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmNvbWJvLk1hbmEgLzEwMCApYW5kIHNlbGYudHNlLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VFIGFuZCBzZWxmLkNvbmZpZy5jb21iby5jb21ib2tleSAgKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0RShzZWxmLnRzZS50YXJnZXQpDQogICAgZW5kDQogICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgICBpZihzZWxmLldTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwICkgYW5kIHNlbGYudHN3LnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VXIGFuZCAgc2VsZi5Db25maWcuY29tYm8uY29tYm9rZXkgICl0aGVuDQogICAgICAgIHNlbGY6Q2FzdFcoc2VsZi50c3cudGFyZ2V0KQ0KICAgIGVuZA0KICAgIGlmKCBzZWxmLlJTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwICkgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVIgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLmNvbWJva2V5ICl0aGVuDQogICAgZm9yIF8sIHVuaXQgaW4gcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8NCiAgICAgIGxvY2FsIGRtZ1IgPWdldERtZygiUiIsdW5pdCxteUhlcm8pKyAoKG15SGVyby5hcCkqMC41NSkgDQogICAgICBsb2NhbCBoZWFsdGg9dW5pdC5oZWFsdGgNCiAgICAgIGlmKGhlYWx0aDxkbWdSIGFuZCBzZWxmLkNvbmZpZy5jb21iby5sb2dpYyA9PSAxIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VSIGFuZCBHZXREaXN0YW5jZSh1bml0KTw3MDApdGhlbg0KICAgICAgICBzZWxmOkNhc3RSKHVuaXQpDQogICAgIGVuZA0KICAgICBlbmQNCiAgICAgaWYgKHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID09IDIgYW5kIHNlbGYudHNyLnRhcmdldH49bmlsKSB0aGVuDQogICAgIHNlbGY6b25seXIoKQ0KICAgIGVuZA0KICANCiAgICBpZihzZWxmLkNvbmZpZy5jb21iby51c2VJIGFuZCBzZWxmLkNvbmZpZy5jb21iby5jb21ib2tleSApdGhlbg0KICAgIGZvciBfLCB1bml0IGluIHBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvDQogICAgICBsb2NhbCBkbWdJID0oNTArICgobXlIZXJvLmxldmVsKSoyMCkpDQogICAgICBsb2NhbCBoZWFsdGg9dW5pdC5oZWFsdGgNCiAgICAgIGlmKGhlYWx0aDxkbWdJIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VJIGFuZCBHZXREaXN0YW5jZSh1bml0KTw2MDApdGhlbg0KICAgICAgICBzZWxmOkNhc3RJKHVuaXQpDQogICAgZW5kDQogICAgZW5kDQplbmQNCmVuZA0KZW5kDQpmdW5jdGlvbiBWaWt0b3I6Q2FzdFEodW5pdCkNCiAgc2VsZi5RU3BlbGw6Q2FzdCh1bml0KQ0KZW5kDQoNCmZ1bmN0aW9uIFZpa3RvcjpDYXN0Vyh1bml0KQ0KICBzZWxmLldTcGVsbDpDYXN0KHVuaXQpDQplbmQNCg0KZnVuY3Rpb24gVmlrdG9yOkNhc3RFKHVuaXQpDQogDQogIGlmIHVuaXQuZGVhZCBvciB1bml0LmhlYWx0aCA9PSAwIHRoZW4NCiAgICByZXR1cm4NCiAgZW5kDQogIA0KICBpZiBHZXREaXN0YW5jZSh1bml0LCBteUhlcm8pID4gc2VsZi5FLlJhbmdlMS01IHRoZW4NCiAgIEVTdGFydFBvcyA9IENpcmNsZUludGVyc2VjdGlvbihteUhlcm8sIHVuaXQsIG15SGVybywgc2VsZi5FLlJhbmdlMS01KQ0KICBlbHNlDQogICBFU3RhcnRQb3MgPSBWZWN0b3IodW5pdC54LCB1bml0LnksIHVuaXQueikNCiAgZW5kDQogIA0KICAgRVBvcywgRUhpdENoYW5jZSA9IHNlbGYuSFByZWQ6R2V0UHJlZGljdChzZWxmLkhQcmVkLlByZXNldHNbJ1Zpa3RvciddWyJFIl0sIHVuaXQsIEVTdGFydFBvcykNCiAgDQogIGlmIG1vZGUgPT0gIkNvbWJvIiBhbmQgRUhpdENoYW5jZSA+PSBzZWxmLkNvbmZpZy5oaXQuRSBvciBtb2RlID09ICJIYXJhc3MiIGFuZCBFSGl0Q2hhbmNlID49IHNlbGYuQ29uZmlnLmhhcmFzcy5FIG9yICBtb2RlID09IG5pbCBhbmQgRUhpdENoYW5jZSA+IDEgdGhlbg0KICAgIENhc3RTcGVsbDMoX0UsIEQzRFhWRUNUT1IzKEVTdGFydFBvcy54LCAwLCBFU3RhcnRQb3MueiksIEQzRFhWRUNUT1IzKEVQb3MueCwgMCwgRVBvcy56KSkNCiAgZW5kDQogIA0KZW5kDQoNCmZ1bmN0aW9uIFZpa3RvcjpDYXN0Uih1bml0KQ0KICBzZWxmLlJTcGVsbDpDYXN0KHVuaXQpDQplbmQNCmZ1bmN0aW9uIFZpa3RvcjpDYXN0SSh1bml0KQ0KICBzZWxmLklnbml0ZTpDYXN0KHVuaXQpDQplbmQNCmZ1bmN0aW9uIFZpa3RvcjpraWxsc3RlYWwoKQ0KZm9yIF8sIHVuaXQgaW4gcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8NCiAgICBsb2NhbCBoZWFsdGggPSB1bml0LmhlYWx0aA0KICAgIGxvY2FsIGRtZ0UgPSBnZXREbWcoIkUiLCB1bml0LCBteUhlcm8pICsgKChteUhlcm8uYXApKjAuNykgKyAoKGdldERtZygiRSIsIHVuaXQsIG15SGVybykgKyAoKG15SGVyby5hcCkqMC43KSkqMC40KQ0KICAgICAgaWYoc2VsZi50c2UudGFyZ2V0IH49IG5pbCBhbmQgIHNlbGYuRVNwZWxsOklzUmVhZHkoKSBhbmQgaGVhbHRoPGRtZ0UgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VFIGFuZCBHZXREaXN0YW5jZSh1bml0KTw3MDAgICBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0RSh1bml0KSAgDQogICAgICBlbmQNCiAgICAgIGxvY2FsIGRtZ1EgPSBnZXREbWcoIlEiLCB1bml0LCBteUhlcm8pICsgKChteUhlcm8uYXApKjAuMzApDQogICAgICBpZihzZWxmLnRzcS50YXJnZXQgfj0gbmlsIGFuZCAgc2VsZi5RU3BlbGw6SXNSZWFkeSgpIGFuZCBoZWFsdGg8ZG1nUSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZVEgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyApdGhlbg0KICAgICAgICBzZWxmOkNhc3RRKHVuaXQpICANCiAgICAgIGVuZA0KICAgICAgIGxvY2FsIGRtZ0kgPSg1MCsgKChteUhlcm8ubGV2ZWwpKjIwKSkNCiAgICAgIGlmKGhlYWx0aDxkbWdJIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlSSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzIGFuZCBHZXREaXN0YW5jZSh1bml0KTw2MDApdGhlbg0KICAgICAgICBzZWxmOkNhc3RJKHVuaXQpDQogICAgICBlbmQNCiAgICAgIGxvY2FsIGRtZ1IgPWdldERtZygiUiIsdW5pdCxteUhlcm8pKygobXlIZXJvLmFwKSowLjU1KSANCiAgICAgIGlmKHNlbGYudHNyLnRhcmdldCB+PSBuaWwgYW5kICBzZWxmLlJTcGVsbDpJc1JlYWR5KCkgYW5kIGhlYWx0aDxkbWdSIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlUiBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzIGFuZCBHZXREaXN0YW5jZSh1bml0KTw3MDApdGhlbg0KICAgICAgICBzZWxmOkNhc3RSKHVuaXQpDQogICAgICBlbmQNCiAgIGVuZA0KZW5kDQoNCmZ1bmN0aW9uIFZpa3RvcjpoYXJhc3MoKQ0KICBzZWxmLnRzOnVwZGF0ZSgpDQogIHNlbGYudHNxOnVwZGF0ZSgpDQogIGlmIHNlbGYuQ29uZmlnLmhhcmFzcy5oYXJhc3NrZXkgb3Igc2VsZi5Db25maWcuaGFyYXNzLmhhcmFzc3RvZ2xlICB0aGVuDQogICAgICBpZihzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuaGFyYXNzLk1hbmEgLzEwMCApIGFuZCBzZWxmLnRzcS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuaGFyYXNzLnVzZVEgKSB0aGVuICAgICAgICANCiAgICAgICAgc2VsZjpDYXN0UShzZWxmLnRzcS50YXJnZXQpDQogICAgICBlbmQgICANCiAgICAgIHNlbGYudHNlOnVwZGF0ZSgpDQogICAgICAgaWYoc2VsZi5FU3BlbGw6SXNSZWFkeSgpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmhhcmFzcy5NYW5hIC8xMDAgKSBhbmQgc2VsZi50c2UudGFyZ2V0IH49IG5pbCBhbmQgc2VsZi5Db25maWcuaGFyYXNzLnVzZUUgIGFuZCBWYWxpZFRhcmdldChzZWxmLnRzZS50YXJnZXQsIHNlbGYuRVJhbmdlKSkgdGhlbg0KICAgICAgc2VsZjpDYXN0RShzZWxmLnRzZS50YXJnZXQpDQogIGVuZA0KDQogICAgICBlbmQNCiAgICBlbmQgICANCiANCmZ1bmN0aW9uIFZpa3RvcjpMYW5lQ2xlYXIoKQ0KIGxvY2FsIGNsZWFydGFyZ2V0ID0gbmlsDQogICAgc2VsZi5lbmVteU1pbmlvbnM6dXBkYXRlKCkNCiAgICBzZWxmLm90aGVyTWluaW9uczp1cGRhdGUoKQ0KICAgIHNlbGYuanVuZ2xlTWluaW9uczp1cGRhdGUoKQ0KICAgIGZvciBpLCBtaW5pb24gaW4gaXBhaXJzKHNlbGYuZW5lbXlNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICBpZiBWYWxpZFRhcmdldChtaW5pb24sIDYwMCkgYW5kIChjbGVhcnRhcmdldCA9PSBuaWwgb3Igbm90IFZhbGlkVGFyZ2V0KGNsZWFydGFyZ2V0KSkgdGhlbg0KICAgICAgICBjbGVhcnRhcmdldCA9IG1pbmlvbg0KICAgICAgZW5kDQogICAgZW5kDQogICAgZm9yIGksIGp1bmdsZW1pbmlvbiBpbiBpcGFpcnMoc2VsZi5qdW5nbGVNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICBpZiBWYWxpZFRhcmdldChqdW5nbGVtaW5pb24sIDYwMCkgYW5kIChjbGVhcnRhcmdldCA9PSBuaWwgb3Igbm90IFZhbGlkVGFyZ2V0KGNsZWFydGFyZ2V0KSkgdGhlbg0KICAgICAgICBjbGVhcnRhcmdldCA9IGp1bmdsZW1pbmlvbg0KICAgICAgZW5kDQogICAgZW5kDQogICAgZm9yIGksIG90aGVybWluaW9uIGluIGlwYWlycyhzZWxmLm90aGVyTWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgaWYgVmFsaWRUYXJnZXQob3RoZXJtaW5pb24sIDYwMCkgYW5kIChjbGVhcnRhcmdldCA9PSBuaWwgb3Igbm90IFZhbGlkVGFyZ2V0KGNsZWFydGFyZ2V0KSkgdGhlbg0KICAgICAgICBjbGVhcnRhcmdldCA9IG90aGVybWluaW9uDQogICAgICBlbmQNCiAgICBlbmQNCiAgICBpZiBjbGVhcnRhcmdldCB+PSBuaWwgdGhlbg0KICAgICAgaWYoc2VsZi5RU3BlbGw6SXNSZWFkeSgpIGFuZCBzZWxmLkNvbmZpZy5sYW5lY2xlYXIudXNlUSBhbmQgc2VsZi5Db25maWcubGFuZWNsZWFyLmxhbmVjbGVhcmtleSkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcubGFuZWNsZWFyLk1hbmEgLzEwMCApIHRoZW4NCiAgICAgICAgc2VsZjpDYXN0UShjbGVhcnRhcmdldCkNCiAgICAgIGVuZA0KICAgICBpZiBjbGVhcnRhcmdldCB+PSBuaWwgdGhlbg0KICAgICAgaWYoc2VsZi5FU3BlbGw6SXNSZWFkeSgpIGFuZCBzZWxmLkNvbmZpZy5sYW5lY2xlYXIudXNlRSBhbmQgc2VsZi5Db25maWcubGFuZWNsZWFyLmxhbmVjbGVhcmtleSkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcubGFuZWNsZWFyLk1hbmEgLzEwMCApIHRoZW4NCiAgICAgIGxvY2FsIEJlc3RQb3MsIEJlc3RIaXQgPSBHZXRCZXN0TGluZUZhcm1Qb3NpdGlvbihzZWxmLkVTcGVsbC5SYW5nZSwgc2VsZi5FU3BlbGwuV2lkdGgsIHNlbGYuZW5lbXlNaW5pb25zLm9iamVjdHMgKQ0KICAgICAgaWYgQmVzdFBvcyB+PSBuaWwgYW5kIEJlc3RIaXQgPj0gMSB0aGVuDQogICAgICAgQ2FzdFNwZWxsKF9FLCBCZXN0UG9zLngsIEJlc3RQb3MueikNCiAgICAgIGVuZA0KICAgIGVuZA0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBWaWt0b3I6SnVuZ2xlQ2xlYXIoKQ0KIGxvY2FsIGNsZWFydGFyZ2V0ID0gbmlsDQogICAgc2VsZi5lbmVteU1pbmlvbnM6dXBkYXRlKCkNCiAgICBzZWxmLm90aGVyTWluaW9uczp1cGRhdGUoKQ0KICAgIHNlbGYuanVuZ2xlTWluaW9uczp1cGRhdGUoKQ0KICAgIGZvciBpLCBqdW5nbGVtaW5pb24gaW4gaXBhaXJzKHNlbGYuanVuZ2xlTWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgaWYgVmFsaWRUYXJnZXQoanVuZ2xlbWluaW9uLCA2MDApIGFuZCAoY2xlYXJ0YXJnZXQgPT0gbmlsIG9yIG5vdCBWYWxpZFRhcmdldChjbGVhcnRhcmdldCkpIHRoZW4NCiAgICAgICAgY2xlYXJ0YXJnZXQgPSBqdW5nbGVtaW5pb24NCiAgICAgIGVuZA0KICAgIGVuZA0KICAgIGlmIGNsZWFydGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICBpZihzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyLnVzZVEgYW5kIHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyLmp1bmdsZWNsZWFya2V5KSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgIHNlbGY6Q2FzdFEoY2xlYXJ0YXJnZXQpDQogICAgICBlbmQNCiAgICAgIGlmIGNsZWFydGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICBpZihzZWxmLkVTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyLnVzZUUgYW5kIHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyLmp1bmdsZWNsZWFya2V5KSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgIHNlbGY6Q2FzdEUoY2xlYXJ0YXJnZXQpDQogICAgICBlbmQNCiAgICBlbmQNCiAgZW5kDQogIGVuZA0KZnVuY3Rpb24gaXRlbWZpeCgpDQoNCiAgSXRlbU5hbWVzICAgICAgID0gew0KICAgIFszMzAzXSAgICAgICAgPSAiQXJjaEFuZ2Vsc0R1bW15U3BlbGwiLA0KICAgIFszMDA3XSAgICAgICAgPSAiQXJjaEFuZ2Vsc0R1bW15U3BlbGwiLA0KICAgIFszMTQ0XSAgICAgICAgPSAiQmlsZ2V3YXRlckN1dGxhc3MiLA0KICAgIFszMTg4XSAgICAgICAgPSAiSXRlbUJsYWNrZmlyZVRvcmNoIiwNCiAgICBbMzE1M10gICAgICAgID0gIkl0ZW1Td29yZE9mRmVhc3RBbmRGYW1pbmUiLA0KICAgIFszNDA1XSAgICAgICAgPSAiVHJpbmtldFN3ZWVwZXJMdmwxIiwNCiAgICBbMzQxMV0gICAgICAgID0gIlRyaW5rZXRPcmJMdmwxIiwNCiAgICBbMzE2Nl0gICAgICAgID0gIlRyaW5rZXRUb3RlbUx2bDEiLA0KICAgIFszNDUwXSAgICAgICAgPSAiT2RpblRyaW5rZXRSZXZpdmUiLA0KICAgIFsyMDQxXSAgICAgICAgPSAiSXRlbUNyeXN0YWxGbGFzayIsDQogICAgWzIwNTRdICAgICAgICA9ICJJdGVtS2luZ1Bvcm9TbmFjayIsDQogICAgWzIxMzhdICAgICAgICA9ICJFbGl4aXJPZklyb24iLA0KICAgIFsyMTM3XSAgICAgICAgPSAiRWxpeGlyT2ZSdWluIiwNCiAgICBbMjEzOV0gICAgICAgID0gIkVsaXhpck9mU29yY2VyeSIsDQogICAgWzIxNDBdICAgICAgICA9ICJFbGl4aXJPZldyYXRoIiwNCiAgICBbMzE4NF0gICAgICAgID0gIk9kaW5FbnRyb3BpY0NsYXltb3JlIiwNCiAgICBbMjA1MF0gICAgICAgID0gIkl0ZW1NaW5pV2FyZCIsDQogICAgWzM0MDFdICAgICAgICA9ICJIZWFsdGhCb21iIiwNCiAgICBbMzM2M10gICAgICAgID0gIlRyaW5rZXRPcmJMdmwzIiwNCiAgICBbMzA5Ml0gICAgICAgID0gIkl0ZW1HbGFjaWFsU3Bpa2VDYXN0IiwNCiAgICBbMzQ2MF0gICAgICAgID0gIkFzY1dhcnAiLA0KICAgIFszMzYxXSAgICAgICAgPSAiVHJpbmtldFRvdGVtTHZsMyIsDQogICAgWzMzNjJdICAgICAgICA9ICJUcmlua2V0VG90ZW1Mdmw0IiwNCiAgICBbMzE1OV0gICAgICAgID0gIkhleHRlY2hTd2VlcGVyIiwNCiAgICBbMjA1MV0gICAgICAgID0gIkl0ZW1Ib3JuIiwNCiAgICAtLVsyMDAzXSAgICAgID0gIlJlZ2VuZXJhdGlvblBvdGlvbiIsDQogICAgWzMxNDZdICAgICAgICA9ICJIZXh0ZWNoR3VuYmxhZGUiLA0KICAgIFszMTg3XSAgICAgICAgPSAiSGV4dGVjaFN3ZWVwZXIiLA0KICAgIFszMTkwXSAgICAgICAgPSAiSXJvblN0eWx1cyIsDQogICAgWzIwMDRdICAgICAgICA9ICJGbGFza09mQ3J5c3RhbFdhdGVyIiwNCiAgICBbMzEzOV0gICAgICAgID0gIkl0ZW1NZXJjdXJpYWwiLA0KICAgIFszMjIyXSAgICAgICAgPSAiSXRlbU1vcmVsbG9zQmFuZSIsDQogICAgWzMwNDJdICAgICAgICA9ICJNdXJhbWFuYSIsDQogICAgWzMwNDNdICAgICAgICA9ICJNdXJhbWFuYSIsDQogICAgWzMxODBdICAgICAgICA9ICJPZHluc1ZlaWwiLA0KICAgIFszMDU2XSAgICAgICAgPSAiSXRlbUZhaXRoU2hha2VyIiwNCiAgICBbMjA0N10gICAgICAgID0gIk9yYWNsZUV4dHJhY3RTaWdodCIsDQogICAgWzMzNjRdICAgICAgICA9ICJUcmlua2V0U3dlZXBlckx2bDMiLA0KICAgIFsyMDUyXSAgICAgICAgPSAiSXRlbVBvcm9TbmFjayIsDQogICAgWzMxNDBdICAgICAgICA9ICJRdWlja3NpbHZlclNhc2giLA0KICAgIFszMTQzXSAgICAgICAgPSAiUmFuZHVpbnNPbWVuIiwNCiAgICBbMzA3NF0gICAgICAgID0gIkl0ZW1UaWFtYXRDbGVhdmUiLA0KICAgIFszODAwXSAgICAgICAgPSAiSXRlbVJpZ2h0ZW91c0dsb3J5IiwNCiAgICBbMjA0NV0gICAgICAgID0gIkl0ZW1HaG9zdFdhcmQiLA0KICAgIFszMzQyXSAgICAgICAgPSAiVHJpbmtldE9yYkx2bDEiLA0KICAgIFszMDQwXSAgICAgICAgPSAiSXRlbVNlcmFwaHNFbWJyYWNlIiwNCiAgICBbMzA0OF0gICAgICAgID0gIkl0ZW1TZXJhcGhzRW1icmFjZSIsDQogICAgWzIwNDldICAgICAgICA9ICJJdGVtR2hvc3RXYXJkIiwNCiAgICBbMzM0NV0gICAgICAgID0gIk9kaW5Ucmlua2V0UmV2aXZlIiwNCiAgICBbMjA0NF0gICAgICAgID0gIlNpZ2h0V2FyZCIsDQogICAgWzMzNDFdICAgICAgICA9ICJUcmlua2V0U3dlZXBlckx2bDEiLA0KICAgIFszMDY5XSAgICAgICAgPSAic2h1cmVseWFzY3Jlc3QiLA0KICAgIFszNTk5XSAgICAgICAgPSAiS2FsaXN0YVBTcGVsbENhc3QiLA0KICAgIFszMTg1XSAgICAgICAgPSAiSGV4dGVjaFN3ZWVwZXIiLA0KICAgIFszMDc3XSAgICAgICAgPSAiSXRlbVRpYW1hdENsZWF2ZSIsDQogICAgWzIwMDldICAgICAgICA9ICJJdGVtTWluaVJlZ2VuUG90aW9uIiwNCiAgICBbMjAxMF0gICAgICAgID0gIkl0ZW1NaW5pUmVnZW5Qb3Rpb24iLA0KICAgIFszMDIzXSAgICAgICAgPSAiSXRlbVdyYWl0aENvbGxhciIsDQogICAgWzMyOTBdICAgICAgICA9ICJJdGVtV3JhaXRoQ29sbGFyIiwNCiAgICBbMjA0M10gICAgICAgID0gIlZpc2lvbldhcmQiLA0KICAgIFszMzQwXSAgICAgICAgPSAiVHJpbmtldFRvdGVtTHZsMSIsDQogICAgWzMwOTBdICAgICAgICA9ICJaaG9ueWFzSG91cmdsYXNzIiwNCiAgICBbMzE1NF0gICAgICAgID0gIndyaWdnbGVsYW50ZXJuIiwNCiAgICBbMzE0Ml0gICAgICAgID0gIllvdW11c0JsYWRlIiwNCiAgICBbMzE1N10gICAgICAgID0gIlpob255YXNIb3VyZ2xhc3MiLA0KICAgIFszNTEyXSAgICAgICAgPSAiSXRlbVZvaWRHYXRlIiwNCiAgICBbMzEzMV0gICAgICAgID0gIkl0ZW1Tb1REIiwNCiAgICBbMzEzN10gICAgICAgID0gIkl0ZW1EZXJ2aXNoQmxhZGUiLA0KICAgIFszMzUyXSAgICAgICAgPSAiUmVsaWNTcG90dGVyIiwNCiAgICBbMzM1MF0gICAgICAgID0gIlRyaW5rZXRUb3RlbUx2bDIiLA0KICB9DQogIA0KICBfRy5JVEVNXzEgICAgICAgPSAwNg0KICBfRy5JVEVNXzIgICAgICAgPSAwNw0KICBfRy5JVEVNXzMgICAgICAgPSAwOA0KICBfRy5JVEVNXzQgICAgICAgPSAwOQ0KICBfRy5JVEVNXzUgICAgICAgPSAxMA0KICBfRy5JVEVNXzYgICAgICAgPSAxMQ0KICBfRy5JVEVNXzcgICAgICAgPSAxMg0KICANCiAgX19fR2V0SW52ZW50b3J5U2xvdEl0ZW0gPSByYXdnZXQoX0csICJHZXRJbnZlbnRvcnlTbG90SXRlbSIpDQogIF9HLkdldEludmVudG9yeVNsb3RJdGVtID0gR2V0U2xvdEl0ZW0NCiAgDQogIA0KZW5kDQpfRy5MZXZlbFNwZWxsID0gZnVuY3Rpb24oaWQpDQogbG9jYWwgb2Zmc2V0cyA9IHsNCiAgW19RXSA9IDB4ODUsDQogIFtfV10gPSAweDQ1LA0KICBbX0VdID0gMHgxNSwNCiAgW19SXSA9IDB4QzUsDQogfQ0KIGxvY2FsIHANCiBwID0gQ0xvTFBhY2tldCgweDEzMCkNCiBwLnZUYWJsZSA9IDB4RURCMzYwDQogcDpFbmNvZGVGKG15SGVyby5uZXR3b3JrSUQpDQogZm9yIGkgPSAxLCA0IGRvIHA6RW5jb2RlMSgweDU1KSBlbmQNCiBmb3IgaSA9IDEsIDQgZG8gcDpFbmNvZGUxKDB4NzQpIGVuZA0KIHA6RW5jb2RlMShvZmZzZXRzW2lkXSkNCiBwOkVuY29kZTEoMHhCMykNCiBmb3IgaSA9IDEsIDQgZG8gcDpFbmNvZGUxKDB4NEYpIGVuZA0KIHA6RW5jb2RlMSgweDAxKQ0KIGZvciBpID0gMSwgMyBkbyBwOkVuY29kZTEoMHgwMCkgZW5kDQogU2VuZFBhY2tldChwKQ0KZW5kDQpmdW5jdGlvbiBDaXJjbGVJbnRlcnNlY3Rpb24odjEsIHYyLCBjLCByYWRpdXMpDQogIGFzc2VydChWZWN0b3JUeXBlKHYxKSBhbmQgVmVjdG9yVHlwZSh2MikgYW5kIFZlY3RvclR5cGUoYykgYW5kIHR5cGUocmFkaXVzKSA9PSAibnVtYmVyIiwgIkNpcmNsZUludGVyc2VjdGlvbjogd3JvbmcgYXJndW1lbnQgdHlwZXMgKDxWZWN0b3I+LCA8VmVjdG9yPiwgPFZlY3Rvcj4sIGludGVnZXIgZXhwZWN0ZWQpIikNCiAgDQogIGxvY2FsIHgxLCB5MSwgeDIsIHkyLCB4MywgeTMgPSB2MS54LCB2MS56IG9yIHYxLnksIHYyLngsIHYyLnogb3IgdjIueSwgYy54LCBjLnogb3IgYy55DQogIGxvY2FsIHIgPSByYWRpdXMNCiAgbG9jYWwgeHAsIHlwLCB4bSwgeW0gPSBuaWwsIG5pbCwgbmlsLCBuaWwNCiAgbG9jYWwgSXNPblNlZ21lbnQgPSBuaWwNCiAgDQogIGlmIHgxID09IHgyIHRoZW4NCiAgDQogICAgbG9jYWwgQiA9IG1hdGguc3FydChyXjItKHgxLXgzKV4yKQ0KICAgIA0KICAgIHhwLCB5cCwgeG0sIHltID0geDEsIHkzK0IsIHgxLCB5My1CDQogIGVsc2UNCiAgDQogICAgbG9jYWwgbSA9ICh5Mi15MSkvKHgyLXgxKQ0KICAgIGxvY2FsIG4gPSB5MS1tKngxDQogICAgbG9jYWwgQSA9IHgzLW0qKG4teTMpDQogICAgbG9jYWwgQiA9IG1hdGguc3FydChBXjItKDErbV4yKSooeDNeMi1yXjIrKG4teTMpXjIpKQ0KICAgIA0KICAgIHhwLCB4bSA9IChBK0IpLygxK21eMiksIChBLUIpLygxK21eMikNCiAgICB5cCwgeW0gPSBtKnhwK24sIG0qeG0rbg0KICBlbmQNCiAgDQogIGlmIHgxIDw9IHgyIHRoZW4NCiAgICBJc09uU2VnbWVudCA9IHgxIDw9IHhwIGFuZCB4cCA8PSB4Mg0KICBlbHNlDQogICAgSXNPblNlZ21lbnQgPSB4MiA8PSB4cCBhbmQgeHAgPD0geDEgICAgICAgIA0KICBlbmQNCiAgICBpZiBJc09uU2VnbWVudCB0aGVuDQogICAgcmV0dXJuIFZlY3Rvcih4cCwgMCwgeXApDQogIGVsc2UNCiAgICByZXR1cm4gVmVjdG9yKHhtLCAwLCB5bSkNCiAgZW5kDQogIA0KZW5kDQpmdW5jdGlvbiBHZXRCZXN0TGluZUZhcm1Qb3NpdGlvbihyYW5nZSwgd2lkdGgsIG9iamVjdHMpDQogICAgbG9jYWwgQmVzdFBvcyANCiAgICBsb2NhbCBCZXN0SGl0ID0gMA0KICAgIGZvciBpLCBvYmplY3QgaW4gaXBhaXJzKG9iamVjdHMpIGRvDQogICAgICAgIGxvY2FsIEVuZFBvcyA9IFZlY3RvcihteUhlcm8ucG9zKSArIHJhbmdlICogKFZlY3RvcihvYmplY3QpIC0gVmVjdG9yKG15SGVyby5wb3MpKTpub3JtYWxpemVkKCkNCiAgICAgICAgbG9jYWwgaGl0ID0gQ291bnRPYmplY3RzT25MaW5lU2VnbWVudChteUhlcm8ucG9zLCBFbmRQb3MsIHdpZHRoLCBvYmplY3RzKQ0KICAgICAgICBpZiBoaXQgPiBCZXN0SGl0IHRoZW4NCiAgICAgICAgICAgIEJlc3RIaXQgPSBoaXQNCiAgICAgICAgICAgIEJlc3RQb3MgPSBWZWN0b3Iob2JqZWN0KQ0KICAgICAgICAgICAgaWYgQmVzdEhpdCA9PSAjb2JqZWN0cyB0aGVuDQogICAgICAgICAgICAgICBicmVhaw0KICAgICAgICAgICAgZW5kDQogICAgICAgICBlbmQNCiAgICBlbmQNCg0KICAgIHJldHVybiBCZXN0UG9zLCBCZXN0SGl0DQplbmQNCg0KZnVuY3Rpb24gQ291bnRPYmplY3RzT25MaW5lU2VnbWVudChTdGFydFBvcywgRW5kUG9zLCB3aWR0aCwgb2JqZWN0cykNCiAgICBsb2NhbCBuID0gMA0KICAgIGZvciBpLCBvYmplY3QgaW4gaXBhaXJzKG9iamVjdHMpIGRvDQogICAgICAgIGxvY2FsIHBvaW50U2VnbWVudCwgcG9pbnRMaW5lLCBpc09uU2VnbWVudCA9IFZlY3RvclBvaW50UHJvamVjdGlvbk9uTGluZVNlZ21lbnQoU3RhcnRQb3MsIEVuZFBvcywgb2JqZWN0KQ0KICAgICAgICBpZiBpc09uU2VnbWVudCBhbmQgR2V0RGlzdGFuY2VTcXIocG9pbnRTZWdtZW50LCBvYmplY3QpIDwgd2lkdGggKiB3aWR0aCB0aGVuDQogICAgICAgICAgICBuID0gbiArIDENCiAgICAgICAgZW5kDQogICAgZW5kDQoNCiAgICByZXR1cm4gbg0KZW5kDQpmdW5jdGlvbiBDb3VudE9iamVjdHNOZWFyUG9zKHBvcywgcmFuZ2UsIHJhZGl1cywgb2JqZWN0cykNCiAgICBsb2NhbCBuID0gMA0KICAgIGZvciBpLCBvYmplY3QgaW4gaXBhaXJzKG9iamVjdHMpIGRvDQogICAgICAgIGlmIEdldERpc3RhbmNlU3FyKHBvcywgb2JqZWN0KSA8PSByYWRpdXMgKiByYWRpdXMgdGhlbg0KICAgICAgICAgICAgbiA9IG4gKyAxDQogICAgICAgIGVuZA0KICAgIGVuZA0KICAgIHJldHVybiBuDQplbmQNCmZ1bmN0aW9uIEdldEJlc3RDaXJjdWxhckZhcm1Qb3NpdGlvbihyYW5nZSwgcmFkaXVzLCBvYmplY3RzKQ0KICAgIGxvY2FsIEJlc3RQb3MgDQogICAgbG9jYWwgQmVzdEhpdCA9IDANCiAgICBmb3IgaSwgb2JqZWN0IGluIGlwYWlycyhvYmplY3RzKSBkbw0KICAgICAgICBsb2NhbCBoaXQgPSBDb3VudE9iamVjdHNOZWFyUG9zKG9iamVjdC5wb3Mgb3Igb2JqZWN0LCByYW5nZSwgcmFkaXVzLCBvYmplY3RzKQ0KICAgICAgICBpZiBoaXQgPiBCZXN0SGl0IHRoZW4NCiAgICAgICAgICAgIEJlc3RIaXQgPSBoaXQNCiAgICAgICAgICAgIEJlc3RQb3MgPSBWZWN0b3Iob2JqZWN0KQ0KICAgICAgICAgICAgaWYgQmVzdEhpdCA9PSAjb2JqZWN0cyB0aGVuDQogICAgICAgICAgICAgICBicmVhaw0KICAgICAgICAgICAgZW5kDQogICAgICAgICBlbmQNCiAgICBlbmQNCiAgICByZXR1cm4gQmVzdFBvcywgQmVzdEhpdA0KZW5kDQpmdW5jdGlvbiBSZXF1aXJlU2ltcGxlTGliKCkNCiAgICBpZiBGaWxlRXhpc3QoTElCX1BBVEguLiJTaW1wbGVMaWIubHVhIikgYW5kIG5vdCBGaWxlRXhpc3QoU0NSSVBUX1BBVEguLiJTaW1wbGVMaWIubHVhIikgdGhlbg0KICAgICAgICByZXF1aXJlICJTaW1wbGVMaWIiDQogICAgICAgIGlmIF9HLlNpbXBsZUxpYlZlcnNpb24gPT0gbmlsIHRoZW4gDQogICAgICAgICAgICBwcmludCgiWW91ciBTaW1wbGVMaWIgZmlsZSBpcyB3cm9uZy4iKQ0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgICAgIGVuZA0KICAgICAgICBpZiBfRy5TaW1wbGVMaWJWZXJzaW9uIDwgMS4wMiB0aGVuDQogICAgICAgICAgICBwcmludCgiWW91IG5lZWQgdGhlIGxhc3Rlc3QgdmVyc2lvbiBvZiBTaW1wbGVMaWIuIikNCiAgICAgICAgICAgIHJldHVybiBmYWxzZQ0KICAgICAgICBlbmQNCiAgICAgICAgcmV0dXJuIHRydWUNCiAgICBlbHNlaWYgRmlsZUV4aXN0KExJQl9QQVRILi4iU2ltcGxlTGliLmx1YSIpIGFuZCBGaWxlRXhpc3QoU0NSSVBUX1BBVEguLiJTaW1wbGVMaWIubHVhIikgdGhlbg0KICAgICAgICBwcmludCgiU2ltcGxlTGliLmx1YSBzaG91bGQgbm90IGJlIGluIEN1c3RvbSBTY3JpcHQgKE9ubHkgb24gQ29tbW9uIGZvbGRlciksIGRlbGV0ZSBpdCBmcm9tIHRoZXJlLi4uIikNCiAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgZWxzZQ0KICAgICAgICBsb2NhbCBmdW5jdGlvbiBCYXNlNjRFbmNvZGUyKGRhdGEpDQogICAgICAgICAgICBsb2NhbCBiPSdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvJw0KICAgICAgICAgICAgcmV0dXJuICgoZGF0YTpnc3ViKCcuJywgZnVuY3Rpb24oeCkNCiAgICAgICAgICAgICAgICBsb2NhbCByLGI9JycseDpieXRlKCkNCiAgICAgICAgICAgICAgICBmb3IgaT04LDEsLTEgZG8gcj1yLi4oYiUyXmktYiUyXihpLTEpPjAgYW5kICcxJyBvciAnMCcpIGVuZA0KICAgICAgICAgICAgICAgIHJldHVybiByOw0KICAgICAgICAgICAgZW5kKS4uJzAwMDAnKTpnc3ViKCclZCVkJWQ/JWQ/JWQ/JWQ/JywgZnVuY3Rpb24oeCkNCiAgICAgICAgICAgICAgICBpZiAoI3ggPCA2KSB0aGVuIHJldHVybiAnJyBlbmQNCiAgICAgICAgICAgICAgICBsb2NhbCBjPTANCiAgICAgICAgICAgICAgICBmb3IgaT0xLDYgZG8gYz1jKyh4OnN1YihpLGkpPT0nMScgYW5kIDJeKDYtaSkgb3IgMCkgZW5kDQogICAgICAgICAgICAgICAgcmV0dXJuIGI6c3ViKGMrMSxjKzEpDQogICAgICAgICAgICBlbmQpLi4oeyAnJywgJz09JywgJz0nIH0pWyNkYXRhJTMrMV0pDQogICAgICAgIGVuZA0KICAgICAgICBsb2NhbCBTYXZlUGF0aCA9IExJQl9QQVRILi4iU2ltcGxlTGliLmx1YSINCiAgICAgICAgbG9jYWwgU2NyaXB0UGF0aCA9ICcvQm9ML1RDUFVwZGF0ZXIvR2V0U2NyaXB0NS5waHA/c2NyaXB0PScuLkJhc2U2NEVuY29kZTIoInJhdy5naXRodWJ1c2VyY29udGVudC5jb20vamFjaGljYW8vQm9ML21hc3Rlci9TaW1wbGVMaWIubHVhIikuLicmcmFuZD0nLi5tYXRoLnJhbmRvbSg5OTk5OTk5OSkNCiAgICAgICAgbG9jYWwgR290U2NyaXB0ID0gZmFsc2UNCiAgICAgICAgbG9jYWwgTHVhU29ja2V0ID0gbmlsDQogICAgICAgIGxvY2FsIFNvY2tldCA9IG5pbA0KICAgICAgICBsb2NhbCBTaXplID0gbmlsDQogICAgICAgIGxvY2FsIFJlY3ZTdGFydGVkID0gZmFsc2UNCiAgICAgICAgbG9jYWwgUmVjZWl2ZSwgU3RhdHVzLCBTbmlwcGVkID0gbmlsLCBuaWwsIG5pbA0KICAgICAgICBsb2NhbCBTdGFydGVkID0gZmFsc2UNCiAgICAgICAgbG9jYWwgRmlsZSA9ICIiDQogICAgICAgIGxvY2FsIE5ld0ZpbGUgPSAiIg0KICAgICAgICBpZiBub3QgTHVhU29ja2V0IHRoZW4NCiAgICAgICAgICAgIEx1YVNvY2tldCA9IHJlcXVpcmUoInNvY2tldCIpDQogICAgICAgIGVsc2UNCiAgICAgICAgICAgIFNvY2tldDpjbG9zZSgpDQogICAgICAgICAgICBTb2NrZXQgPSBuaWwNCiAgICAgICAgICAgIFNpemUgPSBuaWwNCiAgICAgICAgICAgIFJlY3ZTdGFydGVkID0gZmFsc2UNCiAgICAgICAgZW5kDQogICAgICAgIFNvY2tldCA9IEx1YVNvY2tldC50Y3AoKQ0KICAgICAgICBpZiBub3QgU29ja2V0IHRoZW4NCiAgICAgICAgICAgIHByaW50KCdTb2NrZXQgRXJyb3InKQ0KICAgICAgICBlbHNlDQogICAgICAgICAgICBTb2NrZXQ6c2V0dGltZW91dCgwLCAnYicpDQogICAgICAgICAgICBTb2NrZXQ6c2V0dGltZW91dCg5OTk5OTk5OSwgJ3QnKQ0KICAgICAgICAgICAgU29ja2V0OmNvbm5lY3QoJ3N4LWJvbC5ldScsIDgwKQ0KICAgICAgICAgICAgU3RhcnRlZCA9IGZhbHNlDQogICAgICAgICAgICBGaWxlID0gIiINCiAgICAgICAgZW5kDQogICAgICAgIEFkZFRpY2tDYWxsYmFjayhmdW5jdGlvbigpDQogICAgICAgICAgICBpZiBHb3RTY3JpcHQgdGhlbiByZXR1cm4gZW5kDQogICAgICAgICAgICBSZWNlaXZlLCBTdGF0dXMsIFNuaXBwZWQgPSBTb2NrZXQ6cmVjZWl2ZSgxMDI0KQ0KICAgICAgICAgICAgaWYgU3RhdHVzID09ICd0aW1lb3V0JyBhbmQgbm90IFN0YXJ0ZWQgdGhlbg0KICAgICAgICAgICAgICAgIFN0YXJ0ZWQgPSB0cnVlDQogICAgICAgICAgICAgICAgcHJpbnQoIkRvd25sb2FkaW5nIGEgbGlicmFyeSBjYWxsZWQgU2ltcGxlTGliLiBQbGVhc2Ugd2FpdC4uLiIpDQogICAgICAgICAgICAgICAgU29ja2V0OnNlbmQoIkdFVCAiLi5TY3JpcHRQYXRoLi4iIEhUVFAvMS4xXHJcbkhvc3Q6IHN4LWJvbC5ldVxyXG5cclxuIikNCiAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgaWYgKFJlY2VpdmUgb3IgKCNTbmlwcGVkID4gMCkpIGFuZCBub3QgUmVjdlN0YXJ0ZWQgdGhlbg0KICAgICAgICAgICAgICAgIFJlY3ZTdGFydGVkID0gdHJ1ZQ0KICAgICAgICAgICAgZW5kDQoNCiAgICAgICAgICAgIEZpbGUgPSBGaWxlIC4uIChSZWNlaXZlIG9yIFNuaXBwZWQpDQogICAgICAgICAgICBpZiBGaWxlOmZpbmQoJzwvc2knLi4nemU+JykgdGhlbg0KICAgICAgICAgICAgICAgIGlmIG5vdCBTaXplIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgU2l6ZSA9IHRvbnVtYmVyKEZpbGU6c3ViKEZpbGU6ZmluZCgnPHNpJy4uJ3plPicpICsgNiwgRmlsZTpmaW5kKCc8L3NpJy4uJ3plPicpIC0gMSkpDQogICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgaWYgRmlsZTpmaW5kKCc8c2NyJy4uJ2lwdD4nKSB0aGVuDQogICAgICAgICAgICAgICAgICAgIGxvY2FsIF8sIFNjcmlwdEZpbmQgPSBGaWxlOmZpbmQoJzxzY3InLi4naXB0PicpDQogICAgICAgICAgICAgICAgICAgIGxvY2FsIFNjcmlwdEVuZCA9IEZpbGU6ZmluZCgnPC9zY3InLi4naXB0PicpDQogICAgICAgICAgICAgICAgICAgIGlmIFNjcmlwdEVuZCB0aGVuIFNjcmlwdEVuZCA9IFNjcmlwdEVuZCAtIDEgZW5kDQogICAgICAgICAgICAgICAgICAgIGxvY2FsIERvd25sb2FkZWRTaXplID0gRmlsZTpzdWIoU2NyaXB0RmluZCArIDEsU2NyaXB0RW5kIG9yIC0xKTpsZW4oKQ0KICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgZW5kDQogICAgICAgICAgICBpZiBGaWxlOmZpbmQoJzwvc2NyJy4uJ2lwdD4nKSB0aGVuDQogICAgICAgICAgICAgICAgbG9jYWwgYSxiID0gRmlsZTpmaW5kKCdcclxuXHJcbicpDQogICAgICAgICAgICAgICAgRmlsZSA9IEZpbGU6c3ViKGEsLTEpDQogICAgICAgICAgICAgICAgTmV3RmlsZSA9ICcnDQogICAgICAgICAgICAgICAgZm9yIGxpbmUsY29udGVudCBpbiBpcGFpcnMoRmlsZTpzcGxpdCgnXG4nKSkgZG8NCiAgICAgICAgICAgICAgICAgICAgaWYgY29udGVudDpsZW4oKSA+IDUgdGhlbg0KICAgICAgICAgICAgICAgICAgICAgICAgTmV3RmlsZSA9IE5ld0ZpbGUgLi4gY29udGVudA0KICAgICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICBsb2NhbCBIZWFkZXJFbmQsIENvbnRlbnRTdGFydCA9IE5ld0ZpbGU6ZmluZCgnPHNjJy4uJ3JpcHQ+JykNCiAgICAgICAgICAgICAgICBsb2NhbCBDb250ZW50RW5kLCBfID0gTmV3RmlsZTpmaW5kKCc8L3NjcicuLidpcHQ+JykNCiAgICAgICAgICAgICAgICBpZiBub3QgQ29udGVudFN0YXJ0IG9yIG5vdCBDb250ZW50RW5kIHRoZW4NCiAgICAgICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgICAgIGxvY2FsIG5ld2YgPSBOZXdGaWxlOnN1YihDb250ZW50U3RhcnQgKyAxLENvbnRlbnRFbmQgLSAxKQ0KICAgICAgICAgICAgICAgICAgICBsb2NhbCBuZXdmID0gbmV3Zjpnc3ViKCdccicsJycpDQogICAgICAgICAgICAgICAgICAgIGlmIG5ld2Y6bGVuKCkgfj0gU2l6ZSB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4NCiAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgICAgIGxvY2FsIG5ld2YgPSBCYXNlNjREZWNvZGUobmV3ZikNCiAgICAgICAgICAgICAgICAgICAgaWYgdHlwZShsb2FkKG5ld2YpKSB+PSAnZnVuY3Rpb24nIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgZiA9IGlvLm9wZW4oU2F2ZVBhdGgsICJ3K2IiKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZjp3cml0ZShuZXdmKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZjpjbG9zZSgpDQogICAgICAgICAgICAgICAgICAgICAgICBwcmludCgiUmVxdWlyZWQgbGlicmFyeSBkb3dubG9hZGVkLiBQbGVhc2UgcmVsb2FkIHdpdGggMnggRjkuIikNCiAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgR290U2NyaXB0ID0gdHJ1ZQ0KICAgICAgICAgICAgZW5kDQogICAgICAgIGVuZCkNCiAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgZW5kDQplbmQNCg0KLS0gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLW9yYiB3YWxrIHNldHRpbmdzIHN0YXJ0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoNCmZ1bmN0aW9uIFZpa3RvcjpmaW5kb3Jid2Fsa2VyKCkNCiBpZiBfRy5SZWJvcm5fTG9hZGVkIHRoZW4NCiAgICBTQUM9dHJ1ZSBhbmQNCiAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+U2lkYXMgQXV0byBDYXJyeSBoYXMgYmVlbiBmb3VuZCIpIGVuZCwgMikNCiAgICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBwcmludCgiPGZvbnQgY29sb3I9XCIjRkYwMDAwXCI+PGI+ICIuLlNjcmlwdG5hbWUuLiIgLSA8L2I+PC9mb250Pjxmb250IGNvbG9yPVwiI0ZGRkZGRlwiPlNpZGFzIEF1dG8gQ2FycnkgaW50ZWdyYXRpb24gaGFzIGJlZW4gZmluaXNoZWQgc3VjY2VzZnVsbHkiKSBlbmQsIDgpDQogIGVsc2VpZiBub3QgX0cuUmVib3JuX0xvYWRlZCBhbmQgRmlsZUV4aXN0KExJQl9QQVRIIC4uICJTeE9yYldhbGsubHVhIikgdGhlbg0KICAgIFN4T3JiPXRydWUgYW5kIA0KICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+IFN4T3JiV2FsayBoYXMgYmVlbiBmb3VuZCIpIGVuZCwgMikNCiAgICAgICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+IFN4T3JiV2FsayBpbnRlZ3JhdGlvbiBoYXMgYmVlbiBmaW5pc2hlZCBzdWNjZXNmdWxseSIpIGVuZCwgNCkNCiAgICByZXF1aXJlKCJTeE9yYldhbGsiKQ0KICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIlN4T3JiV2FsayIsIm9yYldhbGsiKSBlbmQsNSkNCiAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIF9HLlN4T3JiOkxvYWRUb01lbnUoc2VsZi5Db25maWcub3JiV2FsaykgZW5kLDUpDQogIGVsc2VpZiBTQUN+PXRydWUgYW5kIFN4T3Jifj0gdHJ1ZSB0aGVuDQogICAgcCgiPT09PT09PT09PT09PT09PT0iKQ0KICAgIHAoIj09PT09PT09PT09PT09PT09IikNCiAgICBwKCJTeE9yYiBvciBTQUM6UiBpcyByZXF1aXJlZC4iKQ0KICAgIHAoIj09PT09PT09PT09PT09PT09IikNCiAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogIGVuZA0KZW5kDQpmdW5jdGlvbiBMaXNzYW5kcmE6ZmluZG9yYndhbGtlcigpDQogaWYgX0cuUmVib3JuX0xvYWRlZCB0aGVuDQogICAgU0FDPXRydWUgYW5kDQogICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBwcmludCgiPGZvbnQgY29sb3I9XCIjRkYwMDAwXCI+PGI+ICIuLlNjcmlwdG5hbWUuLiIgLSA8L2I+PC9mb250Pjxmb250IGNvbG9yPVwiI0ZGRkZGRlwiPlNpZGFzIEF1dG8gQ2FycnkgaGFzIGJlZW4gZm91bmQiKSBlbmQsIDIpDQogICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj5TaWRhcyBBdXRvIENhcnJ5IGludGVncmF0aW9uIGhhcyBiZWVuIGZpbmlzaGVkIHN1Y2Nlc2Z1bGx5IikgZW5kLCA4KQ0KICBlbHNlaWYgbm90IF9HLlJlYm9ybl9Mb2FkZWQgYW5kIEZpbGVFeGlzdChMSUJfUEFUSCAuLiAiU3hPcmJXYWxrLmx1YSIpIHRoZW4NCiAgICBTeE9yYj10cnVlIGFuZCANCiAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBwcmludCgiPGZvbnQgY29sb3I9XCIjRkYwMDAwXCI+PGI+ICIuLlNjcmlwdG5hbWUuLiIgLSA8L2I+PC9mb250Pjxmb250IGNvbG9yPVwiI0ZGRkZGRlwiPiBTeE9yYldhbGsgaGFzIGJlZW4gZm91bmQiKSBlbmQsIDIpDQogICAgICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBwcmludCgiPGZvbnQgY29sb3I9XCIjRkYwMDAwXCI+PGI+ICIuLlNjcmlwdG5hbWUuLiIgLSA8L2I+PC9mb250Pjxmb250IGNvbG9yPVwiI0ZGRkZGRlwiPiBTeE9yYldhbGsgaW50ZWdyYXRpb24gaGFzIGJlZW4gZmluaXNoZWQgc3VjY2VzZnVsbHkiKSBlbmQsIDQpDQogICAgcmVxdWlyZSgiU3hPcmJXYWxrIikNCiAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJTeE9yYldhbGsiLCJvcmJXYWxrIikgZW5kLDUpDQogICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBfRy5TeE9yYjpMb2FkVG9NZW51KHNlbGYuQ29uZmlnLm9yYldhbGspIGVuZCw1KQ0KICBlbHNlaWYgU0FDfj10cnVlIGFuZCBTeE9yYn49IHRydWUgdGhlbg0KICAgIHAoIj09PT09PT09PT09PT09PT09IikNCiAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgcCgiU3hPcmIgb3IgU0FDOlIgaXMgcmVxdWlyZWQuIikNCiAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgcCgiPT09PT09PT09PT09PT09PT0iKQ0KICBlbmQNCmVuZA0KZnVuY3Rpb24gTGVibGFuYzpmaW5kb3Jid2Fsa2VyKCkNCiBpZiBfRy5SZWJvcm5fTG9hZGVkIHRoZW4NCiAgICBTQUM9dHJ1ZSBhbmQNCiAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+U2lkYXMgQXV0byBDYXJyeSBoYXMgYmVlbiBmb3VuZCIpIGVuZCwgMikNCiAgICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBwcmludCgiPGZvbnQgY29sb3I9XCIjRkYwMDAwXCI+PGI+ICIuLlNjcmlwdG5hbWUuLiIgLSA8L2I+PC9mb250Pjxmb250IGNvbG9yPVwiI0ZGRkZGRlwiPlNpZGFzIEF1dG8gQ2FycnkgaW50ZWdyYXRpb24gaGFzIGJlZW4gZmluaXNoZWQgc3VjY2VzZnVsbHkiKSBlbmQsIDgpDQogIGVsc2VpZiBub3QgX0cuUmVib3JuX0xvYWRlZCBhbmQgRmlsZUV4aXN0KExJQl9QQVRIIC4uICJTeE9yYldhbGsubHVhIikgdGhlbg0KICAgIFN4T3JiPXRydWUgYW5kIA0KICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+IFN4T3JiV2FsayBoYXMgYmVlbiBmb3VuZCIpIGVuZCwgMikNCiAgICAgICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+IFN4T3JiV2FsayBpbnRlZ3JhdGlvbiBoYXMgYmVlbiBmaW5pc2hlZCBzdWNjZXNmdWxseSIpIGVuZCwgNCkNCiAgICByZXF1aXJlKCJTeE9yYldhbGsiKQ0KICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIlN4T3JiV2FsayIsIm9yYldhbGsiKSBlbmQsNSkNCiAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIF9HLlN4T3JiOkxvYWRUb01lbnUoc2VsZi5Db25maWcub3JiV2FsaykgZW5kLDUpDQogIGVsc2VpZiBTQUN+PXRydWUgYW5kIFN4T3Jifj0gdHJ1ZSB0aGVuDQogICAgcCgiPT09PT09PT09PT09PT09PT0iKQ0KICAgIHAoIj09PT09PT09PT09PT09PT09IikNCiAgICBwKCJTeE9yYiBvciBTQUM6UiBpcyByZXF1aXJlZC4iKQ0KICAgIHAoIj09PT09PT09PT09PT09PT09IikNCiAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogIGVuZA0KZW5kDQotLSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tb3JiIHdhbGsgc2V0dGluZ3Mgc3RhcnQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiBmdW5jdGlvbiBEcmF3ZG1nbGliKCkNCiAgaWYoRmlsZUV4aXN0KExJQl9QQVRILi4iRHJhd0RhbWFnZUxpYi5sdWEiKSl0aGVuDQogICAgY2hlY2s9MQ0KICBlbHNlDQogICAgY2hlY2s9MA0KICBlbmQgDQogICBpZiBfUmVxdWlyZWQoKTpBZGQoe05hbWUgPSAiRHJhd0RhbWFnZUxpYiIsIFVybCA9ICJyYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2lubmVyb3V0L0JvdE9mTGVnZW5kcy9tYXN0ZXIvRHJhd0RhbWFnZUxpYi5sdWEifSk6Q2hlY2soKTpJc0Rvd25sb2FkaW5nKCkgdGhlbiByZXR1cm4gZW5kIA0KZW5kDQpmdW5jdGlvbiBDaXJjbGVJbnRlcnNlY3Rpb24odjEsIHYyLCBjLCByYWRpdXMpDQogIGFzc2VydChWZWN0b3JUeXBlKHYxKSBhbmQgVmVjdG9yVHlwZSh2MikgYW5kIFZlY3RvclR5cGUoYykgYW5kIHR5cGUocmFkaXVzKSA9PSAibnVtYmVyIiwgIkNpcmNsZUludGVyc2VjdGlvbjogd3JvbmcgYXJndW1lbnQgdHlwZXMgKDxWZWN0b3I+LCA8VmVjdG9yPiwgPFZlY3Rvcj4sIGludGVnZXIgZXhwZWN0ZWQpIikNCiAgDQogIGxvY2FsIHgxLCB5MSwgeDIsIHkyLCB4MywgeTMgPSB2MS54LCB2MS56IG9yIHYxLnksIHYyLngsIHYyLnogb3IgdjIueSwgYy54LCBjLnogb3IgYy55DQogIGxvY2FsIHIgPSByYWRpdXMNCiAgbG9jYWwgeHAsIHlwLCB4bSwgeW0gPSBuaWwsIG5pbCwgbmlsLCBuaWwNCiAgbG9jYWwgSXNPblNlZ21lbnQgPSBuaWwNCiAgDQogIGlmIHgxID09IHgyIHRoZW4NCiAgDQogICAgbG9jYWwgQiA9IG1hdGguc3FydChyXjItKHgxLXgzKV4yKQ0KICAgIA0KICAgIHhwLCB5cCwgeG0sIHltID0geDEsIHkzK0IsIHgxLCB5My1CDQogIGVsc2UNCiAgDQogICAgbG9jYWwgbSA9ICh5Mi15MSkvKHgyLXgxKQ0KICAgIGxvY2FsIG4gPSB5MS1tKngxDQogICAgbG9jYWwgQSA9IHgzLW0qKG4teTMpDQogICAgbG9jYWwgQiA9IG1hdGguc3FydChBXjItKDErbV4yKSooeDNeMi1yXjIrKG4teTMpXjIpKQ0KICAgIA0KICAgIHhwLCB4bSA9IChBK0IpLygxK21eMiksIChBLUIpLygxK21eMikNCiAgICB5cCwgeW0gPSBtKnhwK24sIG0qeG0rbg0KICBlbmQNCiAgDQogIGlmIHgxIDw9IHgyIHRoZW4NCiAgICBJc09uU2VnbWVudCA9IHgxIDw9IHhwIGFuZCB4cCA8PSB4Mg0KICBlbHNlDQogICAgSXNPblNlZ21lbnQgPSB4MiA8PSB4cCBhbmQgeHAgPD0geDEgICAgICAgIA0KICBlbmQNCiAgICBpZiBJc09uU2VnbWVudCB0aGVuDQogICAgcmV0dXJuIFZlY3Rvcih4cCwgMCwgeXApDQogIGVsc2UNCiAgICByZXR1cm4gVmVjdG9yKHhtLCAwLCB5bSkNCiAgZW5kDQogIA0KZW5kDQoNCi0taXNrZXlkb3duZml4IHN0YXJ0DQpsb2NhbCBvcmlnaW5hbEtEID0gX0cuSXNLZXlEb3duOw0KX0cuSXNLZXlEb3duID0gZnVuY3Rpb24odGhlS2V5KQ0KICBpZiAodHlwZSh0aGVLZXkpIH49ICdudW1iZXInKSB0aGVuDQogICAgbG9jYWwgdGhlTnVtYmVyID0gdG9udW1iZXIodGhlS2V5KTsNCiAgICBpZiAodGhlTnVtYmVyIH49IG5pbCkgdGhlbg0KICAgICAgcmV0dXJuIG9yaWdpbmFsS0QodGhlTnVtYmVyKTsNCiAgICBlbHNlDQogICAgICByZXR1cm4gb3JpZ2luYWxLRChHZXRLZXkodGhlS2V5KSk7DQogICAgZW5kOw0KICBlbHNlDQogICAgcmV0dXJuIG9yaWdpbmFsS0QodGhlS2V5KTsNCiAgZW5kOw0KZW5kOw0KLS1pc2tleWRvd25maXggZW5kDQotLSBBbGwgY2xhc3NpYyBuZWNlc3NlcmllcyBlbmQNCi0tc2tpbmhhY2sNCmZ1bmN0aW9uIFNlbmRTa2luUGFja2V0KG1PYmplY3QsIHNraW5QQiwgbmV0d29ya0lEKQ0KICBpZiAoc3RyaW5nLmZpbmQoR2V0R2FtZVZlcnNpb24oKSwgJ1JlbGVhc2VzLzUuMjAnKSB+PSBuaWwpIHRoZW4NCiAgICBsb2NhbCBtUCA9IENMb0xQYWNrZXQoMHhEQyk7DQoNCiAgICBtUC52VGFibGUgPSAweEVGNUQ4NDsNCg0KICAgIG1QOkVuY29kZUYobmV0d29ya0lEKTsNCiAgICANCiAgICBtUDpFbmNvZGUxKDB4QzMpOw0KICAgIG1QOkVuY29kZTQoMHgwMDAwMDAwMCk7DQogICAgbVA6RW5jb2RlMSgweDA5KTsNCiAgICBpZiAoc2tpblBCID09IG5pbCkgdGhlbg0KICAgICAgbVA6RW5jb2RlNCgweEU1RTVFNUU1KTsNCiAgICBlbHNlDQogICAgICBtUDpFbmNvZGUxKHNraW5QQik7DQogICAgICBmb3IgSSA9IDEsIDMgZG8NCiAgICAgICAgbVA6RW5jb2RlMShza2luSCk7DQogICAgICBlbmQ7DQogICAgZW5kOw0KICAgIG1QOkVuY29kZTEoMHhCNCk7DQoNCiAgICBmb3IgSSA9IDEsIHN0cmluZy5sZW4obU9iamVjdCkgZG8NCiAgICAgIG1QOkVuY29kZTEoc3RyaW5nLmJ5dGUoc3RyaW5nLnN1YihtT2JqZWN0LCBJLCBJKSkpOw0KICAgIGVuZDsNCg0KICAgIGZvciBJID0gMSwgKDE2IC0gc3RyaW5nLmxlbihtT2JqZWN0KSkgZG8NCiAgICAgIG1QOkVuY29kZTEoMHgwMCk7DQogICAgZW5kOw0KDQogICAgbVA6RW5jb2RlNCgweDAwMDAwMDBFKTsNCiAgICBtUDpFbmNvZGU0KDB4MDAwMDAwMEYpOw0KICAgIG1QOkVuY29kZTQoMHgwMDAwMDAwMCk7DQogICAgDQogICAgbVA6SGlkZSgpOw0KICAgIFJlY3ZQYWNrZXQobVApOw0KICBlbHNlaWYgKHN0cmluZy5maW5kKEdldEdhbWVWZXJzaW9uKCksICdSZWxlYXNlcy81LjIxJykgfj0gbmlsKSB0aGVuDQogICAgICBsb2NhbCBtUCA9IENMb0xQYWNrZXQoMHgxMkEpOw0KDQogICAgICBtUC52VGFibGUgPSAweEVBMjk4QzsNCg0KICAgICAgbVA6RW5jb2RlRihuZXR3b3JrSUQpOw0KICAgICAgDQogICAgICBtUDpFbmNvZGU0KDB4MDAwMDAwMDApOw0KICAgICAgbVA6RW5jb2RlMigweDAwMDApOw0KDQogICAgICBmb3IgSSA9IDEsIHN0cmluZy5sZW4obU9iamVjdCkgZG8NCiAgICAgICAgbVA6RW5jb2RlMShzdHJpbmcuYnl0ZShzdHJpbmcuc3ViKG1PYmplY3QsIEksIEkpKSk7DQogICAgICBlbmQ7DQoNCiAgICAgIGZvciBJID0gMSwgKDE2IC0gc3RyaW5nLmxlbihtT2JqZWN0KSkgZG8NCiAgICAgICAgbVA6RW5jb2RlMSgweDAwKTsNCiAgICAgIGVuZDsNCg0KICAgICAgbVA6RW5jb2RlNCgweDAwMDAwMDBFKTsNCiAgICAgIG1QOkVuY29kZTQoMHgwMDAwMDAwRik7DQogICAgICBpZiAoc2tpblBCID09IG5pbCkgdGhlbg0KICAgICAgICBtUDpFbmNvZGU0KDB4NEU0RTRFNEUpOw0KICAgICAgZWxzZQ0KICAgICAgICBtUDpFbmNvZGUxKHNraW5QQik7DQogICAgICAgIGZvciBJID0gMSwgMyBkbw0KICAgICAgICAgIG1QOkVuY29kZTEoc2tpbkgpOw0KICAgICAgICBlbmQ7DQogICAgICBlbmQ7DQogICAgICBtUDpFbmNvZGU0KDB4MDAwMDAwMDApOw0KICAgICAgbVA6RW5jb2RlMSgweDAwKTsNCg0KICAgICAgbVA6SGlkZSgpOw0KICAgICAgUmVjdlBhY2tldChtUCk7DQogIGVuZDsNCmVuZDsNCmlmIChzdHJpbmcuZmluZChHZXRHYW1lVmVyc2lvbigpLCAnUmVsZWFzZXMvNS4yMCcpIH49IG5pbCkgdGhlbg0KICBza2luc1BCID0gew0KICAgIFsxXSA9IDB4RTYsDQogICAgWzJdID0gMHgwNiwNCiAgICBbM10gPSAweDI2LA0KICAgIFs0XSA9IDB4MzYsDQogICAgWzVdID0gMHg0NiwNCiAgICBbNl0gPSAweDY2LA0KICAgIFs3XSA9IDB4NzYsDQogICAgWzhdID0gMHg4NiwNCiAgICBbOV0gPSAweEE2LA0KICAgIFsxMF0gPSAweEI2LA0KICAgIFsxMV0gPSAweEM2LA0KICAgIFsxMl0gPSAweEY2LA0KICB9Ow0KICBza2luT2JqZWN0UG9zID0gMTc7DQogIHNraW5IZWFkZXIgPSAweERDOw0KICBkaXNwZWxsSGVhZGVyID0gMHg3MzsNCiAgc2tpbkggPSAweEU2Ow0KICBza2luSFBvcyA9IDEyOw0KZWxzZWlmIChzdHJpbmcuZmluZChHZXRHYW1lVmVyc2lvbigpLCAnUmVsZWFzZXMvNS4yMScpIH49IG5pbCkgdGhlbg0KICAgIHNraW5zUEIgPSB7DQogICAgICBbMV0gPSAweDUyLA0KICAgICAgWzJdID0gMHgzRSwNCiAgICAgIFszXSA9IDB4NDIsDQogICAgICBbNF0gPSAweDVFLA0KICAgICAgWzVdID0gMHg2MiwNCiAgICAgIFs2XSA9IDB4QUUsDQogICAgICBbN10gPSAweEIyLA0KICAgICAgWzhdID0gMHhCRSwNCiAgICAgIFs5XSA9IDB4QzIsDQogICAgICBbMTBdID0gMHhDRSwNCiAgICAgIFsxMV0gPSAweEQyLA0KICAgICAgWzEyXSA9IDB4REUsDQogICAgfTsNCiAgICBza2luT2JqZWN0UG9zID0gMTI7DQogICAgc2tpbkhlYWRlciA9IDB4MTJBOw0KICAgIGRpc3BlbGxIZWFkZXIgPSAweDc5Ow0KICAgIHNraW5IID0gMHg1MjsNCiAgICBza2luSFBvcyA9IDM2Ow0KZW5kOw=="), nil, "bt", _ENV))()
-- ---------------------------easy copy line---------------------