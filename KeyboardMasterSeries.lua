
--[[
One Click to Challenger
Keyboard Master Series by Ensuluyn
Current Leauge Of Legends Version :5.23
Current Script Version :2.06
Last Update: 24.11.2015
--Credits to Nebelwolfi for mentoring <3
]]

assert(load(Base64Decode("ICANCiAgDQogIC0tIE9uZSBDbGljayB0byBDaGFsbGVuZ2VyDQogIC0tIEtleWJvYXJkIE1hc3RlciBTZXJpZXMgYnkgRW5zdWx1eW4NCiAgDQogIC0tQ3JlZGl0cyB0byBOZWJlbHdvbGZpIGZvciBtZW50b3JpbmcgPDMNCiAgDQogIGxvY2FsIFZlcnNpb24gPSAiMi4wNyIgIA0KICBsb2NhbCBMVmVyc2lvbiA9ICI1LjIzIg0KICBsb2NhbCBTY3JpcHRuYW1lID0gIktleWJvYXJkIE1hc3RlciBTZXJpZXMiDQogIGxvY2FsIEF1dGhvciA9ICJFbnN1bHV5biINCiAgbG9jYWwgbGlzdCA9ICJMZWJsYW5jICwgTGlzc2FuZHJhICwgVmlrdG9yLCBBa2FsaSINCiAgbG9jYWwgbGluayA9ICJHbyB0byBodHRwOi8vZm9ydW0uYm90b2ZsZWdlbmRzLmNvbS9mb3J1bS8yMC1jaGFtcGlvbi1zY3JpcHRzLyB0aGVuIHlvdSBjYW4gc2VlIG15IHRvcGljICIuLlNjcmlwdG5hbWUuLiIgb24gdGhlIGZpcnN0IG9yIHNlY29uZCBwYWdlLiINCiAgbG9jYWwgZGF0ZSA9ICIxNC4xMS4yMDE1Ig0KICBnbG9iYWxfdGlja3MgPSAwDQogIC0tIHN0YXJ0aW5nIHNjcmlwdA0KICAtLWF1dG8gdXBkYXRlDQogIGxvY2FsIHZlcnNpb24gPSAyLjA3DQogIGxvY2FsIGF1dGhvciA9ICJFbnN1bHV5biINCiAgbG9jYWwgU0NSSVBUX05BTUUgPSAiS2V5Ym9hcmRNYXN0ZXJTZXJpZXMiDQogIGxvY2FsIEFVVE9VUERBVEUgPSB0cnVlDQogIGxvY2FsIFVQREFURV9IT1NUID0gInJhdy5naXRodWIuY29tIg0KICBsb2NhbCBVUERBVEVfUEFUSCA9ICIvTG9uc2VtYXJpYS9zY3JpcHRzL21hc3Rlci9LZXlib2FyZE1hc3RlclNlcmllcy5sdWEiLi4iP3JhbmQ9Ii4ubWF0aC5yYW5kb20oMSwxMDAwMCkNCiAgbG9jYWwgVVBEQVRFX0ZJTEVfUEFUSCA9IFNDUklQVF9QQVRILi5HZXRDdXJyZW50RW52KCkuRklMRV9OQU1FDQogIGxvY2FsIFVQREFURV9VUkwgPSAiaHR0cHM6Ly8iLi5VUERBVEVfSE9TVC4uVVBEQVRFX1BBVEgNCiAgZnVuY3Rpb24gU2F5KHRleHQpDQogICAgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPktleWJvYXJkIE1hc3RlciBTZXJpZXM6PC9iPjwvZm9udD4gPGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+IiAuLiB0ZXh0IC4uICI8L2ZvbnQ+IikNCiAgZW5kDQogIA0KICBpZiBBVVRPVVBEQVRFIHRoZW4NCiAgICBsb2NhbCBTZXJ2ZXJEYXRhID0gR2V0V2ViUmVzdWx0KFVQREFURV9IT1NULCAiL0xvbnNlbWFyaWEvc2NyaXB0cy9tYXN0ZXIvdmVyc2lvbi9CdW5kbGUudmVyc2lvbiIpDQogICAgaWYgU2VydmVyRGF0YSB0aGVuDQogICAgICBTZXJ2ZXJWZXJzaW9uID0gdHlwZSh0b251bWJlcihTZXJ2ZXJEYXRhKSkgPT0gIm51bWJlciIgYW5kIHRvbnVtYmVyKFNlcnZlckRhdGEpIG9yIG5pbA0KICAgICAgaWYgU2VydmVyVmVyc2lvbiB0aGVuDQogICAgICAgIGlmIHRvbnVtYmVyKHZlcnNpb24pIDwgU2VydmVyVmVyc2lvbiB0aGVuDQogICAgICAgICAgU2F5KCJOZXcgdmVyc2lvbiBhdmFpbGFibGUgIi4uU2VydmVyVmVyc2lvbikNCiAgICAgICAgICBTYXkoIlVwZGF0aW5nLCBwbGVhc2UgZG9uJ3QgcHJlc3MgRjkiKQ0KICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgRG93bmxvYWRGaWxlKFVQREFURV9VUkwsIFVQREFURV9GSUxFX1BBVEgsIGZ1bmN0aW9uICgpIFNheSgiU3VjY2Vzc2Z1bGx5IHVwZGF0ZWQuICgiLi52ZXJzaW9uLi4iID0+ICIuLlNlcnZlclZlcnNpb24uLiIpLCBwcmVzcyBGOSB0d2ljZSB0byBsb2FkIHRoZSB1cGRhdGVkIHZlcnNpb24uIikgZW5kKSBlbmQsIDMpDQogICAgICAgIGVsc2UNCiAgICAgICAgICBTYXkoIi1XZWxjb21lLCBZb3UgaGF2ZSBnb3QgdGhlIGxhdGVzdCB2ZXJzaW9uICh2Ii4uU2VydmVyVmVyc2lvbi4uIikgb2YgIi4uU2NyaXB0bmFtZS4uIiAsIHVwZGF0ZWQgYXQgKCIuLmRhdGUuLiIpIGJ5ICIgLi4gYXV0aG9yKQ0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgIGVsc2UgDQogICAgICBTYXkoIkVycm9yIGRvd25sb2FkaW5nIHZlcnNpb24gaW5mbyIpDQogICAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBPbkxvYWQoKQ0KICAgICAgICAgIGlmIG5vdCBSZXF1aXJlU2ltcGxlTGliKCkgdGhlbiByZXR1cm4gZW5kDQogICAgICAgICAgaXRlbWZpeCgpDQogICAgICAgICAgIGlmIF9HW215SGVyby5jaGFyTmFtZV0gdGhlbg0KICAgICAgICAgICAgICAgICAgX0dbbXlIZXJvLmNoYXJOYW1lXSgpDQogICAgICAgICAgICAgICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+IFNraW4gSGFjayBjdXJyZW50bHkgZGlzYWJsZWQgdW50aWwgdGhlIG5leHQgdXBkYXRlIikgZW5kLCAxNCkNCiAgICAgICAgICBlbHNlDQogICAgICAgICAgIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjQ0JGNkZGXCI+IDpUaGlzIGNoYW1waW9uIGlzIG5vdCBzdXBwb3J0ZWQuIEN1cnJlbnRseSBzdXBwb3J0ZWQgY2hhbXBpb25zIGFyZTogIi4ubGlzdC4uIiAiICkNCiAgICAgICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjQ0JGNkZGXCI+RmVlbCBmcmVlIHRvIGNoZWNrIG15IGZvcnVtIHRvcGljIGFuZCBhc2sgYSBuZXcgY2hhbXBpb24gb3IgZ2l2ZSBmZWVkYmFjayIpIGVuZCwgMC41KQ0KICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNDQkY2RkZcIj4iLi5saW5rLi4iIikgZW5kLCAwLjUpDQogICAgICAgICAgZW5kDQogIGVuZA0KICAtLSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1MZUJsYW5jIFN0YXJ0aW5nLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAtLSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1MZUJsYW5jIFN0YXJ0aW5nLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAtLSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1MZUJsYW5jIFN0YXJ0aW5nLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAtLSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1MZUJsYW5jIFN0YXJ0aW5nLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICBjbGFzcyAiTGVibGFuYyINCiAgZnVuY3Rpb24gTGVibGFuYzpfX2luaXQoKQ0KICBzZWxmLnRzPSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCA1MjUsIERBTUFHRV9QSFlTSUNBTCwgZmFsc2UsIHRydWUpDQogICAgc2VsZi50c3E9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDcwMCwgREFNQUdFX1BIWVNJQ0FMLCBmYWxzZSwgdHJ1ZSkNCiAgIHNlbGYudHN3PSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCA2MDAsIERBTUFHRV9NQUdJQywgZmFsc2UsIHRydWUpDQogICAgc2VsZi50c2U9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDkyNSwgREFNQUdFX01BR0lDLCBmYWxzZSwgdHJ1ZSkNCiAgICBzZWxmLnRzcj0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgOTI1LCBEQU1BR0VfTUFHSUMsIGZhbHNlLCB0cnVlKSANCiAgICBzZWxmLnRzZz0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgOTUwLCBEQU1BR0VfTUFHSUMsIGZhbHNlLCB0cnVlKSANCiAgICAgc2VsZi5RU3BlbGwgPSBfU3BlbGwoe1Nsb3QgPSBfUSwgRGFtYWdlTmFtZSA9ICJRIiwgUmFuZ2UgPSA3MDAsIFdpZHRoID0gMSwgRGVsYXkgPSAwLCBTcGVlZCA9IG1hdGguaHVnZSwgQ29sbGlzaW9uID0gZmFsc2UsIEFvZSA9IGZhbHNlLCBUeXBlID0gU1BFTExfVFlQRS5UQVJHRVRURUR9KQ0KICAgICBzZWxmLldTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9XLCBEYW1hZ2VOYW1lID0gIlciLCBSYW5nZSA9IDYwMCwgV2lkdGggPSAxMjUsIERlbGF5ID0gMC41LCBTcGVlZCA9IDEzMDAsIFJhZGl1cyA9IDI1MCAsIENvbGxpc2lvbiA9IGZhbHNlLCBBb2UgPSB0cnVlLCBUeXBlID0gU1BFTExfVFlQRS5UQVJHRVRURUR9KQ0KICAgICBzZWxmLkVTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9FLCBEYW1hZ2VOYW1lID0gIkUiLCBSYW5nZSA9IDkyNSwgV2lkdGggPSA1NSwgRGVsYXkgPSAwLjI1LCBTcGVlZCA9IDE2MDAsIENvbGxpc2lvbiA9IHRydWUsIEFvZSA9IGZhbHNlLCBUeXBlID0gU1BFTExfVFlQRS5MSU5FQVJ9KQ0KICAgICBzZWxmLlJTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9SLCBEYW1hZ2VOYW1lID0gIlIiLCBSYW5nZSA9NjAwLCBXaWR0aCA9IDEyNSwgRGVsYXkgPSAwLjUsIFNwZWVkID0gMTMwMCwgQ29sbGlzaW9uID0gZmFsc2UsIEFvZSA9IHRydWUsIFR5cGUgPSBTUEVMTF9UWVBFLlRBUkdFVFRFRH0pDQogICAgIHNlbGYuSWduaXRlID0gX1NwZWxsKHtTbG90ID0gRmluZFN1bW1vbmVyU2xvdCgic3VtbW9uZXJkb3QiKSwgRGFtYWdlTmFtZSA9ICJJR05JVEUiLCBSYW5nZSA9IDYwMCwgVHlwZSA9IFNQRUxMX1RZUEUuVEFSR0VUVEVEfSkNCiAgICAgc2VsZi5sZWJsYW5jVywgc2VsZi5sZWJsYW5jSW1hZ2UsIHNlbGYuY2xvbmVJZCA9IG5pbCwgbmlsLCBuaWwNCiAgLS18PiBNaW5pb24gTWFuYWdlcnMNCiAgICAgIHNlbGYuZW5lbXlNaW5pb25zICAgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9FTkVNWSwgICA2NTAsIG15SGVybywgTUlOSU9OX1NPUlRfTUFYSEVBTFRIX0RFQykNCiAgICAgIHNlbGYuYWxseU1pbmlvbnMgICAgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9BTExZLCAgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgICAgc2VsZi5qdW5nbGVNaW5pb25zICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX0pVTkdMRSwgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgICAgc2VsZi5vdGhlck1pbmlvbnMgICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX09USEVSLCAgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgICAgc2VsZjpMb2FkTWVudSgpDQogICAgICAgIHNlbGY6ZmluZG9yYndhbGtlcigpDQogICAgICAgICAgTGFzdF9MZXZlbFNwZWxsID0gMA0KICAgICAgICBDbG9jayA9IG9zLmNsb2NrKCkNCiAgICAgICAgICAgLS1pZiBWSVBfVVNFUiB0aGVuICBzZWxmOnNraW5oYWNrKCkgZW5kDQogICAgICAgIEFkZFRpY2tDYWxsYmFjayhmdW5jdGlvbigpIHNlbGY6VGljaygpIGVuZCkNCiAgICBBZGREcmF3Q2FsbGJhY2soZnVuY3Rpb24oKSBzZWxmOkRyYXcoKSBlbmQpDQogICAgQWRkTXNnQ2FsbGJhY2soZnVuY3Rpb24obXNnLEtleSkgc2VsZjpXbmRNc2cobXNnLEtleSkgZW5kKQ0KICAgIC0tQWRkQW5pbWF0aW9uQ2FsbGJhY2soZnVuY3Rpb24odW5pdCwgYW5pbWF0aW9uKSBzZWxmOkFuaW1hdGlvbih1bml0LCBhbmltYXRpb24pIGVuZCkNCiAgICAtLUFkZFByb2Nlc3NTcGVsbENhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIHNwZWxsKSBzZWxmOlByb2Nlc3NTcGVsbCh1bml0LCBzcGVsbCkgZW5kKQ0KICAgIC0tQWRkQXBwbHlCdWZmQ2FsbGJhY2soZnVuY3Rpb24oc291cmNlLCB1bml0LCBidWZmKSBzZWxmOk9uQXBwbHlCdWZmKHNvdXJjZSwgdW5pdCwgYnVmZikgZW5kKQ0KICAgIC0tQWRkVXBkYXRlQnVmZkNhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIGJ1ZmYsIHN0YWNrcykgc2VsZjpVcGRhdGVCdWZmKHVuaXQsIGJ1ZmYsIHN0YWNrcykgZW5kKQ0KICAgIC0tQWRkUmVtb3ZlQnVmZkNhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIGJ1ZmYpIHNlbGY6T25SZW1vdmVCdWZmKHVuaXQsIGJ1ZmYpIGVuZCkgDQogICAgICBlbmQNCiAgICAgIGZ1bmN0aW9uIExlYmxhbmM6TG9hZE1lbnUoKQ0KICAgICAgICBzZWxmLkNvbmZpZz1zY3JpcHRDb25maWcoIiIuLlNjcmlwdG5hbWUuLiIiLCJtZW51IikNCiAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkNvbWJvIFNldHRpbmdzIiwgImNvbWJvIikNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZVEiLCAiVXNlIFEgaW4gQ29tYm8iLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VXIiwgIlVzZSBXIGluIENvbWJvIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlRSIsICJVc2UgRSBpbiBjb21ibyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZVIiLCAiVXNlIFIgaW4gY29tYm8iLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VJIiwgIlVzZSBJZ25pdGUgaWYgdGFyZ2V0IGtpbGxhYmxlIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICAtLXNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJnYXBjbG9zZSIsICJVc2UgVyBhcyBhIGdhcGNsb3NlICggQmV0YSApIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCBmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oImxvZ2ljIiwgIkNvbWJvIGxvZ2ljIiwgU0NSSVBUX1BBUkFNX0xJU1QsIDEsIHsiUT5FPlc+UiIsICJRPlI+RT5XIiwgIkU+UT5XPlIiLCAiRT5XPlE+UiIgLCJSYW5kb20gU2tpbGwgT3JkZXIifSkNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkU3ViTWVudSgiVyBTa2lsbCB0dXJuIGJhY2sgc2V0dGluZ3MiLCAidHVybnciKQ0KICAgICAgICBzZWxmLkNvbmZpZy5jb21iby50dXJudzphZGRQYXJhbSgidzEiLCJUdXJuIGJhY2sgdG8gVyBzcG90IG9uIFE+RT5XPlIgbW9kZSAiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm8udHVybnc6YWRkUGFyYW0oIncyIiwiVHVybiBiYWNrIHRvIFcgc3BvdCBvbiBRPlI+RT5XIG1vZGUgIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvLnR1cm53OmFkZFBhcmFtKCJ3MyIsIlR1cm4gYmFjayB0byBXIHNwb3Qgb24gRT5RPlc+UiBtb2RlICIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5jb21iby50dXJudzphZGRQYXJhbSgidzQiLCJUdXJuIGJhY2sgdG8gVyBzcG90IG9uIEU+Vz5RPlIgbW9kZSAiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm8udHVybnc6YWRkUGFyYW0oInc1IiwiVHVybiBiYWNrIHRvIFcgc3BvdCBvbiBSYW5kb20gU2tpbGwgT3JkZXIgbW9kZSAiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oIk1hbmEiLCJNYW5hIE1hbmFnZXIgJSIsU0NSSVBUX1BBUkFNX1NMSUNFLCAxMCwgMTAsIDEwMCwgMCkNCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkhhcmFzcyBTZXR0aW5ncyIsICJoYXJhc3MiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6YWRkUGFyYW0oInVzZVEiLCAiSGFyYXNzIFdpdGggUSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuaGFyYXNzOmFkZFBhcmFtKCJ1c2VXIiwgIkhhcmFzcyBXaXRoIFciLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDEwLCAxMCwgMTAwLCAwKQ0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiTGFuZUNsZWFyIFNldHRpbmdzIiwibGFuZWNsZWFyIikNCiAgICAgICAgc2VsZi5Db25maWcubGFuZWNsZWFyOmFkZFBhcmFtKCJ1c2VRIiwiVXNlIFEgb24gTGFuZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcubGFuZWNsZWFyOmFkZFBhcmFtKCJ1c2VXIiwiVXNlIFcgb24gTGFuZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcubGFuZWNsZWFyOmFkZFBhcmFtKCJ1c2VSIiwiVXNlIFIgb24gTGFuZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLmxhbmVjbGVhcjphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDMwLCAxMCwgMTAwLCAwKQ0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiSnVuZ2xlQ2xlYXIgU2V0dGluZ3MiLCJqdW5nbGVjbGVhciIpDQogICAgICAgIHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyOmFkZFBhcmFtKCJ1c2VRIiwiVXNlIFEgb24ganVuZ2xlY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhcjphZGRQYXJhbSgidXNlVyIsIlVzZSBXIG9uIExhbmVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyOmFkZFBhcmFtKCJ1c2VFIiwiVXNlIEUgb24ganVuZ2xlY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhcjphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDMwLCAxMCwgMTAwLCAwKQ0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiRXNjYXBlIFNldHRpbmdzIiwiZXNjYXBlIikNCiAgICAgICAgc2VsZi5Db25maWcuZXNjYXBlOmFkZFBhcmFtKCJ1c2VXIiwiVXNlIFcgV2hpbGUgRXNjYXBlIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuZXNjYXBlOmFkZFBhcmFtKCJ1c2VSIiwiVXNlIFIgV2hpbGUgRXNjYXBlIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgDQogICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJLaWxsU3RlYWwgU2V0dGluZ3MiLCAia2lsbHN0ZWFsIikNCiAgICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJrcyIsIktpbGxzdGVhbCBPbi9PZmYiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZVEiLCAiU3RlYWwgV2l0aCBRIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZVciLCAiU3RlYWwgV2l0aCBXIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZUUiLCAiU3RlYWwgV2l0aCBFIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZVIiLCAiU3RlYWwgV2l0aCBSIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZVFXIiwgIlN0ZWFsIFdpdGggUVciLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgidXNlSSIsICJTdGVhbCBXaXRoIElnbml0ZSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkl0ZW0gU2V0dGluZ3MiLCAiaXRlbSIpDQogICAgICAgIHNlbGYuQ29uZmlnLml0ZW06YWRkUGFyYW0oImVuYWJsZWF1dG96aG9ueWEiLCAiQXV0byBaaG9ueWEiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIGZhbHNlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5pdGVtOmFkZFBhcmFtKCJhdXRvemhvbnlhIiwgIlpob255YSBpZiBIZWFsdGggdW5kZXIgLT4gJSIsIFNDUklQVF9QQVJBTV9TTElDRSwgMTAsIDAsIDEwMCwgMCkNCiAgICAgICAgDQogICAgICAgIGlmIFZJUF9VU0VSIHRoZW4NCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiVklQIFNldHRpbmdzIiwgInZpcCIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgicGFja2V0IiwiVXNlIFBhY2tldCBDYXN0aW5nIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzEiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzIiLCAiVG8gdXNlIHZpcCBzZXR0aW5ncywgUGFja2V0IENhc3Rpbmcgc2hvdWxkIGJlIG9wZW4uIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRTdWJNZW51KCJBdXRvIExldmVsIFNldHRpbmdzIiwgImxldmVsIikNCiAgICAgICAgc2VsZi5Db25maWcudmlwLmxldmVsOmFkZFBhcmFtKCJrZXkiLCJVc2UgQXV0byBMZXZlbCIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXAubGV2ZWw6YWRkUGFyYW0oImxvZ2ljIiwgIlNlbGVjdCBTa2lsbCBPcmRlciIsIFNDUklQVF9QQVJBTV9MSVNULCA3LCB7IkZvY3VzIFE+Vz5FIiwgIkZvY3VzIFE+RT5XIiwiRm9jdXMgVz5RPkUiLCJGb2N1cyBXPkU+USIsIkZvY3VzIEU+Vz5RIiwgIkZvY3VzIEU+UT5XIiwgIlNtYXJ0IiAgfSkNCiAgICAgICAgc2VsZi5Db25maWcudmlwOmFkZFN1Yk1lbnUoIlNraW4gSGFjayBTZXR0aW5ncyIsICJza2luIikNCiAgICAgICAgc2VsZi5Db25maWcudmlwLnNraW46YWRkUGFyYW0oImtleSIsIlVzZSBTa2luIEhhY2siLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcudmlwLnNraW46YWRkUGFyYW0oJ3NlbGVjdGVkJyAuLiBteUhlcm8uY2hhck5hbWUgLi4gJ1NraW4nLCAiU2VsZWN0IFNraW4iLCBTQ1JJUFRfUEFSQU1fTElTVCwgMSwgeyJPcmlnaW5hbCIsICJXaWNrZWQgTGVCbGFuYyAiLCJQcmVzdGlnaW91cyBMZUJsYW5jIiwiTWlzdGxldG9lIExlQmxhbmMiLCJSYXZlbmJvcm4gTGVibGFuYyIsIH0pDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcC5za2luOmFkZFBhcmFtKCJpbmZvNCIsICJUbyB1c2Ugc2tpbiBoYWNrLCBZb3UgbmVlZCB0byAyeCBGOSBhZnRlciB5b3Ugc2VsZWN0IHRoZSBza2luIHlvdSBkZXNpcmUuIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcC5za2luOmFkZFBhcmFtKCJpbmZvNSIsICJNYWtlIHN1cmUgdGhhdCB1c2luZyBwYWNrZXQgY2FzdGluZyBpcyBPTi4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgLS1zZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm81IiwgIlNraW4gSGFjayB0ZW1wb3JhcnkgZGlzYWJsZWQgdW50aWwgbmV4dCB1cGRhdGUuIC4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgLS1bW3NlbGYuQ29uZmlnLnZpcDphZGRTdWJNZW51KCJBbnRpLUFGSyBTZXR0aW5ncyIsICJhbnRpYWZrIikNCiAgICAgICAgc2VsZi5Db25maWcudmlwLmFudGlhZms6YWRkUGFyYW0oImFudGlhZmsiLCJVc2UgQW50aSBBZmsiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkgXV0NCiAgICAgICAgc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvMyIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvNCIsICJUbyB1c2UgdmlwIHNldHRpbmdzLCBZb3UgbmVlZCB0byBiZSBhIFZJUCB1c2VyIG9uIEJPTCBjb21tdW5pdHkuIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgZW5kDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkRyYXcgU2V0dGluZ3MiLCJvdGhlciIpDQogICAgICAgIC0tc2VsZi5Db25maWcub3RoZXI6YWRkU3ViTWVudSgiU2hvdyBEYW1hZ2UgT24gSHAgQmFyIiwgIkhQQkFSIikNCiAgICAgICAgLS1zZWxmLkNvbmZpZy5vdGhlci5IUEJBUjphZGRQYXJhbSgia2V5IiwiT04vT0ZGIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXI6YWRkU3ViTWVudSgiU2tpbGwgRHJhd2luZyBTZXR0aW5ncyIsICJkcmF3IikNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgicWRyYXciLCJRIFNraWxsIERyYXdpbmdzIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgid2RyYXciLCJXIFNraWxsIERyYXdpbmdzIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgiZWRyYXciLCJFIFNraWxsIERyYXdpbmdzIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgicmRyYXciLCJSIFNraWxsIERyYXdpbmdzIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgiYWFkcmF3IiwiQXV0byBBdHRhY2sgUmFuZ2UiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXI6YWRkUGFyYW0oImNvbWJvbW9kZSIsIkRyYXcgQ29tYm8gTW9kZSIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLm90aGVyOmFkZFN1Yk1lbnUoIkRyYXcgUGVybWFib3giLCAicGVybWEiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5vdGhlci5wZXJtYTphZGRQYXJhbSgicGVybWEiLCJEcmF3IFBlcm1hYm94ICggTmVlZHMgMnggRjkgKSIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLm90aGVyOmFkZFBhcmFtKCJ0YXJnZXQiLCJEcmF3IGNpcmNsZSBmb3IgdGFyZ2V0IHNlbGVjdGVkIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcub3RoZXI6YWRkUGFyYW0oInRhcmdldGNhbCIsIlRhcmdldCBjYWxjdWxhdGlvbiIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJUYXJnZXRzZWxlY3RvcnMiLCJ0YXJnZXRzZWwiKQ0KICAgICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkUGFyYW0oImluZm9LMiIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFBhcmFtKCJpbmZvSyIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFBhcmFtKCJ0cyIsIkxlZnQgQ2xpY2sgRm9yIFRhcmdldCBTZWxlY3Rpb24iLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgIHNlbGYudHMubmFtZSAgPSAiTGVibGFuYyINCiAgICAgIHNlbGYudHNxLm5hbWUgPSAiTGVibGFuY1EiDQogICAgICBzZWxmLnRzdy5uYW1lID0gIkxlYmxhbmNXIg0KICAgICAgc2VsZi50c2UubmFtZSA9ICJMZWJsYW5jRSINCiAgICAgIHNlbGYudHNyLm5hbWUgPSAiTGVibGFuY1IiDQogICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkVFMoc2VsZi50cykNCiAgICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRUUyhzZWxmLnRzcSkNCiAgICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRUUyhzZWxmLnRzdykNCiAgICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRUUyhzZWxmLnRzZSkNCiAgICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRUUyhzZWxmLnRzcikgDQogICAgICANCiAgICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJLZXlzIFNldHRpbmdzIiwgIktleXMiKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0szIiwgIjwtLS0tLS0tLS0tLS0tLS0tLS1Db21ibyBLZXkgU2V0dGluZ3MtLS0tLS0tLS0tLS0tLS0tLS0+IiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJjb21ib2tleSIsICJDb21ibyBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgMzIpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJvbmx5ZSIsICJPbmx5IHVzZSBFIFNraWxsIChPbmx5IFN0dW4pIiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTixmYWxzZSwgc3RyaW5nLmJ5dGUoIk8iKSkNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImNvbWJvbW9kZSIsICIgU2VsZWN0IENvbWJvbW9kZSBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLGZhbHNlLCBzdHJpbmcuYnl0ZSgiMiIpKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0s0IiwgIjwtLS0tLS0tLS0tLS0tLS0tLS1IYXJhc3MgS2V5IFNldHRpbmdzLS0tLS0tLS0tLS0tLS0tLS0tPiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaGFyYXNza2V5IiwgIlNtYXJ0IEhhcmFzcyBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIkMiKSkNCiAgICAgLS0gc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaGFyYXNzdG9nbGVrZXkiLCAiSGFyYXNzIFRvZ2xlIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWVRPR0dMRSwgZmFsc2UsIHN0cmluZy5ieXRlKCJUIikpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJpbmZvSzUiLCAiPC0tLS0tLS0tLS0tLS0tLS0tLUNsZWFyIEtleSBTZXR0aW5ncy0tLS0tLS0tLS0tLS0tLS0tLS0tPiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgibGFuZWNsZWFya2V5IiwgIkxhbmVDbGVhciBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIlYiKSkNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImp1bmdsZWNsZWFya2V5IiwgIkp1bmdsZUNsZWFyIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiWiIpKQ0KICAgICAgLS1zZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJsYXN0aGl0a2V5IiwgIkxhc3RoaXQgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJYIikpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJpbmZvSzYiLCAiPC0tLS0tLS0tLS0tLS0tLS0tLU90aGVyIEtleSBTZXR0aW5ncy0tLS0tLS0tLS0tLS0tLS0tLS0tPiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiZXNjYXBla2V5IiwgIkVzY2FwZSBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIlkiKSkNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0syIiwgIk1ha2UgU3VyZSBUaGF0IFlvdXIgT3Jid2Fsa2VyIEtleXMgYXJlIFNhbWUgQXMgSGVyZSIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiT3J3V2Fsa2VyS2V5IFNldHRpbmdzIiwgIktleXMyIikNCiAgICAgIA0KICAgICAgT3Jid2Fsa01hbmFnZXI6TG9hZENvbW1vbktleXMoc2VsZi5Db25maWcuS2V5czIpDQogICAgICAgDQogICAgICAgDQogICAgICAgaWYgc2VsZi5Db25maWcub3RoZXIucGVybWEucGVybWEgdGhlbg0KICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgc2VsZi5Db25maWc6cGVybWFTaG93KCJpbmZvYm94IikgZW5kLCAxKQ0KICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBzZWxmLkNvbmZpZy5LZXlzOnBlcm1hU2hvdygiY29tYm9rZXkiKSAgZW5kLCAxLjIpDQogICAgICAtLXNlbGYuQ29uZmlnLktleXM6cGVybWFTaG93KCJoYXJhc3N0b2dsZWtleSIpDQogICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBzZWxmLkNvbmZpZy5LZXlzOnBlcm1hU2hvdygiaGFyYXNza2V5IikgIGVuZCwgMS4yKQ0KICAgIGVuZA0KICBlbmQNCiAgLS1kcmF3aW5nIHNldHRpbmdzIHN0YXJ0DQogIGZ1bmN0aW9uIExlYmxhbmM6Y29tYm9tb2RlKCkNCiAgbG9jYWwgZHJhd3BvcyA9IEdldFVuaXRIUEJhclBvcyhteUhlcm8pDQogIGlmIHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID09IDEgdGhlbg0KICBEcmF3VGV4dCgiQ3VycmVudCBDb21ibyBNb2RlOiBRPkU+Vz5SIiwgMTIsIGRyYXdwb3MueC00MCwgZHJhd3Bvcy55KzE2LCAweGZmMDBmZmZmKSBlbmQNCiAgaWYgc2VsZi5Db25maWcuY29tYm8ubG9naWMgPT0gMiB0aGVuDQogIERyYXdUZXh0KCJDdXJyZW50IENvbWJvIE1vZGU6IFE+Uj5FPlciLCAxMiwgZHJhd3Bvcy54LTQwLCBkcmF3cG9zLnkrMTYsIDB4ZmYwMGZmZmYpIGVuZA0KICBpZiBzZWxmLkNvbmZpZy5jb21iby5sb2dpYyA9PSAzIHRoZW4NCiAgRHJhd1RleHQoIkN1cnJlbnQgQ29tYm8gTW9kZTogRT5RPlc+UiIsIDEyLCBkcmF3cG9zLngtNDAsIGRyYXdwb3MueSsxNiwgMHhmZjAwZmZmZikgZW5kDQogIGlmIHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID09IDQgdGhlbg0KICBEcmF3VGV4dCgiQ3VycmVudCBDb21ibyBNb2RlOiBFPlc+UT5SIiwgMTIsIGRyYXdwb3MueC00MCwgZHJhd3Bvcy55KzE2LCAweGZmMDBmZmZmKSBlbmQNCiAgaWYgc2VsZi5Db25maWcuY29tYm8ubG9naWMgPT0gNSB0aGVuDQogIERyYXdUZXh0KCJDdXJyZW50IENvbWJvIE1vZGU6IFJhbmRvbSBTa2lsbCBPcmRlciIsIDEyLCBkcmF3cG9zLngtNDAsIGRyYXdwb3MueSsxNiwgMHhmZjAwZmZmZikgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOkRyYXcoKQ0KICBpZiBzZWxmLkNvbmZpZy5vdGhlci5jb21ib21vZGUgdGhlbg0KICBsb2NhbCBkcmF3cG9zID0gR2V0VW5pdEhQQmFyUG9zKG15SGVybykNCiAgc2VsZjpjb21ib21vZGUoKQ0KICBlbmQNCiAgICAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5xZHJhdyBhbmQgc2VsZi5RU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCA2NTAsIDEscmVkKQ0KICAgIGVuZA0KICANCiAgICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LndkcmF3IGFuZCBzZWxmLldTcGVsbDpJc1JlYWR5KCkgdGhlbg0KICAgICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDYwMCwgMSwgcmVkKQ0KICAgIGVuZA0KICANCiAgICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LmVkcmF3IGFuZCBzZWxmLkVTcGVsbDpJc1JlYWR5KCkgdGhlbg0KICAgICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDkyNSwgMSwgcmVkKQ0KICAgIGVuZA0KICAgIA0KICAgIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcucmRyYXcgYW5kIHNlbGYuUlNwZWxsOklzUmVhZHkoKSB0aGVuDQogICAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgNzAwLDEsIHJlZCkNCiAgICBlbmQNCiAgICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LmFhZHJhdyB0aGVuDQogICAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgNTUwLDEsIEFSR0IoMjU1LCAyNTUsMCwwKSkNCiAgICBlbmQNCiAgICAgICAgICAgICAgaWYgc2VsZi5Db25maWcub3RoZXIudGFyZ2V0IGFuZCBzZWxmLnNlbGVjdGVkVGFyIH49IG5pbCB0aGVuDQogICAgICAgICBEcmF3Q2lyY2xlM0Qoc2VsZi5zZWxlY3RlZFRhci54LCBzZWxmLnNlbGVjdGVkVGFyLnksIHNlbGYuc2VsZWN0ZWRUYXIueiwgODAsNiwgQVJHQigyNTUsIDI1NSwwLDApKQ0KZW5kDQogIGlmIHNlbGYuQ29uZmlnLm90aGVyLnRhcmdldGNhbCBhbmQgbm90IG15SGVyby5kZWFkIHRoZW4NCiAgICAgIGlmIHRhcmdldCBhbmQgdGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGxvY2FsIGRyYXdwb3M9V29ybGRUb1NjcmVlbihEM0RYVkVDVE9SMyh0YXJnZXQueCwgdGFyZ2V0LnksIHRhcmdldC56KSkNCiAgICAgICAgbG9jYWwgY29tYm9UZXh0LGNvbG9yID0gc2VsZjpHZXREcmF3cyh0YXJnZXQpDQogICAgICAgIGlmIGNvbWJvVGV4dCB0aGVuDQogICAgICAgICAgRHJhd1RleHQoY29tYm9UZXh0LDE1LGRyYXdwb3MueC0yMCxkcmF3cG9zLnktMjAsY29sb3IpDQogICAgICAgIGVuZCANCiAgICAgIGVuZCANCiAgICAgIGVuZA0KICAgICAgZW5kDQogDQogIC0tZHJhd2luZyBzZXR0aW5ncyBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpHZXREcmF3cyh0YXJnZXQpDQpEbWc9e1E9c2VsZi5RU3BlbGw6SXNSZWFkeSgpIGFuZCBnZXREbWcoIlEiLHRhcmdldCxteUhlcm8pb3IgMCxRMj1nZXREbWcoIlEiLHRhcmdldCxteUhlcm8sMilvciAwLFc9c2VsZi5XU3BlbGw6SXNSZWFkeSgpIGFuZCBnZXREbWcoIlciLHRhcmdldCxteUhlcm8pb3IgMCxFPXNlbGYuRVNwZWxsOklzUmVhZHkoKSBhbmQgZ2V0RG1nKCJFIix0YXJnZXQsbXlIZXJvKW9yIDAsUj1zZWxmLlJTcGVsbDpJc1JlYWR5KCkgYW5kIGdldERtZygiUiIsdGFyZ2V0LG15SGVybylvciAwLFIyPWdldERtZygiUiIsdGFyZ2V0LG15SGVybywyKW9yIDAsST1zZWxmLklnbml0ZTpJc1JlYWR5KCkgYW5kIGdldERtZygiSUdOSVRFIix0YXJnZXQsbXlIZXJvKW9yIDB9DQogIGlmIERtZy5RID50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EnLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgRG1nLlErIERtZy5JPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIElnbml0ZScsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBEbWcuVyA+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdXJywgUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIERtZy5XKyBEbWcuST50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1cgKyBJZ25pdGUnLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgRG1nLkUgPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnRScsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBEbWcuRSsgRG1nLkk+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdFICsgSWduaXRlJywgUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIERtZy5RK0RtZy5RMitEbWcuVyA+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgVycsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIERtZy5RK0RtZy5RMitEbWcuRSA+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgRScsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIERtZy5RK0RtZy5RMitEbWcuVysgRG1nLkk+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgVyArIElnbml0ZScsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIERtZy5RK0RtZy5RMitEbWcuRSsgRG1nLkk+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgRSArIElnbml0ZScsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIERtZy5RK0RtZy5RMitEbWcuRStEbWcuVyA+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgVyArIEUnLFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBEbWcuUStEbWcuUTIrRG1nLkUrRG1nLlcrIERtZy5JPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIFcgKyBFICsgSWduaXRlJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgRG1nLlErRG1nLlIrRG1nLlIyK0RtZy5RMitEbWcuRStEbWcuVyA+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgUiArIFcgKyBFJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgRG1nLlErRG1nLlIrRG1nLlIyK0RtZy5RMitEbWcuRStEbWcuVysgRG1nLkk+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgUiArIFcgKyBFICsgSWduaXRlJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlIA0KICAgIHJldHVybiAiQ2FudCBLaWxsIHlldCIsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVuZCANCmVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOlRpY2soKQ0KICAgICAgIHNlbGY6YXV0b3pob255YSgpDQogICAgICAgIHNlbGY6Y2hlY2t0cygpDQogICAgICAgaWYgVklQX1VTRVIgdGhlbiBzZWxmOmF1dG9sZXZlbCgpIGVuZA0KICANCiAgICAgICBzZWxmOmdhcGNsb3NlKCkNCiAgIGlmKHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICApdGhlbg0KICAgICAgc2VsZjpjb21ibygpDQogICAgZW5kDQogICAgIGlmKHNlbGYuQ29uZmlnLktleXMub25seWUgICApdGhlbg0KICAgICAgc2VsZjpvbmx5ZSgpDQogICAgZW5kDQogICAgaWYoc2VsZi5Db25maWcuS2V5cy5sYW5lY2xlYXJrZXkgKXRoZW4NCiAgICAgIHNlbGY6TGFuZUNsZWFyKCkNCiAgICBlbmQNCiAgICBpZihzZWxmLkNvbmZpZy5LZXlzLmVzY2FwZWtleSApdGhlbg0KICAgICAgc2VsZjplc2NhcGUoKQ0KICAgIGVuZA0KICAgICAgaWYoc2VsZi5Db25maWcuS2V5cy5qdW5nbGVjbGVhcmtleSApdGhlbg0KICAgICBzZWxmOkp1bmdsZUNsZWFyKCkNCiAgICBlbmQNCiAgICBpZihzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgKSB0aGVuDQogICAgICBzZWxmOmtpbGxzdGVhbCgpDQogICAgZW5kDQogICAgaWYoc2VsZi5Db25maWcuS2V5cy5oYXJhc3NrZXkgICApIHRoZW4NCiAgICAgIHNlbGY6aGFyYXNzKCkNCiAgICBlbmQNCiAgICAgIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOmNoZWNrdHMoKQ0KICAgICAgICAgc2VsZi50czp1cGRhdGUoKQ0KICAgICAgIHNlbGYudHNlOnVwZGF0ZSgpDQogICAgICAgc2VsZi50c3E6dXBkYXRlKCkNCiAgICAgICBzZWxmLnRzcjp1cGRhdGUoKQ0KICAgICAgIHNlbGYudHN3OnVwZGF0ZSgpDQogICAgICAgc2VsZi50c2c6dXBkYXRlKCkNCiAgaWYgbm90IHNlbGYudHNnLnRhcmdldH49bmlsIG9yIG5vdCBzZWxmLkNvbmZpZy50YXJnZXRzZWwudHMgdGhlbg0KICB0YXJnZXQgPSBzZWxmLnRzdy50YXJnZXQNCiAgZWxzZWlmIHNlbGYudHNnLnRhcmdldH49bmlsIG9yIHNlbGYuc2VsZWN0ZWRUYXIgdGhlbg0KICB0YXJnZXQgPSBzZWxmLnNlbGVjdGVkVGFyDQogIGVuZA0KICBlbmQNCiAgbG9jYWwgc2tpbnNQQiA9IHt9Ow0KICBsb2NhbCBza2luT2JqZWN0UG9zID0gbmlsOw0KICBsb2NhbCBza2luSGVhZGVyID0gbmlsOw0KICBsb2NhbCBkaXNwZWxsSGVhZGVyID0gbmlsOw0KICBsb2NhbCBza2luSCA9IG5pbDsNCiAgbG9jYWwgc2tpbkhQb3MgPSBuaWw7DQogIGZ1bmN0aW9uIExlYmxhbmM6c2tpbmhhY2soKQ0KICBpZiBub3Qgc2VsZi5Db25maWcudmlwLnBhY2tldCB0aGVuIFNlbmRTa2luUGFja2V0KG15SGVyby5jaGFyTmFtZSwgc2tpbnNQQlsxXSwgbXlIZXJvLm5ldHdvcmtJRCk7IGVsc2UNCiAgaWYgc2VsZi5Db25maWcudmlwLnNraW4ua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAucGFja2V0ICB0aGVuDQogIFNlbmRTa2luUGFja2V0KG15SGVyby5jaGFyTmFtZSwgc2tpbnNQQltzZWxmLkNvbmZpZy52aXAuc2tpblsnc2VsZWN0ZWQnIC4uIG15SGVyby5jaGFyTmFtZSAuLiAnU2tpbiddXSwgbXlIZXJvLm5ldHdvcmtJRCk7DQogIGVuZA0KICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6b25seWUoKQ0KICAgICAgICAgc2VsZi50c2U6dXBkYXRlKCkNCiAgICAgICAgICBpZihzZWxmLnRzZS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlRSBhbmQgIHNlbGYuQ29uZmlnLktleXMub25seWUgICBhbmQgc2VsZi5FU3BlbGw6SXNSZWFkeSgpKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0RShzZWxmLnRzZS50YXJnZXQpDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzphbnRpYWZrKCkNCiAgaWYgb3MuY2xvY2soKSA8IENsb2NrIG9yIG5vdCBzZWxmLkNvbmZpZy52aXAuYW50aWFmayB0aGVuIHJldHVybiBlbmQNCiAgICAgIENsb2NrID0gb3MuY2xvY2soKSArIG1hdGgucmFuZG9tKDYwLDEyMCkNCiAgbXlIZXJvOk1vdmVUbyhteUhlcm8ueCwgbXlIZXJvLnopDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOmNvbWJvKCkNCiAgaWYgc2VsZi5Db25maWcuY29tYm8ubG9naWMgPT0gMSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKSB0aGVuDQogIHNlbGY6Y29tYm9RRVdSKCkNCiAgZW5kDQogIGlmIHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID09IDIgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwICkgdGhlbg0KICBzZWxmOmNvbWJvUVJFVygpDQogIGVuZA0KICBpZiBzZWxmLkNvbmZpZy5jb21iby5sb2dpYyA9PSAzIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmNvbWJvLk1hbmEgLzEwMCApIHRoZW4NCiAgc2VsZjpjb21ib0VRV1IoKQ0KICBlbmQNCiAgaWYgc2VsZi5Db25maWcuY29tYm8ubG9naWMgPT0gNCBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKSB0aGVuDQogIHNlbGY6Y29tYm9FV1FSKCkNCiAgZW5kDQogIGlmIHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID09IDUgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwICkgdGhlbg0KICBzZWxmOnJhbmRvbWNvbWJvKCkNCiAgZW5kDQogICAgICBpZihzZWxmLkNvbmZpZy5jb21iby51c2VJIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgKXRoZW4NCiAgICAgIGZvciBfLCB1bml0IGluIHBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvDQogICAgICAgIGxvY2FsIGRtZ0kgPSg1MCsgKChteUhlcm8ubGV2ZWwpKjIwKSkNCiAgICAgICAgbG9jYWwgaGVhbHRoPXVuaXQuaGVhbHRoDQogICAgICAgIGlmKGhlYWx0aDxkbWdJIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VJIGFuZCBHZXREaXN0YW5jZSh1bml0KTw2MDApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEkodW5pdCkNCiAgICAgIGVuZA0KICAgICAgZW5kDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpjb21ib1FSRVcoKQ0KICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgIGlmIG5vdCBzZWxmLkNvbmZpZy5jb21iby50dXJudy53MiB0aGVuDQogIGlmIChzZWxmLnRzdy50YXJnZXQgfj0gbmlsICl0aGVuDQogIHNlbGY6Q2FzdFFSKHRhcmdldCkNCiAgZW5kDQogIGlmKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgKSBhbmQgc2VsZjpRUnVzZWQoKSB0aGVuDQogIHNlbGY6Q2FzdEVXKHRhcmdldCkNCiAgZW5kDQogIGVuZA0KICAgaWYgc2VsZi5Db25maWcuY29tYm8udHVybncudzIgdGhlbg0KICBpZiAoc2VsZi50c3cudGFyZ2V0IH49IG5pbCApdGhlbg0KICBzZWxmOkNhc3RRUih0YXJnZXQpDQogIGVuZA0KICBpZihzZWxmLnRzdy50YXJnZXQgfj0gbmlsICkgYW5kIHNlbGY6UUV1c2VkKCkgdGhlbg0KICBzZWxmOkNhc3RFV0IodGFyZ2V0KQ0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOmNvbWJvRVdRUigpDQogICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgaWYgbm90IHNlbGYuQ29uZmlnLmNvbWJvLnR1cm53Lnc0IHRoZW4NCiAgaWYgKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgKXRoZW4NCiAgc2VsZjpDYXN0RVcodGFyZ2V0KQ0KICBlbmQNCiAgaWYoc2VsZi50c3cudGFyZ2V0IH49IG5pbCApIGFuZCBzZWxmOkVXdXNlZCgpIHRoZW4NCiAgc2VsZjpDYXN0UVIodGFyZ2V0KQ0KICBlbmQNCiAgZW5kDQogICBpZiAgc2VsZi5Db25maWcuY29tYm8udHVybncudzQgdGhlbg0KICBpZiAoc2VsZi50c3cudGFyZ2V0IH49IG5pbCApdGhlbg0KICBzZWxmOkNhc3RFV0IodGFyZ2V0KQ0KICBlbmQNCiAgaWYoc2VsZi50c3cudGFyZ2V0IH49IG5pbCApIGFuZCBzZWxmOkVXdXNlZCgpIHRoZW4NCiAgc2VsZjpDYXN0UVIodGFyZ2V0KQ0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOmNvbWJvRVFXUigpDQogICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgaWYgbm90IHNlbGYuQ29uZmlnLmNvbWJvLnR1cm53LnczIHRoZW4NCiAgaWYgKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgKXRoZW4NCiAgc2VsZjpDYXN0RVEodGFyZ2V0KQ0KICBlbmQNCiAgaWYoc2VsZi50c3cudGFyZ2V0IH49IG5pbCApIGFuZCBzZWxmOkVRdXNlZCgpIHRoZW4NCiAgc2VsZjpDYXN0V1IodGFyZ2V0KQ0KICBlbmQNCiAgZW5kDQogICBpZiAgc2VsZi5Db25maWcuY29tYm8udHVybncudzMgdGhlbg0KICBpZiAoc2VsZi50c3cudGFyZ2V0IH49IG5pbCApdGhlbg0KICBzZWxmOkNhc3RFUSh0YXJnZXQpDQogIGVuZA0KICBpZihzZWxmLnRzdy50YXJnZXQgfj0gbmlsICkgYW5kIHNlbGY6RVF1c2VkKCkgdGhlbg0KICBzZWxmOkNhc3RXUkIodGFyZ2V0KQ0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOmNvbWJvUUVXUigpDQogICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgaWYgbm90IHNlbGYuQ29uZmlnLmNvbWJvLnR1cm53LncxIHRoZW4NCiAgaWYgKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgKXRoZW4NCiAgc2VsZjpDYXN0UUUodGFyZ2V0KQ0KICBlbmQNCiAgaWYoc2VsZi50c3cudGFyZ2V0IH49IG5pbCApIGFuZCBzZWxmOlFFdXNlZCgpIHRoZW4NCiAgc2VsZjpDYXN0V1IodGFyZ2V0KQ0KICBlbmQNCiAgZW5kDQogICBpZiBzZWxmLkNvbmZpZy5jb21iby50dXJudy53MSB0aGVuDQogIGlmIChzZWxmLnRzdy50YXJnZXQgfj0gbmlsICl0aGVuDQogIHNlbGY6Q2FzdFFFKHRhcmdldCkNCiAgZW5kDQogIGlmKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgKSBhbmQgc2VsZjpRRXVzZWQoKSB0aGVuDQogIHNlbGY6Q2FzdFdSQih0YXJnZXQpDQogIGVuZA0KICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6Q2FzdFEodW5pdCkNCiAgICBzZWxmLlFTcGVsbDpDYXN0KHVuaXQpDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOkNhc3RRRSh1bml0KQ0KICAgICAgICBzZWxmLnRzcTp1cGRhdGUoKQ0KICAgICAgIHNlbGYudHN3OnVwZGF0ZSgpDQogICAgICBpZihzZWxmLnRzcS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICAgYW5kIHNlbGYuUVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0USh0YXJnZXQpDQogICAgIGVuZA0KICAgICAgICAgc2VsZi50c2U6dXBkYXRlKCkNCiAgICAgICAgICBpZihzZWxmLnRzZS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlRSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICBhbmQgc2VsZi5FU3BlbGw6SXNSZWFkeSgpKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0RSh0YXJnZXQpDQogICAgICAgICAgZW5kDQogICAgICAgICAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6Q2FzdEVXKHVuaXQpDQogICAgICAgIHNlbGYudHNlOnVwZGF0ZSgpDQogICAgICBpZihzZWxmLnRzZS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlRSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICAgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0RSh0YXJnZXQpDQogICAgIGVuZA0KICAgICAgICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgICAgICAgICBpZihzZWxmLnRzdy50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlVyBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICBhbmQgbm90IHNlbGY6d1VzZWQoKSBhbmQgc2VsZi5XU3BlbGw6SXNSZWFkeSgpKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0Vyh0YXJnZXQpDQogICAgICAgICAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOkNhc3RFV0IodW5pdCkNCiAgICAgICAgc2VsZi50c2U6dXBkYXRlKCkNCiAgICAgIGlmKHNlbGYudHNlLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VFIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgICBhbmQgc2VsZi5FU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RFKHRhcmdldCkNCiAgICAgZW5kDQogICAgICAgICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgICAgICAgIGlmKHNlbGYudHN3LnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VXIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgYW5kIHNlbGYuV1NwZWxsOklzUmVhZHkoKSkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFcodGFyZ2V0KQ0KICAgICAgICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpyYW5kb21jb21ibygpDQogICAgICAgIHNlbGYudHNxOnVwZGF0ZSgpDQogICAgICBpZihzZWxmLnRzcS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICAgYW5kIHNlbGYuUVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0USh0YXJnZXQpICAgICANCiAgICAgICAgICBlbmQNCiAgICAgICAgICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi50c3cudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVcgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgIGFuZCBzZWxmLldTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFcodGFyZ2V0KSAgICAgIA0KICAgICAgICAgIGVuZA0KICAgICAgICAgIHNlbGYudHNlOnVwZGF0ZSgpDQogICAgICBpZihzZWxmLnRzZS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlRSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICAgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0RSh0YXJnZXQpICAgIA0KICAgICAgICAgIGVuZA0KICAgICAgICAgICBzZWxmLnRzcjp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi50c3IudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVIgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgIGFuZCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFIodGFyZ2V0KQ0KICAgICAgICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpDYXN0UVIodW5pdCkNCiAgICAgICAgc2VsZi50c3E6dXBkYXRlKCkNCiAgICAgICAgIHNlbGYudHN3OnVwZGF0ZSgpDQogICAgICBpZihzZWxmLnRzcS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICAgYW5kIHNlbGYuUVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0USh0YXJnZXQpDQogICAgIGVuZA0KICAgICAgICAgc2VsZi50c3I6dXBkYXRlKCkNCiAgICAgICAgICBpZihzZWxmLnRzci50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUiBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICBhbmQgc2VsZi5SU3BlbGw6SXNSZWFkeSgpKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0Uih0YXJnZXQpDQogICAgICAgICAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOkNhc3RXUih1bml0KQ0KICAgICAgICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi50c3cudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVcgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgIGFuZCBzZWxmLldTcGVsbDpJc1JlYWR5KClhbmQgbm90IHNlbGY6d1VzZWQoKSl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0Vyh0YXJnZXQpDQogICAgIGVuZA0KICAgICAgICAgc2VsZi50c3I6dXBkYXRlKCkNCiAgICAgICAgICBpZihzZWxmLnRzci50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUiBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICBhbmQgc2VsZi5SU3BlbGw6SXNSZWFkeSgpKSBhbmQgbm90IHNlbGY6clVzZWQoKSAgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFIodGFyZ2V0KQ0KICAgICAgICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpDYXN0V1JCKHVuaXQpDQogICAgICAgIHNlbGYudHN3OnVwZGF0ZSgpDQogICAgICBpZihzZWxmLnRzdy50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlVyBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICAgYW5kIHNlbGYuV1NwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0Vyh0YXJnZXQpDQogICAgIGVuZA0KICAgICAgICAgc2VsZi50c3I6dXBkYXRlKCkNCiAgICAgICAgICBpZihzZWxmLnRzci50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUiBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICBhbmQgc2VsZi5SU3BlbGw6SXNSZWFkeSgpKSBhbmQgbm90IHNlbGY6clVzZWQoKSAgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFIodGFyZ2V0KQ0KICAgICAgICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpDYXN0UVdIKCkNCiAgICAgICAgc2VsZi50c3E6dXBkYXRlKCkNCiAgICAgIGlmKHNlbGYudHNxLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5oYXJhc3MudXNlUSBhbmQgIHNlbGYuQ29uZmlnLktleXMuaGFyYXNza2V5ICBhbmQgc2VsZi5RU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RRKHRhcmdldCkNCiAgICAgZW5kDQogICAgICAgIHNlbGYudHN3OnVwZGF0ZSgpDQogICAgICBpZihzZWxmLnRzdy50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuaGFyYXNzLnVzZVcgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmhhcmFzc2tleSAgYW5kIHNlbGYuV1NwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgICBzZWxmOkNhc3RXKHRhcmdldCkNCiAgICAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOkNhc3RRV0sodW5pdCkNCiAgICAgICAgc2VsZi50c3E6dXBkYXRlKCkNCiAgICAgIGlmKHNlbGYudHNxLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlUVcgYW5kICBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgYW5kIHNlbGYuUVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0USh0YXJnZXQpDQogICAgIGVuZA0KICAgICAgICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi50c3cudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VRVyBhbmQgbm90IHNlbGY6d1VzZWQoKSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzIGFuZCBzZWxmLldTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFcodGFyZ2V0KQ0KICAgICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6Q2FzdEVRKHVuaXQpDQogICAgICAgIHNlbGYudHNlOnVwZGF0ZSgpDQogICAgICAgIHNlbGYudHN3OnVwZGF0ZSgpDQogICAgICBpZihzZWxmLnRzZS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlRSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICAgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0RSh0YXJnZXQpDQogICAgIGVuZA0KICAgICAgICAgc2VsZi50c3E6dXBkYXRlKCkNCiAgICAgICAgICBpZihzZWxmLnRzcS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICBhbmQgc2VsZi5RU3BlbGw6SXNSZWFkeSgpKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0USh0YXJnZXQpDQogICAgICAgICAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOkNhc3RXKHVuaXQpDQogICAgc2VsZi5XU3BlbGw6Q2FzdCh1bml0KQ0KICBlbmQNCiAgDQogIGZ1bmN0aW9uIExlYmxhbmM6Q2FzdEUodW5pdCkNCiAgIHNlbGYuRVNwZWxsOkNhc3QodW5pdCkNCiAgICANCiAgZW5kDQogIA0KICBmdW5jdGlvbiBMZWJsYW5jOkNhc3RSKHVuaXQpDQogICAgc2VsZi5SU3BlbGw6Q2FzdCh1bml0KQ0KICBlbmQNCiAgDQogIGZ1bmN0aW9uIExlYmxhbmM6Q2FzdEkodW5pdCkNCiAgICBzZWxmLklnbml0ZTpDYXN0KHVuaXQpDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOmtpbGxzdGVhbCgpDQogIGZvciBfLCB1bml0IGluIHBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvDQogICAgICBsb2NhbCBoZWFsdGggPSB1bml0LmhlYWx0aA0KICAgICAgbG9jYWwgZG1nRSA9IGdldERtZygiRSIsIHVuaXQsIG15SGVybykgKyAoKG15SGVyby5hcCkqMC41KSArIChnZXREbWcoIkUiLCB1bml0LCBteUhlcm8pICsgKChteUhlcm8uYXApKjAuNSkpDQogICAgICAgIGlmKHNlbGYudHNlLnRhcmdldCB+PSBuaWwgYW5kICBzZWxmLkVTcGVsbDpJc1JlYWR5KCkgYW5kIG5vdCBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgYW5kIGhlYWx0aDxkbWdFIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlRSAgIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MpdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEUodW5pdCkgIA0KICAgICAgICBlbmQNCiAgICAgICAgbG9jYWwgZG1nUSA9IGdldERtZygiUSIsIHVuaXQsIG15SGVybykgKyAoKG15SGVyby5hcCkqMC40MCkNCiAgICAgICAgaWYoc2VsZi50c3EudGFyZ2V0IH49IG5pbCBhbmQgIHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgbm90IHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICBhbmQgaGVhbHRoPGRtZ1EgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VRIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RRKHVuaXQpICANCiAgICAgICAgZW5kDQogICAgICAgICBsb2NhbCBkbWdRVyA9IGdldERtZygiUSIsIHVuaXQsIG15SGVybykgKyAoKG15SGVyby5hcCkqMC40MCkrKGdldERtZygiVyIsIHVuaXQsIG15SGVybykgKyAoKG15SGVyby5hcCkqMC42MCkrKGdldERtZygiUSIsIHVuaXQsIG15SGVybykgKyAoKG15SGVyby5hcCkqMC40MCkpKQ0KICAgICAgICBpZihzZWxmLnRzdy50YXJnZXQgfj0gbmlsIGFuZCAgaGVhbHRoPGRtZ1EgYW5kIG5vdCBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VRVyBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzICl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0UVdLKHVuaXQpICANCiAgICAgICAgZW5kDQogICAgICAgICAgICAgIGxvY2FsIGRtZ1cgPSBnZXREbWcoIlciLCB1bml0LCBteUhlcm8pICsgKChteUhlcm8uYXApKjAuNjApDQogICAgICAgIGlmKHNlbGYudHN3LnRhcmdldCB+PSBuaWwgYW5kICBzZWxmLldTcGVsbDpJc1JlYWR5KCkgYW5kIG5vdCBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5IGFuZCBub3Qgc2VsZjp3VXNlZCgpICAgYW5kIGhlYWx0aDxkbWdRIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlVyBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzICl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0Vyh1bml0KSAgDQogICAgICAgIGVuZA0KICAgICAgICAgbG9jYWwgZG1nSSA9KDUwKyAoKG15SGVyby5sZXZlbCkqMjApKQ0KICAgICAgICBpZihoZWFsdGg8ZG1nSSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZUkgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyBhbmQgR2V0RGlzdGFuY2UodW5pdCk8NjAwKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RJKHVuaXQpDQogICAgICAgIGVuZA0KICAgICAgICBsb2NhbCBkbWdSID1nZXREbWcoIlIiLHVuaXQsbXlIZXJvKSsoKG15SGVyby5hcCkqMC42MCkgDQogICAgICAgIGlmKHNlbGYudHNyLnRhcmdldCB+PSBuaWwgYW5kICBzZWxmLlJTcGVsbDpJc1JlYWR5KCkgYW5kIG5vdCBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgYW5kIGhlYWx0aDxkbWdSIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlUiBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzIGFuZCBHZXREaXN0YW5jZSh1bml0KTw2MDApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFIodW5pdCkNCiAgICAgICAgZW5kDQogICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpoYXJhc3MoKQ0KICAgIHNlbGYudHNxOnVwZGF0ZSgpDQogICAgIHNlbGYudHN3OnVwZGF0ZSgpDQogICAgaWYgc2VsZi5Db25maWcuS2V5cy5oYXJhc3NrZXkgIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmhhcmFzcy5NYW5hIC8xMDAgKSAgdGhlbg0KICAgIHNlbGY6Q2FzdFFXSCgpDQogICAgICBlbmQgICANCiAgIGVuZA0KICAgZnVuY3Rpb24gTGVibGFuYzpMYW5lQ2xlYXIoKQ0KICBsb2NhbCBjbGVhcnRhcmdldCA9IHNlbGYuY2xlYXJ0YXJnZXQNCiAgc2VsZi5lbmVteU1pbmlvbnM6dXBkYXRlKCkNCiAgIHNlbGYub3RoZXJNaW5pb25zOnVwZGF0ZSgpDQogICAgICBzZWxmLmp1bmdsZU1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIGZvciBpLCBtaW5pb24gaW4gaXBhaXJzKHNlbGYuZW5lbXlNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICAgIGlmIFZhbGlkVGFyZ2V0KG1pbmlvbiwgNjAwKSBhbmQgKGNsZWFydGFyZ2V0ID09IG5pbCBvciBub3QgVmFsaWRUYXJnZXQoY2xlYXJ0YXJnZXQpKSB0aGVuDQogICAgICAgICAgY2xlYXJ0YXJnZXQgPSBtaW5pb24NCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGZvciBpLCBtaW5pb24gaW4gcGFpcnMoc2VsZi5lbmVteU1pbmlvbnMub2JqZWN0cykgZG8NCiAgICAgICAgaWYgVmFsaWRUYXJnZXQobWluaW9uKSBhbmQgbWluaW9uIH49IG5pbCB0aGVuDQogICAgICAgICAgaWYgc2VsZi5Db25maWcuS2V5cy5sYW5lY2xlYXJrZXkgIGFuZCBzZWxmLkNvbmZpZy5sYW5lY2xlYXIudXNlUSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5sYW5lY2xlYXIuTWFuYSAvMTAwICkgYW5kIEdldERpc3RhbmNlKG1pbmlvbikgPD0gc2VsZi5RU3BlbGwuUmFuZ2UgdGhlbiANCiAgICAgICAgICAgICBzZWxmOkNhc3RRKGNsZWFydGFyZ2V0KQ0KICAgICAgICAgIGVuZA0KICAgICAgICAgIGlmIHNlbGYuQ29uZmlnLktleXMubGFuZWNsZWFya2V5ICBhbmQgc2VsZi5Db25maWcubGFuZWNsZWFyLnVzZVcgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcubGFuZWNsZWFyLk1hbmEgLzEwMCApIGFuZCBHZXREaXN0YW5jZShtaW5pb24pIDw9IHNlbGYuV1NwZWxsLlJhbmdlIHRoZW4gDQogICAgICAgICAgICBsb2NhbCBCZXN0UG9zLCBCZXN0SGl0ID0gR2V0QmVzdENpcmN1bGFyRmFybVBvc2l0aW9uKHNlbGYuV1NwZWxsLlJhbmdlLCBzZWxmLldTcGVsbC5XaWR0aCwgc2VsZi5lbmVteU1pbmlvbnMub2JqZWN0cykNCiAgICAgICAgICAgIGlmIEJlc3RQb3Mgfj0gbmlsIHRoZW4NCiAgICAgICAgICAgICAgQ2FzdFNwZWxsKF9XLCBCZXN0UG9zLngsIEJlc3RQb3MueikNCiAgICAgICAgICBlbmQNCiAgICAgICAgZW5kDQogICAgICAgIGlmIHNlbGYuQ29uZmlnLktleXMubGFuZWNsZWFya2V5ICBhbmQgc2VsZi5Db25maWcubGFuZWNsZWFyLnVzZVIgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcubGFuZWNsZWFyLk1hbmEgLzEwMCApIGFuZCBHZXREaXN0YW5jZShtaW5pb24pIDw9IHNlbGYuV1NwZWxsLlJhbmdlIHRoZW4gDQogICAgICAgICAgICBsb2NhbCBCZXN0UG9zLCBCZXN0SGl0ID0gR2V0QmVzdENpcmN1bGFyRmFybVBvc2l0aW9uKHNlbGYuV1NwZWxsLlJhbmdlLCBzZWxmLldTcGVsbC5XaWR0aCwgc2VsZi5lbmVteU1pbmlvbnMub2JqZWN0cykNCiAgICAgICAgICAgIGlmIEJlc3RQb3Mgfj0gbmlsIHRoZW4NCiAgICAgICAgICAgICAgQ2FzdFNwZWxsKF9SLCBCZXN0UG9zLngsIEJlc3RQb3MueikNCiAgICAgICAgICBlbmQNCiAgICAgICAgZW5kICAgICAgICANCiAgICAgIGVuZA0KICAgIGVuZA0KICBlbmQNCiAgDQogIGZ1bmN0aW9uIExlYmxhbmM6SnVuZ2xlQ2xlYXIoKQ0KICBsb2NhbCBjbGVhcnRhcmdldCA9IG5pbA0KICAgICAgc2VsZi5lbmVteU1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIHNlbGYub3RoZXJNaW5pb25zOnVwZGF0ZSgpDQogICAgICBzZWxmLmp1bmdsZU1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIGZvciBpLCBtaW5pb24gaW4gaXBhaXJzKHNlbGYuZW5lbXlNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICAgIGlmIFZhbGlkVGFyZ2V0KG1pbmlvbiwgNjAwKSBhbmQgKGNsZWFydGFyZ2V0ID09IG5pbCBvciBub3QgVmFsaWRUYXJnZXQoY2xlYXJ0YXJnZXQpKSB0aGVuDQogICAgICAgICAgY2xlYXJ0YXJnZXQgPSBtaW5pb24NCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGZvciBpLCBqdW5nbGVtaW5pb24gaW4gaXBhaXJzKHNlbGYuanVuZ2xlTWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgICBpZiBWYWxpZFRhcmdldChqdW5nbGVtaW5pb24sIDYwMCkgYW5kIChjbGVhcnRhcmdldCA9PSBuaWwgb3Igbm90IFZhbGlkVGFyZ2V0KGNsZWFydGFyZ2V0KSkgdGhlbg0KICAgICAgICAgIGNsZWFydGFyZ2V0ID0ganVuZ2xlbWluaW9uDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBmb3IgaSwgb3RoZXJtaW5pb24gaW4gaXBhaXJzKHNlbGYub3RoZXJNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICAgIGlmIFZhbGlkVGFyZ2V0KG90aGVybWluaW9uLCA2MDApIGFuZCAoY2xlYXJ0YXJnZXQgPT0gbmlsIG9yIG5vdCBWYWxpZFRhcmdldChjbGVhcnRhcmdldCkpIHRoZW4NCiAgICAgICAgICBjbGVhcnRhcmdldCA9IG90aGVybWluaW9uDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBpZiBjbGVhcnRhcmdldCB+PSBuaWwgdGhlbg0KICAgICAgICBpZihzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyLnVzZVEgYW5kIHNlbGYuQ29uZmlnLktleXMuanVuZ2xlY2xlYXJrZXkgKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0UShjbGVhcnRhcmdldCkNCiAgICAgICAgZW5kDQogICAgICAgIGlmIGNsZWFydGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGlmKHNlbGYuV1NwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcuanVuZ2xlY2xlYXIudXNlVyBhbmQgc2VsZi5Db25maWcuS2V5cy5qdW5nbGVjbGVhcmtleSApIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyLk1hbmEgLzEwMCApIHRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RXKGNsZWFydGFyZ2V0KQ0KICAgICAgICBlbmQNCiAgICAgICAgaWYgY2xlYXJ0YXJnZXQgfj0gbmlsIHRoZW4NCiAgICAgICAgaWYoc2VsZi5FU3BlbGw6SXNSZWFkeSgpIGFuZCBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhci51c2VFIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmp1bmdsZWNsZWFya2V5ICkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuanVuZ2xlY2xlYXIuTWFuYSAvMTAwICkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEUoY2xlYXJ0YXJnZXQpDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgZW5kDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzp3VXNlZCgpIA0KICAgIGxvY2FsIGxlYmxhbmNXID0gbXlIZXJvOkdldFNwZWxsRGF0YShfVykNCiAgICBpZiBsZWJsYW5jVy5uYW1lID09ICJsZWJsYW5jc2xpZGVyZXR1cm4iIHRoZW4gDQogICAgICByZXR1cm4gdHJ1ZSANCiAgICBlbHNlIA0KICAgICAgcmV0dXJuIGZhbHNlDQogICAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOnJVc2VkKCkgDQogICAgbG9jYWwgbGVibGFuY1IgPSBteUhlcm86R2V0U3BlbGxEYXRhKF9SKQ0KICAgIGlmIGxlYmxhbmNSLm5hbWUgPT0gIkxlYmxhbmNTbGlkZU0iIHRoZW4gDQogICAgICByZXR1cm4gZmFsc2UNCiAgICBlbHNlIA0KICAgICAgcmV0dXJuIHRydWUNCiAgICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6UUV1c2VkKCkgDQogICAgbG9jYWwgbGVibGFuY1EgPSBzZWxmLlFTcGVsbDpJc1JlYWR5KCkNCiAgICBsb2NhbCBsZWJsYW5jRSA9IHNlbGYuRVNwZWxsOklzUmVhZHkoKQ0KICAgIGlmIChsZWJsYW5jUSBhbmQgbGVibGFuY0UpIHRoZW4gDQogICAgICByZXR1cm4gZmFsc2UgDQogICAgZWxzZSANCiAgICAgIHJldHVybiB0cnVlDQogICAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOkVRdXNlZCgpIA0KICAgIGxvY2FsIGxlYmxhbmNXID0gc2VsZi5FU3BlbGw6SXNSZWFkeSgpDQogICAgbG9jYWwgbGVibGFuY0UgPSBzZWxmLlFTcGVsbDpJc1JlYWR5KCkNCiAgICBpZiAobGVibGFuY1cgYW5kIGxlYmxhbmNFKSB0aGVuIA0KICAgICAgcmV0dXJuIGZhbHNlIA0KICAgIGVsc2UgDQogICAgICByZXR1cm4gdHJ1ZQ0KICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpFV3VzZWQoKSANCiAgICBsb2NhbCBsZWJsYW5jVyA9IHNlbGYuRVNwZWxsOklzUmVhZHkoKQ0KICAgIGxvY2FsIGxlYmxhbmNFID0gc2VsZi5XU3BlbGw6SXNSZWFkeSgpDQogICAgaWYgKGxlYmxhbmNXIGFuZCBsZWJsYW5jRSkgdGhlbiANCiAgICAgIHJldHVybiBmYWxzZSANCiAgICBlbHNlIA0KICAgICAgcmV0dXJuIHRydWUNCiAgICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6UVJ1c2VkKCkgDQogICAgbG9jYWwgbGVibGFuY1cgPSBzZWxmLlFTcGVsbDpJc1JlYWR5KCkNCiAgICBsb2NhbCBsZWJsYW5jRSA9IHNlbGYuUlNwZWxsOklzUmVhZHkoKQ0KICAgIGlmIChsZWJsYW5jVyBhbmQgbGVibGFuY0UpIHRoZW4gDQogICAgICByZXR1cm4gZmFsc2UgDQogICAgZWxzZSANCiAgICAgIHJldHVybiB0cnVlDQogICAgZW5kDQogIGVuZA0KICBsb2NhbCBzcGVsbExldmVsID0gMA0KICBmdW5jdGlvbiBMZWJsYW5jOmF1dG9sZXZlbCgpDQppZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDEgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2UxID0gICB7IDEsMiwzLDEsMSw0LDEsMiwxLDIsNCwyLDIsMywzLDQsMywzfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2UxKQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gMiBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTIgPSAgIHsgMSwyLDMsMSwxLDQsMSwzLDEsMyw0LDMsMywyLDIsNCwyLDJ9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTIpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSAzIGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlMyA9ICB7IDIsMywxLDIsMiw0LDIsMSwyLDEsNCwxLDEsMywzLDQsMywzfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2UzKQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gNCBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTQgPSAgeyAyLDMsMSwyLDIsNCwyLDMsMiwzLDQsMywzLDEsMSw0LDEsMX0NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlNCkNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDUgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2U1ID0gIHsgMywxLDIsMywzLDQsMywyLDMsMiw0LDIsMiwxLDEsNCwxLDF9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTUpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSA2IGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlNiA9ICB7IDMsMSwyLDMsMyw0LDMsMSwzLDEsNCwxLDEsMiwyLDQsMiwyfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2U2KQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogICAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSA3IGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlNiA9ICB7IDIsMSwzLDIsMSw0LDIsMiwxLDMsNCwyLDEsMSwzLDQsMywzfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2U2KQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOmF1dG96aG9ueWEoKQ0KICAgIGlmIHNlbGYuQ29uZmlnLml0ZW0uZW5hYmxlYXV0b3pob255YSB0aGVuDQogICAgIGZvciBfID0gSVRFTV8xLCBJVEVNXzcgZG8NCiAgICAgIGlmIG15SGVyby5oZWFsdGggPD0gKG15SGVyby5tYXhIZWFsdGggKiBzZWxmLkNvbmZpZy5pdGVtLmF1dG96aG9ueWEgLyAxMDApIGFuZCAoIG15SGVybzpDYW5Vc2VTcGVsbChfKSA9PSAwIGFuZCBteUhlcm86R2V0U3BlbGxEYXRhKF8pLm5hbWUgPT0gIlpob255YXNIb3VyZ2xhc3MiICl0aGVuIENhc3RTcGVsbChfKQ0KICAgIGVuZA0KICAgIGVuZA0KICAgIGVuZA0KICAgIGVuZA0KICAgIGZ1bmN0aW9uIExlYmxhbmM6ZXNjYXBlZm9yZ2FwKCkNCiAgaWYgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLmdhcGNsb3NlIGFuZCBub3Qgc2VsZjp3VXNlZCgpIHRoZW4NCiAgQ2FzdFNwZWxsKF9XLG1vdXNlUG9zLngsbW91c2VQb3MueikNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOmVzY2FwZSgpDQogIGlmIHNlbGYuQ29uZmlnLktleXMuZXNjYXBla2V5ICBhbmQgc2VsZi5Db25maWcuZXNjYXBlLnVzZVcgYW5kIG5vdCBzZWxmOndVc2VkKCkgdGhlbg0KICBDYXN0U3BlbGwoX1csbW91c2VQb3MueCxtb3VzZVBvcy56KQ0KICBlbmQNCiAgaWYgc2VsZi5Db25maWcuS2V5cy5lc2NhcGVrZXkgIHRoZW4gDQogIHNlbGY6d2FsaygpDQogIGVuZA0KICBpZiBzZWxmLkNvbmZpZy5LZXlzLmVzY2FwZWtleSAgYW5kIHNlbGYuQ29uZmlnLmVzY2FwZS51c2VSIGFuZCBub3QgIHNlbGY6clVzZWQoKSB0aGVuDQogIENhc3RTcGVsbChfUixtb3VzZVBvcy54LG1vdXNlUG9zLnopDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzp3YWxrKCkNCiAgICBteUhlcm86TW92ZVRvKG1vdXNlUG9zLngsbW91c2VQb3MueikNCiAgZW5kDQogIGZ1bmN0aW9uIExlYmxhbmM6Z2FwY2xvc2UoKQ0KICBpZiB0YXJnZXQgYW5kIEdldERpc3RhbmNlKHRhcmdldCxteUhlcm8pPjgwMCB0aGVuIA0KICBzZWxmOmVzY2FwZWZvcmdhcCgpDQogICAgICBlbmQgDQogIA0KICBlbmQNCiAgZnVuY3Rpb24gTGVibGFuYzpUQVJHRVRDUygpDQogICAgICBsb2NhbCBUYXJnZXQgPSBuaWwNCiAgICAgIGlmIHNlbGYuc2VsZWN0ZWRUYXIgdGhlbiBUYXJnZXQgPSBzZWxmLnNlbGVjdGVkVGFyDQogICAgICBlbHNlIFRhcmdldCA9IHNlbGYudHN3LnRhcmdldA0KICAgICAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOlduZE1zZyhNc2csIEtleSkNCiAgaWYgc2VsZi5Db25maWcuS2V5cy5jb21ib21vZGUgdGhlbg0KICBzZWxmLkNvbmZpZy5jb21iby5sb2dpYyA9IHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljICsxDQogIGlmIHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID4gNSB0aGVuIHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID0gMSBlbmQNCiAgZW5kDQogIGlmIHNlbGYuQ29uZmlnLnRhcmdldHNlbC50cyB0aGVuICAgICAgDQogICAgICAgICAgaWYgTXNnID09IFdNX0xCVVRUT05ET1dOIHRoZW4NCiAgICAgICAgICAgICAgbG9jYWwgbWluRCA9IDEwDQogICAgICAgICAgICAgIGxvY2FsIHN0YXJnZXQgPSBuaWwNCiAgICAgICAgICAgICAgZm9yIGksIGVuZW15IGluIGlwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbw0KICAgICAgICAgICAgICAgICAgaWYgVmFsaWRUYXJnZXQoZW5lbXkpIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICBpZiBHZXREaXN0YW5jZShlbmVteSwgbW91c2VQb3MpIDw9IG1pbkQgb3Igc3RhcmdldCA9PSBuaWwgdGhlbg0KICAgICAgICAgICAgICAgICAgICAgICAgICBtaW5EID0gR2V0RGlzdGFuY2UoZW5lbXksIG1vdXNlUG9zKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFyZ2V0ID0gZW5lbXkNCiAgICAgICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICBlbmQgICAgIA0KICAgICAgICAgICAgICBpZiBzdGFyZ2V0IGFuZCBtaW5EIDwgNTAwIHRoZW4NCiAgICAgICAgICAgICAgICAgIGlmIHNlbGYuc2VsZWN0ZWRUYXIgYW5kIHN0YXJnZXQuY2hhck5hbWUgPT0gc2VsZi5zZWxlY3RlZFRhci5jaGFyTmFtZSB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgc2VsZi5zZWxlY3RlZFRhciA9IG5pbA0KICAgICAgICAgICAgICAgICAgICAgIHByaW50KCI8Zm9udCBjb2xvcj1cIiNDQkY2RkZcIj5UYXJnZXQgPGI+aXMgbm8gbG9nZXIgc2VsZWN0ZWQuPC9iPjogIi4uc3RhcmdldC5jaGFyTmFtZS4uIjwvZm9udD4iKQ0KICAgICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWRUYXIgPSBzdGFyZ2V0ICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgcHJpbnQoIjxmb250IGNvbG9yPVwiI0NCRjZGRlwiPk5ldyB0YXJnZXQgPGI+c2VsZWN0ZWQuPC9iPjogIi4uc3RhcmdldC5jaGFyTmFtZS4uIjwvZm9udD4iKQ0KICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgIGVuZA0KICAgICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBlbmQNCiAgLS0gQWxsIGNsYXNzaWMgbmVjZXNzZXJpZXMgc3RhcnQNCiAgLS0gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tTGVCbGFuYyBFbmRpbmctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogIC0tIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLUxlQmxhbmMgRW5kaW5nLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAtLSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1MZUJsYW5jIEVuZGluZy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgLS0gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tTGVCbGFuYyBFbmRpbmctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogIGNsYXNzICJBa2FsaSINCiAgZnVuY3Rpb24gQWthbGk6X19pbml0KCkNCnNlbGYudHM9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDcwMCwgREFNQUdFX1BIWVNJQ0FMLCBmYWxzZSwgdHJ1ZSkNCnNlbGYudHNxPSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCA2MDAsIERBTUFHRV9QSFlTSUNBTCwgZmFsc2UsIHRydWUpDQpzZWxmLnRzdz0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgNzAwLCBEQU1BR0VfUEhZU0lDQUwsIGZhbHNlLCB0cnVlKQ0Kc2VsZi50c2U9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDMyNSwgREFNQUdFX1BIWVNJQ0FMLCBmYWxzZSwgdHJ1ZSkNCnNlbGYudHNyPSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCA3MDAsIERBTUFHRV9QSFlTSUNBTCwgZmFsc2UsIHRydWUpDQpzZWxmLnRzZz0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgOTI1LCBEQU1BR0VfTUFHSUMsIGZhbHNlLCB0cnVlKQ0KICAgc2VsZi5RU3BlbGwgPSBfU3BlbGwoe1Nsb3QgPSBfUSwgRGFtYWdlTmFtZSA9ICJRIiwgUmFuZ2UgPSA2MDAsIENvbGxpc2lvbiA9IGZhbHNlLCBBb2UgPSBmYWxzZSwgVHlwZSA9IFNQRUxMX1RZUEUuVEFSR0VUVEVEfSkNCiAgIHNlbGYuV1NwZWxsID0gX1NwZWxsKHtTbG90ID0gX1csIERhbWFnZU5hbWUgPSAiVyIsIFJhbmdlID0gNzAwLCBDb2xsaXNpb24gPSBmYWxzZSwgQW9lID0gdHJ1ZSwgVHlwZSA9IFNQRUxMX1RZUEUuU0VMRn0pDQogICBzZWxmLkVTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9FLCBEYW1hZ2VOYW1lID0gIkUiLCBSYW5nZSA9IDMyNSwgQ29sbGlzaW9uID0gZmFsc2UsIEFvZSA9IHRydWUsIFR5cGUgPSBTUEVMTF9UWVBFLlNFTEZ9KQ0KICAgc2VsZi5SU3BlbGwgPSBfU3BlbGwoe1Nsb3QgPSBfUiwgRGFtYWdlTmFtZSA9ICJSIiwgUmFuZ2UgPTcwMCwgIENvbGxpc2lvbiA9IGZhbHNlLCBBb2UgPSBmYWxzZSwgVHlwZSA9IFNQRUxMX1RZUEUuVEFSR0VUVEVEfSkNCiAgIHNlbGYuSWduaXRlID0gX1NwZWxsKHtTbG90ID0gRmluZFN1bW1vbmVyU2xvdCgic3VtbW9uZXJkb3QiKSwgRGFtYWdlTmFtZSA9ICJJR05JVEUiLCBSYW5nZSA9IDYwMCwgVHlwZSA9IFNQRUxMX1RZUEUuVEFSR0VUVEVEfSkNCi0tfD4gTWluaW9uIE1hbmFnZXJzDQogICAgc2VsZi5lbmVteU1pbmlvbnMgICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX0VORU1ZLCAgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgIHNlbGYuYWxseU1pbmlvbnMgICAgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9BTExZLCAgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgIHNlbGYuanVuZ2xlTWluaW9ucyAgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9KVU5HTEUsICA2NTAsIG15SGVybywgTUlOSU9OX1NPUlRfTUFYSEVBTFRIX0RFQykNCiAgICBzZWxmLm90aGVyTWluaW9ucyAgID0gbWluaW9uTWFuYWdlcihNSU5JT05fT1RIRVIsICAgNjUwLCBteUhlcm8sIE1JTklPTl9TT1JUX01BWEhFQUxUSF9ERUMpDQogICAgc2VsZjpMb2FkTWVudSgpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gMA0KICAgICAgc2VsZjpmaW5kb3Jid2Fsa2VyKCkNCiAgICAgICAgLS0gaWYgVklQX1VTRVIgdGhlbiAgc2VsZjpza2luaGFjaygpIGVuZA0KICAgICAgQWRkVGlja0NhbGxiYWNrKGZ1bmN0aW9uKCkgc2VsZjpUaWNrKCkgZW5kKQ0KICBBZGREcmF3Q2FsbGJhY2soZnVuY3Rpb24oKSBzZWxmOkRyYXcoKSBlbmQpDQogIEFkZE1zZ0NhbGxiYWNrKGZ1bmN0aW9uKG1zZyxLZXkpIHNlbGY6V25kTXNnKG1zZyxLZXkpIGVuZCkNCiAgLS1BZGRBbmltYXRpb25DYWxsYmFjayhmdW5jdGlvbih1bml0LCBhbmltYXRpb24pIHNlbGY6QW5pbWF0aW9uKHVuaXQsIGFuaW1hdGlvbikgZW5kKQ0KICAtLUFkZFByb2Nlc3NTcGVsbENhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIHNwZWxsKSBzZWxmOlByb2Nlc3NTcGVsbCh1bml0LCBzcGVsbCkgZW5kKQ0KICAtLUFkZEFwcGx5QnVmZkNhbGxiYWNrKGZ1bmN0aW9uKHNvdXJjZSwgdW5pdCwgYnVmZikgc2VsZjpPbkFwcGx5QnVmZihzb3VyY2UsIHVuaXQsIGJ1ZmYpIGVuZCkNCiAgLS1BZGRVcGRhdGVCdWZmQ2FsbGJhY2soZnVuY3Rpb24odW5pdCwgYnVmZiwgc3RhY2tzKSBzZWxmOlVwZGF0ZUJ1ZmYodW5pdCwgYnVmZiwgc3RhY2tzKSBlbmQpDQogIC0tQWRkUmVtb3ZlQnVmZkNhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIGJ1ZmYpIHNlbGY6T25SZW1vdmVCdWZmKHVuaXQsIGJ1ZmYpIGVuZCkgDQogIGVuZA0KICBmdW5jdGlvbiBBa2FsaTpUaWNrKCkNCiAgc2VsZjphdXRvemhvbnlhKCkNCiAgc2VsZjpBdXRvc3RlYWx0aCgpDQogIHNlbGY6YXV0b3EoKQ0KICAgICAgICBzZWxmOmNoZWNrdHMoKQ0KICAgICAgICBpZiBWSVBfVVNFUiB0aGVuIHNlbGY6YXV0b2xldmVsKCkgZW5kDQogaWYoc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSBhbmQgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5SbG9naWMubG9naWMgPT0gMSApdGhlbg0KICAgIHNlbGY6Y29tYm8oKQ0KICBlbmQNCiAgIGlmKHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgYW5kIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljLmxvZ2ljID09IDIgKXRoZW4NCiAgICBzZWxmOmNvbWJvMigpDQogIGVuZA0KICAgICAgaWYoc2VsZi5Db25maWcuS2V5cy5qdW5nbGVjbGVhcmtleSApdGhlbg0KICAgc2VsZjpKdW5nbGVDbGVhcigpDQogIGVuZA0KICAgIGlmKHNlbGYuQ29uZmlnLktleXMubGFuZWNsZWFya2V5ICl0aGVuDQogICAgc2VsZjpMYW5lQ2xlYXIoKQ0KICBlbmQNCiAgaWYoc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzICkgdGhlbg0KICAgIHNlbGY6a2lsbHN0ZWFsKCkNCiAgZW5kDQogIGlmKHNlbGYuQ29uZmlnLktleXMuaGFyYXNza2V5ICApIHRoZW4NCiAgICBzZWxmOmhhcmFzcygpDQogIGVuZA0KICAgICAgaWYoc2VsZi5Db25maWcuS2V5cy5lc2NhcGVrZXkgKXRoZW4NCiAgICAgIHNlbGY6ZXNjYXBlKCkNCiAgICBlbmQNCiAgZW5kDQogICAgZnVuY3Rpb24gQWthbGk6d2FsaygpDQogICAgbXlIZXJvOk1vdmVUbyhtb3VzZVBvcy54LG1vdXNlUG9zLnopDQogIGVuZA0KICBmdW5jdGlvbiBBa2FsaTplc2NhcGUoKQ0KICAgaWYgc2VsZi5Db25maWcuS2V5cy5lc2NhcGVrZXkgIGFuZCBzZWxmLkNvbmZpZy5lc2NhcGUudXNlVyB0aGVuDQogIENhc3RTcGVsbChfVyxtb3VzZVBvcy54LG1vdXNlUG9zLnopDQogIGVuZA0KICBpZiBzZWxmLkNvbmZpZy5LZXlzLmVzY2FwZWtleSAgdGhlbiANCiAgc2VsZjp3YWxrKCkNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBBa2FsaTpEcmF3KCkNCiAgICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LnFkcmF3IGFuZCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkgdGhlbg0KICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCA2MDAsIDEscmVkKQ0KICBlbmQNCg0KICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LndkcmF3IGFuZCBzZWxmLldTcGVsbDpJc1JlYWR5KCkgdGhlbg0KICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCA3MDAsIDEsIHJlZCkNCiAgZW5kDQoNCiAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5lZHJhdyBhbmQgc2VsZi5FU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgMzI1LCAxLCByZWQpDQogIGVuZA0KICANCiAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5yZHJhdyBhbmQgc2VsZi5SU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgNzAwLDEsIHJlZCkNCiAgZW5kDQogIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcuYWFkcmF3IHRoZW4NCiAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgMTAwLDEsIEFSR0IoMjU1LCAyNTUsMCwwKSkNCiAgZW5kDQogICAgICAgICAgaWYgc2VsZi5Db25maWcub3RoZXIudGFyZ2V0IGFuZCBzZWxmLnNlbGVjdGVkVGFyIH49IG5pbCB0aGVuDQogICAgICAgICBEcmF3Q2lyY2xlM0Qoc2VsZi5zZWxlY3RlZFRhci54LCBzZWxmLnNlbGVjdGVkVGFyLnksIHNlbGYuc2VsZWN0ZWRUYXIueiwgODAsNiwgQVJHQigyNTUsIDI1NSwwLDApKQ0KZW5kDQogIGlmIHNlbGYuQ29uZmlnLm90aGVyLnRhcmdldGNhbCBhbmQgbm90IG15SGVyby5kZWFkIHRoZW4NCiAgICAgIGlmIHRhcmdldCBhbmQgdGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGxvY2FsIGRyYXdwb3M9V29ybGRUb1NjcmVlbihEM0RYVkVDVE9SMyh0YXJnZXQueCwgdGFyZ2V0LnksIHRhcmdldC56KSkNCiAgICAgICAgbG9jYWwgY29tYm9UZXh0LGNvbG9yID0gc2VsZjpHZXREcmF3cyh0YXJnZXQpDQogICAgICAgIGlmIGNvbWJvVGV4dCB0aGVuDQogICAgICAgICAgRHJhd1RleHQoY29tYm9UZXh0LDE1LGRyYXdwb3MueC0yMCxkcmF3cG9zLnktMjAsY29sb3IpDQogICAgICAgIGVuZCANCiAgICAgIGVuZCANCiAgICAgIGVuZA0KICAgICAgZW5kDQogDQpmdW5jdGlvbiBBa2FsaTpidWZmKHVuaXQpDQogcmV0dXJuIFRhcmdldEhhdmVCdWZmKCdBa2FsaU1vdGEnLCB1bml0KQ0KZW5kDQoNCiAgZnVuY3Rpb24gQWthbGk6c2tpbmhhY2soKQ0KaWYgbm90IHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgdGhlbiBTZW5kU2tpblBhY2tldChteUhlcm8uY2hhck5hbWUsIHNraW5zUEJbMV0sIG15SGVyby5uZXR3b3JrSUQpOyBlbHNlDQppZiBzZWxmLkNvbmZpZy52aXAuc2tpbi5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgIHRoZW4NClNlbmRTa2luUGFja2V0KG15SGVyby5jaGFyTmFtZSwgc2tpbnNQQltzZWxmLkNvbmZpZy52aXAuc2tpblsnc2VsZWN0ZWQnIC4uIG15SGVyby5jaGFyTmFtZSAuLiAnU2tpbiddXSwgbXlIZXJvLm5ldHdvcmtJRCk7DQplbmQNCmVuZA0KZW5kDQoNCiBmdW5jdGlvbiBBa2FsaTphdXRvbGV2ZWwoKQ0KaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSAxIGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlMSA9ICAgeyAxLDIsMywxLDEsNCwxLDIsMSwyLDQsMiwyLDMsMyw0LDMsM30NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlMSkNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDIgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2UyID0gICB7IDEsMiwzLDEsMSw0LDEsMywxLDMsNCwzLDMsMiwyLDQsMiwyfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2UyKQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gMyBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTMgPSAgeyAyLDMsMSwyLDIsNCwyLDEsMiwxLDQsMSwxLDMsMyw0LDMsM30NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlMykNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDQgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2U0ID0gIHsgMiwzLDEsMiwyLDQsMiwzLDIsMyw0LDMsMywxLDEsNCwxLDF9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTQpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSA1IGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlNSA9ICB7IDMsMSwyLDMsMyw0LDMsMiwzLDIsNCwyLDIsMSwxLDQsMSwxfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2U1KQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gNiBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTYgPSAgeyAzLDEsMiwzLDMsNCwzLDEsMywxLDQsMSwxLDIsMiw0LDIsMn0NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlNikNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICAgIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gNyBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTYgPSAgeyAxLDMsMiwxLDEsNCwxLDMsMSwzLDQsMywzLDIsMiw0LDIsMn0NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlNikNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gQWthbGk6YXV0b3pob255YSgpDQogIGlmIHNlbGYuQ29uZmlnLml0ZW0uZW5hYmxlYXV0b3pob255YSB0aGVuDQogICBmb3IgXyA9IElURU1fMSwgSVRFTV83IGRvDQogICAgaWYgbXlIZXJvLmhlYWx0aCA8PSAobXlIZXJvLm1heEhlYWx0aCAqIHNlbGYuQ29uZmlnLml0ZW0uYXV0b3pob255YSAvIDEwMCkgYW5kICggbXlIZXJvOkNhblVzZVNwZWxsKF8pID09IDAgYW5kIG15SGVybzpHZXRTcGVsbERhdGEoXykubmFtZSA9PSAiWmhvbnlhc0hvdXJnbGFzcyIgKXRoZW4gQ2FzdFNwZWxsKF8pDQogIGVuZA0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBBa2FsaTpjaGVja3RzKCkNCiAgICAgICBzZWxmLnRzOnVwZGF0ZSgpDQogICAgICAgc2VsZi50c2U6dXBkYXRlKCkNCiAgICAgICBzZWxmLnRzcTp1cGRhdGUoKQ0KICAgICAgIHNlbGYudHNyOnVwZGF0ZSgpDQogICAgICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgICAgICBzZWxmLnRzZzp1cGRhdGUoKQ0KaWYgbm90IHNlbGYudHNnLnRhcmdldH49bmlsIG9yIG5vdCBzZWxmLkNvbmZpZy50YXJnZXRzZWwudHMgdGhlbg0KdGFyZ2V0ID0gc2VsZi50cy50YXJnZXQNCmVsc2VpZiBzZWxmLnRzZy50YXJnZXR+PW5pbCBvciBzZWxmLnNlbGVjdGVkVGFyIHRoZW4NCnRhcmdldCA9IHNlbGYuc2VsZWN0ZWRUYXINCmVuZA0KZW5kDQogIGZ1bmN0aW9uIEFrYWxpOmNvbWJvKCkNCiAgbG9jYWwgYWJ1ZmYgPSBzZWxmOmJ1ZmYodGFyZ2V0KQ0KICBpZihzZWxmLnRzcS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgIGFuZCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICBzZWxmOkNhc3RRKHRhcmdldCkNCiAgIGVuZA0KICAgIGlmKHNlbGYudHNyLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VSIGFuZCBhYnVmZiBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgIGFuZCBub3Qgc2VsZi5RU3BlbGw6SXNSZWFkeSgpIGFuZCBzZWxmLlJTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICBzZWxmOkNhc3RSKHRhcmdldCkNCiAgIGVuZA0KICAgIGlmKHNlbGYudHNlLnRhcmdldH49bmlsICBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlRSBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgIGFuZCBzZWxmLkVTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICBzZWxmOkNhc3RFKHRhcmdldCkNCiAgIGVuZA0KICAgICAgIGlmKHNlbGYuQ29uZmlnLmNvbWJvLnVzZUkgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLmNvbWJva2V5ICl0aGVuDQogICAgZm9yIF8sIHVuaXQgaW4gcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8NCiAgICAgIGxvY2FsIGRtZ0kgPSg1MCsgKChteUhlcm8ubGV2ZWwpKjIwKSkNCiAgICAgIGxvY2FsIGhlYWx0aD11bml0LmhlYWx0aA0KICAgICAgaWYoaGVhbHRoPGRtZ0kgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZUkgYW5kIEdldERpc3RhbmNlKHVuaXQpPDYwMCl0aGVuDQogICAgICAgIHNlbGY6Q2FzdEkodW5pdCkNCiAgICBlbmQNCiAgICBlbmQNCiAgZW5kDQogIGVuZA0KICAgIGZ1bmN0aW9uIEFrYWxpOmNvbWJvMigpDQogIGlmKHNlbGYudHNxLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VRIGFuZCAgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgYW5kIHNlbGYuUVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgIHNlbGY6Q2FzdFEodGFyZ2V0KQ0KICAgZW5kDQogICAgaWYoc2VsZi50c3IudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVIgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICBhbmQgbm90IHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5SU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0Uih0YXJnZXQpDQogICBlbmQNCiAgICBpZihzZWxmLnRzZS50YXJnZXR+PW5pbCAgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZUUgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICBhbmQgc2VsZi5FU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0RSh0YXJnZXQpDQogICBlbmQNCiAgICAgICBpZihzZWxmLkNvbmZpZy5jb21iby51c2VJIGFuZCBzZWxmLkNvbmZpZy5jb21iby5jb21ib2tleSApdGhlbg0KICAgIGZvciBfLCB1bml0IGluIHBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvDQogICAgICBsb2NhbCBkbWdJID0oNTArICgobXlIZXJvLmxldmVsKSoyMCkpDQogICAgICBsb2NhbCBoZWFsdGg9dW5pdC5oZWFsdGgNCiAgICAgIGlmKGhlYWx0aDxkbWdJIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VJIGFuZCBHZXREaXN0YW5jZSh1bml0KTw2MDApdGhlbg0KICAgICAgICBzZWxmOkNhc3RJKHVuaXQpDQogICAgZW5kDQogICAgZW5kDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gQWthbGk6aGFyYXNzKCkNCiAgaWYoc2VsZi50c3EudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmhhcmFzcy51c2VRIGFuZCAgc2VsZi5Db25maWcuS2V5cy5oYXJhc3NrZXkgIGFuZCBzZWxmLlFTcGVsbDpJc1JlYWR5KCkpdGhlbg0KICAgICAgICBzZWxmOkNhc3RRKHRhcmdldCkNCiAgIGVuZA0KICAgIGlmKHNlbGYudHNlLnRhcmdldH49bmlsICBhbmQgc2VsZi5Db25maWcuaGFyYXNzLnVzZUUgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmhhcmFzc2tleSAgYW5kIHNlbGYuRVNwZWxsOklzUmVhZHkoKSl0aGVuDQogICAgICAgIHNlbGY6Q2FzdEUodGFyZ2V0KQ0KICAgZW5kDQogIGVuZA0KICAgIGZ1bmN0aW9uIEFrYWxpOkp1bmdsZUNsZWFyKCkNCiAgIGxvY2FsIGNsZWFydGFyZ2V0ID0gbmlsDQogICAgICBzZWxmLmVuZW15TWluaW9uczp1cGRhdGUoKQ0KICAgICAgc2VsZi5vdGhlck1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIHNlbGYuanVuZ2xlTWluaW9uczp1cGRhdGUoKQ0KICAgICAgZm9yIGksIG1pbmlvbiBpbiBpcGFpcnMoc2VsZi5lbmVteU1pbmlvbnMub2JqZWN0cykgZG8NCiAgICAgICAgaWYgVmFsaWRUYXJnZXQobWluaW9uLCA2MDApIGFuZCAoY2xlYXJ0YXJnZXQgPT0gbmlsIG9yIG5vdCBWYWxpZFRhcmdldChjbGVhcnRhcmdldCkpIHRoZW4NCiAgICAgICAgICBjbGVhcnRhcmdldCA9IG1pbmlvbg0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgZm9yIGksIGp1bmdsZW1pbmlvbiBpbiBpcGFpcnMoc2VsZi5qdW5nbGVNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICAgIGlmIFZhbGlkVGFyZ2V0KGp1bmdsZW1pbmlvbiwgNjAwKSBhbmQgKGNsZWFydGFyZ2V0ID09IG5pbCBvciBub3QgVmFsaWRUYXJnZXQoY2xlYXJ0YXJnZXQpKSB0aGVuDQogICAgICAgICAgY2xlYXJ0YXJnZXQgPSBqdW5nbGVtaW5pb24NCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGZvciBpLCBvdGhlcm1pbmlvbiBpbiBpcGFpcnMoc2VsZi5vdGhlck1pbmlvbnMub2JqZWN0cykgZG8NCiAgICAgICAgaWYgVmFsaWRUYXJnZXQob3RoZXJtaW5pb24sIDYwMCkgYW5kIChjbGVhcnRhcmdldCA9PSBuaWwgb3Igbm90IFZhbGlkVGFyZ2V0KGNsZWFydGFyZ2V0KSkgdGhlbg0KICAgICAgICAgIGNsZWFydGFyZ2V0ID0gb3RoZXJtaW5pb24NCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGlmIGNsZWFydGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGlmKHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci51c2VRIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmp1bmdsZWNsZWFya2V5ICkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0UShjbGVhcnRhcmdldCkNCiAgICAgICAgZW5kDQogICAgICAgIGlmIGNsZWFydGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGlmKHNlbGYuUlNwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci51c2VSIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmp1bmdsZWNsZWFya2V5ICkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0UihjbGVhcnRhcmdldCkNCiAgICAgICAgZW5kDQogICAgICAgIGlmIGNsZWFydGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGlmKHNlbGYuRVNwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci51c2VFIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmp1bmdsZWNsZWFya2V5ICkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0RShjbGVhcnRhcmdldCkNCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICBlbmQNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBBa2FsaTpMYW5lQ2xlYXIoKQ0KICAgbG9jYWwgY2xlYXJ0YXJnZXQgPSBuaWwNCiAgICAgIHNlbGYuZW5lbXlNaW5pb25zOnVwZGF0ZSgpDQogICAgICBzZWxmLm90aGVyTWluaW9uczp1cGRhdGUoKQ0KICAgICAgc2VsZi5qdW5nbGVNaW5pb25zOnVwZGF0ZSgpDQogICAgICBmb3IgaSwgbWluaW9uIGluIGlwYWlycyhzZWxmLmVuZW15TWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgICBpZiBWYWxpZFRhcmdldChtaW5pb24sIDYwMCkgYW5kIChjbGVhcnRhcmdldCA9PSBuaWwgb3Igbm90IFZhbGlkVGFyZ2V0KGNsZWFydGFyZ2V0KSkgdGhlbg0KICAgICAgICAgIGNsZWFydGFyZ2V0ID0gbWluaW9uDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBmb3IgaSwganVuZ2xlbWluaW9uIGluIGlwYWlycyhzZWxmLmp1bmdsZU1pbmlvbnMub2JqZWN0cykgZG8NCiAgICAgICAgaWYgVmFsaWRUYXJnZXQoanVuZ2xlbWluaW9uLCA2MDApIGFuZCAoY2xlYXJ0YXJnZXQgPT0gbmlsIG9yIG5vdCBWYWxpZFRhcmdldChjbGVhcnRhcmdldCkpIHRoZW4NCiAgICAgICAgICBjbGVhcnRhcmdldCA9IGp1bmdsZW1pbmlvbg0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgZm9yIGksIG90aGVybWluaW9uIGluIGlwYWlycyhzZWxmLm90aGVyTWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgICBpZiBWYWxpZFRhcmdldChvdGhlcm1pbmlvbiwgNjAwKSBhbmQgKGNsZWFydGFyZ2V0ID09IG5pbCBvciBub3QgVmFsaWRUYXJnZXQoY2xlYXJ0YXJnZXQpKSB0aGVuDQogICAgICAgICAgY2xlYXJ0YXJnZXQgPSBvdGhlcm1pbmlvbg0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgaWYgY2xlYXJ0YXJnZXQgfj0gbmlsIHRoZW4NCiAgICAgICAgaWYoc2VsZi5RU3BlbGw6SXNSZWFkeSgpIGFuZCBzZWxmLkNvbmZpZy5mYXJtLmxhbmVjbGVhci51c2VRIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmp1bmdsZWNsZWFya2V5ICkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0UShjbGVhcnRhcmdldCkNCiAgICAgICAgZW5kDQogICAgICAgIGlmIGNsZWFydGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGlmKHNlbGYuUlNwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcuZmFybS5sYW5lY2xlYXIudXNlUiBhbmQgc2VsZi5Db25maWcuS2V5cy5qdW5nbGVjbGVhcmtleSApIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmZhcm0uanVuZ2xlY2xlYXIuTWFuYSAvMTAwICkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFIoY2xlYXJ0YXJnZXQpDQogICAgICAgIGVuZA0KICAgICAgICBpZiBjbGVhcnRhcmdldCB+PSBuaWwgdGhlbg0KICAgICAgICBpZihzZWxmLkVTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYuQ29uZmlnLmZhcm0ubGFuZWNsZWFyLnVzZUUgYW5kIHNlbGYuQ29uZmlnLktleXMuanVuZ2xlY2xlYXJrZXkgKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyLk1hbmEgLzEwMCApIHRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RFKGNsZWFydGFyZ2V0KQ0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgIGVuZA0KICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIEFrYWxpOkNhc3RRKHVuaXQpDQogIHNlbGYuUVNwZWxsOkNhc3QodW5pdCkNCmVuZA0KDQpmdW5jdGlvbiBBa2FsaTpDYXN0Vyh1bml0KQ0KICBzZWxmLldTcGVsbDpDYXN0KHVuaXQpDQplbmQNCg0KZnVuY3Rpb24gQWthbGk6Q2FzdEUodW5pdCkNCiAgc2VsZi5FU3BlbGw6Q2FzdCh1bml0KQ0KZW5kDQoNCmZ1bmN0aW9uIEFrYWxpOkNhc3RSKHVuaXQpDQogIHNlbGYuUlNwZWxsOkNhc3QodW5pdCkNCmVuZA0KZnVuY3Rpb24gQWthbGk6Q2FzdEkodW5pdCkNCiAgc2VsZi5JZ25pdGU6Q2FzdCh1bml0KQ0KZW5kDQogIGZ1bmN0aW9uIEFrYWxpOmF1dG9xKCkNCiAgICAgICAgIGlmKHNlbGYudHNxLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmF1dG9xIGFuZCAgc2VsZi5RU3BlbGw6SXNSZWFkeSgpKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0USh0YXJnZXQpDQogICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIEFrYWxpOkdldERyYXdzKHRhcmdldCkNCmxvY2FsIFFkbWc9Z2V0RG1nKCJRIix0YXJnZXQsbXlIZXJvKQ0KbG9jYWwgUWRtZzI9KG15SGVyby5hcCowLjUpDQpsb2NhbCBFZG1nPWdldERtZygiRSIsdGFyZ2V0LG15SGVybykNCmxvY2FsIFJkbWc9Z2V0RG1nKCJSIix0YXJnZXQsbXlIZXJvKQ0KbG9jYWwgSWRtZz0oNTArICgobXlIZXJvLmxldmVsKSoyMCkpDQogIA0KICBpZiBRZG1nID4gdGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRJywgUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIFFkbWcrSWRtZz50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBJZ25pdGUnLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgRWRtZz50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ0UnLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgRWRtZytJZG1nPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnRSArIElnbml0ZScsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogICAgICBlbHNlaWYgUmRtZz50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1InLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgUmRtZytJZG1nPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUiArIElnbml0ZScsIFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBRZG1nK0VkbWc+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgRScsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgICAgIGVsc2VpZiBRZG1nK1JkbWc+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgUicsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIFFkbWcrRWRtZytJZG1nPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIEUgKyBJZ25pdGUnLFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogICAgICBlbHNlaWYgUWRtZytSZG1nK0lkbWc+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgUiArIElnbml0ZScsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIFFkbWcrRWRtZytSZG1nK0lkbWc+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgUiArIEUgKyBJZ25pdGUnLFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBRZG1nK1JkbWcrRWRtZyA+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgUiArIEUnLFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2VpZiBRZG1nK1FkbWcyID4gdGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgUTInLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgUWRtZytJZG1nK1FkbWcyPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIFEyICsgSWduaXRlJywgUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIEVkbWc+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdFJywgUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIEVkbWcrSWRtZz50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ0UgKyBJZ25pdGUnLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICAgICAgZWxzZWlmIFJkbWc+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdSJywgUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIFJkbWcrSWRtZz50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1IgKyBJZ25pdGUnLCBSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgUWRtZytFZG1nK1FkbWcyPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIFEyICsgRScsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgICAgIGVsc2VpZiBRZG1nK1JkbWcrUWRtZzI+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgUTIgKyBSJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICBlbHNlaWYgUWRtZytFZG1nK0lkbWcrUWRtZzI+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgUTIgKyBFICsgSWduaXRlJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICAgICAgZWxzZWlmIFFkbWcrUmRtZytJZG1nK1FkbWcyPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnUSArIFEyICsgUiArIElnbml0ZScsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIFFkbWcrRWRtZytSZG1nK0lkbWcrUWRtZzI+dGFyZ2V0LmhlYWx0aCB0aGVuDQogICAgcmV0dXJuICdRICsgUTIgKyBSICsgRSArIElnbml0ZScsUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZWxzZWlmIFFkbWcrUmRtZytFZG1nK1FkbWcyID50YXJnZXQuaGVhbHRoIHRoZW4NCiAgICByZXR1cm4gJ1EgKyBRMiArIFIgKyBFJyxSR0JBKDAsIDI1NSwgMCwgMjU1KQ0KICAgICAgZWxzZWlmIChRZG1nK0VkbWcrUmRtZytJZG1nK1FkbWcyKSsoUWRtZytFZG1nK1JkbWcrSWRtZytRZG1nMikgPnRhcmdldC5oZWFsdGggdGhlbg0KICAgIHJldHVybiAnS2lsbCBXaXRoIDIgQ29tYm8nLFJHQkEoMCwgMjU1LCAwLCAyNTUpDQogIGVsc2UgDQogICAgcmV0dXJuICJDYW50IEtpbGwgeWV0IiwgUkdCQSgwLCAyNTUsIDAsIDI1NSkNCiAgZW5kIA0KZW5kDQogIGZ1bmN0aW9uIEFrYWxpOmtpbGxzdGVhbCgpDQpmb3IgXywgdW5pdCBpbiBwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbw0KICAgIGxvY2FsIGhlYWx0aCA9IHVuaXQuaGVhbHRoDQogICAgbG9jYWwgZG1nRSA9IGdldERtZygiRSIsIHVuaXQsIG15SGVybykNCiAgICAgIGlmKHNlbGYudHNlLnRhcmdldCB+PSBuaWwgYW5kICBzZWxmLkVTcGVsbDpJc1JlYWR5KCkgYW5kIGhlYWx0aDxkbWdFIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlRSAgIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MpdGhlbg0KICAgICAgICBzZWxmOkNhc3RFKHVuaXQpICANCiAgICAgIGVuZA0KICAgICAgbG9jYWwgZG1nUSA9IGdldERtZygiUSIsIHVuaXQsIG15SGVybykgDQogICAgICBpZihzZWxmLnRzcS50YXJnZXQgfj0gbmlsIGFuZCAgc2VsZi5RU3BlbGw6SXNSZWFkeSgpIGFuZCBoZWFsdGg8ZG1nUSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZVEgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyApdGhlbg0KICAgICAgICBzZWxmOkNhc3RRKHVuaXQpICANCiAgICAgIGVuZA0KICAgICAgIGxvY2FsIGRtZ0kgPSg1MCsgKChteUhlcm8ubGV2ZWwpKjIwKSkNCiAgICAgIGlmKGhlYWx0aDxkbWdJIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlSSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzIGFuZCBHZXREaXN0YW5jZSh1bml0KTw2MDApdGhlbg0KICAgICAgICBzZWxmOkNhc3RJKHVuaXQpDQogICAgICBlbmQNCiAgICAgIGxvY2FsIGRtZ1IgPWdldERtZygiUiIsdW5pdCxteUhlcm8pDQogICAgICBpZihzZWxmLnRzci50YXJnZXQgfj0gbmlsIGFuZCAgc2VsZi5SU3BlbGw6SXNSZWFkeSgpIGFuZCBoZWFsdGg8ZG1nUiBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZVIgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyBhbmQgR2V0RGlzdGFuY2UodW5pdCk8NTUwKXRoZW4NCiAgICAgICAgc2VsZjpDYXN0Uih1bml0KQ0KICAgICAgZW5kDQogICBlbmQNCmVuZA0KZnVuY3Rpb24gQWthbGk6aXRlbXMoKQ0KICBpZiBzZWxmLkNvbmZpZy5pdGVtLnVzZWJnIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5IHRoZW4NCiAgIGZvciBfID0gSVRFTV8xLCBJVEVNXzcgZG8NCiAgICBpZiAoIG15SGVybzpDYW5Vc2VTcGVsbChfKSA9PSAwIGFuZCBteUhlcm86R2V0U3BlbGxEYXRhKF8pLm5hbWUgPT0gIkJpbGdld2F0ZXJDdXRsYXNzIiApdGhlbiBDYXN0U3BlbGwoXykNCiAgZW5kDQogIGVuZA0KICBlbmQNCiAgaWYgc2VsZi5Db25maWcuaXRlbS51c2VoZyBhbmQgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSB0aGVuDQogICBmb3IgXyA9IElURU1fMSwgSVRFTV83IGRvDQogICAgaWYgKCBteUhlcm86Q2FuVXNlU3BlbGwoXykgPT0gMCBhbmQgbXlIZXJvOkdldFNwZWxsRGF0YShfKS5uYW1lID09ICJIZXh0ZWNoR3VuYmxhZGUiICl0aGVuIENhc3RTcGVsbChfKQ0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBlbmQNCiBmdW5jdGlvbiBBa2FsaTpBdXRvc3RlYWx0aCgpDQogICAgaWYgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5XbG9naWMudXNlVyBhbmQgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5XbG9naWMudXNlV2VuIHRoZW4NCiAgICAgICAgaWYgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5XbG9naWMudXNlV2UgPT0gMSB0aGVuDQogICAgICAgICAgICBpZiBDb3VudEVuZW15SGVyb0luUmFuZ2UoOTAwKSA+PSAyIHRoZW4NCiAgICAgICAgICAgICAgICBDYXN0U3BlbGwoX1csIG15SGVyby54LCBteUhlcm8ueikNCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbHNlaWYgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5XbG9naWMudXNlV2UgPT0gMiB0aGVuDQogICAgICAgICAgICBpZiBDb3VudEVuZW15SGVyb0luUmFuZ2UoOTAwKSA+PSAzIHRoZW4NCiAgICAgICAgICAgICAgICBDYXN0U3BlbGwoX1csIG15SGVyby54LCBteUhlcm8ueikNCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbHNlaWYgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5XbG9naWMudXNlV2UgPT0gMyB0aGVuDQogICAgICAgICAgICBpZiBDb3VudEVuZW15SGVyb0luUmFuZ2UoOTAwKSA+PSA0IHRoZW4NCiAgICAgICAgICAgICAgICBDYXN0U3BlbGwoX1csIG15SGVyby54LCBteUhlcm8ueikNCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbHNlaWYgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5XbG9naWMudXNlV2UgPT0gNCB0aGVuDQogICAgICAgICAgICBpZiBDb3VudEVuZW15SGVyb0luUmFuZ2UoOTAwKSA+PSA1IHRoZW4NCiAgICAgICAgICAgICAgICBDYXN0U3BlbGwoX1csIG15SGVyby54LCBteUhlcm8ueikNCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgICBlbmQNCiAgICBpZiBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLldsb2dpYy51c2VXaHAgYW5kIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuV2xvZ2ljLnVzZVcgdGhlbg0KICAgICAgICBpZiBteUhlcm8uaGVhbHRoIDw9IChteUhlcm8ubWF4SGVhbHRoICogc2VsZi5Db25maWcuc2tpbGxsb2dpYy5XbG9naWMuaHAgLyAxMDApIHRoZW4gDQogICAgICAgICAgICBDYXN0U3BlbGwoX1csIG15SGVyby54LCBteUhlcm8ueikNCiAgICAgICAgZW5kDQogICAgZW5kDQplbmQNCg0KICBmdW5jdGlvbiBBa2FsaTpMb2FkTWVudSgpDQogICAgICBzZWxmLkNvbmZpZz1zY3JpcHRDb25maWcoIiIuLlNjcmlwdG5hbWUuLiIiLCJtZW51IikNCg0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiQ29tYm8gU2V0dGluZ3MiLCAiY29tYm8iKQ0KICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZVEiLCAiVXNlIFEgaW4gQ29tYm8iLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlRSIsICJVc2UgRSBpbiBjb21ibyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VSIiwgIlVzZSBSIGluIGNvbWJvIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZUkiLCAiVXNlIElnbml0ZSBpZiB0YXJnZXQga2lsbGFibGUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDEwLCAxMCwgMTAwLCAwKQ0KICAgICANCiAgICAgIA0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiSGFyYXNzIFNldHRpbmdzIiwgImhhcmFzcyIpDQogICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6YWRkUGFyYW0oInVzZVEiLCAiSGFyYXNzIFdpdGggUSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczphZGRQYXJhbSgidXNlRSIsICJIYXJhc3MgV2l0aCBFIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgc2VsZi5Db25maWcuaGFyYXNzOmFkZFBhcmFtKCJNYW5hIiwiTWFuYSBNYW5hZ2VyICUiLFNDUklQVF9QQVJBTV9TTElDRSwgMTAsIDEwLCAxMDAsIDApDQogICAgICANCiAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIlNraWxsIExvZ2ljcyIsICJza2lsbGxvZ2ljIikNCiAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWM6YWRkU3ViTWVudSgiVyBTa2lsbCBMb2dpYyIsICJXbG9naWMiKSANCiAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuV2xvZ2ljOmFkZFBhcmFtKCJ1c2VXIiwgIlVzZSBTdGVhbHRoIChXKSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuV2xvZ2ljOmFkZFBhcmFtKCJ1c2VXaHAiLCAiVXNlIFN0ZWFsdGggaWYgaGVhbHQgJSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgZmFsc2UpDQogICAgICBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLldsb2dpYzphZGRQYXJhbSgiaHAiLCJIZWFsdGggTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDMwLCAxMCwgMTAwLCAwKQ0KICAgICAgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5XbG9naWM6YWRkUGFyYW0oInVzZVdlbiIsICJVc2UgU3RlYWx0aCBpZiBlbmVteSA+IiwgU0NSSVBUX1BBUkFNX09OT0ZGLCBmYWxzZSkNCiAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuV2xvZ2ljOmFkZFBhcmFtKCJ1c2VXZSIsICJVc2UgU3RlYWx0aCBpZiBlbmVteSA+IiwgU0NSSVBUX1BBUkFNX0xJU1QsIDEsIHsiMiBlbmVteSIsICIzIGVuZW15IiAsICI0IGVuZW15IiwiNSBlbmVteSIgfSkNCiAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWM6YWRkU3ViTWVudSgiUiBTa2lsbCBMb2dpYyIsICJSbG9naWMiKSANCiAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljOmFkZFBhcmFtKCJsb2dpYyIsICJSIFNraWxsIExvZ2ljIiwgU0NSSVBUX1BBUkFNX0xJU1QsIDEsIHsiVXNlIFIgaWYgUSBpcyBvbiB0YXJnZXQiLCAiUnVzaCBTa2lsbHMiIH0pDQogICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiRmFybSBTZXR0aW5ncyIsICJmYXJtIikNCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnLmZhcm06YWRkU3ViTWVudSgiTGFuZUNsZWFyIFNldHRpbmdzIiwibGFuZWNsZWFyIikNCiAgICAgICAgc2VsZi5Db25maWcuZmFybS5sYW5lY2xlYXI6YWRkUGFyYW0oInVzZVEiLCJVc2UgUSBvbiBMYW5lY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5mYXJtLmxhbmVjbGVhcjphZGRQYXJhbSgidXNlRSIsIlVzZSBFIG9uIExhbmVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmZhcm0ubGFuZWNsZWFyOmFkZFBhcmFtKCJ1c2VSIiwiVXNlIFIgb24gTGFuZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLmZhcm0ubGFuZWNsZWFyOmFkZFBhcmFtKCJNYW5hIiwiTWFuYSBNYW5hZ2VyICUiLFNDUklQVF9QQVJBTV9TTElDRSwgMzAsIDEwLCAxMDAsIDApDQogICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZy5mYXJtOmFkZFN1Yk1lbnUoIkp1bmdsZUNsZWFyIFNldHRpbmdzIiwianVuZ2xlY2xlYXIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyOmFkZFBhcmFtKCJ1c2VRIiwiVXNlIFEgb24gSnVuZ2xlY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyOmFkZFBhcmFtKCJ1c2VFIiwiVXNlIEUgb24gSnVuZ2xlY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyOmFkZFBhcmFtKCJ1c2VSIiwiVXNlIFIgb24gSnVuZ2xlY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhcjphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDMwLCAxMCwgMTAwLCAwKQ0KICAgICAgDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJLaWxsU3RlYWwgU2V0dGluZ3MiLCAia2lsbHN0ZWFsIikNCiAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgia3MiLCJLaWxsc3RlYWwgT24vT2ZmIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgidXNlUSIsICJTdGVhbCBXaXRoIFEiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZUUiLCAiU3RlYWwgV2l0aCBFIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJ1c2VSIiwgIlN0ZWFsIFdpdGggUiIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgidXNlSSIsICJTdGVhbCBXaXRoIElnbml0ZSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIA0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiRXNjYXBlIFNldHRpbmdzIiwiZXNjYXBlIikNCiAgICAgIHNlbGYuQ29uZmlnLmVzY2FwZTphZGRQYXJhbSgidXNlVyIsIlVzZSBXIFdoaWxlIEVzY2FwZSIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIA0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiSXRlbSBTZXR0aW5ncyIsICJpdGVtIikNCiAgICAgIHNlbGYuQ29uZmlnLml0ZW06YWRkUGFyYW0oImVuYWJsZWF1dG96aG9ueWEiLCAiQXV0byBaaG9ueWEiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIGZhbHNlKQ0KICAgICAgc2VsZi5Db25maWcuaXRlbTphZGRQYXJhbSgiYXV0b3pob255YSIsICJaaG9ueWEgaWYgSGVhbHRoIHVuZGVyIC0+ICUiLCBTQ1JJUFRfUEFSQU1fU0xJQ0UsIDEwLCAwLCAxMDAsIDApDQogICAgICBzZWxmLkNvbmZpZy5pdGVtOmFkZFBhcmFtKCJ1c2VoZyIsICJVc2UgSGV4dGVjaCBHdW5ibGFkZSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLml0ZW06YWRkUGFyYW0oInVzZWJnIiwgIlVzZSBCaWxnZXdhdGVyIEN1dGxhc3MiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICANCiAgICAgIGlmIFZJUF9VU0VSIHRoZW4NCiAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIlZJUCBTZXR0aW5ncyIsICJ2aXAiKQ0KICAgICAgc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJwYWNrZXQiLCJVc2UgUGFja2V0IENhc3RpbmciLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzEiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm8yIiwgIlRvIHVzZSB2aXAgc2V0dGluZ3MsIFBhY2tldCBDYXN0aW5nIHNob3VsZCBiZSBvcGVuLiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcudmlwOmFkZFN1Yk1lbnUoIkF1dG8gTGV2ZWwgU2V0dGluZ3MiLCAibGV2ZWwiKQ0KICAgICAgc2VsZi5Db25maWcudmlwLmxldmVsOmFkZFBhcmFtKCJrZXkiLCJVc2UgQXV0byBMZXZlbCIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgc2VsZi5Db25maWcudmlwLmxldmVsOmFkZFBhcmFtKCJsb2dpYyIsICJTZWxlY3QgU2tpbGwgT3JkZXIiLCBTQ1JJUFRfUEFSQU1fTElTVCwgMiwgeyJGb2N1cyBRPlc+RSIsICJGb2N1cyBRPkU+VyIsIkZvY3VzIFc+UT5FIiwiRm9jdXMgVz5FPlEiLCJGb2N1cyBFPlc+USIsICJGb2N1cyBFPlE+VyIsIlNtYXJ0IiAgfSkNCiAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRTdWJNZW51KCJTa2luIEhhY2sgU2V0dGluZ3MiLCAic2tpbiIpDQogICAgICBzZWxmLkNvbmZpZy52aXAuc2tpbjphZGRQYXJhbSgia2V5IiwiVXNlIFNraW4gSGFjayIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgc2VsZi5Db25maWcudmlwLnNraW46YWRkUGFyYW0oJ3NlbGVjdGVkJyAuLiBteUhlcm8uY2hhck5hbWUgLi4gJ1NraW4nLCAiU2VsZWN0IFNraW4iLCBTQ1JJUFRfUEFSQU1fTElTVCwgMSwgeyJPcmlnaW5hbCIsICIgTnVyc2UgQWthbGkgIiwiQWxsLXN0YXIgQWthbGkiLCIgQmxvb2QgTW9vbiBBa2FsaSIsIkhlYWRodW50ZXIgQWthbGkiLCJTdGluZ2VyIEFrYWxpIiB9KQ0KICAgICAgc2VsZi5Db25maWcudmlwLnNraW46YWRkUGFyYW0oImluZm80IiwgIlRvIHVzZSBza2luIGhhY2ssIFlvdSBuZWVkIHRvIDJ4IEY5IGFmdGVyIHlvdSBzZWxlY3QgdGhlIHNraW4geW91IGRlc2lyZS4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLnZpcC5za2luOmFkZFBhcmFtKCJpbmZvNSIsICJNYWtlIHN1cmUgdGhhdCB1c2luZyBwYWNrZXQgY2FzdGluZyBpcyBPTi4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIC0tc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvNSIsICJTa2luIEhhY2sgdGVtcG9yYXJ5IGRpc2FibGVkIHVudGlsIG5leHQgdXBkYXRlLiAuIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAtLVtbc2VsZi5Db25maWcudmlwOmFkZFN1Yk1lbnUoIkFudGktQUZLIFNldHRpbmdzIiwgImFudGlhZmsiKQ0KICAgICAgc2VsZi5Db25maWcudmlwLmFudGlhZms6YWRkUGFyYW0oImFudGlhZmsiLCJVc2UgQW50aSBBZmsiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkgXV0NCiAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzMiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm80IiwgIlRvIHVzZSB2aXAgc2V0dGluZ3MsIFlvdSBuZWVkIHRvIGJlIGEgVklQIHVzZXIgb24gQk9MIGNvbW11bml0eS4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgZW5kDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJEcmF3IFNldHRpbmdzIiwib3RoZXIiKQ0KICAgICAgLS1zZWxmLkNvbmZpZy5vdGhlcjphZGRTdWJNZW51KCJTaG93IERhbWFnZSBPbiBIcCBCYXIiLCAiSFBCQVIiKQ0KICAgICAgLS1zZWxmLkNvbmZpZy5vdGhlci5IUEJBUjphZGRQYXJhbSgia2V5IiwiT04vT0ZGIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLm90aGVyOmFkZFN1Yk1lbnUoIlNraWxsIERyYXdpbmcgU2V0dGluZ3MiLCAiZHJhdyIpDQogICAgICBzZWxmLkNvbmZpZy5vdGhlci5kcmF3OmFkZFBhcmFtKCJxZHJhdyIsIlEgU2tpbGwgRHJhd2luZ3MiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgid2RyYXciLCJXIFNraWxsIERyYXdpbmdzIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oImVkcmF3IiwiRSBTa2lsbCBEcmF3aW5ncyIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICBzZWxmLkNvbmZpZy5vdGhlci5kcmF3OmFkZFBhcmFtKCJyZHJhdyIsIlIgU2tpbGwgRHJhd2luZ3MiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgc2VsZi5Db25maWcub3RoZXIuZHJhdzphZGRQYXJhbSgiYWFkcmF3IiwiQXV0byBBdHRhY2sgUmFuZ2UiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgIHNlbGYuQ29uZmlnLm90aGVyOmFkZFN1Yk1lbnUoIkRyYXcgUGVybWFib3giLCAicGVybWEiKQ0KICAgICAgc2VsZi5Db25maWcub3RoZXIucGVybWE6YWRkUGFyYW0oInBlcm1hIiwiRHJhdyBQZXJtYWJveCAoIE5lZWRzIDJ4IEY5ICkiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgc2VsZi5Db25maWcub3RoZXI6YWRkUGFyYW0oInRhcmdldCIsIkRyYXcgY2lyY2xlIGZvciB0YXJnZXQgc2VsZWN0ZWQiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgc2VsZi5Db25maWcub3RoZXI6YWRkUGFyYW0oInRhcmdldGNhbCIsIlRhcmdldCBjYWxjdWxhdGlvbiIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICANCiAgICAgIA0KICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiVGFyZ2V0c2VsZWN0b3JzIiwidGFyZ2V0c2VsIikNCiAgICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRQYXJhbSgiaW5mb0syIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFBhcmFtKCJpbmZvSyIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRQYXJhbSgidHMiLCJMZWZ0IENsaWNrIEZvciBUYXJnZXQgU2VsZWN0aW9uIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICBzZWxmLnRzLm5hbWUgID0gIkFrYWxpIg0KICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRUUyhzZWxmLnRzKQ0KICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJLZXlzIFNldHRpbmdzIiwgIktleXMiKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LMyIsICI8LS0tLS0tLS0tLS0tLS0tLS0tQ29tYm8gS2V5IFNldHRpbmdzLS0tLS0tLS0tLS0tLS0tLS0tPiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImNvbWJva2V5IiwgIkNvbWJvIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCAzMikNCiAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJpbmZvSzQiLCAiPC0tLS0tLS0tLS0tLS0tLS0tLUhhcmFzcyBLZXkgU2V0dGluZ3MtLS0tLS0tLS0tLS0tLS0tLS0+IiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaGFyYXNza2V5IiwgIlNtYXJ0IEhhcmFzcyBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIkMiKSkNCiAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJhdXRvcSIsICJBdXRvIEhhcmFzcyBRIiwgU0NSSVBUX1BBUkFNX09OS0VZVE9HR0xFLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIlQiKSkNCiAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJpbmZvSzUiLCAiPC0tLS0tLS0tLS0tLS0tLS0tLUNsZWFyIEtleSBTZXR0aW5ncy0tLS0tLS0tLS0tLS0tLS0tLS0tPiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImxhbmVjbGVhcmtleSIsICJMYW5lQ2xlYXIgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJWIikpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgianVuZ2xlY2xlYXJrZXkiLCAiSnVuZ2xlQ2xlYXIgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJWIikpDQogICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0s2IiwgIjwtLS0tLS0tLS0tLS0tLS0tLS1PdGhlciBLZXkgU2V0dGluZ3MtLS0tLS0tLS0tLS0tLS0tLS0tLT4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJlc2NhcGVrZXkiLCAiRXNjYXBlIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiWSIpKQ0KICAgIC0tc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgibGFzdGhpdGtleSIsICJMYXN0aGl0IEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiWCIpKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LMiIsICJNYWtlIFN1cmUgVGhhdCBZb3VyIE9yYndhbGtlciBLZXlzIGFyZSBTYW1lIEFzIEhlcmUiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJPcndXYWxrZXJLZXkgU2V0dGluZ3MiLCAiS2V5czIiKQ0KICAgIA0KICAgIE9yYndhbGtNYW5hZ2VyOkxvYWRDb21tb25LZXlzKHNlbGYuQ29uZmlnLktleXMyKQ0KICAgIA0KICAgICANCiAgICAgaWYgc2VsZi5Db25maWcub3RoZXIucGVybWEucGVybWEgdGhlbg0KICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBzZWxmLkNvbmZpZzpwZXJtYVNob3coImluZm9ib3giKSBlbmQsIDEpDQogICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHNlbGYuQ29uZmlnLktleXM6cGVybWFTaG93KCJjb21ib2tleSIpIGVuZCwgMS4yKQ0KICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgc2VsZi5Db25maWcuS2V5czpwZXJtYVNob3coImhhcmFzc2tleSIpIGVuZCwgMS4yKQ0KICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgc2VsZi5Db25maWcuS2V5czpwZXJtYVNob3coImF1dG9xIikgZW5kLCAxLjIpDQplbmQNCiAgZW5kDQpmdW5jdGlvbiBBa2FsaTpXbmRNc2coTXNnLCBLZXkpDQppZiBzZWxmLkNvbmZpZy50YXJnZXRzZWwudHMgdGhlbiAgICAgIA0KICAgICAgICBpZiBNc2cgPT0gV01fTEJVVFRPTkRPV04gdGhlbg0KICAgICAgICAgICAgbG9jYWwgbWluRCA9IDEwDQogICAgICAgICAgICBsb2NhbCBzdGFyZ2V0ID0gbmlsDQogICAgICAgICAgICBmb3IgaSwgZW5lbXkgaW4gaXBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvDQogICAgICAgICAgICAgICAgaWYgVmFsaWRUYXJnZXQoZW5lbXkpIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgaWYgR2V0RGlzdGFuY2UoZW5lbXksIG1vdXNlUG9zKSA8PSBtaW5EIG9yIHN0YXJnZXQgPT0gbmlsIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICAgIG1pbkQgPSBHZXREaXN0YW5jZShlbmVteSwgbW91c2VQb3MpDQogICAgICAgICAgICAgICAgICAgICAgICBzdGFyZ2V0ID0gZW5lbXkNCiAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICBlbmQgICAgIA0KICAgICAgICAgICAgaWYgc3RhcmdldCBhbmQgbWluRCA8IDUwMCB0aGVuDQogICAgICAgICAgICAgICAgaWYgc2VsZi5zZWxlY3RlZFRhciBhbmQgc3RhcmdldC5jaGFyTmFtZSA9PSBzZWxmLnNlbGVjdGVkVGFyLmNoYXJOYW1lIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgc2VsZi5zZWxlY3RlZFRhciA9IG5pbA0KICAgICAgICAgICAgICAgICAgICBwcmludCgiPGZvbnQgY29sb3I9XCIjQ0JGNkZGXCI+VGFyZ2V0IDxiPmlzIG5vIGxvZ2VyIHNlbGVjdGVkLjwvYj46ICIuLnN0YXJnZXQuY2hhck5hbWUuLiI8L2ZvbnQ+IikNCiAgICAgICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWRUYXIgPSBzdGFyZ2V0ICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIHByaW50KCI8Zm9udCBjb2xvcj1cIiNDQkY2RkZcIj5OZXcgdGFyZ2V0IDxiPnNlbGVjdGVkLjwvYj46ICIuLnN0YXJnZXQuY2hhck5hbWUuLiI8L2ZvbnQ+IikNCiAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgICBlbmQNCiAgICBlbmQNCiAgLS0gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tTGlzYW5kcmEgc3RhcnRpbmctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogIC0tIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLUxpc2FuZHJhIHN0YXJ0aW5nLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAtLSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1MaXNhbmRyYSBzdGFydGluZy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgLS0gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tTGlzYW5kcmEgc3RhcnRpbmctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogIGNsYXNzICJMaXNzYW5kcmEiDQogIGZ1bmN0aW9uIExpc3NhbmRyYTpfX2luaXQoKQ0KICAgc2VsZi50cz0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgNTUwLCBEQU1BR0VfUEhZU0lDQUwsIGZhbHNlLCB0cnVlKQ0KICBzZWxmLnRzcT0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgNzI1LCBEQU1BR0VfUEhZU0lDQUwsIGZhbHNlLCB0cnVlKQ0KICBzZWxmLnRzdz0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgNDUwLCBEQU1BR0VfTUFHSUMsIGZhbHNlLCB0cnVlKQ0KICBzZWxmLnRzZT0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgMTA1MCwgREFNQUdFX01BR0lDLCBmYWxzZSwgdHJ1ZSkNCiAgc2VsZi50c3I9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDU1MCwgREFNQUdFX01BR0lDLCBmYWxzZSwgdHJ1ZSkgDQogICAgIHNlbGYuUVNwZWxsID0gX1NwZWxsKHtTbG90ID0gX1EsIERhbWFnZU5hbWUgPSAiUSIsIFJhbmdlID0gNzI1LCBXaWR0aCA9IDIwLCBEZWxheSA9IDAuMjUsIFNwZWVkID0gbWF0aC5odWdlLCBDb2xsaXNpb24gPSBmYWxzZSwgQW9lID0gZmFsc2UsIFR5cGUgPSBTUEVMTF9UWVBFLkxJTkVBUn0pDQogICAgIHNlbGYuV1NwZWxsID0gX1NwZWxsKHtTbG90ID0gX1csIERhbWFnZU5hbWUgPSAiVyIsIFJhbmdlID0gNDUwLCBXaWR0aCA9IDAsIERlbGF5ID0gMC41LCBTcGVlZCA9IG1hdGguaHVnZSwgQ29sbGlzaW9uID0gZmFsc2UsIEFvZSA9IHRydWUsIFR5cGUgPSBTUEVMTF9UWVBFLlNFTEZ9KQ0KICAgICBzZWxmLkVTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9FLCBEYW1hZ2VOYW1lID0gIkUiLCBSYW5nZSA9IDEwNTAsIFdpZHRoID0gMTEwLCBEZWxheSA9IC4yNSwgU3BlZWQgPSBtYXRoLmh1Z2UsIENvbGxpc2lvbiA9IGZhbHNlLCBBb2UgPSBmYWxzZSwgVHlwZSA9IFNQRUxMX1RZUEUuTElORUFSfSkNCiAgICAgc2VsZi5SU3BlbGwgPSBfU3BlbGwoe1Nsb3QgPSBfUiwgRGFtYWdlTmFtZSA9ICJSIiwgUmFuZ2UgPTU1MCwgV2lkdGggPSAwLCBEZWxheSA9IDAuMjUsIFNwZWVkID0gbWF0aC5odWdlLCBDb2xsaXNpb24gPSBmYWxzZSwgQW9lID0gdHJ1ZSwgVHlwZSA9IFNQRUxMX1RZUEUuVEFSR0VUVEVEfSkNCiAgICAgc2VsZi5SU1NwZWxsID0gX1NwZWxsKHtTbG90ID0gX1IsIERhbWFnZU5hbWUgPSAiUiIsIFJhbmdlID01NTAsIFdpZHRoID0gMCwgRGVsYXkgPSAwLjI1LCBTcGVlZCA9IG1hdGguaHVnZSwgQ29sbGlzaW9uID0gZmFsc2UsIEFvZSA9IHRydWUsIFR5cGUgPSBTUEVMTF9UWVBFLlRBUkdFVFRFRH0pDQogICAgIHNlbGYuSWduaXRlID0gX1NwZWxsKHtTbG90ID0gRmluZFN1bW1vbmVyU2xvdCgic3VtbW9uZXJkb3QiKSwgRGFtYWdlTmFtZSA9ICJJR05JVEUiLCBSYW5nZSA9IDYwMCwgVHlwZSA9IFNQRUxMX1RZUEUuVEFSR0VUVEVEfSkNCiAgLS18PiBNaW5pb24gTWFuYWdlcnMNCiAgICAgIHNlbGYuZW5lbXlNaW5pb25zICAgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9FTkVNWSwgICA2NTAsIG15SGVybywgTUlOSU9OX1NPUlRfTUFYSEVBTFRIX0RFQykNCiAgICAgIHNlbGYuYWxseU1pbmlvbnMgICAgPSBtaW5pb25NYW5hZ2VyKE1JTklPTl9BTExZLCAgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgICAgc2VsZi5qdW5nbGVNaW5pb25zICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX0pVTkdMRSwgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgICAgc2VsZi5vdGhlck1pbmlvbnMgICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX09USEVSLCAgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgICAgICAgIHNlbGY6TG9hZE1lbnUoKQ0KICAgICAgICAgICAgTGFzdF9MZXZlbFNwZWxsID0gMA0KICAgICAgICAgICAgc2VsZjpmaW5kb3Jid2Fsa2VyKCkNCiAgICAgICAgICAgICAgICAgIC0tIGlmIFZJUF9VU0VSIHRoZW4gICBzZWxmOnNraW5oYWNrKCkgZW5kDQogICAgICAgIEFkZFRpY2tDYWxsYmFjayhmdW5jdGlvbigpIHNlbGY6VGljaygpIGVuZCkNCiAgICBBZGREcmF3Q2FsbGJhY2soZnVuY3Rpb24oKSBzZWxmOkRyYXcoKSBlbmQpDQogICAgLS1BZGRNc2dDYWxsYmFjayhmdW5jdGlvbihtc2csS2V5KSBzZWxmOlduZE1zZyhtc2csS2V5KSBlbmQpDQogICAgLS1BZGRBbmltYXRpb25DYWxsYmFjayhmdW5jdGlvbih1bml0LCBhbmltYXRpb24pIHNlbGY6QW5pbWF0aW9uKHVuaXQsIGFuaW1hdGlvbikgZW5kKQ0KICAgIC0tQWRkUHJvY2Vzc1NwZWxsQ2FsbGJhY2soZnVuY3Rpb24odW5pdCwgc3BlbGwpIHNlbGY6UHJvY2Vzc1NwZWxsKHVuaXQsIHNwZWxsKSBlbmQpDQogICAgLS1BZGRBcHBseUJ1ZmZDYWxsYmFjayhmdW5jdGlvbihzb3VyY2UsIHVuaXQsIGJ1ZmYpIHNlbGY6T25BcHBseUJ1ZmYoc291cmNlLCB1bml0LCBidWZmKSBlbmQpDQogICAgLS1BZGRVcGRhdGVCdWZmQ2FsbGJhY2soZnVuY3Rpb24odW5pdCwgYnVmZiwgc3RhY2tzKSBzZWxmOlVwZGF0ZUJ1ZmYodW5pdCwgYnVmZiwgc3RhY2tzKSBlbmQpDQogICAgLS1BZGRSZW1vdmVCdWZmQ2FsbGJhY2soZnVuY3Rpb24odW5pdCwgYnVmZikgc2VsZjpPblJlbW92ZUJ1ZmYodW5pdCwgYnVmZikgZW5kKSANCiAgICAgIGVuZA0KICAgICAgZnVuY3Rpb24gTGlzc2FuZHJhOlRpY2soKQ0KICAgICAgIHNlbGY6YXV0b3pob255YSgpDQogICAgICAgc2VsZjplbmdhZ2V3aXRocigpDQogICAgICAgICBpZiBWSVBfVVNFUiB0aGVuIHNlbGY6YXV0b2xldmVsKCkgZW5kDQogICAgICAgc2VsZjphdXRvUigpDQogICAgICAgc2VsZjphdXRvcSgpDQogICBpZihzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICl0aGVuDQogICAgICBzZWxmOmNvbWJvKCkNCiAgICBlbmQNCiAgICAgICAgaWYoc2VsZi5Db25maWcuS2V5cy5qdW5nbGVjbGVhcmtleSApdGhlbg0KICAgICBzZWxmOkp1bmdsZUNsZWFyKCkNCiAgICBlbmQNCiAgICAgIGlmKHNlbGYuQ29uZmlnLktleXMubGFuZWNsZWFya2V5ICl0aGVuDQogICAgICBzZWxmOkxhbmVDbGVhcigpDQogICAgZW5kDQogICAgIGlmKHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXlyICl0aGVuDQogICAgICBzZWxmOmVuZ2FnZXdpdGhyKCkNCiAgICBlbmQNCiAgICAgIGlmKHNlbGYuQ29uZmlnLktleXMuZXNjYXBla2V5KXRoZW4NCiAgICAgIHNlbGY6ZXNjYXBlKCkNCiAgICBlbmQNCiAgICBpZihzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgKSB0aGVuDQogICAgICBzZWxmOmtpbGxzdGVhbCgpDQogICAgZW5kDQogICAgaWYoc2VsZi5Db25maWcuS2V5cy5oYXJhc3NrZXkgb3Igc2VsZi5Db25maWcuS2V5cy5oYXJhc3N0b2dsZWtleSAgKSB0aGVuDQogICAgICBzZWxmOmhhcmFzcygpDQogICAgZW5kDQogICAgICBlbmQNCiAgICAgIGZ1bmN0aW9uIExpc3NhbmRyYTpMb2FkTWVudSgpDQogICAgICAgIHNlbGYuQ29uZmlnPXNjcmlwdENvbmZpZygiIi4uU2NyaXB0bmFtZS4uIiIsIm1lbnUiKQ0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiQ29tYm8gU2V0dGluZ3MiLCAiY29tYm8iKQ0KICAgICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlUSIsICJVc2UgUSBpbiBDb21ibyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZVciLCAiVXNlIFcgaW4gQ29tYm8iLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VFIiwgIlVzZSBFIGluIGNvbWJvIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlUiIsICJVc2UgUiBpbiBjb21ibyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZUkiLCAiVXNlIElnbml0ZSBpZiB0YXJnZXQga2lsbGFibGUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJNYW5hIiwiTWFuYSBNYW5hZ2VyICUiLFNDUklQVF9QQVJBTV9TTElDRSwgMTAsIDEwLCAxMDAsIDApDQogIA0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiSGFyYXNzIFNldHRpbmdzIiwgImhhcmFzcyIpDQogICAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczphZGRQYXJhbSgidXNlUSIsICJIYXJhc3MgV2l0aCBRIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6YWRkUGFyYW0oInVzZVciLCAiSGFyYXNzIFdpdGggVyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuaGFyYXNzOmFkZFBhcmFtKCJ1c2VFIiwgIkhhcmFzcyBXaXRoIEUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIGZhbHNlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6YWRkUGFyYW0oImF1dG9xIiwgIkF1dG8gSGFyYXNzIHdpdGggUSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDMwLCAxMCwgMTAwLCAwKQ0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiU2tpbGwgTG9naWNzIiwgInNraWxsbG9naWMiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljOmFkZFN1Yk1lbnUoIkUgU2tpbGwgTG9naWMiLCAiRWxvZ2ljIikNCiAgICAgICAgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5FbG9naWM6YWRkUGFyYW0oImNvbWJvIiwgIkUgTG9naWMgZm9yIGNvbWJvIG1vZGUiLCBTQ1JJUFRfUEFSQU1fTElTVCwgMiwgeyJFbmdhZ2Ugd2l0aCBzZWNvbmQgRSIsICJEbyBub3QgdXNlIFNlY29uZCBFICggUmVjb21lbmRlZCkiIH0pDQogICAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuRWxvZ2ljOmFkZFBhcmFtKCJoYXJhc3MiLCAiRSBMb2dpYyBmb3IgSGFyYXNzIG1vZGUiLCBTQ1JJUFRfUEFSQU1fTElTVCwgMSwgeyJEbyBub3QgdXNlIFNlY29uZCBFICggUmVjb21lbmRlZCkiLCAiRW5nYWdlIHdpdGggc2Vjb25kIEUiIH0pDQogICAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuRWxvZ2ljOmFkZFBhcmFtKCJibGFuayIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5FbG9naWM6YWRkUGFyYW0oImluZm9FIiwgIkVuZ2FnZSB3aXRoIHNlY29uZCBFIG9wdGlvbiBpcyBzdGlsbCBvbiBCZXRhLi4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgc2VsZi5Db25maWcuc2tpbGxsb2dpYzphZGRTdWJNZW51KCJSIFNraWxsIExvZ2ljIiwgIlJsb2dpYyIpDQogICAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljOmFkZFBhcmFtKCJSbG9naWMiLCAiUiBMb2dpYyBmb3IgY29tYm8gbW9kZSIsIFNDUklQVF9QQVJBTV9MSVNULCAxLCB7IlNtYXJ0IiwgInNhdmUgZm9yIHlvdXJzZWxmIiwgIlVzZSBmb3IgZW5lbXkiIH0pDQogICAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljOmFkZFBhcmFtKCJlbmFibGVhdXRvUiIsICJBdXRvIFIgZm9yIHlvdXJzZWxmIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLlJsb2dpYzphZGRQYXJhbSgiYXV0b1IiLCAiQXV0b1IgaWYgSGVhbHRoIHVuZGVyIC0+ICUiLCBTQ1JJUFRfUEFSQU1fU0xJQ0UsIDEwLCAwLCAxMDAsIDApDQogICAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljOmFkZFBhcmFtKCJpbmZvUjIiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljOmFkZFBhcmFtKCJpbmZvUiIsICJGb3IgdXNpbmcgU21hcnQgUiBsb2dpYywgQXV0b1Igc2hvdWxkIGJlIG9wZW4uLiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljOmFkZFN1Yk1lbnUoIlcgU2tpbGwgTG9naWMiLCAiV2xvZ2ljIikgDQogICAgICAgIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuV2xvZ2ljOmFkZFBhcmFtKCJ1c2VXIiwgIlVzZSBXIGZvciBBbnRpIEdhcENsb3NlIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCBmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5XbG9naWM6YWRkUGFyYW0oImluZm93MiIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICAgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5XbG9naWM6YWRkUGFyYW0oImluZm9XMyIsICJUaGlzIEZ1bmN0aW9uIGlzIG9uIGJldGEuLiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICANCiAgICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkVzY2FwZSBTZXR0aW5ncyIsImVzY2FwZSIpDQogICAgICAgIHNlbGYuQ29uZmlnLmVzY2FwZTphZGRQYXJhbSgidXNlRSIsIlVzZSBFIFdoaWxlIEVzY2FwZSIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmVzY2FwZTphZGRQYXJhbSgidXNlVyIsIlVzZSBXIFdoaWxlIEVzY2FwZSIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJGYXJtIFNldHRpbmdzIiwgImZhcm0iKQ0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWcuZmFybTphZGRTdWJNZW51KCJMYW5lQ2xlYXIgU2V0dGluZ3MiLCJsYW5lY2xlYXIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5mYXJtLmxhbmVjbGVhcjphZGRQYXJhbSgidXNlUSIsIlVzZSBRIG9uIExhbmVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmZhcm0ubGFuZWNsZWFyOmFkZFBhcmFtKCJ1c2VXIiwiVXNlIFcgb24gTGFuZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICAgIC0tc2VsZi5Db25maWcuZmFybS5sYW5lY2xlYXI6YWRkUGFyYW0oInVzZUUiLCJVc2UgRSBvbiBMYW5lY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5mYXJtLmxhbmVjbGVhcjphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDMwLCAxMCwgMTAwLCAwKQ0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWcuZmFybTphZGRTdWJNZW51KCJKdW5nbGVDbGVhciBTZXR0aW5ncyIsImp1bmdsZWNsZWFyIikNCiAgICAgICAgc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhcjphZGRQYXJhbSgidXNlUSIsIlVzZSBRIG9uIGp1bmdsZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhcjphZGRQYXJhbSgidXNlVyIsIlVzZSBXIG9uIGp1bmdsZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhcjphZGRQYXJhbSgidXNlRSIsIlVzZSBFIG9uIGp1bmdsZWNsZWFyIixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuZmFybS5qdW5nbGVjbGVhcjphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDMwLCAxMCwgMTAwLCAwKQ0KICAgICAgICANCiAgICAgICAgLS1zZWxmLkNvbmZpZy5mYXJtOmFkZFN1Yk1lbnUoIkxhc3RoaXQgU2V0dGluZ3MiLCJsYXN0aGl0IikNCiAgICAgICAgLS1zZWxmLkNvbmZpZy5mYXJtLmxhc3RoaXQ6YWRkUGFyYW0oInVzZVEiLCJVc2UgUSBvbiBMYXN0aGl0IixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgLS1zZWxmLkNvbmZpZy5mYXJtLmxhc3RoaXQ6YWRkUGFyYW0oInVzZVciLCJVc2UgVyBvbiBMYXN0aGl0IixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgLS1zZWxmLkNvbmZpZy5mYXJtLmxhc3RoaXQ6YWRkUGFyYW0oInVzZUUiLCJVc2UgRSBvbiBMYXN0aGl0IixTQ1JJUFRfUEFSQU1fT05PRkYsdHJ1ZSkNCiAgICAgICAgLS1zZWxmLkNvbmZpZy5mYXJtLmxhc3RoaXQ6YWRkUGFyYW0oIk1hbmEiLCJNYW5hIE1hbmFnZXIgJSIsU0NSSVBUX1BBUkFNX1NMSUNFLCAzMCwgMTAsIDEwMCwgMCkNCiAgICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJLaWxsU3RlYWwgU2V0dGluZ3MiLCAia2lsbHN0ZWFsIikNCiAgICAgICAgc2VsZi5Db25maWcua2lsbHN0ZWFsOmFkZFBhcmFtKCJrcyIsIktpbGxzdGVhbCBPbi9PZmYiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZVEiLCAiU3RlYWwgV2l0aCBRIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZUUiLCAiU3RlYWwgV2l0aCBFIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZVIiLCAiU3RlYWwgV2l0aCBSIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oInVzZUkiLCAiU3RlYWwgV2l0aCBJZ25pdGUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJJdGVtIFNldHRpbmdzIiwgIml0ZW0iKQ0KICAgICAgICBzZWxmLkNvbmZpZy5pdGVtOmFkZFBhcmFtKCJlbmFibGVhdXRvemhvbnlhIiwgIkF1dG8gWmhvbnlhIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCBmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcuaXRlbTphZGRQYXJhbSgiYXV0b3pob255YSIsICJaaG9ueWEgaWYgSGVhbHRoIHVuZGVyIC0+ICUiLCBTQ1JJUFRfUEFSQU1fU0xJQ0UsIDEwLCAwLCAxMDAsIDApDQogICAgICAgIA0KICAgICAgICAgICAgICBpZiBWSVBfVVNFUiB0aGVuDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIlZJUCBTZXR0aW5ncyIsICJ2aXAiKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oInBhY2tldCIsIlVzZSBQYWNrZXQgQ2FzdGluZyIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm8xIiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXA6YWRkUGFyYW0oImluZm8yIiwgIlRvIHVzZSB2aXAgc2V0dGluZ3MsIFBhY2tldCBDYXN0aW5nIHNob3VsZCBiZSBvcGVuLiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXA6YWRkU3ViTWVudSgiQXV0byBMZXZlbCBTZXR0aW5ncyIsICJsZXZlbCIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcC5sZXZlbDphZGRQYXJhbSgia2V5IiwiVXNlIEF1dG8gTGV2ZWwiLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcudmlwLmxldmVsOmFkZFBhcmFtKCJsb2dpYyIsICJTZWxlY3QgU2tpbGwgT3JkZXIiLCBTQ1JJUFRfUEFSQU1fTElTVCwgNywgeyJGb2N1cyBRPlc+RSIsICJGb2N1cyBRPkU+VyIsIkZvY3VzIFc+UT5FIiwiRm9jdXMgVz5FPlEiLCJGb2N1cyBFPlc+USIsICJGb2N1cyBFPlE+VyIgLCAiU21hcnQiICB9KQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXA6YWRkU3ViTWVudSgiU2tpbiBIYWNrIFNldHRpbmdzIiwgInNraW4iKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXAuc2tpbjphZGRQYXJhbSgia2V5IiwiVXNlIFNraW4gSGFjayIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXAuc2tpbjphZGRQYXJhbSgnc2VsZWN0ZWQnIC4uIG15SGVyby5jaGFyTmFtZSAuLiAnU2tpbicsICJTZWxlY3QgU2tpbiIsIFNDUklQVF9QQVJBTV9MSVNULCAxLCB7Ik9yaWdpbmFsIiwgIkJsb29kc3RvbmUgTGlzc2FuZHJhICIsIkJsYWRlIFF1ZWVuIExpc3NhbmRyYSJ9KQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXAuc2tpbjphZGRQYXJhbSgiaW5mbzQiLCAiVG8gdXNlIHNraW4gaGFjaywgWW91IG5lZWQgdG8gMnggRjkgYWZ0ZXIgeW91IHNlbGVjdCB0aGUgc2tpbiB5b3UgZGVzaXJlLiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXAuc2tpbjphZGRQYXJhbSgiaW5mbzUiLCAiTWFrZSBzdXJlIHRoYXQgdXNpbmcgcGFja2V0IGNhc3RpbmcgaXMgT04uIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIC0tc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvNSIsICJTa2luIEhhY2sgdGVtcG9yYXJ5IGRpc2FibGVkIHVudGlsIG5leHQgdXBkYXRlLiAuIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIC0tW1tzZWxmLkNvbmZpZy52aXA6YWRkU3ViTWVudSgiQW50aS1BRksgU2V0dGluZ3MiLCAiYW50aWFmayIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcC5hbnRpYWZrOmFkZFBhcmFtKCJhbnRpYWZrIiwiVXNlIEFudGkgQWZrIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpIF1dDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzMiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzQiLCAiVG8gdXNlIHZpcCBzZXR0aW5ncywgWW91IG5lZWQgdG8gYmUgYSBWSVAgdXNlciBvbiBCT0wgY29tbXVuaXR5LiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIGVuZA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJEcmF3IFNldHRpbmdzIiwib3RoZXIiKQ0KICAgICAgICAtLXNlbGYuQ29uZmlnLm90aGVyOmFkZFN1Yk1lbnUoIlNob3cgRGFtYWdlIE9uIEhwIEJhciIsICJIUEJBUiIpDQogICAgICAgIC0tc2VsZi5Db25maWcub3RoZXIuSFBCQVI6YWRkUGFyYW0oImtleSIsIk9OL09GRiIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLm90aGVyOmFkZFN1Yk1lbnUoIlNraWxsIERyYXdpbmcgU2V0dGluZ3MiLCAiZHJhdyIpDQogICAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oInFkcmF3IiwiUSBTa2lsbCBEcmF3aW5ncyIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oIndkcmF3IiwiVyBTa2lsbCBEcmF3aW5ncyIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oImVkcmF3IiwiRSBTa2lsbCBEcmF3aW5ncyIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oInJkcmF3IiwiUiBTa2lsbCBEcmF3aW5ncyIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oImFhZHJhdyIsIkF1dG8gQXR0YWNrIFJhbmdlIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogIA0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiVGFyZ2V0c2VsZWN0b3JzIiwidGFyZ2V0c2VsIikNCiAgICAgIHNlbGYudHMubmFtZSAgPSAiTGlzc2FuZHJhIEdlbmVyYWwiDQogICAgICBzZWxmLnRzcS5uYW1lID0gIkxpc3NhbmRyYSBRIFNraWxsIg0KICAgICAgc2VsZi50c3cubmFtZSA9ICJMaXNzYW5kcmEgVyBTa2lsbCINCiAgICAgIHNlbGYudHNlLm5hbWUgPSAiTGlzc2FuZHJhIEUgU2tpbGwiDQogICAgICBzZWxmLnRzci5uYW1lID0gIkxpc3NhbmRyYSBSIFNraWxsIg0KICAgICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFRTKHNlbGYudHMpDQogICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkVFMoc2VsZi50c3EpDQogICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkVFMoc2VsZi50c3cpDQogICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkVFMoc2VsZi50c2UpDQogICAgICBzZWxmLkNvbmZpZy50YXJnZXRzZWw6YWRkVFMoc2VsZi50c3IpIA0KICAgICAgDQogICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJLZXlzIFNldHRpbmdzIiwgIktleXMiKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0szIiwgIjwtLS0tLS0tLS0tLS0tLS0tLS1Db21ibyBLZXkgU2V0dGluZ3MtLS0tLS0tLS0tLS0tLS0tLS0+IiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJjb21ib2tleSIsICJDb21ibyBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgMzIpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJjb21ib2tleXIiLCAiU3RhcnQgRW5nYWdlIFdpdGggWW91ciBVbHRpICIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiVSIpKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0s0IiwgIjwtLS0tLS0tLS0tLS0tLS0tLS1IYXJhc3MgS2V5IFNldHRpbmdzLS0tLS0tLS0tLS0tLS0tLS0tPiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaGFyYXNza2V5IiwgIlNtYXJ0IEhhcmFzcyBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIkMiKSkNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImhhcmFzc3RvZ2xla2V5IiwgIkhhcmFzcyBUb2dsZSBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlUT0dHTEUsIGZhbHNlLCBzdHJpbmcuYnl0ZSgiVCIpKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0s1IiwgIjwtLS0tLS0tLS0tLS0tLS0tLS1DbGVhciBLZXkgU2V0dGluZ3MtLS0tLS0tLS0tLS0tLS0tLS0tLT4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImxhbmVjbGVhcmtleSIsICJMYW5lQ2xlYXIgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJWIikpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJqdW5nbGVjbGVhcmtleSIsICJKdW5nbGVDbGVhciBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIloiKSkNCiAgICAgIC0tc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgibGFzdGhpdGtleSIsICJMYXN0aGl0IEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiWCIpKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czphZGRQYXJhbSgiaW5mb0s2IiwgIjwtLS0tLS0tLS0tLS0tLS0tLS1PdGhlciBLZXkgU2V0dGluZ3MtLS0tLS0tLS0tLS0tLS0tLS0tLT4iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImVzY2FwZWtleSIsICJFc2NhcGUgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJZIikpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzOmFkZFBhcmFtKCJpbmZvSyIsICIiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIHNlbGYuQ29uZmlnLktleXM6YWRkUGFyYW0oImluZm9LMiIsICJNYWtlIFN1cmUgVGhhdCBZb3VyIE9yYndhbGtlciBLZXlzIGFyZSBTYW1lIEFzIEhlcmUiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgIA0KICAgICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIk9yYndhbGtlciBLZXkgU2V0dGluZ3MiLCAiS2V5czIiKQ0KICAgICAgT3Jid2Fsa01hbmFnZXI6TG9hZENvbW1vbktleXMoc2VsZi5Db25maWcuS2V5czIpDQogICAgICBzZWxmLkNvbmZpZy5LZXlzMjphZGRQYXJhbSgiaW5mb0s0IiwgIiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgc2VsZi5Db25maWcuS2V5czI6YWRkUGFyYW0oImluZm9LMjIiLCAiTWFrZSBTdXJlIFRoYXQgWW91ciBTY3JpcHQgS2V5cyBhcmUgU2FtZSBBcyBIZXJlIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm8zIiwgIl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveCIsICIgICAgICAgICAgICAgICAiLi5TY3JpcHRuYW1lLi4iIiwgU0NSSVBUX1BBUkFNX0lORk8sICIiKSANCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDIiLCAiICAgICAgICAgICAgICAgICBTY3JpcHQgVmVyc2lvbjogICIuLlZlcnNpb24uLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3g2IiwgIiAgICAgICAgICAgIFNjcmlwdCB3YXMgbWFkZSBieSAgIi4uQXV0aG9yLi4gIiAgICAgICAgICIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94NSIsICIgICAgICAgTGVhdWdlIE9mIExlZ2VuZHMgVmVyc2lvbjogICIuLkxWZXJzaW9uLi4gIiAgICAgICAgICIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIA0KICAgICAgIHNlbGYuQ29uZmlnOnBlcm1hU2hvdygiaW5mb2JveCIpDQogICAgICAgc2VsZi5Db25maWcuS2V5czpwZXJtYVNob3coImNvbWJva2V5IikNCiAgICAgICBzZWxmLkNvbmZpZy5LZXlzOnBlcm1hU2hvdygiaGFyYXNzdG9nbGVrZXkiKQ0KICAgICAgIHNlbGYuQ29uZmlnLktleXM6cGVybWFTaG93KCJoYXJhc3NrZXkiKQ0KICAgIA0KICANCiAgZW5kDQogIGZ1bmN0aW9uIExpc3NhbmRyYTpza2luaGFjaygpDQogIGlmIG5vdCBzZWxmLkNvbmZpZy52aXAucGFja2V0IHRoZW4gU2VuZFNraW5QYWNrZXQobXlIZXJvLmNoYXJOYW1lLCBza2luc1BCWzFdLCBteUhlcm8ubmV0d29ya0lEKTsgZWxzZQ0KICBpZiBzZWxmLkNvbmZpZy52aXAuc2tpbi5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgIHRoZW4NCiAgU2VuZFNraW5QYWNrZXQobXlIZXJvLmNoYXJOYW1lLCBza2luc1BCW3NlbGYuQ29uZmlnLnZpcC5za2luWydzZWxlY3RlZCcgLi4gbXlIZXJvLmNoYXJOYW1lIC4uICdTa2luJ11dLCBteUhlcm8ubmV0d29ya0lEKTsNCiAgZW5kDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGlzc2FuZHJhOmF1dG9sZXZlbCgpDQppZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDEgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2UxID0gICB7IDEsMiwzLDEsMSw0LDEsMiwxLDIsNCwyLDIsMywzLDQsMywzfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2UxKQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gMiBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTIgPSAgIHsgMSwyLDMsMSwxLDQsMSwzLDEsMyw0LDMsMywyLDIsNCwyLDJ9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTIpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSAzIGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlMyA9ICB7IDIsMywxLDIsMiw0LDIsMSwyLDEsNCwxLDEsMywzLDQsMywzfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2UzKQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gNCBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTQgPSAgeyAyLDMsMSwyLDIsNCwyLDMsMiwzLDQsMywzLDEsMSw0LDEsMX0NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlNCkNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDUgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2U1ID0gIHsgMywxLDIsMywzLDQsMywyLDMsMiw0LDIsMiwxLDEsNCwxLDF9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTUpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSA2IGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlNiA9ICB7IDMsMSwyLDMsMyw0LDMsMSwzLDEsNCwxLDEsMiwyLDQsMiwyfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2U2KQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogICAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSA3IGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlNiA9ICB7IDEsMywyLDEsMSw0LDEsMiwxLDIsNCwyLDIsMywzLDQsMywzfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2U2KQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMaXNzYW5kcmE6YXV0b3pob255YSgpDQogICAgaWYgc2VsZi5Db25maWcuaXRlbS5lbmFibGVhdXRvemhvbnlhIHRoZW4NCiAgICAgZm9yIF8gPSBJVEVNXzEsIElURU1fNyBkbw0KICAgICAgaWYgbXlIZXJvLmhlYWx0aCA8PSAobXlIZXJvLm1heEhlYWx0aCAqIHNlbGYuQ29uZmlnLml0ZW0uYXV0b3pob255YSAvIDEwMCkgYW5kICggbXlIZXJvOkNhblVzZVNwZWxsKF8pID09IDAgYW5kIG15SGVybzpHZXRTcGVsbERhdGEoXykubmFtZSA9PSAiWmhvbnlhc0hvdXJnbGFzcyIgKXRoZW4gQ2FzdFNwZWxsKF8pDQogICAgZW5kDQogICAgZW5kDQogICAgZW5kDQogICAgZW5kDQogIA0KICBmdW5jdGlvbiBMaXNzYW5kcmE6YXV0b1IoKQ0KICAgIGlmICggc2VsZi5Db25maWcuc2tpbGxsb2dpYy5SbG9naWMuZW5hYmxlYXV0b1IgYW5kIChzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLlJsb2dpYy5SbG9naWMgPT0gMiBvciBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLlJsb2dpYy5SbG9naWMgPT0gMSkpIHRoZW4NCiAgICAgIGlmIG15SGVyby5oZWFsdGggPD0gKG15SGVyby5tYXhIZWFsdGggKiBzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLlJsb2dpYy5hdXRvUiAvIDEwMCkgdGhlbiBzZWxmOkNhc3RSUyhteUhlcm8pDQogICAgICBlbmQNCiAgICBlbmQNCiAgICBlbmQNCiAgDQogIGZ1bmN0aW9uIExpc3NhbmRyYTplbmdhZ2V3aXRocigpDQogICBzZWxmLnRzcTp1cGRhdGUoKQ0KICAgaWYgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleXIgdGhlbg0KICAgc2VsZjp3YWxrKCkNCiAgIGVuZA0KICAgICAgaWYoc2VsZi5RU3BlbGw6SXNSZWFkeSgpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmNvbWJvLk1hbmEgLzEwMCApYW5kIHNlbGYudHNxLnRhcmdldH49bmlsICBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUSBhbmQgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleXIgICl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0UShzZWxmLnRzcS50YXJnZXQpDQogICAgICBlbmQNCiAgICAgIHNlbGYudHNlOnVwZGF0ZSgpDQogICAgICBpZihzZWxmLkVTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwIClhbmQgc2VsZi50c2UudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZUUgYW5kIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXlyICl0aGVuDQogICAgICAgICAgICAgICAgbG9jYWwgVGlja2VyID0gR2V0VGlja0NvdW50KCkNCiAgaWYgKGdsb2JhbF90aWNrcyArIDIwMDApIDwgVGlja2VyIHRoZW4NCiAgaWYgKG15SGVybzpDYW5Vc2VTcGVsbChfRSkgPT0gUkVBRFkgKSB0aGVuDQogICAgIENhc3RTcGVsbChfRSwgc2VsZi50c2UudGFyZ2V0LngsIHNlbGYudHNlLnRhcmdldC56KQ0KICAgICBnbG9iYWxfdGlja3MgPSBUaWNrZXINCiAgICAgICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIENhc3RTcGVsbChfRSkgZW5kLCAxLjUpDQogICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi5XU3BlbGw6SXNSZWFkeSgpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmNvbWJvLk1hbmEgLzEwMCApIGFuZCBzZWxmLnRzdy50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlVyBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXlyICApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFcoc2VsZi50c3cudGFyZ2V0KQ0KICAgICAgZW5kDQogICAgICBzZWxmLnRzcjp1cGRhdGUoKQ0KICAgICAgaWYoc2VsZi5SU3BlbGw6SXNSZWFkeSgpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmNvbWJvLk1hbmEgLzEwMCApIGFuZCBzZWxmLnRzci50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUiBhbmQgIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXlyICl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0UihzZWxmLnRzci50YXJnZXQpDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGlzc2FuZHJhOkRyYXcoKQ0KICAgICAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5xZHJhdyBhbmQgc2VsZi5RU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCA3MjUsIDEscmVkKQ0KICAgIGVuZA0KICANCiAgICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LndkcmF3IGFuZCBzZWxmLldTcGVsbDpJc1JlYWR5KCkgdGhlbg0KICAgICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDEwNTAsIDEsIHJlZCkNCiAgICBlbmQNCiAgDQogICAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5lZHJhdyBhbmQgc2VsZi5FU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCA0MjAsIDEsIHJlZCkNCiAgICBlbmQNCiAgICANCiAgICBpZiBzZWxmLkNvbmZpZy5vdGhlci5kcmF3LnJkcmF3IGFuZCBzZWxmLlJTcGVsbDpJc1JlYWR5KCkgdGhlbg0KICAgICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDUwMCwxLCByZWQpDQogICAgZW5kDQogICAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5hYWRyYXcgdGhlbg0KICAgICAgRHJhd0NpcmNsZTNEKG15SGVyby54LCBteUhlcm8ueSwgbXlIZXJvLnosIDU1MCwxLCBBUkdCKDI1NSwgMjU1LDAsMCkpDQogICAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMaXNzYW5kcmE6YW50aWdhcHcoKQ0KICAgICAgaWYoc2VsZi5XU3BlbGw6SXNSZWFkeSgpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmNvbWJvLk1hbmEgLzEwMCApYW5kIHNlbGYudHN3LnRhcmdldH49bmlsICBhbmQgc2VsZi5Db25maWcuc2tpbGxsb2dpYy5XbG9naWMudXNlVyAgKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RXKHNlbGYudHN3LnRhcmdldCkNCiAgICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGlzc2FuZHJhOmNvbWJvKCkNCiAgICAgICAgc2VsZi50c3E6dXBkYXRlKCkNCiAgICAgIGlmKHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKWFuZCBzZWxmLnRzcS50YXJnZXR+PW5pbCAgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVEgYW5kIHNlbGYuQ29uZmlnLktleXMuY29tYm9rZXkgICl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0UShzZWxmLnRzcS50YXJnZXQpDQogICAgICBlbmQNCiAgICAgIHNlbGYudHNlOnVwZGF0ZSgpDQogICAgICBpZihzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLkVsb2dpYy5jb21ibyA9PSAxIGFuZCAgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKWFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VFIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICApdGhlbg0KICAgICAgbG9jYWwgVGlja2VyID0gR2V0VGlja0NvdW50KCkNCiAgaWYgKGdsb2JhbF90aWNrcyArIDIwMDApIDwgVGlja2VyIHRoZW4NCiAgaWYgKG15SGVybzpDYW5Vc2VTcGVsbChfRSkgPT0gUkVBRFkgYW5kIHNlbGYudHNlLnRhcmdldH49bmlsKSB0aGVuDQogICAgIENhc3RTcGVsbChfRSwgc2VsZi50c2UudGFyZ2V0LngsIHNlbGYudHNlLnRhcmdldC56KQ0KICAgICBnbG9iYWxfdGlja3MgPSBUaWNrZXINCiAgICAgICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIENhc3RTcGVsbChfRSkgZW5kLCAxLjUpDQogICAgICAgICAgZW5kDQogICAgICAgICAgZW5kDQogICAgICAgICAgZW5kDQogICAgICAgICBpZihzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLkVsb2dpYy5jb21ibyA9PSAyIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmNvbWJvLk1hbmEgLzEwMCApIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VFIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICApdGhlbg0KICAgICAgICAgbG9jYWwgVGlja2VyID0gR2V0VGlja0NvdW50KCkNCiAgaWYgKGdsb2JhbF90aWNrcyArIDIwMDApIDwgVGlja2VyIHRoZW4NCiAgaWYgKG15SGVybzpDYW5Vc2VTcGVsbChfRSkgPT0gUkVBRFkgYW5kIHNlbGYudHNlLnRhcmdldH49bmlsKSB0aGVuDQogICAgIENhc3RTcGVsbChfRSwgc2VsZi50c2UudGFyZ2V0LngsIHNlbGYudHNlLnRhcmdldC56KQ0KICAgICBnbG9iYWxfdGlja3MgPSBUaWNrZXINCiAgICAgICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIENhc3RTcGVsbChfRSkgZW5kLCAyKQ0KICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgc2VsZi50c3c6dXBkYXRlKCkNCiAgICAgIGlmKHNlbGYuV1NwZWxsOklzUmVhZHkoKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKSBhbmQgc2VsZi50c3cudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVcgYW5kICBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICAgKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RXKHNlbGYudHN3LnRhcmdldCkNCiAgICAgIGVuZA0KICAgICAgaWYoc2VsZi5Db25maWcuc2tpbGxsb2dpYy5SbG9naWMuUmxvZ2ljID09IDMgb3Igc2VsZi5Db25maWcuc2tpbGxsb2dpYy5SbG9naWMuUmxvZ2ljID09IDEgYW5kIHNlbGYuUlNwZWxsOklzUmVhZHkoKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKSBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUiBhbmQgc2VsZi5Db25maWcuS2V5cy5jb21ib2tleSAgKXRoZW4NCiAgICAgIGZvciBfLCB1bml0IGluIHBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvDQogICAgICAgIGxvY2FsIGRtZ1IgPWdldERtZygiUiIsdW5pdCxteUhlcm8pKyAoKG15SGVyby5hcCkqMC43MCkgDQogICAgICAgIGxvY2FsIGhlYWx0aD11bml0LmhlYWx0aA0KICAgICAgICBpZihoZWFsdGg8ZG1nUiBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlUiBhbmQgR2V0RGlzdGFuY2UodW5pdCk8NTUwKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RSKHVuaXQpDQogICAgICBlbHNlaWYgKHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljLlJsb2dpYyA9PSAyIGFuZCAgbXlIZXJvLmhlYWx0aCA8PSAobXlIZXJvLm1heEhlYWx0aCAqIHNlbGYuQ29uZmlnLnNraWxsbG9naWMuUmxvZ2ljLmF1dG9SIC8gMTAwKSkgdGhlbiANCiAgICAgICBzZWxmOkNhc3RSUyhteUhlcm8pDQogICAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgDQogICAgICBpZihzZWxmLkNvbmZpZy5jb21iby51c2VJIGFuZCBzZWxmLkNvbmZpZy5LZXlzLmNvbWJva2V5ICApdGhlbg0KICAgICAgZm9yIF8sIHVuaXQgaW4gcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8NCiAgICAgICAgbG9jYWwgZG1nSSA9KDUwKyAoKG15SGVyby5sZXZlbCkqMjApKQ0KICAgICAgICBsb2NhbCBoZWFsdGg9dW5pdC5oZWFsdGgNCiAgICAgICAgaWYoaGVhbHRoPGRtZ0kgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZUkgYW5kIEdldERpc3RhbmNlKHVuaXQpPDYwMCl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0SSh1bml0KQ0KICAgICAgZW5kDQogICAgICBlbmQNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMaXNzYW5kcmE6Q2FzdFEodW5pdCkNCiAgICBzZWxmLlFTcGVsbDpDYXN0KHVuaXQpDQogIGVuZA0KICANCiAgZnVuY3Rpb24gTGlzc2FuZHJhOkNhc3RXKHVuaXQpDQogICAgc2VsZi5XU3BlbGw6Q2FzdCh1bml0KQ0KICBlbmQNCiAgDQogIGZ1bmN0aW9uIExpc3NhbmRyYTpDYXN0RSh1bml0KQ0KICAgIHNlbGYuRVNwZWxsOkNhc3QodW5pdCkNCiAgZW5kDQogIA0KICBmdW5jdGlvbiBMaXNzYW5kcmE6Q2FzdFIodW5pdCkNCiAgICBzZWxmLlJTcGVsbDpDYXN0KHVuaXQpDQogIGVuZA0KICBmdW5jdGlvbiBMaXNzYW5kcmE6Q2FzdFJTKHVuaXQpDQogICBDYXN0U3BlbGwoX1IgLCBteUhlcm8pDQogIGVuZA0KICANCiAgZnVuY3Rpb24gTGlzc2FuZHJhOkNhc3RJKHVuaXQpDQogICAgc2VsZi5JZ25pdGU6Q2FzdCh1bml0KQ0KICBlbmQNCiAgZnVuY3Rpb24gTGlzc2FuZHJhOmtpbGxzdGVhbCgpDQogIGZvciBfLCB1bml0IGluIHBhaXJzKEdldEVuZW15SGVyb2VzKCkpIGRvDQogICAgICBsb2NhbCBoZWFsdGggPSB1bml0LmhlYWx0aA0KICAgICAgbG9jYWwgZG1nRSA9IGdldERtZygiRSIsIHVuaXQsIG15SGVybykgKyAoKG15SGVyby5hcCkqMC42KSANCiAgICAgICAgaWYoc2VsZi50c2UudGFyZ2V0IH49IG5pbCBhbmQgIHNlbGYuRVNwZWxsOklzUmVhZHkoKSBhbmQgaGVhbHRoPGRtZ0UgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VFICAgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0RSh1bml0KSAgDQogICAgICAgIGVuZA0KICAgICAgICBsb2NhbCBkbWdRID0gZ2V0RG1nKCJRIiwgdW5pdCwgbXlIZXJvKSArICgobXlIZXJvLmFwKSowLjY1KQ0KICAgICAgICBpZihzZWxmLnRzcS50YXJnZXQgfj0gbmlsIGFuZCAgc2VsZi5RU3BlbGw6SXNSZWFkeSgpIGFuZCBoZWFsdGg8ZG1nUSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZVEgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFEodW5pdCkgIA0KICAgICAgICBlbmQNCiAgICAgICAgbG9jYWwgZG1nVyA9IGdldERtZygiVyIsIHVuaXQsIG15SGVybykgKyAoKG15SGVyby5hcCkqMC40MCkNCiAgICAgICAgaWYoc2VsZi50c3cudGFyZ2V0IH49IG5pbCBhbmQgIHNlbGYuV1NwZWxsOklzUmVhZHkoKSBhbmQgaGVhbHRoPGRtZ1EgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VXIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RXKHVuaXQpICANCiAgICAgICAgZW5kDQogICAgICAgICBsb2NhbCBkbWdJID0oNTArICgobXlIZXJvLmxldmVsKSoyMCkpDQogICAgICAgIGlmKGhlYWx0aDxkbWdJIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlSSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzIGFuZCBHZXREaXN0YW5jZSh1bml0KTw2MDApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEkodW5pdCkNCiAgICAgICAgZW5kDQogICAgICAgIGxvY2FsIGRtZ1IgPWdldERtZygiUiIsdW5pdCxteUhlcm8pKygobXlIZXJvLmFwKSowLjcwKSANCiAgICAgICAgaWYoc2VsZi50c3IudGFyZ2V0IH49IG5pbCBhbmQgIHNlbGYuUlNwZWxsOklzUmVhZHkoKSBhbmQgaGVhbHRoPGRtZ1IgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VSIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgYW5kIEdldERpc3RhbmNlKHVuaXQpPDU1MCl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0Uih1bml0KQ0KICAgICAgICBlbmQNCiAgICAgZW5kDQogIGVuZA0KICANCiAgZnVuY3Rpb24gTGlzc2FuZHJhOmVzY2FwZSgpDQogIGxvY2FsIFRpY2tlciA9IEdldFRpY2tDb3VudCgpDQogIGlmIChnbG9iYWxfdGlja3MgKyAyMDAwKSA8IFRpY2tlciB0aGVuDQogIGlmIHNlbGYuQ29uZmlnLktleXMuZXNjYXBla2V5IGFuZCBzZWxmLkNvbmZpZy5lc2NhcGUudXNlRSAgdGhlbg0KICBpZiAobXlIZXJvOkNhblVzZVNwZWxsKF9FKSA9PSBSRUFEWSApIHRoZW4NCiAgICAgQ2FzdFNwZWxsKF9FLG1vdXNlUG9zLngsbW91c2VQb3MueikNCiAgICAgZ2xvYmFsX3RpY2tzID0gVGlja2VyDQogICAgICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBDYXN0U3BlbGwoX0UpIGVuZCwgMS41KQ0KICBlbmQNCiAgZW5kDQogIGVuZA0KICBpZiBzZWxmLkNvbmZpZy5LZXlzLmVzY2FwZWtleSB0aGVuIA0KICBzZWxmOndhbGsoKQ0KICBlbmQNCiAgaWYgc2VsZi5Db25maWcuS2V5cy5lc2NhcGVrZXkgYW5kIHNlbGYuQ29uZmlnLmVzY2FwZS51c2VXIGFuZCBzZWxmLnRzdy50YXJnZXR+PW5pbCB0aGVuDQogIENhc3RTcGVsbChfVyx0c3cudGFyZ2V0KQ0KICBlbmQNCiAgZW5kDQogIGZ1bmN0aW9uIExpc3NhbmRyYTp3YWxrKCkNCiAgICBteUhlcm86TW92ZVRvKG1vdXNlUG9zLngsbW91c2VQb3MueikNCiAgZW5kDQogIGZ1bmN0aW9uIExpc3NhbmRyYTpoYXJhc3MoKQ0KICAgIHNlbGYudHM6dXBkYXRlKCkNCiAgICBzZWxmLnRzcTp1cGRhdGUoKQ0KICAgICBzZWxmLnRzdzp1cGRhdGUoKQ0KICAgICAgc2VsZi50c2U6dXBkYXRlKCkNCiAgICBpZiBzZWxmLkNvbmZpZy5LZXlzLmhhcmFzc2tleSBvciBzZWxmLkNvbmZpZy5LZXlzLmhhcmFzc3RvZ2xla2V5IHRoZW4NCiAgICAgICAgaWYoc2VsZi5RU3BlbGw6SXNSZWFkeSgpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmhhcmFzcy5NYW5hIC8xMDAgKSBhbmQgc2VsZi50c3EudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmhhcmFzcy51c2VRICkgdGhlbiAgICAgICAgDQogICAgICAgICAgc2VsZjpDYXN0UShzZWxmLnRzcS50YXJnZXQpDQogICAgICAgIGVuZCAgIA0KICAgICAgICBlbmQNCiAgICBpZiBzZWxmLkNvbmZpZy5LZXlzLmhhcmFzc2tleSBvciBzZWxmLkNvbmZpZy5LZXlzLmhhcmFzc3RvZ2xla2V5IHRoZW4NCiAgICAgICAgaWYoc2VsZi5XU3BlbGw6SXNSZWFkeSgpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmhhcmFzcy5NYW5hIC8xMDAgKSBhbmQgc2VsZi50c3cudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmhhcmFzcy51c2VXICkgdGhlbiAgICAgICAgDQogICAgICAgICAgc2VsZjpDYXN0VyhzZWxmLnRzdy50YXJnZXQpDQogICAgICAgIGVuZCAgDQogICAgICAgIGVuZCANCiAgICAgICAgICBpZiBzZWxmLkNvbmZpZy5LZXlzLmhhcmFzc2tleSBvciBzZWxmLkNvbmZpZy5LZXlzLmhhcmFzc3RvZ2xla2V5ICB0aGVuDQogICAgICAgIGlmKHNlbGYuQ29uZmlnLnNraWxsbG9naWMuRWxvZ2ljLmhhcmFzcyA9PSAxICBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5oYXJhc3MuTWFuYSAvMTAwICkgIGFuZCBzZWxmLkNvbmZpZy5oYXJhc3MudXNlRSApIHRoZW4gICAgICAgIA0KICAgICAgICAgbG9jYWwgVGlja2VyID0gR2V0VGlja0NvdW50KCkNCiAgaWYgKGdsb2JhbF90aWNrcyArIDIwMDApIDwgVGlja2VyIHRoZW4NCiAgaWYgKG15SGVybzpDYW5Vc2VTcGVsbChfRSkgPT0gUkVBRFkgYW5kIHNlbGYudHNlLnRhcmdldH49bmlsKSB0aGVuDQogICAgIENhc3RTcGVsbChfRSwgc2VsZi50c2UudGFyZ2V0LngsIHNlbGYudHNlLnRhcmdldC56KQ0KICAgICBnbG9iYWxfdGlja3MgPSBUaWNrZXINCiAgICAgICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIENhc3RTcGVsbChfRSkgZW5kLCAyKQ0KICAgICAgICAgIGVuZA0KICAgICAgICAgIGVuZA0KICAgICAgICAgIGVuZA0KICAgICAgICAgIGVuZA0KICAgICAgICAgICBpZiBzZWxmLkNvbmZpZy5LZXlzLmhhcmFzc2tleSBvciBzZWxmLkNvbmZpZy5LZXlzLmhhcmFzc3RvZ2xla2V5ICB0aGVuDQogICAgICAgICAgICAgICBpZihzZWxmLkNvbmZpZy5za2lsbGxvZ2ljLkVsb2dpYy5oYXJhc3MgPT0gMiBhbmQgICAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmhhcmFzcy5NYW5hIC8xMDAgKSAgYW5kIHNlbGYuQ29uZmlnLmhhcmFzcy51c2VFICkgdGhlbiAgICAgICAgDQogICAgICAgICBsb2NhbCBUaWNrZXIgPSBHZXRUaWNrQ291bnQoKQ0KICBpZiAoZ2xvYmFsX3RpY2tzICsgMjAwMCkgPCBUaWNrZXIgdGhlbg0KICBpZiAobXlIZXJvOkNhblVzZVNwZWxsKF9FKSA9PSBSRUFEWSBhbmQgc2VsZi50c2UudGFyZ2V0fj1uaWwpIHRoZW4NCiAgICAgQ2FzdFNwZWxsKF9FLCBzZWxmLnRzZS50YXJnZXQueCwgc2VsZi50c2UudGFyZ2V0LnopDQogICAgIGdsb2JhbF90aWNrcyA9IFRpY2tlcg0KICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgQ2FzdFNwZWxsKF9FKSBlbmQsIDEuNSkNCiAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgZW5kDQogIGZ1bmN0aW9uIExpc3NhbmRyYTpMYW5lQ2xlYXIoKQ0KICAgbG9jYWwgY2xlYXJ0YXJnZXQgPSBuaWwNCiAgc2VsZi5lbmVteU1pbmlvbnM6dXBkYXRlKCkNCiAgIHNlbGYub3RoZXJNaW5pb25zOnVwZGF0ZSgpDQogICAgICBzZWxmLmp1bmdsZU1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIGZvciBpLCBtaW5pb24gaW4gaXBhaXJzKHNlbGYuZW5lbXlNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICAgIGlmIFZhbGlkVGFyZ2V0KG1pbmlvbiwgNjAwKSBhbmQgKGNsZWFydGFyZ2V0ID09IG5pbCBvciBub3QgVmFsaWRUYXJnZXQoY2xlYXJ0YXJnZXQpKSB0aGVuDQogICAgICAgICAgY2xlYXJ0YXJnZXQgPSBtaW5pb24NCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGZvciBpLCBtaW5pb24gaW4gcGFpcnMoc2VsZi5lbmVteU1pbmlvbnMub2JqZWN0cykgZG8NCiAgICAgICAgaWYgVmFsaWRUYXJnZXQobWluaW9uKSBhbmQgbWluaW9uIH49IG5pbCB0aGVuDQogICAgICAgICAgaWYgc2VsZi5Db25maWcuS2V5cy5sYW5lY2xlYXJrZXkgIGFuZCBzZWxmLkNvbmZpZy5mYXJtLmxhbmVjbGVhci51c2VRIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmZhcm0ubGFuZWNsZWFyLk1hbmEgLzEwMCApIGFuZCBHZXREaXN0YW5jZShtaW5pb24pIDw9IHNlbGYuUVNwZWxsLlJhbmdlIHRoZW4gDQogICAgICAgICBsb2NhbCBCZXN0UG9zLCBCZXN0SGl0ID0gR2V0QmVzdExpbmVGYXJtUG9zaXRpb24oc2VsZi5RU3BlbGwuUmFuZ2UsIHNlbGYuUVNwZWxsLldpZHRoLCBzZWxmLmVuZW15TWluaW9ucy5vYmplY3RzICkNCiAgICAgICAgaWYgQmVzdFBvcyAgYW5kIEJlc3RIaXQgPiAwIHRoZW4NCiAgICAgICAgIENhc3RTcGVsbChfUSwgQmVzdFBvcy54LCBCZXN0UG9zLnopDQogICAgICAgICAgZW5kDQogICAgICAgIGlmIGNsZWFydGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGlmKHNlbGYuV1NwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcuZmFybS5sYW5lY2xlYXIudXNlVyBhbmQgc2VsZi5Db25maWcuS2V5cy5sYW5lY2xlYXJrZXkgKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5mYXJtLmxhbmVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgICAgc2VsZjpDYXN0VyhjbGVhcnRhcmdldCkNCiAgICAgICAgZW5kDQogICAgICAgIGVuZA0KICAgICAgICBlbmQNCiAgICAgICAgZW5kDQogICAgICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGlzc2FuZHJhOmF1dG9xKCkNCiAgDQogICAgICAgIGlmKHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5oYXJhc3MuTWFuYSAvMTAwICkgYW5kIHNlbGYudHNxLnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5oYXJhc3MuYXV0b3EgKSB0aGVuICAgICAgICANCiAgICAgICAgICBzZWxmOkNhc3RRKHNlbGYudHNxLnRhcmdldCkNCiAgICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGlzc2FuZHJhOkp1bmdsZUNsZWFyKCkNCiAgbG9jYWwgY2xlYXJ0YXJnZXQgPSBuaWwNCiAgICAgIHNlbGYuZW5lbXlNaW5pb25zOnVwZGF0ZSgpDQogICAgICBzZWxmLm90aGVyTWluaW9uczp1cGRhdGUoKQ0KICAgICAgc2VsZi5qdW5nbGVNaW5pb25zOnVwZGF0ZSgpDQogICAgICBmb3IgaSwgbWluaW9uIGluIGlwYWlycyhzZWxmLmVuZW15TWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgICBpZiBWYWxpZFRhcmdldChtaW5pb24sIDYwMCkgYW5kIChjbGVhcnRhcmdldCA9PSBuaWwgb3Igbm90IFZhbGlkVGFyZ2V0KGNsZWFydGFyZ2V0KSkgdGhlbg0KICAgICAgICAgIGNsZWFydGFyZ2V0ID0gbWluaW9uDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBmb3IgaSwganVuZ2xlbWluaW9uIGluIGlwYWlycyhzZWxmLmp1bmdsZU1pbmlvbnMub2JqZWN0cykgZG8NCiAgICAgICAgaWYgVmFsaWRUYXJnZXQoanVuZ2xlbWluaW9uLCA2MDApIGFuZCAoY2xlYXJ0YXJnZXQgPT0gbmlsIG9yIG5vdCBWYWxpZFRhcmdldChjbGVhcnRhcmdldCkpIHRoZW4NCiAgICAgICAgICBjbGVhcnRhcmdldCA9IGp1bmdsZW1pbmlvbg0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgZm9yIGksIG90aGVybWluaW9uIGluIGlwYWlycyhzZWxmLm90aGVyTWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgICBpZiBWYWxpZFRhcmdldChvdGhlcm1pbmlvbiwgNjAwKSBhbmQgKGNsZWFydGFyZ2V0ID09IG5pbCBvciBub3QgVmFsaWRUYXJnZXQoY2xlYXJ0YXJnZXQpKSB0aGVuDQogICAgICAgICAgY2xlYXJ0YXJnZXQgPSBvdGhlcm1pbmlvbg0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgaWYgY2xlYXJ0YXJnZXQgfj0gbmlsIHRoZW4NCiAgICAgICAgaWYoc2VsZi5RU3BlbGw6SXNSZWFkeSgpIGFuZCBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyLnVzZVEgYW5kIHNlbGYuQ29uZmlnLktleXMuanVuZ2xlY2xlYXJrZXkgKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyLk1hbmEgLzEwMCApIHRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RRKGNsZWFydGFyZ2V0KQ0KICAgICAgICBlbmQNCiAgICAgICAgaWYgY2xlYXJ0YXJnZXQgfj0gbmlsIHRoZW4NCiAgICAgICAgaWYoc2VsZi5XU3BlbGw6SXNSZWFkeSgpIGFuZCBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyLnVzZVcgYW5kIHNlbGYuQ29uZmlnLktleXMuanVuZ2xlY2xlYXJrZXkgKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyLk1hbmEgLzEwMCApIHRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RXKGNsZWFydGFyZ2V0KQ0KICAgICAgICBlbmQNCiAgICAgICAgaWYgY2xlYXJ0YXJnZXQgfj0gbmlsIHRoZW4NCiAgICAgICAgaWYoc2VsZi5FU3BlbGw6SXNSZWFkeSgpIGFuZCBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyLnVzZUUgYW5kIHNlbGYuQ29uZmlnLktleXMuanVuZ2xlY2xlYXJrZXkgKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5mYXJtLmp1bmdsZWNsZWFyLk1hbmEgLzEwMCApIHRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RFKGNsZWFydGFyZ2V0KQ0KICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgIGVuZA0KICBlbmQNCiAgZW5kDQogIC0tIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLUxpc2FuZHJhIGVuZGluZy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgLS0gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tTGlzYW5kcmEgZW5kaW5nLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAtLSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1MaXNhbmRyYSBlbmRpbmctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogIC0tIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLUxpc2FuZHJhIGVuZGluZy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgDQogIC0tIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVZpa3RvciBTdGFydC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgLS0gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tVmlrdG9yIFN0YXJ0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAtLSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1WaWt0b3IgU3RhcnQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogIC0tIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVZpa3RvciBTdGFydC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgY2xhc3MgIlZpa3RvciINCiAgcmVxdWlyZSAnSFByZWRpY3Rpb24nDQogIGZ1bmN0aW9uIFZpa3RvcjpfX2luaXQoKQ0KICAgc2VsZi50cz0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgNTI1LCBEQU1BR0VfUEhZU0lDQUwsIGZhbHNlLCB0cnVlKQ0KICAgIHNlbGYudHNxPSBUYXJnZXRTZWxlY3RvcihUQVJHRVRfTEVTU19DQVNUX1BSSU9SSVRZLCA2MDAsIERBTUFHRV9QSFlTSUNBTCwgZmFsc2UsIHRydWUpDQogICAgc2VsZi50c3c9IFRhcmdldFNlbGVjdG9yKFRBUkdFVF9MRVNTX0NBU1RfUFJJT1JJVFksIDcwMCwgREFNQUdFX01BR0lDLCBmYWxzZSwgdHJ1ZSkNCiAgICBzZWxmLnRzZT0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgMTIwMCwgREFNQUdFX01BR0lDLCBmYWxzZSwgdHJ1ZSkNCiAgICBzZWxmLnRzcj0gVGFyZ2V0U2VsZWN0b3IoVEFSR0VUX0xFU1NfQ0FTVF9QUklPUklUWSwgNzAwLCBEQU1BR0VfTUFHSUMsIGZhbHNlLCB0cnVlKSANCiAgICAgc2VsZi5RU3BlbGwgPSBfU3BlbGwoe1Nsb3QgPSBfUSwgRGFtYWdlTmFtZSA9ICJRIiwgUmFuZ2UgPSBtYXRoLmh1Z2UsIFdpZHRoID0gMSwgRGVsYXkgPSAwLCBTcGVlZCA9IG1hdGguaHVnZSwgQ29sbGlzaW9uID0gdHJ1ZSwgQW9lID0gZmFsc2UsIFR5cGUgPSBTUEVMTF9UWVBFLlRBUkdFVFRFRH0pDQogICAgIHNlbGYuV1NwZWxsID0gX1NwZWxsKHtTbG90ID0gX1csIERhbWFnZU5hbWUgPSAiVyIsIFJhbmdlID0gbWF0aC5odWdlLCBXaWR0aCA9IDEyNSwgRGVsYXkgPSAwLjUsIFNwZWVkID0gNzUwLCBDb2xsaXNpb24gPSBmYWxzZSwgQW9lID0gdHJ1ZSwgVHlwZSA9IFNQRUxMX1RZUEUuQ0lSQ1VMQVJ9KQ0KICAgICBzZWxmLkVTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9FLCBEYW1hZ2VOYW1lID0gIkUiLCBSYW5nZSA9IDEyMDAsIFdpZHRoID0gOTAsIERlbGF5ID0gMCwgU3BlZWQgPSBtYXRoLmh1Z2UsIENvbGxpc2lvbiA9IHRydWUsIEFvZSA9IGZhbHNlLCBUeXBlID0gU1BFTExfVFlQRS5MSU5FQVJ9KQ0KICAgICBzZWxmLlJTcGVsbCA9IF9TcGVsbCh7U2xvdCA9IF9SLCBEYW1hZ2VOYW1lID0gIlIiLCBSYW5nZSA9NzAwLCBXaWR0aCA9IDAsIERlbGF5ID0gMC4yNSwgU3BlZWQgPSAxMDAwLCBDb2xsaXNpb24gPSBmYWxzZSwgQW9lID0gdHJ1ZSwgVHlwZSA9IFNQRUxMX1RZUEUuQ0lSQ1VMQVJ9KQ0KICAgICBzZWxmLklnbml0ZSA9IF9TcGVsbCh7U2xvdCA9IEZpbmRTdW1tb25lclNsb3QoInN1bW1vbmVyZG90IiksIERhbWFnZU5hbWUgPSAiSUdOSVRFIiwgUmFuZ2UgPSA2MDAsIFR5cGUgPSBTUEVMTF9UWVBFLlRBUkdFVFRFRH0pDQogICAgIHNlbGYuSFByZWQgPSBIUHJlZGljdGlvbigpDQogICAgIHNlbGYuRSA9IHtSYW5nZTEgPSA1NTAsIFJhbmdlMiA9IDcwMCwgd2lkdGggPSAxODAsIHJlYWR5fQ0KICAgICBzZWxmLkVSYW5nZSA9IHNlbGYuRS5SYW5nZTErc2VsZi5FLlJhbmdlMg0KICAtLXw+IE1pbmlvbiBNYW5hZ2Vycw0KICAgICAgc2VsZi5lbmVteU1pbmlvbnMgICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX0VORU1ZLCAgIDY1MCwgbXlIZXJvLCBNSU5JT05fU09SVF9NQVhIRUFMVEhfREVDKQ0KICAgICAgc2VsZi5hbGx5TWluaW9ucyAgICA9IG1pbmlvbk1hbmFnZXIoTUlOSU9OX0FMTFksICAgNjUwLCBteUhlcm8sIE1JTklPTl9TT1JUX01BWEhFQUxUSF9ERUMpDQogICAgICBzZWxmLmp1bmdsZU1pbmlvbnMgID0gbWluaW9uTWFuYWdlcihNSU5JT05fSlVOR0xFLCAgNjUwLCBteUhlcm8sIE1JTklPTl9TT1JUX01BWEhFQUxUSF9ERUMpDQogICAgICBzZWxmLm90aGVyTWluaW9ucyAgID0gbWluaW9uTWFuYWdlcihNSU5JT05fT1RIRVIsICAgNjUwLCBteUhlcm8sIE1JTklPTl9TT1JUX01BWEhFQUxUSF9ERUMpDQogICAgICAgICAgICAgIHNlbGY6TG9hZE1lbnUoKQ0KICAgICAgICAgICAgICBzZWxmOmZpbmRvcmJ3YWxrZXIoKQ0KICAgICAgICAgICAgICAgIExhc3RfTGV2ZWxTcGVsbCA9IDANCiAgICAgICAgIC0tIGlmIFZJUF9VU0VSIHRoZW4gc2VsZjpza2luaGFjaygpIGVuZA0KICAgICAgICBBZGRUaWNrQ2FsbGJhY2soZnVuY3Rpb24oKSBzZWxmOlRpY2soKSBlbmQpDQogICAgQWRkRHJhd0NhbGxiYWNrKGZ1bmN0aW9uKCkgc2VsZjpEcmF3KCkgZW5kKQ0KICAgIC0tQWRkTXNnQ2FsbGJhY2soZnVuY3Rpb24obXNnLEtleSkgc2VsZjpXbmRNc2cobXNnLEtleSkgZW5kKQ0KICAgIC0tQWRkQW5pbWF0aW9uQ2FsbGJhY2soZnVuY3Rpb24odW5pdCwgYW5pbWF0aW9uKSBzZWxmOkFuaW1hdGlvbih1bml0LCBhbmltYXRpb24pIGVuZCkNCiAgICAtLUFkZFByb2Nlc3NTcGVsbENhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIHNwZWxsKSBzZWxmOlByb2Nlc3NTcGVsbCh1bml0LCBzcGVsbCkgZW5kKQ0KICAgIC0tQWRkQXBwbHlCdWZmQ2FsbGJhY2soZnVuY3Rpb24oc291cmNlLCB1bml0LCBidWZmKSBzZWxmOk9uQXBwbHlCdWZmKHNvdXJjZSwgdW5pdCwgYnVmZikgZW5kKQ0KICAgIC0tQWRkVXBkYXRlQnVmZkNhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIGJ1ZmYsIHN0YWNrcykgc2VsZjpVcGRhdGVCdWZmKHVuaXQsIGJ1ZmYsIHN0YWNrcykgZW5kKQ0KICAgIC0tQWRkUmVtb3ZlQnVmZkNhbGxiYWNrKGZ1bmN0aW9uKHVuaXQsIGJ1ZmYpIHNlbGY6T25SZW1vdmVCdWZmKHVuaXQsIGJ1ZmYpIGVuZCkgDQogICAgICBlbmQNCiAgLS0gaGFuZGxlcyBzY3JpcHQgbG9naWMsIGEgcHVyZSBoaWdoIHNwZWVkIGxvb3ANCiAgZnVuY3Rpb24gVmlrdG9yOlRpY2soKQ0KICAgICAgIHNlbGY6YXV0b3pob255YSgpDQogICAgICAgICAgIGlmIFZJUF9VU0VSIHRoZW4gc2VsZjphdXRvbGV2ZWwoKSBlbmQNCiAgIGlmKHNlbGYuQ29uZmlnLmNvbWJvLmNvbWJva2V5ICl0aGVuDQogICAgICBzZWxmOmNvbWJvKCkNCiAgICBlbmQNCiAgICBpZihzZWxmLkNvbmZpZy5sYW5lY2xlYXIubGFuZWNsZWFya2V5KXRoZW4NCiAgICAgIHNlbGY6TGFuZUNsZWFyKCkNCiAgICBlbmQNCiAgICAgIGlmKHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyLmp1bmdsZWNsZWFya2V5KXRoZW4NCiAgICAgIHNlbGY6SnVuZ2xlQ2xlYXIoKQ0KICAgIGVuZA0KICAgIGlmKHNlbGYuQ29uZmlnLmtpbGxzdGVhbC5rcyApIHRoZW4NCiAgICAgIHNlbGY6a2lsbHN0ZWFsKCkNCiAgICBlbmQNCiAgICBpZihzZWxmLkNvbmZpZy5oYXJhc3MuaGFyYXNza2V5IG9yIHNlbGYuQ29uZmlnLmhhcmFzcy5oYXJhc3N0b2dsZSApIHRoZW4NCiAgICAgIHNlbGY6aGFyYXNzKCkNCiAgICBlbmQNCiAgICAgIGVuZA0KICBmdW5jdGlvbiBWaWt0b3I6TG9hZE1lbnUoKQ0KICAgICAgICBzZWxmLkNvbmZpZz1zY3JpcHRDb25maWcoIiIuLlNjcmlwdG5hbWUuLiIiLCJtZW51IikNCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiSGl0Y2hhbmNlIiwgImhpdCIpDQogICAgICAgIHNlbGYuQ29uZmlnLmhpdDphZGRQYXJhbSgiRSIsICJFIEhpdENoYW5jZSAoRGVmYXVsdCB2YWx1ZSA9IDEuNikiLCBTQ1JJUFRfUEFSQU1fU0xJQ0UsIDEuNiwgMSwgMywgMikNCiAgICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiQ29tYm8gU2V0dGluZ3MiLCAiY29tYm8iKQ0KICAgICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgiY29tYm9rZXkiLCAiQ29tYm8gS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIDMyKQ0KICAgICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlUSIsICJVc2UgUSBpbiBDb21ibyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZVciLCAiVXNlIFcgaW4gQ29tYm8iLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJ1c2VFIiwgIlVzZSBFIGluIGNvbWJvIiwgU0NSSVBUX1BBUkFNX09OT0ZGLCB0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5jb21ibzphZGRQYXJhbSgidXNlUiIsICJVc2UgUiBpbiBjb21ibyIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuY29tYm86YWRkUGFyYW0oInVzZUkiLCAiVXNlIElnbml0ZSBpZiB0YXJnZXQga2lsbGFibGUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJsb2dpYyIsICJVbHRpIExvZ2ljIiwgU0NSSVBUX1BBUkFNX0xJU1QsIDEsIHsiVXNlIFVsdGkgSWYgVGFyZ2V0IElzIEtpbGxhYmxlIix9KSAtLSgiVXNlIFVsdGkgRGlyZWN0bHkiIH0pDQogICAgICAgIHNlbGYuQ29uZmlnLmNvbWJvOmFkZFBhcmFtKCJNYW5hIiwiTWFuYSBNYW5hZ2VyICUiLFNDUklQVF9QQVJBTV9TTElDRSwgMTAsIDEwLCAxMDAsIDApDQogICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJIYXJhc3MgU2V0dGluZ3MiLCAiaGFyYXNzIikNCiAgICAgICAgc2VsZi5Db25maWcuaGFyYXNzOmFkZFBhcmFtKCJoYXJhc3NrZXkiLCAiU21hcnQgSGFyYXNzIEtleSIsIFNDUklQVF9QQVJBTV9PTktFWURPV04sIGZhbHNlLCBzdHJpbmcuYnl0ZSgiQyIpKQ0KICAgICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6YWRkUGFyYW0oImhhcmFzc3RvZ2xlIiwgIlNtYXJ0IEF1dG8gSGFyYXNzIiwgICBTQ1JJUFRfUEFSQU1fT05LRVlUT0dHTEUsIGZhbHNlLCBzdHJpbmcuYnl0ZSgiVCIpKQ0KICAgICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6YWRkUGFyYW0oInVzZVEiLCAiSGFyYXNzIFdpdGggUSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgc2VsZi5Db25maWcuaGFyYXNzOmFkZFBhcmFtKCJ1c2VFIiwgIkhhcmFzcyBXaXRoIEUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmhhcmFzczphZGRQYXJhbSgiRSIsICJFIEhpdENoYW5jZSAoRGVmYXVsdCB2YWx1ZSA9IDIpIiwgU0NSSVBUX1BBUkFNX1NMSUNFLCAyLCAxLCAzLCAyKQ0KICAgICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6YWRkUGFyYW0oIk1hbmEiLCJNYW5hIE1hbmFnZXIgJSIsU0NSSVBUX1BBUkFNX1NMSUNFLCAzMCwgMTAsIDEwMCwgMCkNCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkxhbmVDbGVhciBTZXR0aW5ncyIsImxhbmVjbGVhciIpDQogICAgICAgIHNlbGYuQ29uZmlnLmxhbmVjbGVhcjphZGRQYXJhbSgibGFuZWNsZWFya2V5IiwgIkxhbmUgQ2xlYXIgS2V5IiwgU0NSSVBUX1BBUkFNX09OS0VZRE9XTiwgZmFsc2UsIHN0cmluZy5ieXRlKCJWIikpDQogICAgICAgIHNlbGYuQ29uZmlnLmxhbmVjbGVhcjphZGRQYXJhbSgidXNlUSIsIlVzZSBRIG9uIExhbmVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmxhbmVjbGVhcjphZGRQYXJhbSgidXNlRSIsIlVzZSBFIG9uIExhbmVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmxhbmVjbGVhcjphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDMwLCAxMCwgMTAwLCAwKQ0KICAgICAgICANCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiSnVuZ2xlQ2xlYXIgU2V0dGluZ3MiLCJqdW5nbGVjbGVhciIpDQogICAgICAgIHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyOmFkZFBhcmFtKCJqdW5nbGVjbGVhcmtleSIsICJKdW5nbGVDbGVhciBLZXkiLCBTQ1JJUFRfUEFSQU1fT05LRVlET1dOLCBmYWxzZSwgc3RyaW5nLmJ5dGUoIlYiKSkNCiAgICAgICAgc2VsZi5Db25maWcuanVuZ2xlY2xlYXI6YWRkUGFyYW0oInVzZVEiLCJVc2UgUSBvbiBqdW5nbGVjbGVhciIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyOmFkZFBhcmFtKCJ1c2VFIiwiVXNlIEUgb24ganVuZ2xlY2xlYXIiLFNDUklQVF9QQVJBTV9PTk9GRix0cnVlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhcjphZGRQYXJhbSgiTWFuYSIsIk1hbmEgTWFuYWdlciAlIixTQ1JJUFRfUEFSQU1fU0xJQ0UsIDMwLCAxMCwgMTAwLCAwKQ0KICAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIktpbGxTdGVhbCBTZXR0aW5ncyIsICJraWxsc3RlYWwiKQ0KICAgICAgICBzZWxmLkNvbmZpZy5raWxsc3RlYWw6YWRkUGFyYW0oImtzIiwiS2lsbHN0ZWFsIE9uL09mZiIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgidXNlUSIsICJTdGVhbCBXaXRoIFEiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgidXNlRSIsICJTdGVhbCBXaXRoIEUiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgidXNlUiIsICJTdGVhbCBXaXRoIFIiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLmtpbGxzdGVhbDphZGRQYXJhbSgidXNlSSIsICJTdGVhbCBXaXRoIElnbml0ZSIsIFNDUklQVF9QQVJBTV9PTk9GRiwgdHJ1ZSkNCiAgICAgICAgDQogICAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIkl0ZW0gU2V0dGluZ3MiLCAiaXRlbSIpDQogICAgICAgIHNlbGYuQ29uZmlnLml0ZW06YWRkUGFyYW0oImVuYWJsZWF1dG96aG9ueWEiLCAiQXV0byBaaG9ueWEiLCBTQ1JJUFRfUEFSQU1fT05PRkYsIGZhbHNlKQ0KICAgICAgICBzZWxmLkNvbmZpZy5pdGVtOmFkZFBhcmFtKCJhdXRvemhvbnlhIiwgIlpob255YSBpZiBIZWFsdGggdW5kZXIgLT4gJSIsIFNDUklQVF9QQVJBTV9TTElDRSwgMTAsIDAsIDEwMCwgMCkNCiAgICAgICAgDQogICAgICAgICAgICAgIGlmIFZJUF9VU0VSIHRoZW4NCiAgICAgICAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiVklQIFNldHRpbmdzIiwgInZpcCIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgicGFja2V0IiwiVXNlIFBhY2tldCBDYXN0aW5nIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzEiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzIiLCAiVG8gdXNlIHZpcCBzZXR0aW5ncywgUGFja2V0IENhc3Rpbmcgc2hvdWxkIGJlIG9wZW4uIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRTdWJNZW51KCJBdXRvIExldmVsIFNldHRpbmdzIiwgImxldmVsIikNCiAgICAgICAgc2VsZi5Db25maWcudmlwLmxldmVsOmFkZFBhcmFtKCJrZXkiLCJVc2UgQXV0byBMZXZlbCIsU0NSSVBUX1BBUkFNX09OT0ZGLGZhbHNlKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXAubGV2ZWw6YWRkUGFyYW0oImxvZ2ljIiwgIlNlbGVjdCBTa2lsbCBPcmRlciIsIFNDUklQVF9QQVJBTV9MSVNULCA3LCB7IkZvY3VzIFE+Vz5FIiwgIkZvY3VzIFE+RT5XIiwiRm9jdXMgVz5RPkUiLCJGb2N1cyBXPkU+USIsIkZvY3VzIEU+Vz5RIiwgIkZvY3VzIEU+UT5XIiwgIlNtYXJ0IiAgfSkNCiAgICAgICAgc2VsZi5Db25maWcudmlwOmFkZFN1Yk1lbnUoIlNraW4gSGFjayBTZXR0aW5ncyIsICJza2luIikNCiAgICAgICAgc2VsZi5Db25maWcudmlwLnNraW46YWRkUGFyYW0oImtleSIsIlVzZSBTa2luIEhhY2siLFNDUklQVF9QQVJBTV9PTk9GRixmYWxzZSkNCiAgICAgICAgc2VsZi5Db25maWcudmlwLnNraW46YWRkUGFyYW0oJ3NlbGVjdGVkJyAuLiBteUhlcm8uY2hhck5hbWUgLi4gJ1NraW4nLCAiU2VsZWN0IFNraW4iLCBTQ1JJUFRfUEFSQU1fTElTVCwgMSwgeyJPcmlnaW5hbCIsICJGdWxsIE1hY2hpbmUgVmlrdG9yICIsIlByb3RvdHlwZSBWaWt0b3IgIiwiQ3JlYXRvciBWaWt0b3IgIiB9KQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXAuc2tpbjphZGRQYXJhbSgiaW5mbzQiLCAiVG8gdXNlIHNraW4gaGFjaywgWW91IG5lZWQgdG8gMnggRjkgYWZ0ZXIgeW91IHNlbGVjdCB0aGUgc2tpbiB5b3UgZGVzaXJlLiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgICBzZWxmLkNvbmZpZy52aXAuc2tpbjphZGRQYXJhbSgiaW5mbzUiLCAiTWFrZSBzdXJlIHRoYXQgdXNpbmcgcGFja2V0IGNhc3RpbmcgaXMgT04uIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIC0tc2VsZi5Db25maWcudmlwOmFkZFBhcmFtKCJpbmZvNSIsICJTa2luIEhhY2sgdGVtcG9yYXJ5IGRpc2FibGVkIHVudGlsIG5leHQgdXBkYXRlLiAuIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIC0tW1tzZWxmLkNvbmZpZy52aXA6YWRkU3ViTWVudSgiQW50aS1BRksgU2V0dGluZ3MiLCAiYW50aWFmayIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcC5hbnRpYWZrOmFkZFBhcmFtKCJhbnRpYWZrIiwiVXNlIEFudGkgQWZrIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpIF1dDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzMiLCAiIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgIHNlbGYuQ29uZmlnLnZpcDphZGRQYXJhbSgiaW5mbzQiLCAiVG8gdXNlIHZpcCBzZXR0aW5ncywgWW91IG5lZWQgdG8gYmUgYSBWSVAgdXNlciBvbiBCT0wgY29tbXVuaXR5LiIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIGVuZA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJEcmF3IFNldHRpbmdzIiwib3RoZXIiKQ0KICAgICAgICAtLXNlbGYuQ29uZmlnLm90aGVyOmFkZFN1Yk1lbnUoIlNob3cgRGFtYWdlIE9uIEhwIEJhciIsICJIUEJBUiIpDQogICAgICAgIC0tc2VsZi5Db25maWcub3RoZXIuSFBCQVI6YWRkUGFyYW0oImtleSIsIk9OL09GRiIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLm90aGVyOmFkZFN1Yk1lbnUoIlNraWxsIERyYXdpbmcgU2V0dGluZ3MiLCAiZHJhdyIpDQogICAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oInFkcmF3IiwiUSBTa2lsbCBEcmF3aW5ncyIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oIndkcmF3IiwiVyBTa2lsbCBEcmF3aW5ncyIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oImVkcmF3IiwiRSBTa2lsbCBEcmF3aW5ncyIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oInJkcmF3IiwiUiBTa2lsbCBEcmF3aW5ncyIsU0NSSVBUX1BBUkFNX09OT0ZGLHRydWUpDQogICAgICAgIHNlbGYuQ29uZmlnLm90aGVyLmRyYXc6YWRkUGFyYW0oImFhZHJhdyIsIkF1dG8gQXR0YWNrIFJhbmdlIixTQ1JJUFRfUEFSQU1fT05PRkYsZmFsc2UpDQogICAgICAgIA0KICAgICAgICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJUYXJnZXRzZWxlY3RvcnMiLCJ0YXJnZXRzZWwiKQ0KICAgICBzZWxmLnRzLm5hbWUgID0gIlZpa3RvciINCiAgICAgIHNlbGYudHNxLm5hbWUgPSAiVmlrdG9yUSINCiAgICAgIHNlbGYudHN3Lm5hbWUgPSAiVmlrdG9yVyINCiAgICAgIHNlbGYudHNlLm5hbWUgPSAiVmlrdG9yRSINCiAgICAgIHNlbGYudHNyLm5hbWUgPSAiVmlrdG9yUiINCiAgICAgIHNlbGYuQ29uZmlnLnRhcmdldHNlbDphZGRUUyhzZWxmLnRzKQ0KICAgICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFRTKHNlbGYudHNxKQ0KICAgICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFRTKHNlbGYudHN3KQ0KICAgICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFRTKHNlbGYudHNlKQ0KICAgICAgc2VsZi5Db25maWcudGFyZ2V0c2VsOmFkZFRTKHNlbGYudHNyKSANCiAgICAgIHNlbGYuQ29uZmlnOmFkZFN1Yk1lbnUoIktleXMgU2V0dGluZ3MiLCAiS2V5cyIpDQogICAgICBPcmJ3YWxrTWFuYWdlcjpMb2FkQ29tbW9uS2V5cyhzZWxmLkNvbmZpZy5LZXlzKQ0KICAgICAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mbzMiLCAiX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXyIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94IiwgIiAgICAgICAgICAgICAgICIuLlNjcmlwdG5hbWUuLiIiLCBTQ1JJUFRfUEFSQU1fSU5GTywgIiIpIA0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94MiIsICIgICAgICAgICAgICAgICAgIFNjcmlwdCBWZXJzaW9uOiAgIi4uVmVyc2lvbi4uICIgICAgICAgICAiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDYiLCAiICAgICAgICAgICAgU2NyaXB0IHdhcyBtYWRlIGJ5ICAiLi5BdXRob3IuLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3g1IiwgIiAgICAgICBMZWF1Z2UgT2YgTGVnZW5kcyBWZXJzaW9uOiAgIi4uTFZlcnNpb24uLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgDQogICAgICAgc2VsZi5Db25maWc6cGVybWFTaG93KCJpbmZvYm94IikNCiAgICAgICBzZWxmLkNvbmZpZy5jb21ibzpwZXJtYVNob3coImNvbWJva2V5IikNCiAgICAgICBzZWxmLkNvbmZpZy5oYXJhc3M6cGVybWFTaG93KCJoYXJhc3N0b2dsZSIpDQogICAgICAgc2VsZi5Db25maWcuaGFyYXNzOnBlcm1hU2hvdygiaGFyYXNza2V5IikNCiAgICANCiAgZW5kDQogIGZ1bmN0aW9uIFZpa3RvcjpEcmF3KCkNCiAgICAgIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcucWRyYXcgYW5kIHNlbGYuUVNwZWxsOklzUmVhZHkoKSB0aGVuDQogICAgICBEcmF3Q2lyY2xlM0QobXlIZXJvLngsIG15SGVyby55LCBteUhlcm8ueiwgNjAwLCAxLHJlZCkNCiAgICBlbmQNCiAgDQogICAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy53ZHJhdyBhbmQgc2VsZi5XU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCA3MDAsIDEsIHJlZCkNCiAgICBlbmQNCiAgDQogICAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5lZHJhdyBhbmQgc2VsZi5FU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCAxMjAwLCAxLCByZWQpDQogICAgZW5kDQogICAgDQogICAgaWYgc2VsZi5Db25maWcub3RoZXIuZHJhdy5yZHJhdyBhbmQgc2VsZi5SU3BlbGw6SXNSZWFkeSgpIHRoZW4NCiAgICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCA3MDAsMSwgcmVkKQ0KICAgIGVuZA0KICAgIGlmIHNlbGYuQ29uZmlnLm90aGVyLmRyYXcuYWFkcmF3IHRoZW4NCiAgICAgIERyYXdDaXJjbGUzRChteUhlcm8ueCwgbXlIZXJvLnksIG15SGVyby56LCA1MjUsMSwgQVJHQigyNTUsIDI1NSwwLDApKQ0KICAgIGVuZA0KICBlbmQNCiAgDQogIGZ1bmN0aW9uIFZpa3Rvcjpza2luaGFjaygpDQogIGlmIG5vdCBzZWxmLkNvbmZpZy52aXAucGFja2V0IHRoZW4gU2VuZFNraW5QYWNrZXQobXlIZXJvLmNoYXJOYW1lLCBza2luc1BCWzFdLCBteUhlcm8ubmV0d29ya0lEKTsgZWxzZQ0KICBpZiBzZWxmLkNvbmZpZy52aXAuc2tpbi5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgIHRoZW4NCiAgU2VuZFNraW5QYWNrZXQobXlIZXJvLmNoYXJOYW1lLCBza2luc1BCW3NlbGYuQ29uZmlnLnZpcC5za2luWydzZWxlY3RlZCcgLi4gbXlIZXJvLmNoYXJOYW1lIC4uICdTa2luJ11dLCBteUhlcm8ubmV0d29ya0lEKTsNCiAgZW5kDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gVmlrdG9yOmF1dG9sZXZlbCgpDQppZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDEgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2UxID0gICB7IDEsMiwzLDEsMSw0LDEsMiwxLDIsNCwyLDIsMywzLDQsMywzfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2UxKQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gMiBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTIgPSAgIHsgMSwyLDMsMSwxLDQsMSwzLDEsMyw0LDMsMywyLDIsNCwyLDJ9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTIpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSAzIGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlMyA9ICB7IDIsMywxLDIsMiw0LDIsMSwyLDEsNCwxLDEsMywzLDQsMywzfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2UzKQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGlmKCBzZWxmLkNvbmZpZy52aXAucGFja2V0IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwua2V5IGFuZCBzZWxmLkNvbmZpZy52aXAubGV2ZWwubG9naWMgPT0gNCBhbmQgb3MuY2xvY2soKS1MYXN0X0xldmVsU3BlbGwgPiAwLjUgKSB0aGVuDQogICAgbG9jYWwgbGV2ZWxTZXF1ZW5jZTQgPSAgeyAyLDMsMSwyLDIsNCwyLDMsMiwzLDQsMywzLDEsMSw0LDEsMX0NCiAgICBhdXRvTGV2ZWxTZXRTZXF1ZW5jZShsZXZlbFNlcXVlbmNlNCkNCiAgICBMYXN0X0xldmVsU3BlbGwgPSBvcy5jbG9jaygpDQogIGVuZA0KICBpZiggc2VsZi5Db25maWcudmlwLnBhY2tldCBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmtleSBhbmQgc2VsZi5Db25maWcudmlwLmxldmVsLmxvZ2ljID09IDUgYW5kIG9zLmNsb2NrKCktTGFzdF9MZXZlbFNwZWxsID4gMC41ICkgdGhlbg0KICAgIGxvY2FsIGxldmVsU2VxdWVuY2U1ID0gIHsgMywxLDIsMywzLDQsMywyLDMsMiw0LDIsMiwxLDEsNCwxLDF9DQogICAgYXV0b0xldmVsU2V0U2VxdWVuY2UobGV2ZWxTZXF1ZW5jZTUpDQogICAgTGFzdF9MZXZlbFNwZWxsID0gb3MuY2xvY2soKQ0KICBlbmQNCiAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSA2IGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlNiA9ICB7IDMsMSwyLDMsMyw0LDMsMSwzLDEsNCwxLDEsMiwyLDQsMiwyfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2U2KQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogICAgaWYoIHNlbGYuQ29uZmlnLnZpcC5wYWNrZXQgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5rZXkgYW5kIHNlbGYuQ29uZmlnLnZpcC5sZXZlbC5sb2dpYyA9PSA3IGFuZCBvcy5jbG9jaygpLUxhc3RfTGV2ZWxTcGVsbCA+IDAuNSApIHRoZW4NCiAgICBsb2NhbCBsZXZlbFNlcXVlbmNlNiA9ICB7IDEsMywzLDIsMyw0LDMsMSwzLDEsNCwxLDIsMSwyLDQsMiwyfQ0KICAgIGF1dG9MZXZlbFNldFNlcXVlbmNlKGxldmVsU2VxdWVuY2U2KQ0KICAgIExhc3RfTGV2ZWxTcGVsbCA9IG9zLmNsb2NrKCkNCiAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBWaWt0b3I6YXV0b3pob255YSgpDQogICAgaWYgc2VsZi5Db25maWcuaXRlbS5lbmFibGVhdXRvemhvbnlhIHRoZW4NCiAgICAgZm9yIF8gPSBJVEVNXzEsIElURU1fNyBkbw0KICAgICAgaWYgbXlIZXJvLmhlYWx0aCA8PSAobXlIZXJvLm1heEhlYWx0aCAqIHNlbGYuQ29uZmlnLml0ZW0uYXV0b3pob255YSAvIDEwMCkgYW5kICggbXlIZXJvOkNhblVzZVNwZWxsKF8pID09IDAgYW5kIG15SGVybzpHZXRTcGVsbERhdGEoXykubmFtZSA9PSAiWmhvbnlhc0hvdXJnbGFzcyIgKXRoZW4gQ2FzdFNwZWxsKF8pDQogICAgZW5kDQogICAgZW5kDQogICAgZW5kDQogICAgZW5kDQogICAgZnVuY3Rpb24gVmlrdG9yOm9ubHlyKCkNCiAgICBpZiAoc2VsZi5SU3BlbGw6SXNSZWFkeSgpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmNvbWJvLk1hbmEgLzEwMCApIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VSIGFuZCBzZWxmLkNvbmZpZy5jb21iby5jb21ib2tleSBhbmQgR2V0RGlzdGFuY2Uoc2VsZi50c3IudGFyZ2V0KTw3MDAgKXRoZW4NCiAgICAgIHNlbGY6Q2FzdFIoc2VsZi50c3IudGFyZ2V0KQ0KICAgICAgZW5kDQogICAgZW5kDQogIGZ1bmN0aW9uIFZpa3Rvcjpjb21ibygpDQogICAgICAgIHNlbGYudHNxOnVwZGF0ZSgpDQogICAgICBpZihzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwIClhbmQgc2VsZi50c3EudGFyZ2V0fj1uaWwgIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VRIGFuZCBzZWxmLkNvbmZpZy5jb21iby5jb21ib2tleSAgKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RRKHNlbGYudHNxLnRhcmdldCkNCiAgICAgIGVuZA0KICAgICAgc2VsZi50c2U6dXBkYXRlKCkNCiAgICAgIGlmKHNlbGYuRVNwZWxsOklzUmVhZHkoKSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5jb21iby5NYW5hIC8xMDAgKWFuZCBzZWxmLnRzZS50YXJnZXR+PW5pbCBhbmQgc2VsZi5Db25maWcuY29tYm8udXNlRSBhbmQgc2VsZi5Db25maWcuY29tYm8uY29tYm9rZXkgICl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0RShzZWxmLnRzZS50YXJnZXQpDQogICAgICBlbmQNCiAgICAgIHNlbGYudHN3OnVwZGF0ZSgpDQogICAgICBpZihzZWxmLldTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwICkgYW5kIHNlbGYudHN3LnRhcmdldH49bmlsIGFuZCBzZWxmLkNvbmZpZy5jb21iby51c2VXIGFuZCAgc2VsZi5Db25maWcuY29tYm8uY29tYm9rZXkgICl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0VyhzZWxmLnRzdy50YXJnZXQpDQogICAgICBlbmQNCiAgICAgIGlmKCBzZWxmLlJTcGVsbDpJc1JlYWR5KCkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuY29tYm8uTWFuYSAvMTAwICkgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVIgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLmNvbWJva2V5ICl0aGVuDQogICAgICBmb3IgXywgdW5pdCBpbiBwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbw0KICAgICAgICBsb2NhbCBkbWdSID1nZXREbWcoIlIiLHVuaXQsbXlIZXJvKSsgKChteUhlcm8uYXApKjAuNTUpIA0KICAgICAgICBsb2NhbCBoZWFsdGg9dW5pdC5oZWFsdGgNCiAgICAgICAgaWYoaGVhbHRoPGRtZ1IgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLmxvZ2ljID09IDEgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZVIgYW5kIEdldERpc3RhbmNlKHVuaXQpPDcwMCl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0Uih1bml0KQ0KICAgICAgIGVuZA0KICAgICAgIGVuZA0KICAgICAgIGlmIChzZWxmLkNvbmZpZy5jb21iby5sb2dpYyA9PSAyIGFuZCBzZWxmLnRzci50YXJnZXR+PW5pbCkgdGhlbg0KICAgICAgIHNlbGY6b25seXIoKQ0KICAgICAgZW5kDQogICAgDQogICAgICBpZihzZWxmLkNvbmZpZy5jb21iby51c2VJIGFuZCBzZWxmLkNvbmZpZy5jb21iby5jb21ib2tleSApdGhlbg0KICAgICAgZm9yIF8sIHVuaXQgaW4gcGFpcnMoR2V0RW5lbXlIZXJvZXMoKSkgZG8NCiAgICAgICAgbG9jYWwgZG1nSSA9KDUwKyAoKG15SGVyby5sZXZlbCkqMjApKQ0KICAgICAgICBsb2NhbCBoZWFsdGg9dW5pdC5oZWFsdGgNCiAgICAgICAgaWYoaGVhbHRoPGRtZ0kgYW5kIHNlbGYuQ29uZmlnLmNvbWJvLnVzZUkgYW5kIEdldERpc3RhbmNlKHVuaXQpPDYwMCl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0SSh1bml0KQ0KICAgICAgZW5kDQogICAgICBlbmQNCiAgZW5kDQogIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gVmlrdG9yOkNhc3RRKHVuaXQpDQogICAgc2VsZi5RU3BlbGw6Q2FzdCh1bml0KQ0KICBlbmQNCiAgDQogIGZ1bmN0aW9uIFZpa3RvcjpDYXN0Vyh1bml0KQ0KICAgIHNlbGYuV1NwZWxsOkNhc3QodW5pdCkNCiAgZW5kDQogIA0KICBmdW5jdGlvbiBWaWt0b3I6Q2FzdEUodW5pdCkNCiAgIA0KICAgIGlmIHVuaXQuZGVhZCBvciB1bml0LmhlYWx0aCA9PSAwIHRoZW4NCiAgICAgIHJldHVybg0KICAgIGVuZA0KICAgIA0KICAgIGlmIEdldERpc3RhbmNlKHVuaXQsIG15SGVybykgPiBzZWxmLkUuUmFuZ2UxLTUgdGhlbg0KICAgICBFU3RhcnRQb3MgPSBDaXJjbGVJbnRlcnNlY3Rpb24obXlIZXJvLCB1bml0LCBteUhlcm8sIHNlbGYuRS5SYW5nZTEtNSkNCiAgICBlbHNlDQogICAgIEVTdGFydFBvcyA9IFZlY3Rvcih1bml0LngsIHVuaXQueSwgdW5pdC56KQ0KICAgIGVuZA0KICAgIA0KICAgICBFUG9zLCBFSGl0Q2hhbmNlID0gc2VsZi5IUHJlZDpHZXRQcmVkaWN0KHNlbGYuSFByZWQuUHJlc2V0c1snVmlrdG9yJ11bIkUiXSwgdW5pdCwgRVN0YXJ0UG9zKQ0KICAgIA0KICAgIGlmIG1vZGUgPT0gIkNvbWJvIiBhbmQgRUhpdENoYW5jZSA+PSBzZWxmLkNvbmZpZy5oaXQuRSBvciBtb2RlID09ICJIYXJhc3MiIGFuZCBFSGl0Q2hhbmNlID49IHNlbGYuQ29uZmlnLmhhcmFzcy5FIG9yICBtb2RlID09IG5pbCBhbmQgRUhpdENoYW5jZSA+IDEgdGhlbg0KICAgICAgQ2FzdFNwZWxsMyhfRSwgRDNEWFZFQ1RPUjMoRVN0YXJ0UG9zLngsIDAsIEVTdGFydFBvcy56KSwgRDNEWFZFQ1RPUjMoRVBvcy54LCAwLCBFUG9zLnopKQ0KICAgIGVuZA0KICAgIA0KICBlbmQNCiAgDQogIGZ1bmN0aW9uIFZpa3RvcjpDYXN0Uih1bml0KQ0KICAgIHNlbGYuUlNwZWxsOkNhc3QodW5pdCkNCiAgZW5kDQogIGZ1bmN0aW9uIFZpa3RvcjpDYXN0SSh1bml0KQ0KICAgIHNlbGYuSWduaXRlOkNhc3QodW5pdCkNCiAgZW5kDQogIGZ1bmN0aW9uIFZpa3RvcjpraWxsc3RlYWwoKQ0KICBmb3IgXywgdW5pdCBpbiBwYWlycyhHZXRFbmVteUhlcm9lcygpKSBkbw0KICAgICAgbG9jYWwgaGVhbHRoID0gdW5pdC5oZWFsdGgNCiAgICAgIGxvY2FsIGRtZ0UgPSBnZXREbWcoIkUiLCB1bml0LCBteUhlcm8pICsgKChteUhlcm8uYXApKjAuNykgKyAoKGdldERtZygiRSIsIHVuaXQsIG15SGVybykgKyAoKG15SGVyby5hcCkqMC43KSkqMC40KQ0KICAgICAgICBpZihzZWxmLnRzZS50YXJnZXQgfj0gbmlsIGFuZCAgc2VsZi5FU3BlbGw6SXNSZWFkeSgpIGFuZCBoZWFsdGg8ZG1nRSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLnVzZUUgYW5kIEdldERpc3RhbmNlKHVuaXQpPDcwMCAgIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MpdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEUodW5pdCkgIA0KICAgICAgICBlbmQNCiAgICAgICAgbG9jYWwgZG1nUSA9IGdldERtZygiUSIsIHVuaXQsIG15SGVybykgKyAoKG15SGVyby5hcCkqMC4zMCkNCiAgICAgICAgaWYoc2VsZi50c3EudGFyZ2V0IH49IG5pbCBhbmQgIHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgaGVhbHRoPGRtZ1EgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VRIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgKXRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RRKHVuaXQpICANCiAgICAgICAgZW5kDQogICAgICAgICBsb2NhbCBkbWdJID0oNTArICgobXlIZXJvLmxldmVsKSoyMCkpDQogICAgICAgIGlmKGhlYWx0aDxkbWdJIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwudXNlSSBhbmQgc2VsZi5Db25maWcua2lsbHN0ZWFsLmtzIGFuZCBHZXREaXN0YW5jZSh1bml0KTw2MDApdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEkodW5pdCkNCiAgICAgICAgZW5kDQogICAgICAgIGxvY2FsIGRtZ1IgPWdldERtZygiUiIsdW5pdCxteUhlcm8pKygobXlIZXJvLmFwKSowLjU1KSANCiAgICAgICAgaWYoc2VsZi50c3IudGFyZ2V0IH49IG5pbCBhbmQgIHNlbGYuUlNwZWxsOklzUmVhZHkoKSBhbmQgaGVhbHRoPGRtZ1IgYW5kIHNlbGYuQ29uZmlnLmtpbGxzdGVhbC51c2VSIGFuZCBzZWxmLkNvbmZpZy5raWxsc3RlYWwua3MgYW5kIEdldERpc3RhbmNlKHVuaXQpPDcwMCl0aGVuDQogICAgICAgICAgc2VsZjpDYXN0Uih1bml0KQ0KICAgICAgICBlbmQNCiAgICAgZW5kDQogIGVuZA0KICANCiAgZnVuY3Rpb24gVmlrdG9yOmhhcmFzcygpDQogICAgc2VsZi50czp1cGRhdGUoKQ0KICAgIHNlbGYudHNxOnVwZGF0ZSgpDQogICAgaWYgc2VsZi5Db25maWcuaGFyYXNzLmhhcmFzc2tleSBvciBzZWxmLkNvbmZpZy5oYXJhc3MuaGFyYXNzdG9nbGUgIHRoZW4NCiAgICAgICAgaWYoc2VsZi5RU3BlbGw6SXNSZWFkeSgpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmhhcmFzcy5NYW5hIC8xMDAgKSBhbmQgc2VsZi50c3EudGFyZ2V0fj1uaWwgYW5kIHNlbGYuQ29uZmlnLmhhcmFzcy51c2VRICkgdGhlbiAgICAgICAgDQogICAgICAgICAgc2VsZjpDYXN0UShzZWxmLnRzcS50YXJnZXQpDQogICAgICAgIGVuZCAgIA0KICAgICAgICBzZWxmLnRzZTp1cGRhdGUoKQ0KICAgICAgICAgaWYoc2VsZi5FU3BlbGw6SXNSZWFkeSgpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmhhcmFzcy5NYW5hIC8xMDAgKSBhbmQgc2VsZi50c2UudGFyZ2V0IH49IG5pbCBhbmQgc2VsZi5Db25maWcuaGFyYXNzLnVzZUUgIGFuZCBWYWxpZFRhcmdldChzZWxmLnRzZS50YXJnZXQsIHNlbGYuRVJhbmdlKSkgdGhlbg0KICAgICAgICBzZWxmOkNhc3RFKHNlbGYudHNlLnRhcmdldCkNCiAgICBlbmQNCiAgDQogICAgICAgIGVuZA0KICAgICAgZW5kICAgDQogICANCiAgZnVuY3Rpb24gVmlrdG9yOkxhbmVDbGVhcigpDQogICBsb2NhbCBjbGVhcnRhcmdldCA9IG5pbA0KICAgICAgc2VsZi5lbmVteU1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIHNlbGYub3RoZXJNaW5pb25zOnVwZGF0ZSgpDQogICAgICBzZWxmLmp1bmdsZU1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIGZvciBpLCBtaW5pb24gaW4gaXBhaXJzKHNlbGYuZW5lbXlNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICAgIGlmIFZhbGlkVGFyZ2V0KG1pbmlvbiwgNjAwKSBhbmQgKGNsZWFydGFyZ2V0ID09IG5pbCBvciBub3QgVmFsaWRUYXJnZXQoY2xlYXJ0YXJnZXQpKSB0aGVuDQogICAgICAgICAgY2xlYXJ0YXJnZXQgPSBtaW5pb24NCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGZvciBpLCBqdW5nbGVtaW5pb24gaW4gaXBhaXJzKHNlbGYuanVuZ2xlTWluaW9ucy5vYmplY3RzKSBkbw0KICAgICAgICBpZiBWYWxpZFRhcmdldChqdW5nbGVtaW5pb24sIDYwMCkgYW5kIChjbGVhcnRhcmdldCA9PSBuaWwgb3Igbm90IFZhbGlkVGFyZ2V0KGNsZWFydGFyZ2V0KSkgdGhlbg0KICAgICAgICAgIGNsZWFydGFyZ2V0ID0ganVuZ2xlbWluaW9uDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBmb3IgaSwgb3RoZXJtaW5pb24gaW4gaXBhaXJzKHNlbGYub3RoZXJNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICAgIGlmIFZhbGlkVGFyZ2V0KG90aGVybWluaW9uLCA2MDApIGFuZCAoY2xlYXJ0YXJnZXQgPT0gbmlsIG9yIG5vdCBWYWxpZFRhcmdldChjbGVhcnRhcmdldCkpIHRoZW4NCiAgICAgICAgICBjbGVhcnRhcmdldCA9IG90aGVybWluaW9uDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgICBpZiBjbGVhcnRhcmdldCB+PSBuaWwgdGhlbg0KICAgICAgICBpZihzZWxmLlFTcGVsbDpJc1JlYWR5KCkgYW5kIHNlbGYuQ29uZmlnLmxhbmVjbGVhci51c2VRIGFuZCBzZWxmLkNvbmZpZy5sYW5lY2xlYXIubGFuZWNsZWFya2V5KSBhbmQgKG15SGVyby5tYW5hIC8gbXlIZXJvLm1heE1hbmEgPiBzZWxmLkNvbmZpZy5sYW5lY2xlYXIuTWFuYSAvMTAwICkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdFEoY2xlYXJ0YXJnZXQpDQogICAgICAgIGVuZA0KICAgICAgIGlmIGNsZWFydGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGlmKHNlbGYuRVNwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcubGFuZWNsZWFyLnVzZUUgYW5kIHNlbGYuQ29uZmlnLmxhbmVjbGVhci5sYW5lY2xlYXJrZXkpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmxhbmVjbGVhci5NYW5hIC8xMDAgKSB0aGVuDQogICAgICAgIGxvY2FsIEJlc3RQb3MsIEJlc3RIaXQgPSBHZXRCZXN0TGluZUZhcm1Qb3NpdGlvbihzZWxmLkVTcGVsbC5SYW5nZSwgc2VsZi5FU3BlbGwuV2lkdGgsIHNlbGYuZW5lbXlNaW5pb25zLm9iamVjdHMgKQ0KICAgICAgICBpZiBCZXN0UG9zIH49IG5pbCBhbmQgQmVzdEhpdCA+PSAxIHRoZW4NCiAgICAgICAgIENhc3RTcGVsbChfRSwgQmVzdFBvcy54LCBCZXN0UG9zLnopDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgZW5kDQogICAgZW5kDQogICAgZW5kDQogICAgZnVuY3Rpb24gVmlrdG9yOkp1bmdsZUNsZWFyKCkNCiAgIGxvY2FsIGNsZWFydGFyZ2V0ID0gbmlsDQogICAgICBzZWxmLmVuZW15TWluaW9uczp1cGRhdGUoKQ0KICAgICAgc2VsZi5vdGhlck1pbmlvbnM6dXBkYXRlKCkNCiAgICAgIHNlbGYuanVuZ2xlTWluaW9uczp1cGRhdGUoKQ0KICAgICAgZm9yIGksIGp1bmdsZW1pbmlvbiBpbiBpcGFpcnMoc2VsZi5qdW5nbGVNaW5pb25zLm9iamVjdHMpIGRvDQogICAgICAgIGlmIFZhbGlkVGFyZ2V0KGp1bmdsZW1pbmlvbiwgNjAwKSBhbmQgKGNsZWFydGFyZ2V0ID09IG5pbCBvciBub3QgVmFsaWRUYXJnZXQoY2xlYXJ0YXJnZXQpKSB0aGVuDQogICAgICAgICAgY2xlYXJ0YXJnZXQgPSBqdW5nbGVtaW5pb24NCiAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIGlmIGNsZWFydGFyZ2V0IH49IG5pbCB0aGVuDQogICAgICAgIGlmKHNlbGYuUVNwZWxsOklzUmVhZHkoKSBhbmQgc2VsZi5Db25maWcuanVuZ2xlY2xlYXIudXNlUSBhbmQgc2VsZi5Db25maWcuanVuZ2xlY2xlYXIuanVuZ2xlY2xlYXJrZXkpIGFuZCAobXlIZXJvLm1hbmEgLyBteUhlcm8ubWF4TWFuYSA+IHNlbGYuQ29uZmlnLmp1bmdsZWNsZWFyLk1hbmEgLzEwMCApIHRoZW4NCiAgICAgICAgICBzZWxmOkNhc3RRKGNsZWFydGFyZ2V0KQ0KICAgICAgICBlbmQNCiAgICAgICAgaWYgY2xlYXJ0YXJnZXQgfj0gbmlsIHRoZW4NCiAgICAgICAgaWYoc2VsZi5FU3BlbGw6SXNSZWFkeSgpIGFuZCBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhci51c2VFIGFuZCBzZWxmLkNvbmZpZy5qdW5nbGVjbGVhci5qdW5nbGVjbGVhcmtleSkgYW5kIChteUhlcm8ubWFuYSAvIG15SGVyby5tYXhNYW5hID4gc2VsZi5Db25maWcuanVuZ2xlY2xlYXIuTWFuYSAvMTAwICkgdGhlbg0KICAgICAgICAgIHNlbGY6Q2FzdEUoY2xlYXJ0YXJnZXQpDQogICAgICAgIGVuZA0KICAgICAgZW5kDQogICAgZW5kDQogICAgZW5kDQogIGZ1bmN0aW9uIGl0ZW1maXgoKQ0KICANCiAgICBJdGVtTmFtZXMgICAgICAgPSB7DQogICAgICBbMzMwM10gICAgICAgID0gIkFyY2hBbmdlbHNEdW1teVNwZWxsIiwNCiAgICAgIFszMDA3XSAgICAgICAgPSAiQXJjaEFuZ2Vsc0R1bW15U3BlbGwiLA0KICAgICAgWzMxNDRdICAgICAgICA9ICJCaWxnZXdhdGVyQ3V0bGFzcyIsDQogICAgICBbMzE4OF0gICAgICAgID0gIkl0ZW1CbGFja2ZpcmVUb3JjaCIsDQogICAgICBbMzE1M10gICAgICAgID0gIkl0ZW1Td29yZE9mRmVhc3RBbmRGYW1pbmUiLA0KICAgICAgWzM0MDVdICAgICAgICA9ICJUcmlua2V0U3dlZXBlckx2bDEiLA0KICAgICAgWzM0MTFdICAgICAgICA9ICJUcmlua2V0T3JiTHZsMSIsDQogICAgICBbMzE2Nl0gICAgICAgID0gIlRyaW5rZXRUb3RlbUx2bDEiLA0KICAgICAgWzM0NTBdICAgICAgICA9ICJPZGluVHJpbmtldFJldml2ZSIsDQogICAgICBbMjA0MV0gICAgICAgID0gIkl0ZW1DcnlzdGFsRmxhc2siLA0KICAgICAgWzIwNTRdICAgICAgICA9ICJJdGVtS2luZ1Bvcm9TbmFjayIsDQogICAgICBbMjEzOF0gICAgICAgID0gIkVsaXhpck9mSXJvbiIsDQogICAgICBbMjEzN10gICAgICAgID0gIkVsaXhpck9mUnVpbiIsDQogICAgICBbMjEzOV0gICAgICAgID0gIkVsaXhpck9mU29yY2VyeSIsDQogICAgICBbMjE0MF0gICAgICAgID0gIkVsaXhpck9mV3JhdGgiLA0KICAgICAgWzMxODRdICAgICAgICA9ICJPZGluRW50cm9waWNDbGF5bW9yZSIsDQogICAgICBbMjA1MF0gICAgICAgID0gIkl0ZW1NaW5pV2FyZCIsDQogICAgICBbMzQwMV0gICAgICAgID0gIkhlYWx0aEJvbWIiLA0KICAgICAgWzMzNjNdICAgICAgICA9ICJUcmlua2V0T3JiTHZsMyIsDQogICAgICBbMzA5Ml0gICAgICAgID0gIkl0ZW1HbGFjaWFsU3Bpa2VDYXN0IiwNCiAgICAgIFszNDYwXSAgICAgICAgPSAiQXNjV2FycCIsDQogICAgICBbMzM2MV0gICAgICAgID0gIlRyaW5rZXRUb3RlbUx2bDMiLA0KICAgICAgWzMzNjJdICAgICAgICA9ICJUcmlua2V0VG90ZW1Mdmw0IiwNCiAgICAgIFszMTU5XSAgICAgICAgPSAiSGV4dGVjaFN3ZWVwZXIiLA0KICAgICAgWzIwNTFdICAgICAgICA9ICJJdGVtSG9ybiIsDQogICAgICAtLVsyMDAzXSAgICAgID0gIlJlZ2VuZXJhdGlvblBvdGlvbiIsDQogICAgICBbMzE0Nl0gICAgICAgID0gIkhleHRlY2hHdW5ibGFkZSIsDQogICAgICBbMzE4N10gICAgICAgID0gIkhleHRlY2hTd2VlcGVyIiwNCiAgICAgIFszMTkwXSAgICAgICAgPSAiSXJvblN0eWx1cyIsDQogICAgICBbMjAwNF0gICAgICAgID0gIkZsYXNrT2ZDcnlzdGFsV2F0ZXIiLA0KICAgICAgWzMxMzldICAgICAgICA9ICJJdGVtTWVyY3VyaWFsIiwNCiAgICAgIFszMjIyXSAgICAgICAgPSAiSXRlbU1vcmVsbG9zQmFuZSIsDQogICAgICBbMzA0Ml0gICAgICAgID0gIk11cmFtYW5hIiwNCiAgICAgIFszMDQzXSAgICAgICAgPSAiTXVyYW1hbmEiLA0KICAgICAgWzMxODBdICAgICAgICA9ICJPZHluc1ZlaWwiLA0KICAgICAgWzMwNTZdICAgICAgICA9ICJJdGVtRmFpdGhTaGFrZXIiLA0KICAgICAgWzIwNDddICAgICAgICA9ICJPcmFjbGVFeHRyYWN0U2lnaHQiLA0KICAgICAgWzMzNjRdICAgICAgICA9ICJUcmlua2V0U3dlZXBlckx2bDMiLA0KICAgICAgWzIwNTJdICAgICAgICA9ICJJdGVtUG9yb1NuYWNrIiwNCiAgICAgIFszMTQwXSAgICAgICAgPSAiUXVpY2tzaWx2ZXJTYXNoIiwNCiAgICAgIFszMTQzXSAgICAgICAgPSAiUmFuZHVpbnNPbWVuIiwNCiAgICAgIFszMDc0XSAgICAgICAgPSAiSXRlbVRpYW1hdENsZWF2ZSIsDQogICAgICBbMzgwMF0gICAgICAgID0gIkl0ZW1SaWdodGVvdXNHbG9yeSIsDQogICAgICBbMjA0NV0gICAgICAgID0gIkl0ZW1HaG9zdFdhcmQiLA0KICAgICAgWzMzNDJdICAgICAgICA9ICJUcmlua2V0T3JiTHZsMSIsDQogICAgICBbMzA0MF0gICAgICAgID0gIkl0ZW1TZXJhcGhzRW1icmFjZSIsDQogICAgICBbMzA0OF0gICAgICAgID0gIkl0ZW1TZXJhcGhzRW1icmFjZSIsDQogICAgICBbMjA0OV0gICAgICAgID0gIkl0ZW1HaG9zdFdhcmQiLA0KICAgICAgWzMzNDVdICAgICAgICA9ICJPZGluVHJpbmtldFJldml2ZSIsDQogICAgICBbMjA0NF0gICAgICAgID0gIlNpZ2h0V2FyZCIsDQogICAgICBbMzM0MV0gICAgICAgID0gIlRyaW5rZXRTd2VlcGVyTHZsMSIsDQogICAgICBbMzA2OV0gICAgICAgID0gInNodXJlbHlhc2NyZXN0IiwNCiAgICAgIFszNTk5XSAgICAgICAgPSAiS2FsaXN0YVBTcGVsbENhc3QiLA0KICAgICAgWzMxODVdICAgICAgICA9ICJIZXh0ZWNoU3dlZXBlciIsDQogICAgICBbMzA3N10gICAgICAgID0gIkl0ZW1UaWFtYXRDbGVhdmUiLA0KICAgICAgWzIwMDldICAgICAgICA9ICJJdGVtTWluaVJlZ2VuUG90aW9uIiwNCiAgICAgIFsyMDEwXSAgICAgICAgPSAiSXRlbU1pbmlSZWdlblBvdGlvbiIsDQogICAgICBbMzAyM10gICAgICAgID0gIkl0ZW1XcmFpdGhDb2xsYXIiLA0KICAgICAgWzMyOTBdICAgICAgICA9ICJJdGVtV3JhaXRoQ29sbGFyIiwNCiAgICAgIFsyMDQzXSAgICAgICAgPSAiVmlzaW9uV2FyZCIsDQogICAgICBbMzM0MF0gICAgICAgID0gIlRyaW5rZXRUb3RlbUx2bDEiLA0KICAgICAgWzMwOTBdICAgICAgICA9ICJaaG9ueWFzSG91cmdsYXNzIiwNCiAgICAgIFszMTU0XSAgICAgICAgPSAid3JpZ2dsZWxhbnRlcm4iLA0KICAgICAgWzMxNDJdICAgICAgICA9ICJZb3VtdXNCbGFkZSIsDQogICAgICBbMzE1N10gICAgICAgID0gIlpob255YXNIb3VyZ2xhc3MiLA0KICAgICAgWzM1MTJdICAgICAgICA9ICJJdGVtVm9pZEdhdGUiLA0KICAgICAgWzMxMzFdICAgICAgICA9ICJJdGVtU29URCIsDQogICAgICBbMzEzN10gICAgICAgID0gIkl0ZW1EZXJ2aXNoQmxhZGUiLA0KICAgICAgWzMzNTJdICAgICAgICA9ICJSZWxpY1Nwb3R0ZXIiLA0KICAgICAgWzMzNTBdICAgICAgICA9ICJUcmlua2V0VG90ZW1MdmwyIiwNCiAgICB9DQogICAgDQogICAgX0cuSVRFTV8xICAgICAgID0gMDYNCiAgICBfRy5JVEVNXzIgICAgICAgPSAwNw0KICAgIF9HLklURU1fMyAgICAgICA9IDA4DQogICAgX0cuSVRFTV80ICAgICAgID0gMDkNCiAgICBfRy5JVEVNXzUgICAgICAgPSAxMA0KICAgIF9HLklURU1fNiAgICAgICA9IDExDQogICAgX0cuSVRFTV83ICAgICAgID0gMTINCiAgICANCiAgICBfX19HZXRJbnZlbnRvcnlTbG90SXRlbSA9IHJhd2dldChfRywgIkdldEludmVudG9yeVNsb3RJdGVtIikNCiAgICBfRy5HZXRJbnZlbnRvcnlTbG90SXRlbSA9IEdldFNsb3RJdGVtDQogICAgDQogICAgDQogIGVuZA0KICBfRy5MZXZlbFNwZWxsID0gZnVuY3Rpb24oaWQpDQogIGxvY2FsIG9mZnNldHMgPSB7IA0KICAgIFtfUV0gPSAweDYxLA0KICAgIFtfV10gPSAweDgxLA0KICAgIFtfRV0gPSAweEExLA0KICAgIFtfUl0gPSAweEMxLA0KICB9DQogIGxvY2FsIHAgPSBDTG9MUGFja2V0KDB4MDAzMykNCiAgcC52VGFibGUgPSAweEU1NTZFOA0KICBwOkVuY29kZUYobXlIZXJvLm5ldHdvcmtJRCkNCiAgcDpFbmNvZGUxKDB4NzMpDQogIGZvciBpID0gMSwgNCBkbyBwOkVuY29kZTEoMHhGOSkgZW5kDQogIGZvciBpID0gMSwgNCBkbyBwOkVuY29kZTEoMHgxRSkgZW5kDQogIHA6RW5jb2RlMShvZmZzZXRzW2lkXSkNCiAgZm9yIGkgPSAxLCA0IGRvIHA6RW5jb2RlMSgweDk5KSBlbmQNCiAgZm9yIGkgPSAxLCA0IGRvIHA6RW5jb2RlMSgweDAwKSBlbmQNCiAgU2VuZFBhY2tldChwKQ0KZW5kDQogIGZ1bmN0aW9uIENpcmNsZUludGVyc2VjdGlvbih2MSwgdjIsIGMsIHJhZGl1cykNCiAgICBhc3NlcnQoVmVjdG9yVHlwZSh2MSkgYW5kIFZlY3RvclR5cGUodjIpIGFuZCBWZWN0b3JUeXBlKGMpIGFuZCB0eXBlKHJhZGl1cykgPT0gIm51bWJlciIsICJDaXJjbGVJbnRlcnNlY3Rpb246IHdyb25nIGFyZ3VtZW50IHR5cGVzICg8VmVjdG9yPiwgPFZlY3Rvcj4sIDxWZWN0b3I+LCBpbnRlZ2VyIGV4cGVjdGVkKSIpDQogICAgDQogICAgbG9jYWwgeDEsIHkxLCB4MiwgeTIsIHgzLCB5MyA9IHYxLngsIHYxLnogb3IgdjEueSwgdjIueCwgdjIueiBvciB2Mi55LCBjLngsIGMueiBvciBjLnkNCiAgICBsb2NhbCByID0gcmFkaXVzDQogICAgbG9jYWwgeHAsIHlwLCB4bSwgeW0gPSBuaWwsIG5pbCwgbmlsLCBuaWwNCiAgICBsb2NhbCBJc09uU2VnbWVudCA9IG5pbA0KICAgIA0KICAgIGlmIHgxID09IHgyIHRoZW4NCiAgICANCiAgICAgIGxvY2FsIEIgPSBtYXRoLnNxcnQocl4yLSh4MS14MyleMikNCiAgICAgIA0KICAgICAgeHAsIHlwLCB4bSwgeW0gPSB4MSwgeTMrQiwgeDEsIHkzLUINCiAgICBlbHNlDQogICAgDQogICAgICBsb2NhbCBtID0gKHkyLXkxKS8oeDIteDEpDQogICAgICBsb2NhbCBuID0geTEtbSp4MQ0KICAgICAgbG9jYWwgQSA9IHgzLW0qKG4teTMpDQogICAgICBsb2NhbCBCID0gbWF0aC5zcXJ0KEFeMi0oMSttXjIpKih4M14yLXJeMisobi15MyleMikpDQogICAgICANCiAgICAgIHhwLCB4bSA9IChBK0IpLygxK21eMiksIChBLUIpLygxK21eMikNCiAgICAgIHlwLCB5bSA9IG0qeHArbiwgbSp4bStuDQogICAgZW5kDQogICAgDQogICAgaWYgeDEgPD0geDIgdGhlbg0KICAgICAgSXNPblNlZ21lbnQgPSB4MSA8PSB4cCBhbmQgeHAgPD0geDINCiAgICBlbHNlDQogICAgICBJc09uU2VnbWVudCA9IHgyIDw9IHhwIGFuZCB4cCA8PSB4MSAgICAgICAgDQogICAgZW5kDQogICAgICBpZiBJc09uU2VnbWVudCB0aGVuDQogICAgICByZXR1cm4gVmVjdG9yKHhwLCAwLCB5cCkNCiAgICBlbHNlDQogICAgICByZXR1cm4gVmVjdG9yKHhtLCAwLCB5bSkNCiAgICBlbmQNCiAgICANCiAgZW5kDQogIGZ1bmN0aW9uIEdldEJlc3RMaW5lRmFybVBvc2l0aW9uKHJhbmdlLCB3aWR0aCwgb2JqZWN0cykNCiAgICAgIGxvY2FsIEJlc3RQb3MgDQogICAgICBsb2NhbCBCZXN0SGl0ID0gMA0KICAgICAgZm9yIGksIG9iamVjdCBpbiBpcGFpcnMob2JqZWN0cykgZG8NCiAgICAgICAgICBsb2NhbCBFbmRQb3MgPSBWZWN0b3IobXlIZXJvLnBvcykgKyByYW5nZSAqIChWZWN0b3Iob2JqZWN0KSAtIFZlY3RvcihteUhlcm8ucG9zKSk6bm9ybWFsaXplZCgpDQogICAgICAgICAgbG9jYWwgaGl0ID0gQ291bnRPYmplY3RzT25MaW5lU2VnbWVudChteUhlcm8ucG9zLCBFbmRQb3MsIHdpZHRoLCBvYmplY3RzKQ0KICAgICAgICAgIGlmIGhpdCA+IEJlc3RIaXQgdGhlbg0KICAgICAgICAgICAgICBCZXN0SGl0ID0gaGl0DQogICAgICAgICAgICAgIEJlc3RQb3MgPSBWZWN0b3Iob2JqZWN0KQ0KICAgICAgICAgICAgICBpZiBCZXN0SGl0ID09ICNvYmplY3RzIHRoZW4NCiAgICAgICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgIGVuZA0KICAgICAgZW5kDQogIA0KICAgICAgcmV0dXJuIEJlc3RQb3MsIEJlc3RIaXQNCiAgZW5kDQogIA0KICBmdW5jdGlvbiBDb3VudE9iamVjdHNPbkxpbmVTZWdtZW50KFN0YXJ0UG9zLCBFbmRQb3MsIHdpZHRoLCBvYmplY3RzKQ0KICAgICAgbG9jYWwgbiA9IDANCiAgICAgIGZvciBpLCBvYmplY3QgaW4gaXBhaXJzKG9iamVjdHMpIGRvDQogICAgICAgICAgbG9jYWwgcG9pbnRTZWdtZW50LCBwb2ludExpbmUsIGlzT25TZWdtZW50ID0gVmVjdG9yUG9pbnRQcm9qZWN0aW9uT25MaW5lU2VnbWVudChTdGFydFBvcywgRW5kUG9zLCBvYmplY3QpDQogICAgICAgICAgaWYgaXNPblNlZ21lbnQgYW5kIEdldERpc3RhbmNlU3FyKHBvaW50U2VnbWVudCwgb2JqZWN0KSA8IHdpZHRoICogd2lkdGggdGhlbg0KICAgICAgICAgICAgICBuID0gbiArIDENCiAgICAgICAgICBlbmQNCiAgICAgIGVuZA0KICANCiAgICAgIHJldHVybiBuDQogIGVuZA0KICBmdW5jdGlvbiBDb3VudE9iamVjdHNOZWFyUG9zKHBvcywgcmFuZ2UsIHJhZGl1cywgb2JqZWN0cykNCiAgICAgIGxvY2FsIG4gPSAwDQogICAgICBmb3IgaSwgb2JqZWN0IGluIGlwYWlycyhvYmplY3RzKSBkbw0KICAgICAgICAgIGlmIEdldERpc3RhbmNlU3FyKHBvcywgb2JqZWN0KSA8PSByYWRpdXMgKiByYWRpdXMgdGhlbg0KICAgICAgICAgICAgICBuID0gbiArIDENCiAgICAgICAgICBlbmQNCiAgICAgIGVuZA0KICAgICAgcmV0dXJuIG4NCiAgZW5kDQogIGZ1bmN0aW9uIEdldEJlc3RDaXJjdWxhckZhcm1Qb3NpdGlvbihyYW5nZSwgcmFkaXVzLCBvYmplY3RzKQ0KICAgICAgbG9jYWwgQmVzdFBvcyANCiAgICAgIGxvY2FsIEJlc3RIaXQgPSAwDQogICAgICBmb3IgaSwgb2JqZWN0IGluIGlwYWlycyhvYmplY3RzKSBkbw0KICAgICAgICAgIGxvY2FsIGhpdCA9IENvdW50T2JqZWN0c05lYXJQb3Mob2JqZWN0LnBvcyBvciBvYmplY3QsIHJhbmdlLCByYWRpdXMsIG9iamVjdHMpDQogICAgICAgICAgaWYgaGl0ID4gQmVzdEhpdCB0aGVuDQogICAgICAgICAgICAgIEJlc3RIaXQgPSBoaXQNCiAgICAgICAgICAgICAgQmVzdFBvcyA9IFZlY3RvcihvYmplY3QpDQogICAgICAgICAgICAgIGlmIEJlc3RIaXQgPT0gI29iamVjdHMgdGhlbg0KICAgICAgICAgICAgICAgICBicmVhaw0KICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgZW5kDQogICAgICBlbmQNCiAgICAgIHJldHVybiBCZXN0UG9zLCBCZXN0SGl0DQogIGVuZA0KICBmdW5jdGlvbiBSZXF1aXJlU2ltcGxlTGliKCkNCiAgICAgIGlmIEZpbGVFeGlzdChMSUJfUEFUSC4uIlNpbXBsZUxpYi5sdWEiKSBhbmQgbm90IEZpbGVFeGlzdChTQ1JJUFRfUEFUSC4uIlNpbXBsZUxpYi5sdWEiKSB0aGVuDQogICAgICAgICAgcmVxdWlyZSAiU2ltcGxlTGliIg0KICAgICAgICAgIGlmIF9HLlNpbXBsZUxpYlZlcnNpb24gPT0gbmlsIHRoZW4gDQogICAgICAgICAgICAgIHByaW50KCJZb3VyIFNpbXBsZUxpYiBmaWxlIGlzIHdyb25nLiIpDQogICAgICAgICAgICAgIHJldHVybiBmYWxzZQ0KICAgICAgICAgIGVuZA0KICAgICAgICAgIGlmIF9HLlNpbXBsZUxpYlZlcnNpb24gPCAxLjAyIHRoZW4NCiAgICAgICAgICAgICAgcHJpbnQoIllvdSBuZWVkIHRoZSBsYXN0ZXN0IHZlcnNpb24gb2YgU2ltcGxlTGliLiIpDQogICAgICAgICAgICAgIHJldHVybiBmYWxzZQ0KICAgICAgICAgIGVuZA0KICAgICAgICAgIHJldHVybiB0cnVlDQogICAgICBlbHNlaWYgRmlsZUV4aXN0KExJQl9QQVRILi4iU2ltcGxlTGliLmx1YSIpIGFuZCBGaWxlRXhpc3QoU0NSSVBUX1BBVEguLiJTaW1wbGVMaWIubHVhIikgdGhlbg0KICAgICAgICAgIHByaW50KCJTaW1wbGVMaWIubHVhIHNob3VsZCBub3QgYmUgaW4gQ3VzdG9tIFNjcmlwdCAoT25seSBvbiBDb21tb24gZm9sZGVyKSwgZGVsZXRlIGl0IGZyb20gdGhlcmUuLi4iKQ0KICAgICAgICAgIHJldHVybiBmYWxzZQ0KICAgICAgZWxzZQ0KICAgICAgICAgIGxvY2FsIGZ1bmN0aW9uIEJhc2U2NEVuY29kZTIoZGF0YSkNCiAgICAgICAgICAgICAgbG9jYWwgYj0nQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLycNCiAgICAgICAgICAgICAgcmV0dXJuICgoZGF0YTpnc3ViKCcuJywgZnVuY3Rpb24oeCkNCiAgICAgICAgICAgICAgICAgIGxvY2FsIHIsYj0nJyx4OmJ5dGUoKQ0KICAgICAgICAgICAgICAgICAgZm9yIGk9OCwxLC0xIGRvIHI9ci4uKGIlMl5pLWIlMl4oaS0xKT4wIGFuZCAnMScgb3IgJzAnKSBlbmQNCiAgICAgICAgICAgICAgICAgIHJldHVybiByOw0KICAgICAgICAgICAgICBlbmQpLi4nMDAwMCcpOmdzdWIoJyVkJWQlZD8lZD8lZD8lZD8nLCBmdW5jdGlvbih4KQ0KICAgICAgICAgICAgICAgICAgaWYgKCN4IDwgNikgdGhlbiByZXR1cm4gJycgZW5kDQogICAgICAgICAgICAgICAgICBsb2NhbCBjPTANCiAgICAgICAgICAgICAgICAgIGZvciBpPTEsNiBkbyBjPWMrKHg6c3ViKGksaSk9PScxJyBhbmQgMl4oNi1pKSBvciAwKSBlbmQNCiAgICAgICAgICAgICAgICAgIHJldHVybiBiOnN1YihjKzEsYysxKQ0KICAgICAgICAgICAgICBlbmQpLi4oeyAnJywgJz09JywgJz0nIH0pWyNkYXRhJTMrMV0pDQogICAgICAgICAgZW5kDQogICAgICAgICAgbG9jYWwgU2F2ZVBhdGggPSBMSUJfUEFUSC4uIlNpbXBsZUxpYi5sdWEiDQogICAgICAgICAgbG9jYWwgU2NyaXB0UGF0aCA9ICcvQm9ML1RDUFVwZGF0ZXIvR2V0U2NyaXB0NS5waHA/c2NyaXB0PScuLkJhc2U2NEVuY29kZTIoInJhdy5naXRodWJ1c2VyY29udGVudC5jb20vamFjaGljYW8vQm9ML21hc3Rlci9TaW1wbGVMaWIubHVhIikuLicmcmFuZD0nLi5tYXRoLnJhbmRvbSg5OTk5OTk5OSkNCiAgICAgICAgICBsb2NhbCBHb3RTY3JpcHQgPSBmYWxzZQ0KICAgICAgICAgIGxvY2FsIEx1YVNvY2tldCA9IG5pbA0KICAgICAgICAgIGxvY2FsIFNvY2tldCA9IG5pbA0KICAgICAgICAgIGxvY2FsIFNpemUgPSBuaWwNCiAgICAgICAgICBsb2NhbCBSZWN2U3RhcnRlZCA9IGZhbHNlDQogICAgICAgICAgbG9jYWwgUmVjZWl2ZSwgU3RhdHVzLCBTbmlwcGVkID0gbmlsLCBuaWwsIG5pbA0KICAgICAgICAgIGxvY2FsIFN0YXJ0ZWQgPSBmYWxzZQ0KICAgICAgICAgIGxvY2FsIEZpbGUgPSAiIg0KICAgICAgICAgIGxvY2FsIE5ld0ZpbGUgPSAiIg0KICAgICAgICAgIGlmIG5vdCBMdWFTb2NrZXQgdGhlbg0KICAgICAgICAgICAgICBMdWFTb2NrZXQgPSByZXF1aXJlKCJzb2NrZXQiKQ0KICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgU29ja2V0OmNsb3NlKCkNCiAgICAgICAgICAgICAgU29ja2V0ID0gbmlsDQogICAgICAgICAgICAgIFNpemUgPSBuaWwNCiAgICAgICAgICAgICAgUmVjdlN0YXJ0ZWQgPSBmYWxzZQ0KICAgICAgICAgIGVuZA0KICAgICAgICAgIFNvY2tldCA9IEx1YVNvY2tldC50Y3AoKQ0KICAgICAgICAgIGlmIG5vdCBTb2NrZXQgdGhlbg0KICAgICAgICAgICAgICBwcmludCgnU29ja2V0IEVycm9yJykNCiAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgIFNvY2tldDpzZXR0aW1lb3V0KDAsICdiJykNCiAgICAgICAgICAgICAgU29ja2V0OnNldHRpbWVvdXQoOTk5OTk5OTksICd0JykNCiAgICAgICAgICAgICAgU29ja2V0OmNvbm5lY3QoJ3N4LWJvbC5ldScsIDgwKQ0KICAgICAgICAgICAgICBTdGFydGVkID0gZmFsc2UNCiAgICAgICAgICAgICAgRmlsZSA9ICIiDQogICAgICAgICAgZW5kDQogICAgICAgICAgQWRkVGlja0NhbGxiYWNrKGZ1bmN0aW9uKCkNCiAgICAgICAgICAgICAgaWYgR290U2NyaXB0IHRoZW4gcmV0dXJuIGVuZA0KICAgICAgICAgICAgICBSZWNlaXZlLCBTdGF0dXMsIFNuaXBwZWQgPSBTb2NrZXQ6cmVjZWl2ZSgxMDI0KQ0KICAgICAgICAgICAgICBpZiBTdGF0dXMgPT0gJ3RpbWVvdXQnIGFuZCBub3QgU3RhcnRlZCB0aGVuDQogICAgICAgICAgICAgICAgICBTdGFydGVkID0gdHJ1ZQ0KICAgICAgICAgICAgICAgICAgcHJpbnQoIkRvd25sb2FkaW5nIGEgbGlicmFyeSBjYWxsZWQgU2ltcGxlTGliLiBQbGVhc2Ugd2FpdC4uLiIpDQogICAgICAgICAgICAgICAgICBTb2NrZXQ6c2VuZCgiR0VUICIuLlNjcmlwdFBhdGguLiIgSFRUUC8xLjFcclxuSG9zdDogc3gtYm9sLmV1XHJcblxyXG4iKQ0KICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgaWYgKFJlY2VpdmUgb3IgKCNTbmlwcGVkID4gMCkpIGFuZCBub3QgUmVjdlN0YXJ0ZWQgdGhlbg0KICAgICAgICAgICAgICAgICAgUmVjdlN0YXJ0ZWQgPSB0cnVlDQogICAgICAgICAgICAgIGVuZA0KICANCiAgICAgICAgICAgICAgRmlsZSA9IEZpbGUgLi4gKFJlY2VpdmUgb3IgU25pcHBlZCkNCiAgICAgICAgICAgICAgaWYgRmlsZTpmaW5kKCc8L3NpJy4uJ3plPicpIHRoZW4NCiAgICAgICAgICAgICAgICAgIGlmIG5vdCBTaXplIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICBTaXplID0gdG9udW1iZXIoRmlsZTpzdWIoRmlsZTpmaW5kKCc8c2knLi4nemU+JykgKyA2LCBGaWxlOmZpbmQoJzwvc2knLi4nemU+JykgLSAxKSkNCiAgICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICAgICAgaWYgRmlsZTpmaW5kKCc8c2NyJy4uJ2lwdD4nKSB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgbG9jYWwgXywgU2NyaXB0RmluZCA9IEZpbGU6ZmluZCgnPHNjcicuLidpcHQ+JykNCiAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBTY3JpcHRFbmQgPSBGaWxlOmZpbmQoJzwvc2NyJy4uJ2lwdD4nKQ0KICAgICAgICAgICAgICAgICAgICAgIGlmIFNjcmlwdEVuZCB0aGVuIFNjcmlwdEVuZCA9IFNjcmlwdEVuZCAtIDEgZW5kDQogICAgICAgICAgICAgICAgICAgICAgbG9jYWwgRG93bmxvYWRlZFNpemUgPSBGaWxlOnN1YihTY3JpcHRGaW5kICsgMSxTY3JpcHRFbmQgb3IgLTEpOmxlbigpDQogICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgIGlmIEZpbGU6ZmluZCgnPC9zY3InLi4naXB0PicpIHRoZW4NCiAgICAgICAgICAgICAgICAgIGxvY2FsIGEsYiA9IEZpbGU6ZmluZCgnXHJcblxyXG4nKQ0KICAgICAgICAgICAgICAgICAgRmlsZSA9IEZpbGU6c3ViKGEsLTEpDQogICAgICAgICAgICAgICAgICBOZXdGaWxlID0gJycNCiAgICAgICAgICAgICAgICAgIGZvciBsaW5lLGNvbnRlbnQgaW4gaXBhaXJzKEZpbGU6c3BsaXQoJ1xuJykpIGRvDQogICAgICAgICAgICAgICAgICAgICAgaWYgY29udGVudDpsZW4oKSA+IDUgdGhlbg0KICAgICAgICAgICAgICAgICAgICAgICAgICBOZXdGaWxlID0gTmV3RmlsZSAuLiBjb250ZW50DQogICAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgICBlbmQNCiAgICAgICAgICAgICAgICAgIGxvY2FsIEhlYWRlckVuZCwgQ29udGVudFN0YXJ0ID0gTmV3RmlsZTpmaW5kKCc8c2MnLi4ncmlwdD4nKQ0KICAgICAgICAgICAgICAgICAgbG9jYWwgQ29udGVudEVuZCwgXyA9IE5ld0ZpbGU6ZmluZCgnPC9zY3InLi4naXB0PicpDQogICAgICAgICAgICAgICAgICBpZiBub3QgQ29udGVudFN0YXJ0IG9yIG5vdCBDb250ZW50RW5kIHRoZW4NCiAgICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBuZXdmID0gTmV3RmlsZTpzdWIoQ29udGVudFN0YXJ0ICsgMSxDb250ZW50RW5kIC0gMSkNCiAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBuZXdmID0gbmV3Zjpnc3ViKCdccicsJycpDQogICAgICAgICAgICAgICAgICAgICAgaWYgbmV3ZjpsZW4oKSB+PSBTaXplIHRoZW4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuDQogICAgICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgICAgICAgbG9jYWwgbmV3ZiA9IEJhc2U2NERlY29kZShuZXdmKQ0KICAgICAgICAgICAgICAgICAgICAgIGlmIHR5cGUobG9hZChuZXdmKSkgfj0gJ2Z1bmN0aW9uJyB0aGVuDQogICAgICAgICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBmID0gaW8ub3BlbihTYXZlUGF0aCwgIncrYiIpDQogICAgICAgICAgICAgICAgICAgICAgICAgIGY6d3JpdGUobmV3ZikNCiAgICAgICAgICAgICAgICAgICAgICAgICAgZjpjbG9zZSgpDQogICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCJSZXF1aXJlZCBsaWJyYXJ5IGRvd25sb2FkZWQuIFBsZWFzZSByZWxvYWQgd2l0aCAyeCBGOS4iKQ0KICAgICAgICAgICAgICAgICAgICAgIGVuZA0KICAgICAgICAgICAgICAgICAgZW5kDQogICAgICAgICAgICAgICAgICBHb3RTY3JpcHQgPSB0cnVlDQogICAgICAgICAgICAgIGVuZA0KICAgICAgICAgIGVuZCkNCiAgICAgICAgICByZXR1cm4gZmFsc2UNCiAgICAgIGVuZA0KICBlbmQNCiAgDQogIC0tIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1vcmIgd2FsayBzZXR0aW5ncyBzdGFydC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICANCiAgZnVuY3Rpb24gVmlrdG9yOmZpbmRvcmJ3YWxrZXIoKQ0KICAgaWYgX0cuUmVib3JuX0xvYWRlZCB0aGVuDQogICAgICBTQUM9dHJ1ZSBhbmQNCiAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj5TaWRhcyBBdXRvIENhcnJ5IGhhcyBiZWVuIGZvdW5kIikgZW5kLCAyKQ0KICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj5TaWRhcyBBdXRvIENhcnJ5IGludGVncmF0aW9uIGhhcyBiZWVuIGZpbmlzaGVkIHN1Y2Nlc2Z1bGx5IikgZW5kLCA4KQ0KICAgIGVsc2VpZiBub3QgX0cuUmVib3JuX0xvYWRlZCBhbmQgRmlsZUV4aXN0KExJQl9QQVRIIC4uICJTeE9yYldhbGsubHVhIikgdGhlbg0KICAgICAgU3hPcmI9dHJ1ZSBhbmQgDQogICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBwcmludCgiPGZvbnQgY29sb3I9XCIjRkYwMDAwXCI+PGI+ICIuLlNjcmlwdG5hbWUuLiIgLSA8L2I+PC9mb250Pjxmb250IGNvbG9yPVwiI0ZGRkZGRlwiPiBTeE9yYldhbGsgaGFzIGJlZW4gZm91bmQiKSBlbmQsIDIpDQogICAgICAgICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+IFN4T3JiV2FsayBpbnRlZ3JhdGlvbiBoYXMgYmVlbiBmaW5pc2hlZCBzdWNjZXNmdWxseSIpIGVuZCwgNCkNCiAgICAgIHJlcXVpcmUoIlN4T3JiV2FsayIpDQogICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJTeE9yYldhbGsiLCJvcmJXYWxrIikgZW5kLDUpDQogICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIF9HLlN4T3JiOkxvYWRUb01lbnUoc2VsZi5Db25maWcub3JiV2FsaykgZW5kLDUpDQogICAgZWxzZWlmIFNBQ349dHJ1ZSBhbmQgU3hPcmJ+PSB0cnVlIHRoZW4NCiAgICAgIHAoIj09PT09PT09PT09PT09PT09IikNCiAgICAgIHAoIj09PT09PT09PT09PT09PT09IikNCiAgICAgIHAoIlN4T3JiIG9yIFNBQzpSIGlzIHJlcXVpcmVkLiIpDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgZW5kDQogIGVuZA0KICAgIGZ1bmN0aW9uIEFrYWxpOmZpbmRvcmJ3YWxrZXIoKQ0KaWYgX0cuUmVib3JuX0xvYWRlZCB0aGVuDQogICAgICBTQUM9dHJ1ZSBhbmQNCiAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj5TaWRhcyBBdXRvIENhcnJ5IGhhcyBiZWVuIGZvdW5kIikgZW5kLCAyKQ0KICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj5TaWRhcyBBdXRvIENhcnJ5IGludGVncmF0aW9uIGhhcyBiZWVuIGZpbmlzaGVkIHN1Y2Nlc2Z1bGx5IikgZW5kLCA4KQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94MjIiLCAiQ3VycmVudCBPcmJ3YWxrZXI6ICAgICAgICAgICAgICAgICAgICAgIFNpZGFzIEF1dG8gQ2FycnkiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mbzMiLCAiX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXyIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94IiwgIiAgICAgICAgICAgICAgICIuLlNjcmlwdG5hbWUuLiIiLCBTQ1JJUFRfUEFSQU1fSU5GTywgIiIpIA0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94MiIsICIgICAgICAgICAgICAgICAgIFNjcmlwdCBWZXJzaW9uOiAgIi4uVmVyc2lvbi4uICIgICAgICAgICAiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDYiLCAiICAgICAgICAgICAgU2NyaXB0IHdhcyBtYWRlIGJ5ICAiLi5BdXRob3IuLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3g1IiwgIiAgICAgICBMZWF1Z2UgT2YgTGVnZW5kcyBWZXJzaW9uOiAgIi4uTFZlcnNpb24uLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpICAgDQogICAgZWxzZWlmIG5vdCBfRy5SZWJvcm5fTG9hZGVkIGFuZCBGaWxlRXhpc3QoTElCX1BBVEggLi4gIlN4T3JiV2Fsay5sdWEiKSB0aGVuDQogICAgICBTeE9yYj10cnVlIGFuZCANCiAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+IFN4T3JiV2FsayBoYXMgYmVlbiBmb3VuZCIpIGVuZCwgMikNCiAgICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj4gU3hPcmJXYWxrIGludGVncmF0aW9uIGhhcyBiZWVuIGZpbmlzaGVkIHN1Y2Nlc2Z1bGx5IikgZW5kLCA0KQ0KICAgICAgcmVxdWlyZSgiU3hPcmJXYWxrIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDIyIiwgIkN1cnJlbnQgT3Jid2Fsa2VyOiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3hPcmJXYWxrIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm8zIiwgIl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveCIsICIgICAgICAgICAgICAgICAiLi5TY3JpcHRuYW1lLi4iIiwgU0NSSVBUX1BBUkFNX0lORk8sICIiKSANCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDIiLCAiICAgICAgICAgICAgICAgICBTY3JpcHQgVmVyc2lvbjogICIuLlZlcnNpb24uLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3g2IiwgIiAgICAgICAgICAgIFNjcmlwdCB3YXMgbWFkZSBieSAgIi4uQXV0aG9yLi4gIiAgICAgICAgICIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94NSIsICIgICAgICAgTGVhdWdlIE9mIExlZ2VuZHMgVmVyc2lvbjogICIuLkxWZXJzaW9uLi4gIiAgICAgICAgICIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKSAgIA0KICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiU3hPcmJXYWxrIiwib3JiV2FsayIpIGVuZCw1KQ0KICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBfRy5TeE9yYjpMb2FkVG9NZW51KHNlbGYuQ29uZmlnLm9yYldhbGspIGVuZCw1KQ0KICAgIGVsc2VpZiBTQUN+PXRydWUgYW5kIFN4T3Jifj0gdHJ1ZSB0aGVuDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgICBwKCJTeE9yYiBvciBTQUM6UiBpcyByZXF1aXJlZC4iKQ0KICAgICAgcCgiPT09PT09PT09PT09PT09PT0iKQ0KICAgICAgcCgiPT09PT09PT09PT09PT09PT0iKQ0KICAgIGVuZA0KICBlbmQNCiAgZnVuY3Rpb24gTGlzc2FuZHJhOmZpbmRvcmJ3YWxrZXIoKQ0KICAgaWYgX0cuUmVib3JuX0xvYWRlZCB0aGVuDQogICAgICBTQUM9dHJ1ZSBhbmQNCiAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj5TaWRhcyBBdXRvIENhcnJ5IGhhcyBiZWVuIGZvdW5kIikgZW5kLCAyKQ0KICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj5TaWRhcyBBdXRvIENhcnJ5IGludGVncmF0aW9uIGhhcyBiZWVuIGZpbmlzaGVkIHN1Y2Nlc2Z1bGx5IikgZW5kLCA4KQ0KICAgIGVsc2VpZiBub3QgX0cuUmVib3JuX0xvYWRlZCBhbmQgRmlsZUV4aXN0KExJQl9QQVRIIC4uICJTeE9yYldhbGsubHVhIikgdGhlbg0KICAgICAgU3hPcmI9dHJ1ZSBhbmQgDQogICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBwcmludCgiPGZvbnQgY29sb3I9XCIjRkYwMDAwXCI+PGI+ICIuLlNjcmlwdG5hbWUuLiIgLSA8L2I+PC9mb250Pjxmb250IGNvbG9yPVwiI0ZGRkZGRlwiPiBTeE9yYldhbGsgaGFzIGJlZW4gZm91bmQiKSBlbmQsIDIpDQogICAgICAgICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+IFN4T3JiV2FsayBpbnRlZ3JhdGlvbiBoYXMgYmVlbiBmaW5pc2hlZCBzdWNjZXNmdWxseSIpIGVuZCwgNCkNCiAgICAgIHJlcXVpcmUoIlN4T3JiV2FsayIpDQogICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpICBzZWxmLkNvbmZpZzphZGRTdWJNZW51KCJTeE9yYldhbGsiLCJvcmJXYWxrIikgZW5kLDUpDQogICAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIF9HLlN4T3JiOkxvYWRUb01lbnUoc2VsZi5Db25maWcub3JiV2FsaykgZW5kLDUpDQogICAgZWxzZWlmIFNBQ349dHJ1ZSBhbmQgU3hPcmJ+PSB0cnVlIHRoZW4NCiAgICAgIHAoIj09PT09PT09PT09PT09PT09IikNCiAgICAgIHAoIj09PT09PT09PT09PT09PT09IikNCiAgICAgIHAoIlN4T3JiIG9yIFNBQzpSIGlzIHJlcXVpcmVkLiIpDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgZW5kDQogIGVuZA0KICBmdW5jdGlvbiBMZWJsYW5jOmZpbmRvcmJ3YWxrZXIoKQ0KICAgaWYgX0cuUmVib3JuX0xvYWRlZCB0aGVuDQogICAgICBTQUM9dHJ1ZSBhbmQNCiAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj5TaWRhcyBBdXRvIENhcnJ5IGhhcyBiZWVuIGZvdW5kIikgZW5kLCAyKQ0KICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj5TaWRhcyBBdXRvIENhcnJ5IGludGVncmF0aW9uIGhhcyBiZWVuIGZpbmlzaGVkIHN1Y2Nlc2Z1bGx5IikgZW5kLCA4KQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94MjIiLCAiQ3VycmVudCBPcmJ3YWxrZXI6ICAgICAgICAgICAgICAgICAgICAgIFNpZGFzIEF1dG8gQ2FycnkiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mbzMiLCAiX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXyIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94IiwgIiAgICAgICAgICAgICAgICIuLlNjcmlwdG5hbWUuLiIiLCBTQ1JJUFRfUEFSQU1fSU5GTywgIiIpIA0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94MiIsICIgICAgICAgICAgICAgICAgIFNjcmlwdCBWZXJzaW9uOiAgIi4uVmVyc2lvbi4uICIgICAgICAgICAiLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDYiLCAiICAgICAgICAgICAgU2NyaXB0IHdhcyBtYWRlIGJ5ICAiLi5BdXRob3IuLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3g1IiwgIiAgICAgICBMZWF1Z2UgT2YgTGVnZW5kcyBWZXJzaW9uOiAgIi4uTFZlcnNpb24uLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpICAgDQogICAgZWxzZWlmIG5vdCBfRy5SZWJvcm5fTG9hZGVkIGFuZCBGaWxlRXhpc3QoTElCX1BBVEggLi4gIlN4T3JiV2Fsay5sdWEiKSB0aGVuDQogICAgICBTeE9yYj10cnVlIGFuZCANCiAgICBEZWxheUFjdGlvbihmdW5jdGlvbigpIHByaW50KCI8Zm9udCBjb2xvcj1cIiNGRjAwMDBcIj48Yj4gIi4uU2NyaXB0bmFtZS4uIiAtIDwvYj48L2ZvbnQ+PGZvbnQgY29sb3I9XCIjRkZGRkZGXCI+IFN4T3JiV2FsayBoYXMgYmVlbiBmb3VuZCIpIGVuZCwgMikNCiAgICAgICAgICAgIERlbGF5QWN0aW9uKGZ1bmN0aW9uKCkgcHJpbnQoIjxmb250IGNvbG9yPVwiI0ZGMDAwMFwiPjxiPiAiLi5TY3JpcHRuYW1lLi4iIC0gPC9iPjwvZm9udD48Zm9udCBjb2xvcj1cIiNGRkZGRkZcIj4gU3hPcmJXYWxrIGludGVncmF0aW9uIGhhcyBiZWVuIGZpbmlzaGVkIHN1Y2Nlc2Z1bGx5IikgZW5kLCA0KQ0KICAgICAgcmVxdWlyZSgiU3hPcmJXYWxrIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDIyIiwgIkN1cnJlbnQgT3Jid2Fsa2VyOiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU3hPcmJXYWxrIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm8zIiwgIl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18iLCBTQ1JJUFRfUEFSQU1fSU5GTywiIikNCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveCIsICIgICAgICAgICAgICAgICAiLi5TY3JpcHRuYW1lLi4iIiwgU0NSSVBUX1BBUkFNX0lORk8sICIiKSANCiAgICAgICBzZWxmLkNvbmZpZzphZGRQYXJhbSgiaW5mb2JveDIiLCAiICAgICAgICAgICAgICAgICBTY3JpcHQgVmVyc2lvbjogICIuLlZlcnNpb24uLiAiICAgICAgICAgIiwgU0NSSVBUX1BBUkFNX0lORk8sIiIpDQogICAgICAgc2VsZi5Db25maWc6YWRkUGFyYW0oImluZm9ib3g2IiwgIiAgICAgICAgICAgIFNjcmlwdCB3YXMgbWFkZSBieSAgIi4uQXV0aG9yLi4gIiAgICAgICAgICIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKQ0KICAgICAgIHNlbGYuQ29uZmlnOmFkZFBhcmFtKCJpbmZvYm94NSIsICIgICAgICAgTGVhdWdlIE9mIExlZ2VuZHMgVmVyc2lvbjogICIuLkxWZXJzaW9uLi4gIiAgICAgICAgICIsIFNDUklQVF9QQVJBTV9JTkZPLCIiKSAgIA0KICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSAgc2VsZi5Db25maWc6YWRkU3ViTWVudSgiU3hPcmJXYWxrIiwib3JiV2FsayIpIGVuZCw1KQ0KICAgICAgRGVsYXlBY3Rpb24oZnVuY3Rpb24oKSBfRy5TeE9yYjpMb2FkVG9NZW51KHNlbGYuQ29uZmlnLm9yYldhbGspIGVuZCw1KQ0KICAgIGVsc2VpZiBTQUN+PXRydWUgYW5kIFN4T3Jifj0gdHJ1ZSB0aGVuDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgICBwKCI9PT09PT09PT09PT09PT09PSIpDQogICAgICBwKCJTeE9yYiBvciBTQUM6UiBpcyByZXF1aXJlZC4iKQ0KICAgICAgcCgiPT09PT09PT09PT09PT09PT0iKQ0KICAgICAgcCgiPT09PT09PT09PT09PT09PT0iKQ0KICAgIGVuZA0KICBlbmQNCiAgLS0gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLW9yYiB3YWxrIHNldHRpbmdzIHN0YXJ0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogICBmdW5jdGlvbiBEcmF3ZG1nbGliKCkNCiAgICBpZihGaWxlRXhpc3QoTElCX1BBVEguLiJEcmF3RGFtYWdlTGliLmx1YSIpKXRoZW4NCiAgICAgIGNoZWNrPTENCiAgICBlbHNlDQogICAgICBjaGVjaz0wDQogICAgZW5kIA0KICAgICBpZiBfUmVxdWlyZWQoKTpBZGQoe05hbWUgPSAiRHJhd0RhbWFnZUxpYiIsIFVybCA9ICJyYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2lubmVyb3V0L0JvdE9mTGVnZW5kcy9tYXN0ZXIvRHJhd0RhbWFnZUxpYi5sdWEifSk6Q2hlY2soKTpJc0Rvd25sb2FkaW5nKCkgdGhlbiByZXR1cm4gZW5kIA0KICBlbmQNCiAgZnVuY3Rpb24gQ2lyY2xlSW50ZXJzZWN0aW9uKHYxLCB2MiwgYywgcmFkaXVzKQ0KICAgIGFzc2VydChWZWN0b3JUeXBlKHYxKSBhbmQgVmVjdG9yVHlwZSh2MikgYW5kIFZlY3RvclR5cGUoYykgYW5kIHR5cGUocmFkaXVzKSA9PSAibnVtYmVyIiwgIkNpcmNsZUludGVyc2VjdGlvbjogd3JvbmcgYXJndW1lbnQgdHlwZXMgKDxWZWN0b3I+LCA8VmVjdG9yPiwgPFZlY3Rvcj4sIGludGVnZXIgZXhwZWN0ZWQpIikNCiAgICANCiAgICBsb2NhbCB4MSwgeTEsIHgyLCB5MiwgeDMsIHkzID0gdjEueCwgdjEueiBvciB2MS55LCB2Mi54LCB2Mi56IG9yIHYyLnksIGMueCwgYy56IG9yIGMueQ0KICAgIGxvY2FsIHIgPSByYWRpdXMNCiAgICBsb2NhbCB4cCwgeXAsIHhtLCB5bSA9IG5pbCwgbmlsLCBuaWwsIG5pbA0KICAgIGxvY2FsIElzT25TZWdtZW50ID0gbmlsDQogICAgDQogICAgaWYgeDEgPT0geDIgdGhlbg0KICAgIA0KICAgICAgbG9jYWwgQiA9IG1hdGguc3FydChyXjItKHgxLXgzKV4yKQ0KICAgICAgDQogICAgICB4cCwgeXAsIHhtLCB5bSA9IHgxLCB5MytCLCB4MSwgeTMtQg0KICAgIGVsc2UNCiAgICANCiAgICAgIGxvY2FsIG0gPSAoeTIteTEpLyh4Mi14MSkNCiAgICAgIGxvY2FsIG4gPSB5MS1tKngxDQogICAgICBsb2NhbCBBID0geDMtbSoobi15MykNCiAgICAgIGxvY2FsIEIgPSBtYXRoLnNxcnQoQV4yLSgxK21eMikqKHgzXjItcl4yKyhuLXkzKV4yKSkNCiAgICAgIA0KICAgICAgeHAsIHhtID0gKEErQikvKDErbV4yKSwgKEEtQikvKDErbV4yKQ0KICAgICAgeXAsIHltID0gbSp4cCtuLCBtKnhtK24NCiAgICBlbmQNCiAgICANCiAgICBpZiB4MSA8PSB4MiB0aGVuDQogICAgICBJc09uU2VnbWVudCA9IHgxIDw9IHhwIGFuZCB4cCA8PSB4Mg0KICAgIGVsc2UNCiAgICAgIElzT25TZWdtZW50ID0geDIgPD0geHAgYW5kIHhwIDw9IHgxICAgICAgICANCiAgICBlbmQNCiAgICAgIGlmIElzT25TZWdtZW50IHRoZW4NCiAgICAgIHJldHVybiBWZWN0b3IoeHAsIDAsIHlwKQ0KICAgIGVsc2UNCiAgICAgIHJldHVybiBWZWN0b3IoeG0sIDAsIHltKQ0KICAgIGVuZA0KICAgIA0KICBlbmQNCiAgDQogIC0taXNrZXlkb3duZml4IHN0YXJ0DQogIGxvY2FsIG9yaWdpbmFsS0QgPSBfRy5Jc0tleURvd247DQogIF9HLklzS2V5RG93biA9IGZ1bmN0aW9uKHRoZUtleSkNCiAgICBpZiAodHlwZSh0aGVLZXkpIH49ICdudW1iZXInKSB0aGVuDQogICAgICBsb2NhbCB0aGVOdW1iZXIgPSB0b251bWJlcih0aGVLZXkpOw0KICAgICAgaWYgKHRoZU51bWJlciB+PSBuaWwpIHRoZW4NCiAgICAgICAgcmV0dXJuIG9yaWdpbmFsS0QodGhlTnVtYmVyKTsNCiAgICAgIGVsc2UNCiAgICAgICAgcmV0dXJuIG9yaWdpbmFsS0QoR2V0S2V5KHRoZUtleSkpOw0KICAgICAgZW5kOw0KICAgIGVsc2UNCiAgICAgIHJldHVybiBvcmlnaW5hbEtEKHRoZUtleSk7DQogICAgZW5kOw0KICBlbmQ7DQogIC0taXNrZXlkb3duZml4IGVuZA0KICAtLSBBbGwgY2xhc3NpYyBuZWNlc3NlcmllcyBlbmQNCiAgLS1za2luaGFjaw0KICBmdW5jdGlvbiBTZW5kU2tpblBhY2tldChtT2JqZWN0LCBza2luUEIsIG5ldHdvcmtJRCkNCiAgaWYgKHN0cmluZy5maW5kKEdldEdhbWVWZXJzaW9uKCksICdSZWxlYXNlcy81LjIyJykgfj0gbmlsKSB0aGVuDQogICAgbG9jYWwgbVAgPSBDTG9MUGFja2V0KDB4MTBFKTsNCg0KICAgIG1QLnZUYWJsZSA9IDB4RkQxN0QwOw0KDQogICAgbVA6RW5jb2RlRihuZXR3b3JrSUQpOw0KICAgIA0KICAgIG1QOkVuY29kZTEoMHgwMCk7DQogICAgDQogICAgaWYgKHNraW5QQiA9PSBuaWwpIHRoZW4NCiAgICAgIG1QOkVuY29kZTQoMHhFNEU0RTRFNCk7DQogICAgZWxzZQ0KICAgICAgbVA6RW5jb2RlMShza2luUEIpOw0KICAgICAgZm9yIEkgPSAxLCAzIGRvDQogICAgICAgIG1QOkVuY29kZTEoc2tpbkgpOw0KICAgICAgZW5kOw0KICAgIGVuZDsNCg0KICAgIGZvciBJID0gMSwgc3RyaW5nLmxlbihtT2JqZWN0KSBkbw0KICAgICAgbVA6RW5jb2RlMShzdHJpbmcuYnl0ZShzdHJpbmcuc3ViKG1PYmplY3QsIEksIEkpKSk7DQogICAgZW5kOw0KDQogICAgZm9yIEkgPSAxLCAoMTYgLSBzdHJpbmcubGVuKG1PYmplY3QpKSBkbw0KICAgICAgbVA6RW5jb2RlMSgweDAwKTsNCiAgICBlbmQ7DQoNCiAgICBtUDpFbmNvZGU0KDB4MDAwMDAwMEUpOw0KICAgIG1QOkVuY29kZTQoMHgwMDAwMDAwRik7DQogICAgbVA6RW5jb2RlNCgweDAwMDAwMDAwKTsNCiAgICBtUDpFbmNvZGU0KDB4MDAwMDAwMDApOw0KICAgIG1QOkVuY29kZTIoMHgwMDAwKTsNCiAgICANCiAgICBtUDpIaWRlKCk7DQogICAgUmVjdlBhY2tldChtUCk7DQogIGVsc2VpZiAoc3RyaW5nLmZpbmQoR2V0R2FtZVZlcnNpb24oKSwgJ1JlbGVhc2VzLzUuMjEnKSB+PSBuaWwpIHRoZW4NCiAgICAgIGxvY2FsIG1QID0gQ0xvTFBhY2tldCgweDEyQSk7DQoNCiAgICAgIG1QLnZUYWJsZSA9IDB4RUEyOThDOw0KDQogICAgICBtUDpFbmNvZGVGKG5ldHdvcmtJRCk7DQogICAgICANCiAgICAgIG1QOkVuY29kZTQoMHgwMDAwMDAwMCk7DQogICAgICBtUDpFbmNvZGUyKDB4MDAwMCk7DQoNCiAgICAgIGZvciBJID0gMSwgc3RyaW5nLmxlbihtT2JqZWN0KSBkbw0KICAgICAgICBtUDpFbmNvZGUxKHN0cmluZy5ieXRlKHN0cmluZy5zdWIobU9iamVjdCwgSSwgSSkpKTsNCiAgICAgIGVuZDsNCg0KICAgICAgZm9yIEkgPSAxLCAoMTYgLSBzdHJpbmcubGVuKG1PYmplY3QpKSBkbw0KICAgICAgICBtUDpFbmNvZGUxKDB4MDApOw0KICAgICAgZW5kOw0KDQogICAgICBtUDpFbmNvZGU0KDB4MDAwMDAwMEUpOw0KICAgICAgbVA6RW5jb2RlNCgweDAwMDAwMDBGKTsNCiAgICAgIGlmIChza2luUEIgPT0gbmlsKSB0aGVuDQogICAgICAgIG1QOkVuY29kZTQoMHg0RTRFNEU0RSk7DQogICAgICBlbHNlDQogICAgICAgIG1QOkVuY29kZTEoc2tpblBCKTsNCiAgICAgICAgZm9yIEkgPSAxLCAzIGRvDQogICAgICAgICAgbVA6RW5jb2RlMShza2luSCk7DQogICAgICAgIGVuZDsNCiAgICAgIGVuZDsNCiAgICAgIG1QOkVuY29kZTQoMHgwMDAwMDAwMCk7DQogICAgICBtUDpFbmNvZGUxKDB4MDApOw0KDQogICAgICBtUDpIaWRlKCk7DQogICAgICBSZWN2UGFja2V0KG1QKTsNCiAgZW5kOw0KZW5kOw0KICBpZiAoc3RyaW5nLmZpbmQoR2V0R2FtZVZlcnNpb24oKSwgJ1JlbGVhc2VzLzUuMjInKSB+PSBuaWwpIHRoZW4NCiAgc2tpbnNQQiA9IHsNCiAgICBbMV0gPSAweENBLA0KICAgIFsyXSA9IDB4MjAsDQogICAgWzNdID0gMHgzQywNCiAgICBbNF0gPSAweDc1LA0KICAgIFs1XSA9IDB4N0IsDQogICAgWzZdID0gMHhCNCwNCiAgICBbN10gPSAweEM4LA0KICAgIFs4XSA9IDB4Q0UsDQogICAgWzldID0gMHhENCwNCiAgICBbMTBdID0gMHhENywNCiAgICBbMTFdID0gMHhERCwNCiAgICBbMTJdID0gMHhGOSwNCiAgfTsNCiAgc2tpbk9iamVjdFBvcyA9IDExOw0KICBza2luSGVhZGVyID0gMHgxMEU7DQogIGRpc3BlbGxIZWFkZXIgPSAweDgzOw0KICBza2luSCA9IDB4Q0E7DQogIHNraW5IUG9zID0gNzsNCmVsc2VpZiAoc3RyaW5nLmZpbmQoR2V0R2FtZVZlcnNpb24oKSwgJ1JlbGVhc2VzLzUuMjEnKSB+PSBuaWwpIHRoZW4NCiAgICBza2luc1BCID0gew0KICAgICAgWzFdID0gMHg1MiwNCiAgICAgIFsyXSA9IDB4M0UsDQogICAgICBbM10gPSAweDQyLA0KICAgICAgWzRdID0gMHg1RSwNCiAgICAgIFs1XSA9IDB4NjIsDQogICAgICBbNl0gPSAweEFFLA0KICAgICAgWzddID0gMHhCMiwNCiAgICAgIFs4XSA9IDB4QkUsDQogICAgICBbOV0gPSAweEMyLA0KICAgICAgWzEwXSA9IDB4Q0UsDQogICAgICBbMTFdID0gMHhEMiwNCiAgICAgIFsxMl0gPSAweERFLA0KICAgIH07DQogICAgc2tpbk9iamVjdFBvcyA9IDEyOw0KICAgIHNraW5IZWFkZXIgPSAweDEyQTsNCiAgICBkaXNwZWxsSGVhZGVyID0gMHg3OTsNCiAgICBza2luSCA9IDB4NTI7DQogICAgc2tpbkhQb3MgPSAzNjsNCmVuZDs=="), nil, "bt", _ENV))()